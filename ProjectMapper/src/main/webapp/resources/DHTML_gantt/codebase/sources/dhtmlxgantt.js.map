{"version":3,"file":"dhtmlxgantt.js","sources":["../../sources/core/ui/utils/dom_helpers.js","../../sources/utils/global.js","../../sources/ext/click_drag/eventsManager.ts","../../sources/utils/eventable.js","../../sources/utils/helpers.js","../../sources/ext/click_drag/selectedRegion.ts","../../sources/ext/drag_timeline/eventsManager.ts","../../sources/ext/keyboard_navigation/modals.js","../../sources/ext/quick_info/quickInfo.ts","../../sources/utils/utils.js","../../sources/core/ui/utils/dom_event_scope.js","../../sources/ext/tooltip/tooltip.ts","../../sources/ext/tooltip/tooltipManager.ts","../../sources/ext/undo/monitor.ts","../../sources/ext/undo/undo.ts","../../sources/ext/extensions_gpl.ts","../../sources/ext/click_drag/index.ts","../../sources/ext/drag_timeline/index.ts","../../sources/ext/fullscreen/index.ts","../../sources/ext/keyboard_navigation.js","../../sources/ext/keyboard_navigation/common/keyboard_shortcuts.js","../../sources/ext/keyboard_navigation/common/eventhandler.js","../../sources/ext/keyboard_navigation/common/trap_modal_focus.js","../../sources/ext/keyboard_navigation/elements/gantt_node.js","../../sources/ext/keyboard_navigation/elements/nav_node.js","../../sources/ext/keyboard_navigation/elements/header_cell.js","../../sources/ext/keyboard_navigation/elements/task_row.js","../../sources/ext/keyboard_navigation/elements/task_cell.js","../../sources/ext/keyboard_navigation/core.js","../../sources/ext/quick_info/index.ts","../../sources/ext/tooltip/index.ts","../../sources/ext/undo/index.ts","../../sources/ext/marker.js","../../sources/ext/multiselect.js","../../sources/ext/export_api/index.ts","../../sources/constants/index.js","../../sources/ext/extension_manager.ts","../../sources/core/common/config.ts","../../sources/utils/env.js","../../sources/core/common/serialize.ts","../../sources/core/common/ajax.js","../../sources/core/common/date_parsers/fast_version.ts","../../sources/core/common/date_parsers/csp_compliant_version.ts","../../sources/core/common/date.js","../../node_modules/remote-client/dist/remote.es6.js","../../sources/core/remote/remote_events.js","../../sources/utils/timeout.js","../../sources/core/common/state.js","../../sources/utils/promise.js","../../sources/core/facades/datastore_tasks.js","../../sources/core/datastore/power_array.js","../../sources/utils/placeholder_task.js","../../sources/core/datastore/datastore.js","../../sources/core/datastore/treedatastore.js","../../sources/utils/is_headless.js","../../sources/core/datastore/datastore_render.js","../../sources/core/facades/datastore.js","../../sources/core/datastore/select.js","../../sources/core/facades/datastore_links.js","../../sources/core/ui/timeline/scales.js","../../sources/core/gantt_data_range.js","../../sources/utils/task_tree_helpers.js","../../sources/core/dataprocessor/data_processor_events.ts","../../sources/core/dataprocessor/simple_storage.ts","../../sources/core/dataprocessor/data_processor.ts","../../sources/core/dataprocessor/extend_gantt.ts","../../sources/core/dataprocessor/index.js","../../sources/core/plugins/batch_update.js","../../sources/core/plugins/wbs.js","../../sources/core/plugins/resources.js","../../sources/core/plugins/resource_assignments.js","../../sources/core/plugins/new_task_placeholder.js","../../sources/core/plugins/auto_task_types.js","../../sources/core/common/duration_formatter_numeric.ts","../../sources/core/common/link_formatter_simple.ts","../../sources/core/plugins/formatters.js","../../sources/core/plugins/empty_state_screen.ts","../../sources/core/ui/render/baseline_helper.js","../../sources/core/plugins/baselines.js","../../sources/core/loading/parsing.js","../../sources/core/worktime/calendar_arguments_helper.js","../../sources/core/worktime/strategy/work_calendar_merger.js","../../sources/core/worktime/strategy/work_unit_cache/workunit_map_cache.ts","../../sources/core/worktime/strategy/work_unit_cache/workunit_object_cache.ts","../../sources/core/worktime/strategy/work_unit_cache/larger_units_helper.ts","../../sources/core/worktime/strategy/work_unit_cache/date_duration_cache.ts","../../sources/core/worktime/strategy/calendar_strategy.js","../../sources/core/worktime/strategy/work_unit_cache/index.ts","../../sources/core/worktime/legacy_resource_config.js","../../sources/core/worktime/calendar_manager.js","../../sources/core/worktime/dynamic_resource_calendars.js","../../sources/core/worktime/strategy/no_work_time.js","../../sources/core/worktime/time_calculator.js","../../sources/core/facades/worktime_calendars.js","../../sources/core/data.js","../../sources/core/ui/resize_listener.js","../../sources/core/gantt_core.js","../../sources/core/common/assert.js","../../sources/locale/locale_ar.ts","../../sources/locale/locale_be.ts","../../sources/locale/locale_ca.ts","../../sources/locale/locale_cn.ts","../../sources/locale/locale_cs.ts","../../sources/locale/locale_da.ts","../../sources/locale/locale_de.ts","../../sources/locale/locale_el.ts","../../sources/locale/locale_en.ts","../../sources/locale/locale_es.ts","../../sources/locale/locale_fa.ts","../../sources/locale/locale_fi.ts","../../sources/locale/locale_fr.ts","../../sources/locale/locale_he.ts","../../sources/locale/locale_hr.ts","../../sources/locale/locale_hu.ts","../../sources/locale/locale_id.ts","../../sources/locale/locale_it.ts","../../sources/locale/locale_jp.ts","../../sources/locale/locale_kr.ts","../../sources/locale/locale_manager.ts","../../sources/locale/locale_nb.ts","../../sources/locale/locale_nl.ts","../../sources/locale/locale_no.ts","../../sources/locale/locale_pl.ts","../../sources/locale/locale_pt.ts","../../sources/locale/locale_ro.ts","../../sources/locale/locale_ru.ts","../../sources/locale/locale_si.ts","../../sources/locale/locale_sk.ts","../../sources/locale/locale_sv.ts","../../sources/locale/locale_tr.ts","../../sources/locale/locale_ua.ts","../../sources/factory/make_instance_common.js","../../sources/core/common/services.js","../../sources/core/common/dnd.js","../../sources/core/common/templates.js","../../sources/core/datastore/datastore_hooks.js","../../sources/core/plugins/index.js","../../sources/core/grid_column_api.gpl.js","../../sources/core/tasks.js","../../sources/core/worktime/work_time.js","../../sources/core/data_task_types.gpl.js","../../sources/core/cached_functions.js","../../sources/core/destructor.js","../../sources/locale/index.ts","../../sources/core/ui/message.js","../../sources/core/ui/configurable.js","../../sources/core/ui/ui_factory.js","../../sources/core/ui/mouse.js","../../sources/core/ui/render/viewport/is_in_viewport.js","../../sources/core/ui/render/is_legacy_smart_render.js","../../sources/core/ui/render/viewport/get_grid_row_rectangle.js","../../sources/core/ui/render/viewport/get_visible_bars_range.js","../../sources/core/ui/render/render_factory.js","../../sources/core/ui/render/layer_engine.js","../../sources/core/ui/render/viewport/get_bar_rectangle.js","../../sources/core/ui/render/viewport/factory/get_visible_link_range.js","../../sources/core/ui/render/viewport/get_link_rectangle.js","../../sources/core/ui/render/viewport/is_link_in_viewport.js","../../sources/core/ui/gantt_layers.js","../../sources/core/ui/layout/cell.js","../../sources/utils/extends.js","../../sources/core/ui/layout/layout.js","../../sources/core/ui/layout/view_layout.js","../../sources/core/ui/layout/view_cell.js","../../sources/core/ui/layout/scrollbar_cell.js","../../sources/core/ui/row_position_mixin.js","../../sources/core/ui/row_position_fixed_height.js","../../sources/core/ui/timeline/tasks_canvas_render.gpl.js","../../sources/core/ui/timeline/timeline.js","../../sources/core/ui/timeline/timeline_layers_gpl.js","../../sources/core/ui/plugins/column_grid_dnd/scrollable_grid.ts","../../sources/core/ui/plugins/column_grid_dnd/column_grid_dnd.ts","../../sources/core/ui/mouse_event_container.js","../../sources/core/ui/grid/grid.js","../../sources/core/ui/grid/grid_resize.gpl.js","../../sources/core/ui/grid/task_grid_row_resize.js","../../sources/core/ui/grid/editors/keyboard_mappings/default.js","../../sources/core/ui/grid/editors/keyboard_mappings/keyboard_navigation.js","../../sources/core/ui/grid/editors/editors/base.js","../../sources/core/ui/grid/editors/editors/text.js","../../sources/core/ui/grid/editors/editors/number.js","../../sources/core/ui/grid/editors/editors/select.js","../../sources/core/ui/grid/editors/editors/date.js","../../sources/core/ui/grid/editors/editors/predecessor.js","../../sources/core/ui/grid/editors/editors/duration.js","../../sources/core/ui/grid/editors/linked_properties.js","../../sources/core/ui/grid/editors/controller.js","../../sources/core/ui/grid/editors/keyboard_mappings.js","../../sources/core/ui/render/viewport/is_bar_in_viewport.js","../../sources/core/ui/render/task_bar_render.js","../../sources/core/ui/render/task_bar_smart_render.js","../../sources/core/ui/render/dummy_layer.js","../../sources/core/ui/render/viewport/get_bg_row_rectangle.js","../../sources/core/ui/render/viewport/get_visible_cells_range.js","../../sources/core/ui/render/viewport/is_column_visible.js","../../sources/core/ui/render/prerender/task_bg_placeholder.js","../../sources/core/ui/render/link_render.js","../../sources/core/ui/render/viewport/is_grid_row_in_viewport.js","../../sources/core/resource_timetable_builder.js","../../sources/core/ui/grid/tasks_grid_dnd.js","../../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/drop_target.js","../../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/locked_level.js","../../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/highlight.js","../../sources/core/ui/grid/tasks_grid_dnd_marker.js","../../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/multi_level.js","../../sources/core/ui/grid/main_grid_initializer.js","../../sources/core/ui/timeline/tasks_dnd.js","../../sources/core/ui/timeline/links_dnd.js","../../sources/core/ui/timeline/main_timeline_initializer.js","../../sources/core/ui/main_layout_initializer.js","../../sources/core/ui/index.js","../../sources/core/ui/layout/resizer_cell.gpl.js","../../sources/core/ui/render/task_grid_line_render.js","../../sources/core/ui/render/task_bg_render.js","../../sources/core/ui/render/task_rollup_render.js","../../sources/core/ui/render/resource_matrix_render.js","../../sources/core/ui/render/task_grid_row_resize_render.js","../../sources/core/ui/skin.js","../../sources/core/ui/plugins/autoscroll.js","../../sources/core/ui/plugins/jquery_hooks.js","../../sources/core/ui/plugins/dhtmlx_hooks.js","../../sources/core/ui/plugins/timeline_zoom.ts","../../sources/core/ui/touch.js","../../sources/core/ui/lightbox/controls/base_control.js","../../sources/core/ui/utils/html_helpers.js","../../sources/core/ui/lightbox/controls/select_control.js","../../sources/core/ui/lightbox/controls/parent_control.js","../../sources/core/ui/lightbox/index.js","../../sources/core/ui/lightbox/controls/template_control.js","../../sources/core/ui/lightbox/controls/textarea_control.js","../../sources/core/ui/lightbox/controls/time_control.js","../../sources/core/ui/lightbox/controls/checkbox_control.js","../../sources/core/ui/lightbox/controls/radio_control.js","../../sources/core/ui/lightbox/controls/duration_control.js","../../sources/core/ui/lightbox/controls/constraint_control.js","../../sources/core/ui/lightbox/controls/typeselect_control.js","../../sources/core/ui/lightbox/controls/baseline_control.js","../../sources/core/ui_core.js","../../sources/core/data_task_layers.gpl.js","../../sources/core/facades/layout.js","../../sources/css/skins/skyblue.js","../../sources/css/skins/dark.js","../../sources/css/skins/meadow.js","../../sources/css/skins/terrace.js","../../sources/css/skins/broadway.js","../../sources/css/skins/material.js","../../sources/css/skins/contrast_black.js","../../sources/css/skins/contrast_white.js","../../sources/core/ui/plugins/index.js","../../sources/core/ui/lightbox/lightbox_optional_time.js","../../sources/core/ui/wai_aria.js","../../sources/dhtmlxgantt.gpl.ts","../../sources/factory/make_instance_web.js","../../sources/core/loading/ajax_loading.js"],"sourcesContent":["//returns position of html element on the page\nfunction getNodePosition(elem) {\n\tvar top=0, left=0, right=0, bottom=0;\n\tif (elem.getBoundingClientRect) { //HTML5 method\n\t\tvar box = elem.getBoundingClientRect();\n\t\tvar body = document.body;\n\t\tvar docElem = (document.documentElement ||\n\t\t\tdocument.body.parentNode ||\n\t\t\tdocument.body);\n\n\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\n\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\n\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\n\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\n\t\ttop  = box.top +  scrollTop - clientTop;\n\t\tleft = box.left + scrollLeft - clientLeft;\n\n\t\tright = document.body.offsetWidth - box.right;\n\t\tbottom = document.body.offsetHeight - box.bottom;\n\t} else { //fallback to naive approach\n\t\twhile(elem) {\n\t\t\ttop = top + parseInt(elem.offsetTop,10);\n\t\t\tleft = left + parseInt(elem.offsetLeft,10);\n\t\t\telem = elem.offsetParent;\n\t\t}\n\n\t\tright = document.body.offsetWidth - elem.offsetWidth - left;\n\t\tbottom = document.body.offsetHeight - elem.offsetHeight - top;\n\t}\n\treturn { y: Math.round(top), x: Math.round(left), width:elem.offsetWidth, height:elem.offsetHeight, right: Math.round(right), bottom: Math.round(bottom) };\n}\n\nfunction isVisible(node){\n\tvar display = false,\n\t\tvisibility = false;\n\tif(window.getComputedStyle){\n\t\tvar style = window.getComputedStyle(node, null);\n\t\tdisplay = style[\"display\"];\n\t\tvisibility = style[\"visibility\"];\n\t}else if(node.currentStyle){\n\t\tdisplay = node.currentStyle[\"display\"];\n\t\tvisibility = node.currentStyle[\"visibility\"];\n\t}\n\treturn (display != \"none\" && visibility != \"hidden\");\n}\n\nfunction hasNonNegativeTabIndex(node){\n\treturn !isNaN(node.getAttribute(\"tabindex\")) && (node.getAttribute(\"tabindex\")*1 >= 0);\n}\n\nfunction hasHref(node){\n\tvar canHaveHref = {\"a\": true, \"area\": true};\n\tif(canHaveHref[node.nodeName.loLowerCase()]){\n\t\treturn !!node.getAttribute(\"href\");\n\t}\n\treturn true;\n}\n\nfunction isEnabled(node){\n\tvar canDisable = {\"input\":true, \"select\":true, \"textarea\":true, \"button\":true, \"object\":true};\n\tif(canDisable[node.nodeName.toLowerCase()]){\n\t\treturn !node.hasAttribute(\"disabled\");\n\t}\n\n\treturn true;\n}\n\nfunction getFocusableNodes(root){\n\tvar nodes = root.querySelectorAll([\n\t\t\"a[href]\",\n\t\t\"area[href]\",\n\t\t\"input\",\n\t\t\"select\",\n\t\t\"textarea\",\n\t\t\"button\",\n\t\t\"iframe\",\n\t\t\"object\",\n\t\t\"embed\",\n\t\t\"[tabindex]\",\n\t\t\"[contenteditable]\"\n\t].join(\", \"));\n\n\tvar nodesArray = Array.prototype.slice.call(nodes, 0);\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tnodesArray[i].$position = i;\n\t\t// we remember original nodes order, \n\t\t// so when we sort them by tabindex we ensure order of nodes with same tabindex is preserved, \n\t\t// since some browsers do unstable sort\n\t}\n\t\n\t// use tabindex to sort focusable nodes\n\tnodesArray.sort(function(a, b) {\n\t\tif(a.tabIndex === 0 && b.tabIndex !== 0){\n\t\t\treturn 1;\n\t\t}\n\t\tif(a.tabIndex !== 0 && b.tabIndex === 0){\n\t\t\treturn -1;\n\t\t}\n\t\t\n\t\tif (a.tabIndex === b.tabIndex){\n\t\t\t// ensure we do stable sort\n\t\t\treturn a.$position - b.$position;\n\t\t}\n\t\tif (a.tabIndex < b.tabIndex) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn 1;\n\t});\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tvar node = nodesArray[i];\n\t\tvar isValid = (hasNonNegativeTabIndex(node)  || isEnabled(node) || hasHref(node)) && isVisible(node);\n\t\tif(!isValid){\n\t\t\tnodesArray.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n\treturn nodesArray;\n}\n\nfunction getScrollSize(){\n\tvar div = document.createElement(\"div\");\n\tdiv.style.cssText=\"visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;\";\n\n\tdocument.body.appendChild(div);\n\tvar width = div.offsetWidth-div.clientWidth;\n\tdocument.body.removeChild(div);\n\n\treturn Math.max(width, 15);\n}\n\nfunction getClassName(node){\n\tif(!node) return \"\";\n\n\tvar className = node.className || \"\";\n\tif(className.baseVal)//'className' exist but not a string - IE svg element in DOM\n\t\tclassName = className.baseVal;\n\n\tif(!className.indexOf)\n\t\tclassName = \"\";\n\n\treturn _trimString(className);\n}\n\nfunction addClassName(node, className){\n\tif (className && node.className.indexOf(className) === -1) {\n\t\tnode.className += \" \" + className;\n\t}\n}\n\nfunction removeClassName(node, name) {\n\tname = name.split(\" \");\n\tfor (var i = 0; i < name.length; i++) {\n\t\tvar regEx = new RegExp(\"\\\\s?\\\\b\" + name[i] + \"\\\\b(?![-_.])\", \"\");\n\t\tnode.className = node.className.replace(regEx, \"\");\n\t}\n}\n\nfunction hasClass(element, className){\n\tif ('classList' in element) {\n\t\treturn element.classList.contains(className);\n\t} else { \n\t\treturn new RegExp(\"\\\\b\" + className + \"\\\\b\").test(element.className);\n\t}\n}\n\nfunction toNode(node) {\n\tif (typeof node === \"string\") {\n\t\treturn (document.getElementById(node) || document.querySelector(node) || document.body);\n\t}\n\treturn node || document.body;\n}\n\nvar _slave;\nfunction insertNode(node, newone) {\n\tif(!_slave){\n\t\t_slave = document.createElement(\"div\");\n\t}\n\t_slave.innerHTML = newone;\n\tvar child = _slave.firstChild;\n\tnode.appendChild(child);\n\treturn child;\n}\n\nfunction removeNode(node) {\n\tif (node && node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\nfunction getChildNodes(node, css) {\n\tvar ch = node.childNodes;\n\tvar len = ch.length;\n\tvar out = [];\n\tfor (var i = 0; i < len; i++) {\n\t\tvar obj = ch[i];\n\t\tif (obj.className && obj.className.indexOf(css) !== -1) {\n\t\t\tout.push(obj);\n\t\t}\n\t}\n\treturn out;\n}\n\nfunction getTargetNode(e) {\n\tvar trg;\n\tif (e.tagName)\n\t\ttrg = e;\n\telse {\n\t\te = e || window.event;\n\t\ttrg = e.target || e.srcElement;\n\t\tif (trg.shadowRoot && e.composedPath) {\n\t\t\ttrg = e.composedPath()[0];\n\t\t}\n\t}\n\treturn trg;\n}\n\nfunction locateAttribute(e, attribute) {\n\tif(!attribute) return;\n\n\tvar trg = getTargetNode(e);\n\n\twhile (trg){\n\t\tif (trg.getAttribute){\t//text nodes has not getAttribute\n\t\t\tvar test = trg.getAttribute(attribute);\n\t\t\tif (test) return trg;\n\t\t}\n\t\ttrg=trg.parentNode;\n\t}\n\treturn null;\n}\n\nfunction _trimString(str){\n\tvar func = String.prototype.trim || function(){ return this.replace(/^\\s+|\\s+$/g, \"\"); };\n\treturn func.apply(str);\n}\n\nfunction locateClassName(e, classname, strict){\n\tvar trg = getTargetNode(e);\n\tvar css = \"\";\n\n\tif(strict === undefined)\n\t\tstrict = true;\n\n\twhile (trg){\n\t\tcss = getClassName(trg);\n\t\tif(css){\n\t\t\tvar ind = css.indexOf(classname);\n\t\t\tif (ind >= 0){\n\t\t\t\tif (!strict)\n\t\t\t\t\treturn trg;\n\n\t\t\t\t//check that we have exact match\n\t\t\t\tvar left = (ind === 0) || (!_trimString(css.charAt(ind - 1)));\n\t\t\t\tvar right = ((ind + classname.length >= css.length)) || (!_trimString(css.charAt(ind + classname.length)));\n\n\t\t\t\tif (left && right)\n\t\t\t\t\treturn trg;\n\t\t\t}\n\t\t}\n\t\ttrg=trg.parentNode;\n\t}\n\treturn null;\n}\n\n/*\nevent position relatively to DOM element\n */\nfunction getRelativeEventPosition(ev, node){\n\tvar d = document.documentElement;\n\tvar box = getNodePosition(node);\n\n\treturn {\n\t\tx: ev.clientX + d.scrollLeft - d.clientLeft - box.x + node.scrollLeft,\n\t\ty: ev.clientY + d.scrollTop - d.clientTop - box.y + node.scrollTop\n\t};\n}\n\nfunction getRelativeNodePosition(child, parent){\n\tconst childPos = getNodePosition(child);\n\tconst parentPos = getNodePosition(parent);\n\treturn {\n\t\tx: childPos.x - parentPos.x,\n\t\ty: childPos.y - parentPos.y\n\t};\n}\n\nfunction isChildOf(child, parent){\n\tif(!child || !parent){\n\t\treturn false;\n\t}\n\n\twhile(child && child != parent) {\n\t\tchild = child.parentNode;\n\t}\n\n\treturn child === parent;\n}\n\nfunction closest(element, selector){\n\tif(element.closest){\n\t\treturn element.closest(selector);\n\t}else if(element.matches || element.msMatchesSelector || element.webkitMatchesSelector){\n\t\tvar el = element;\n\t\tif (!document.documentElement.contains(el)) return null;\n\t\tdo {\n\t\t\tvar method = el.matches || el.msMatchesSelector || el.webkitMatchesSelector;\n\n\t\t\tif (method.call(el, selector)) return el;\n\t\t\tel = el.parentElement || el.parentNode;\n\t\t} while (el !== null && el.nodeType === 1); \n\t\treturn null;\n\t}else{\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\"Your browser is not supported\");\n\t\treturn null;\n\t}\n}\n\nfunction getClosestSizedElement(element) {\n\twhile (element) {\n\t\tif (element.offsetWidth > 0 && element.offsetHeight > 0) {\n\t\t\treturn element;\n\t\t}\n\t\telement = element.parentElement;\n\t}\n\treturn null;\n}\n\nfunction isShadowDomSupported() {\n\treturn document.head.createShadowRoot || document.head.attachShadow;\n}\n\n/**\n * Returns element that has the browser focus, or null if no element has focus.\n * Works with shadow DOM, so it's prefereed to use this function instead of document.activeElement directly.\n * @returns HTMLElement\n */\nfunction getActiveElement(){\n\tvar activeElement = document.activeElement;\n\tif (activeElement.shadowRoot) {\n\t\tactiveElement = activeElement.shadowRoot.activeElement;\n\t}\n\tif (activeElement === document.body && document.getSelection) {\n\t\tactiveElement = document.getSelection().focusNode || document.body;\n\t}\n\n\treturn activeElement;\n}\n\n/**\n * Returns document.body or the host node of the ShadowRoot, if the element is attached to ShadowDom\n * @param {HTMLElement} element \n * @returns HTMLElement\n */\nfunction getRootNode(element) {\n\tif (!element) {\n\t\treturn document.body;\n\t}\n\tif (!isShadowDomSupported()) {\n\t\treturn document.body;\n\t}\n\twhile (element.parentNode && (element = element.parentNode)) {\n\t\tif (element instanceof ShadowRoot) {\n\t\t\treturn element.host;\n\t\t}\n\t}\n\treturn document.body;\n}\n\nfunction hasShadowParent(element) {\n\treturn !!getRootNode(element);\n}\n\nexport {\n\tgetNodePosition,\n\tgetFocusableNodes,\n\tgetScrollSize,\n\tgetClassName,\n\taddClassName,\n\tremoveClassName,\n\tinsertNode,\n\tremoveNode,\n\tgetChildNodes,\n\ttoNode,\n\tlocateClassName,\n\tlocateAttribute,\n\tgetTargetNode,\n\tgetRelativeEventPosition,\n\tisChildOf,\n\thasClass,\n\tclosest,\n\tgetRootNode,\n\thasShadowParent,\n\tisShadowDomSupported,\n\tgetActiveElement,\n\tgetRelativeNodePosition,\n\tgetClosestSizedElement\n};","\n/* eslint-disable no-restricted-globals */\nvar globalScope;\nif(typeof window !== \"undefined\"){\n\tglobalScope = window;\n}else{\n\tglobalScope = global;\n}\n/* eslint-enable no-restricted-globals */\n\nexport default globalScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\nimport global from \"../../utils/global\";\nimport { SelectedRegion } from \"./selectedRegion\";\n\nexport class EventsManager {\n\tprivate _mouseDown: boolean = false;\n\tprivate _domEvents: any;\n\tprivate _originPosition: string;\n\tprivate _gantt: any;\n\tprivate _restoreOriginPosition: () => void;\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = gantt._createDomEventScope();\n\t}\n\n\tattach(selectedRegion: SelectedRegion, useKey?: \"shiftKey\" | \"ctrlKey\" | \"altKey\", ignore?: any): void {\n\t\tconst gantt = this._gantt;\n\t\tconst _target = selectedRegion.getViewPort();\n\t\tthis._originPosition = global.getComputedStyle(_target).display;\n\t\tthis._restoreOriginPosition = () => {\n\t\t\t_target.style.position = this._originPosition;\n\t\t};\n\t\tif (this._originPosition === \"static\") {\n\t\t\t_target.style.position = \"relative\";\n\t\t}\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tstate.registerProvider(\"clickDrag\", () => {\n\t\t\tconst result = { autoscroll: false };\n\t\t\treturn result;\n\t\t});\n\n\n\t\tlet scheduledDndCoordinates = null;\n\t\tconst startDragAndDrop = () => {\n\t\t\tif (!scheduledDndCoordinates) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._mouseDown = true;\n\t\t\tselectedRegion.setStart(gantt.copy(scheduledDndCoordinates));\n\t\t\tselectedRegion.setPosition(gantt.copy(scheduledDndCoordinates));\n\t\t\tselectedRegion.setEnd(gantt.copy(scheduledDndCoordinates));\n\t\t\tscheduledDndCoordinates = null;\n\t\t};\n\n\t\tthis._domEvents.attach(_target, \"mousedown\", (event) => {\n\t\t\tscheduledDndCoordinates = null;\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\n\t\t\tif (ignore !== undefined) {\n\t\t\t\tif (ignore instanceof Array) {\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\n\t\t\t\t} else {\n\t\t\t\t\tfilterTargets = ignore;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterTargets) {\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstate.registerProvider(\"clickDrag\", () => {\n\t\t\t\tconst result = { autoscroll: this._mouseDown };\n\t\t\t\treturn result;\n\t\t\t});\n\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\tscheduledDndCoordinates = this._getCoordinates(event, selectedRegion);\n\t\t});\n\t\tconst eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\n\t\tthis._domEvents.attach(eventElement, \"mouseup\", (event) => {\n\t\t\tscheduledDndCoordinates = null;\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tthis._mouseDown = false;\n\t\t\t\tconst coordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tselectedRegion.dragEnd(coordinates);\n\t\t\t}\n\t\t});\n\t\tthis._domEvents.attach(_target, \"mousemove\", (event) => {\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\t// GS-854. If we don't have useKey for the click_drag extension,\n\t\t\t// check the drag_timeline to not simultaneously use both extensions\n\t\t\tconst dragTimeline = this._gantt.ext.clickDrag;\n\t\t\tconst dragTimelineUseKey = (this._gantt.config.drag_timeline || {}).useKey;\n\t\t\tif (dragTimeline && dragTimelineUseKey) {\n\t\t\t\tif (!useKey && event[dragTimelineUseKey]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet coordinates = null;\n\t\t\tif(!this._mouseDown && scheduledDndCoordinates){\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tif(Math.abs(scheduledDndCoordinates.relative.left - coordinates.relative.left) > 5){\n\t\t\t\t\t// add small threshold not to start dnd on simple click\n\t\t\t\t\tstartDragAndDrop();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tselectedRegion.setEnd(coordinates);\n\t\t\t\tselectedRegion.render();\n\t\t\t}\n\t\t});\n\t}\n\n\tdetach(): void {\n\t\tconst gantt = this._gantt;\n\t\tthis._domEvents.detachAll();\n\t\tif(this._restoreOriginPosition){\n\t\t\tthis._restoreOriginPosition();\n\t\t}\n\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tstate.unregisterProvider(\"clickDrag\");\n\t}\n\n\tdestructor(): void {\n\t\tthis.detach();\n\t}\n\n\tprivate _getCoordinates(event: MouseEvent, selectedRegion: SelectedRegion) {\n\t\tconst viewPort = selectedRegion.getViewPort();\n\t\tconst viewPortBounds = viewPort.getBoundingClientRect();\n\t\tconst { clientX, clientY } = event;\n\t\tconst result = {\n\t\t\tabsolute: {\n\t\t\t\tleft: clientX,\n\t\t\t\ttop: clientY\n\t\t\t},\n\t\t\trelative: {\n\t\t\t\tleft: clientX - viewPortBounds.left + viewPort.scrollLeft,\n\t\t\t\ttop: clientY - viewPortBounds.top + viewPort.scrollTop\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n}","var EventHost = function(){\n\tthis._silent_mode = false;\n\tthis.listeners = {};\n};\n\nEventHost.prototype = {\n\t_silentStart: function() {\n\t\tthis._silent_mode = true;\n\t},\n\t_silentEnd: function() {\n\t\tthis._silent_mode = false;\n\t}\n};\n\nvar\tcreateEventStorage = function(obj) {\n\tvar handlers = {};\n\tvar index = 0;\n\tvar eventStorage = function(){\n\t\tvar combinedResult = true;\n\t\tfor(var i in handlers){\n\t\t\tvar handlerResult = handlers[i].apply(obj, arguments);\n\t\t\tcombinedResult=combinedResult && handlerResult;\n\t\t}\n\t\treturn combinedResult;\n\t};\n\teventStorage.addEvent=function(handler, settings){\n\t\tif (typeof (handler) == \"function\"){\n\t\t\tvar handlerId;\n\t\t\tif(settings && settings.id){\n\t\t\t\thandlerId = settings.id;\n\t\t\t}else{\n\t\t\t\thandlerId = index;\n\t\t\t\tindex++;\n\t\t\t}\n\n\t\t\tif(settings && settings.once){\n\t\t\t\tvar originalHandler = handler;\n\t\t\t\thandler = function(){\n\t\t\t\t\toriginalHandler();\n\t\t\t\t\teventStorage.removeEvent(handlerId);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\thandlers[handlerId] = handler;\n\t\t\treturn handlerId;\n\t\t}\n\t\treturn false;\n\t};\n\teventStorage.removeEvent=function(id){\n\t\tdelete handlers[id];\n\t};\n\n\teventStorage.clear = function(){\n\t\thandlers = {};\n\t};\n\n\treturn eventStorage;\n};\n\nfunction makeEventable(obj){\n\n\tvar eventHost = new EventHost();\n\tobj.attachEvent=function(eventName, handler, settings){\n\t\teventName = 'ev_'+eventName.toLowerCase();\n\t\tif (!eventHost.listeners[eventName]){\n\t\t\teventHost.listeners[eventName] = createEventStorage(this);\n\t\t}\n\n\t\tif(settings && settings.thisObject){\n\t\t\thandler = handler.bind(settings.thisObject);\n\t\t}\n\n\t\tvar innerId = eventHost.listeners[eventName].addEvent(handler, settings);\n\n\t\tvar handlerId = (eventName+':'+innerId); //return ID (ev_eventname:1)\n\t\tif(settings && settings.id){\n\t\t\thandlerId = settings.id;\n\t\t}\n\t\treturn handlerId;\n\t};\n\n\tobj.attachAll = function(callback){\n\t\tthis.attachEvent('listen_all', callback);\n\t};\n\n\tobj.callEvent=function(name, eventArguments){\n\t\tif (eventHost._silent_mode) return true;\n\n\t\tvar handlerName = 'ev_'+name.toLowerCase();\n\n\t\tvar listeners = eventHost.listeners;\n\t\tif (listeners['ev_listen_all']){\n\t\t\tlisteners['ev_listen_all'].apply(this, [name].concat(eventArguments));\n\t\t}\n\n\t\tif (listeners[handlerName])\n\t\t\treturn listeners[handlerName].apply(this, eventArguments);\n\t\treturn true;\n\t};\n\n\tobj.checkEvent=function(name){\n\t\tvar listeners = eventHost.listeners;\n\t\treturn (!!listeners['ev_'+name.toLowerCase()]);\n\t};\n\n\tobj.detachEvent=function(id){\n\t\tif (id){\n\t\t\tvar listeners = eventHost.listeners;\n\t\t\tfor(var i in listeners){\n\t\t\t\tlisteners[i].removeEvent(id); //remove event\n\t\t\t}\n\n\t\t\tvar list = id.split(':');//get EventName and ID\n\t\t\tvar listeners = eventHost.listeners;\n\t\t\tif(list.length === 2){\n\t\t\t\tvar eventName = list[0];\n\t\t\t\tvar eventId = list[1];\n\t\t\t\tif(listeners[eventName]){\n\t\t\t\t\tlisteners[eventName].removeEvent(eventId); //remove event\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tobj.detachAllEvents = function(){\n\t\tfor (var name in eventHost.listeners) {\n\t\t\teventHost.listeners[name].clear();\n\t\t}\n\t};\n\n}\n\nexport default makeEventable;","var units = {\n\t\"second\": 1,\n\t\"minute\": 60,\n\t\"hour\": 60 * 60,\n\t\"day\": 60 * 60 * 24,\n\t\"week\": 60 * 60 * 24 * 7,\n\t\"month\": 60 * 60 * 24 * 30,\n\t\"quarter\": 60 * 60 * 24 * 30 * 3,\n\t\"year\": 60 * 60 * 24 * 365\n};\nfunction getSecondsInUnit(unit){\n\treturn units[unit] || units.hour;\n}\n\nfunction forEach(arr, callback) {\n\tif (arr.forEach) {\n\t\tarr.forEach(callback);\n\t} else {\n\t\tvar workArray = arr.slice();\n\t\tfor (var i = 0; i < workArray.length; i++) {\n\t\t\tcallback(workArray[i], i);\n\t\t}\n\t}\n}\n\nfunction arrayMap(arr, callback) {\n\tif (arr.map) {\n\t\treturn arr.map(callback);\n\t} else {\n\t\tvar workArray = arr.slice();\n\t\tvar resArray = [];\n\n\t\tfor (var i = 0; i < workArray.length; i++) {\n\t\t\tresArray.push(callback(workArray[i], i));\n\t\t}\n\t\treturn resArray;\n\t}\n}\n\n\nfunction arrayFind(arr, callback) {\n\tif (arr.find) {\n\t\treturn arr.find(callback);\n\t} else {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (callback(arr[i], i)) {\n\t\t\t\treturn arr[i];\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction arrayIncludes(arr, item) {\n\tif(arr.includes){\n\t\treturn arr.includes(item);\n\t}else{\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (arr[i] === item) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n\n// iframe-safe array type check instead of using instanceof\nfunction isArray(obj){\n\tif(Array.isArray){\n\t\treturn Array.isArray(obj);\n\t}else{\n\t\t// close enough\n\t\treturn (obj && obj.length !== undefined && obj.pop && obj.push);\n\t}\n}\n\n// non-primitive string object, e.g. new String(\"abc\")\nfunction isStringObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function String() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Number(5)\nfunction isNumberObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Number() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Boolean(true)\nfunction isBooleanObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Boolean() { [native code] }\";\n}\n\nfunction isDate(obj) {\n\tif (obj && typeof obj === \"object\") {\n\t\treturn !!(obj.getFullYear && obj.getMonth && obj.getDate);\n\t} else {\n\t\treturn false;\n\t}\n}\n\nfunction isValidDate(obj){\n\treturn isDate(obj) && !isNaN(obj.getTime());\n}\n\nfunction arrayFilter(arr, callback) {\n\tvar result = [];\n\n\tif (arr.filter) {\n\t\treturn arr.filter(callback);\n\t} else {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (callback(arr[i], i)) {\n\t\t\t\tresult[result.length] = arr[i];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nfunction hashToArray(hash) {\n\tvar result = [];\n\n\tfor (var key in hash) {\n\t\tif (hash.hasOwnProperty(key)) {\n\t\t\tresult.push(hash[key]);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction arraySome(arr, callback) {\n\tif (arr.length === 0) return false;\n\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (callback(arr[i], i, arr)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction arrayDifference(arr, callback) {\n\treturn arrayFilter(arr, function(item, i) {\n\t\treturn !callback(item, i);\n\t});\n}\n\nfunction throttle (callback, timeout) {\n\tvar wait = false;\n\n\treturn function () {\n\t\tif (!wait) {\n\t\t\tcallback.apply(null, arguments);\n\t\t\twait = true;\n\t\t\tsetTimeout(function () {\n\t\t\t\twait = false;\n\t\t\t}, timeout);\n\t\t}\n\t};\n}\n\nfunction delay (callback, timeout){\n\tvar timer;\n\n\tvar result = function() {\n\t\tresult.$cancelTimeout();\n\t\tresult.$pending = true;\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\ttimer = setTimeout(function(){\n\t\t\tcallback.apply(this, args);\n\t\t\tresult.$pending = false;\n\t\t}, timeout);\n\t};\n\n\tresult.$pending = false;\n\tresult.$cancelTimeout = function(){\n\t\tclearTimeout(timer);\n\t\tresult.$pending = false;\n\t};\n\tresult.$execute = function(){\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\tcallback.apply(this, args);\n\t\tresult.$cancelTimeout();\n\t};\n\n\treturn result;\n}\n\nfunction sortArrayOfHash(arr, field, desc) {\n\tvar compare = function(a, b) {\n\t\treturn a < b;\n\t};\n\n\tarr.sort(function(a, b) {\n\t\tif (a[field] === b[field]) return 0;\n\n\t\treturn desc ? compare(a[field], b[field]) : compare(b[field], a[field]);\n\t});\n}\n\nfunction objectKeys(obj) {\n\tif (Object.keys) {\n\t\treturn Object.keys(obj);\n\t}\n\tvar result = [];\n\tvar key;\n\tfor (key in obj) {\n\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction isEventable(obj) {\n\treturn obj.attachEvent && obj.detachEvent;\n}\n\n//GS-1090: A task should be able to have the id = 0\nfunction replaceValidZeroId(id, rootId) {\n\tif (checkZeroId(id) && !checkZeroId(rootId)){\n\t\tid = \"0\";\n\t}\n\treturn id;\n}\n\nfunction checkZeroId(id) {\n\tif (id === 0){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction findBinary(array, target) {\n\t// modified binary search, target value not exactly match array elements, looking for closest one\n\n\tvar low = 0, high = array.length - 1, i, item, prev;\n\twhile (low <= high) {\n\n\t\ti = Math.floor((low + high) / 2);\n\t\titem = +array[i];\n\t\tprev = +array[i - 1];\n\t\tif (item < target) {\n\t\t\tlow = i + 1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (item > target) {\n\t\t\tif (!(!isNaN(prev) && prev < target)) {\n\t\t\t\thigh = i - 1;\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\t// if target is between 'i' and 'i-1' return 'i - 1'\n\t\t\t\treturn i - 1;\n\t\t\t}\n\n\t\t}\n\t\twhile (+array[i] == +array[i + 1]) i++;\n\n\t\treturn i;\n\t}\n\treturn array.length - 1;\n}\n\nexport {\n\tgetSecondsInUnit,\n\tforEach,\n\tarrayMap,\n\tarrayIncludes,\n\tarrayFind,\n\tarrayFilter,\n\tarrayDifference,\n\tarraySome,\n\thashToArray,\n\tsortArrayOfHash,\n\tthrottle,\n\tisArray,\n\tisDate,\n\tisValidDate,\n\tisStringObject,\n\tisNumberObject,\n\tisBooleanObject,\n\tdelay,\n\tobjectKeys,\n\tisEventable,\n\treplaceValidZeroId,\n\tcheckZeroId,\n\tfindBinary\n};","import eventable from \"../../utils/eventable\";\nimport { isEventable } from \"../../utils/helpers\";\n\nexport interface ISelectedRegionConfig {\n\tclassName?: string;\n\trender?: (startPoint: IPoint, endPoint: IPoint) => HTMLElement;\n\tviewPort?: HTMLElement;\n\tuseRequestAnimationFrame: boolean;\n\tcallback?: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\n\tsingleRow: boolean;\n}\n\ninterface ICoordinates {\n\tleft: number;\n\ttop: number;\n}\n\nexport interface IPoint {\n\tabsolute: ICoordinates;\n\trelative: ICoordinates;\n}\n\nexport class SelectedRegion {\n\trender: () => void;\n\tprivate _viewPort: HTMLElement & eventable;\n\tprivate _el: HTMLElement = document.createElement(\"div\");\n\tprivate _callback: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\n\tprivate _startPoint: IPoint;\n\tprivate _endPoint: IPoint;\n\tprivate _positionPoint: IPoint;\n\tprivate _useRequestAnimationFrame: boolean;\n\tprivate _startDate: Date;\n\tprivate _endDate: Date;\n\tprivate _singleRow: boolean;\n\tprivate _gantt: any;\n\tprivate _view: any;\n\n\tconstructor(config: ISelectedRegionConfig, gantt: any, view: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._view = view;\n\t\tthis._viewPort = config.viewPort;\n\t\tthis._el.classList.add(config.className);\n\t\tif (typeof config.callback === \"function\") {\n\t\t\tthis._callback = config.callback;\n\t\t}\n\n\t\tthis.render = () => {\n\t\t\tlet node;\n\t\t\tif(config.render){\n\t\t\t\tnode = config.render(this._startPoint, this._endPoint);\n\t\t\t}else{\n\t\t\t\tnode = this.defaultRender(this._startPoint, this._endPoint);\n\t\t\t}\n\n\t\t\tif(node !== this._el){\n\t\t\t\tif(this._el && this._el.parentNode){\n\t\t\t\t\tthis._el.parentNode.removeChild(this._el);\n\t\t\t\t}\n\t\t\t\tthis._el = node;\n\t\t\t}\n\n\t\t\tif (config.className !== \"\") {\n\t\t\t\tthis._el.classList.add(config.className);\n\t\t\t}\n\t\t\tthis.draw();\n\t\t};\n\n\t\tif (!isEventable(this._viewPort)) {\n\t\t\teventable(this._viewPort);\n\t\t}\n\t\tthis._singleRow = config.singleRow;\n\t\tthis._useRequestAnimationFrame = config.useRequestAnimationFrame;\n\t}\n\n\tdefaultRender = (start: IPoint, end: IPoint) => {\n\t\tif(!this._el){\n\t\t\tthis._el = document.createElement(\"div\");\n\t\t}\n\t\tconst node = this._el;\n\t\t// const gantt = this._gantt;\n\n\t\tconst top = Math.min(start.relative.top, end.relative.top);\n\t\tconst bottom = Math.max(start.relative.top, end.relative.top);\n\t\tconst left = Math.min(start.relative.left, end.relative.left);\n\t\tconst right = Math.max(start.relative.left, end.relative.left);\n\n\t\tif (this._singleRow) {\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\n\t\t\tnode.style.height = pos.height + \"px\";\n\t\t\tnode.style.top = pos.top + \"px\";\n\t\t} else {\n\t\t\tnode.style.height = Math.abs(bottom - top) + \"px\";\n\t\t\tnode.style.top = top + \"px\";\n\t\t}\n\t\tnode.style.width = Math.abs(right - left) + \"px\";\n\t\tnode.style.left = left + \"px\";\n\t\treturn node;\n\t};\n\n\tdraw() {\n\t\tif (this._useRequestAnimationFrame) {\n\t\t\treturn requestAnimationFrame(() => {\n\t\t\t\tthis._viewPort.appendChild(this.getElement());\n\t\t\t});\n\t\t} else {\n\t\t\tthis._viewPort.appendChild(this.getElement());\n\t\t}\n\t}\n\n\tclear() {\n\t\tif (this._useRequestAnimationFrame) {\n\t\t\treturn requestAnimationFrame(() => {\n\t\t\t\tif (!this._el.parentNode) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._viewPort.removeChild(this._el);\n\t\t\t});\n\t\t} else {\n\t\t\tif (!this._el.parentNode) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._viewPort.removeChild(this._el);\n\t\t}\n\t}\n\n\tgetElement() {\n\t\treturn this._el;\n\t}\n\n\tgetViewPort() {\n\t\treturn this._viewPort;\n\t}\n\n\tsetStart(startPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tthis._startPoint = startPoint;\n\t\tthis._startDate = gantt.dateFromPos(this._startPoint.relative.left);\n\t\tthis._viewPort.callEvent(\"onBeforeDrag\", [this._startPoint]);\n\t}\n\n\tsetEnd(endPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tthis._endPoint = endPoint;\n\t\tif (this._singleRow) {\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\n\t\t\tthis._endPoint.relative.top = pos.top;\n\t\t}\n\t\tthis._endDate = gantt.dateFromPos(this._endPoint.relative.left);\n\t\tif (this._startPoint.relative.left > this._endPoint.relative.left) {\n\t\t\tthis._positionPoint = {\n\t\t\t\trelative: { left: this._endPoint.relative.left, top: this._positionPoint.relative.top },\n\t\t\t\tabsolute: { left: this._endPoint.absolute.left, top: this._positionPoint.absolute.top }\n\t\t\t};\n\t\t}\n\t\tif (this._startPoint.relative.top > this._endPoint.relative.top) {\n\t\t\tthis._positionPoint = {\n\t\t\t\trelative: { left: this._positionPoint.relative.left, top: this._endPoint.relative.top },\n\t\t\t\tabsolute: { left: this._positionPoint.absolute.left, top: this._endPoint.absolute.top }\n\t\t\t};\n\t\t}\n\n\n\t\tthis._viewPort.callEvent(\"onDrag\", [this._startPoint, this._endPoint]);\n\t}\n\n\tsetPosition(positionPoint: IPoint) {\n\t\tthis._positionPoint = positionPoint;\n\t}\n\n\tdragEnd(endPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tif(endPoint.relative.left < 0){\n\t\t\tendPoint.relative.left = 0;\n\t\t}\n\t\tthis._viewPort.callEvent(\"onBeforeDragEnd\", [this._startPoint, endPoint]);\n\t\tthis.setEnd(endPoint);\n\t\t// GS-1422. The endDate can be null if we drag the mouse outside the Gantt container\n\t\tthis._endDate = this._endDate || gantt.getState().max_date;\n\n\t\tif (this._startDate.valueOf() > this._endDate.valueOf()) {\n\t\t\t[ this._startDate, this._endDate ] = [ this._endDate, this._startDate ];\n\t\t}\n\t\tthis.clear();\n\t\tconst tasksByTime = gantt.getTaskByTime(this._startDate, this._endDate);\n\t\tconst tasksByIndex = this._getTasksByTop(this._startPoint.relative.top, this._endPoint.relative.top);\n\n\t\tthis._viewPort.callEvent(\"onDragEnd\", [this._startPoint, this._endPoint]);\n\t\tif (this._callback) {\n\t\t\tthis._callback(this._startPoint, this._endPoint, this._startDate, this._endDate, tasksByTime, tasksByIndex);\n\t\t}\n\t}\n\n\tgetInBounds() {\n\t\treturn this._singleRow;\n\t}\n\n\tprivate _getTasksByTop(start: number, end:number) {\n\t\tconst gantt = this._gantt;\n\t\tlet startValue = start;\n\t\tlet endValue = end;\n\t\tif (start > end) {\n\t\t\tstartValue = end;\n\t\t\tendValue = start;\n\t\t}\n\t\tconst startIndex = this._getTaskPositionByTop(startValue).index;\n\t\tconst endIndex = this._getTaskPositionByTop(endValue).index;\n\t\tconst result = [];\n\t\tfor (let i = startIndex; i <= endIndex; i++) {\n\t\t\tconst task = gantt.getTaskByIndex(i);\n\t\t\tif (task) {\n\t\t\t\tresult.push(gantt.getTaskByIndex(i));\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _getTaskPositionByTop(top: number){\n\t\tconst gantt = this._gantt;\n\t\tconst view = this._view;\n\t\tconst index = view.getItemIndexByTopPosition(top);\n\t\tconst task = gantt.getTaskByIndex(index);\n\t\tif(task){\n\t\t\tconst height = view.getItemHeight(task.id);\n\t\t\tconst itemTop = view.getItemTop(task.id);\n\t\t\treturn {\n\t\t\t\ttop: itemTop || 0,\n\t\t\t\theight: height || 0,\n\t\t\t\tindex\n\t\t\t};\n\t\t} else {\n\t\t\tconst dataHeight = view.getTotalHeight();\n\t\t\treturn {\n\t\t\t\ttop: top > dataHeight ? dataHeight : 0,\n\t\t\t\theight: gantt.config.row_height,\n\t\t\t\tindex: top > dataHeight ? gantt.getTaskCount() : 0\n\t\t\t};\n\t\t}\n\t}\n}","interface IPoint {\n\tx: number;\n\ty: number;\n}\n\nexport class EventsManager {\n\tstatic create(gantt: any) {\n\t\treturn new EventsManager(gantt);\n\t}\n\tprivate _mouseDown: boolean = false;\n\tprivate _startPoint: IPoint;\n\tprivate _scrollState: IPoint;\n\tprivate _originAutoscroll: boolean;\n\tprivate _domEvents: any;\n\tprivate _timeline: any;\n\tprivate _gantt: any;\n\tprivate _trace: IPoint[];\n\tprivate _originalReadonly: boolean;\n\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = gantt._createDomEventScope();\n\t\tthis._trace = [];\n\t}\n\n\tdestructor() {\n\t\tthis._domEvents.detachAll();\n\t}\n\n\tattach(timeline: any): void {\n\t\tthis._timeline = timeline;\n\t\tconst gantt = this._gantt;\n\t\tthis._domEvents.attach(timeline.$task, \"mousedown\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey,ignore, enabled } = gantt.config.drag_timeline;\n\t\t\tif(enabled === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\n\t\t\tif(ignore !== undefined) {\n\t\t\t\tif(ignore instanceof Array){\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\n\t\t\t\t} else {\n\t\t\t\t\tfilterTargets = ignore;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterTargets) {\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\n\t\t\tthis._startDrag(event);\n\t\t});\n\n\t\tthis._domEvents.attach(document, \"keydown\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] === true) {\n\t\t\t\tthis._applyDndReadyStyles();\n\t\t\t}\n\t\t});\n\t\tthis._domEvents.attach(document, \"keyup\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] === false) {\n\t\t\t\tthis._clearDndReadyStyles();\n\t\t\t\tthis._stopDrag(event);\n\t\t\t}\n\t\t});\n\n\t\tthis._domEvents.attach(document, \"mouseup\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(gantt.$root, \"mouseup\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(document, \"mouseleave\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(gantt.$root, \"mouseleave\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\n\t\tthis._domEvents.attach(gantt.$root, \"mousemove\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\t// GS-854. If we don't have useKey for the drag_timeline extension,\n\t\t\t// check the click_drag to not simultaneously use both extensions\n\t\t\tconst clickDrag = this._gantt.ext.clickDrag;\n\t\t\tconst clickDragUseKey = (this._gantt.config.click_drag || {}).useKey;\n\t\t\tif (clickDrag && clickDragUseKey) {\n\t\t\t\tif (!useKey && event[clickDragUseKey]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tthis._trace.push({ x: event.clientX, y: event.clientY });\n\t\t\t\tconst scrollPosition: IPoint = this._countNewScrollPosition({ x: event.clientX, y: event.clientY });\n\t\t\t\tthis._setScrollPosition(timeline, scrollPosition);\n\t\t\t\tthis._scrollState = scrollPosition;\n\t\t\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _calculateDirectionVector = () => {\n\t\tconst traceSteps = 10;\n\t\tif(this._trace.length >= traceSteps) {\n\t\t\tconst dots = this._trace.slice(this._trace.length - traceSteps);\n\n\t\t\tconst vectors = [];\n\t\t\tfor(let i = 1; i < dots.length; i++) {\n\t\t\t\tvectors.push({\n\t\t\t\t\tx: dots[i].x - dots[i - 1].x,\n\t\t\t\t\ty: dots[i].y - dots[i - 1].y\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst resultVector = {x:0, y:0};\n\n\t\t\tvectors.forEach((vector) => {\n\t\t\t\tresultVector.x += vector.x;\n\t\t\t\tresultVector.y += vector.y;\n\t\t\t});\n\n\t\t\tconst magnitude = Math.sqrt(resultVector.x*resultVector.x + resultVector.y*resultVector.y);\n\t\t\tconst angleDegrees = Math.atan2(Math.abs(resultVector.y), Math.abs(resultVector.x)) * 180 / Math.PI;\n\n\t\t\treturn {\n\t\t\t\tmagnitude,\n\t\t\t\tangleDegrees\n\t\t\t};\n\n\t\t}\n\t\treturn null;\n\t};\n\n\tprivate _applyDndReadyStyles = (): void => {\n\t\tthis._timeline.$task.classList.add(\"gantt_timeline_move_available\");\n\t};\n\n\tprivate _clearDndReadyStyles = (): void => {\n\t\tthis._timeline.$task.classList.remove(\"gantt_timeline_move_available\");\n\t};\n\n\tprivate _getScrollPosition = (timeline: any): IPoint => {\n\t\tconst gantt = this._gantt;\n\t\treturn {\n\t\t\tx: gantt.$ui.getView(timeline.$config.scrollX).getScrollState().position,\n\t\t\ty: gantt.$ui.getView(timeline.$config.scrollY).getScrollState().position\n\t\t};\n\t};\n\tprivate _countNewScrollPosition = (coords: IPoint): IPoint => {\n\t\tconst vector = this._calculateDirectionVector();\n\t\tlet shiftX = this._startPoint.x - coords.x;\n\t\tlet shiftY = this._startPoint.y - coords.y;\n\t\tif(vector){\n\t\t\tif(vector.angleDegrees < 15){\n\t\t\t\tshiftY = 0;\n\t\t\t} else if(vector.angleDegrees > 75){\n\t\t\t\tshiftX = 0;\n\t\t\t}\n\t\t}\n\n\t\tconst result = {\n\t\t\tx: this._scrollState.x + shiftX,\n\t\t\ty: this._scrollState.y + shiftY\n\t\t};\n\t\treturn result;\n\t};\n\tprivate _setScrollPosition = (timeline: any, coords: IPoint): void => {\n\t\tconst gantt = this._gantt;\n\t\trequestAnimationFrame(() => {\n\t\t\tgantt.scrollLayoutCell(timeline.$id, coords.x, coords.y);\n\t\t});\n\t};\n\tprivate _stopDrag = (event: Event): void => {\n\t\tconst gantt = this._gantt;\n\t\tthis._trace = [];\n\t\tgantt.$root.classList.remove(\"gantt_noselect\");\n\n\t\tif(this._originalReadonly !== undefined){\n\t\t\tgantt.config.readonly = this._originalReadonly;\n\t\t\tif(this._mouseDown && gantt.config.drag_timeline && gantt.config.drag_timeline.render){\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}\n\n\t\tif(this._originAutoscroll !== undefined){\n\t\t\tgantt.config.autoscroll = this._originAutoscroll;\n\t\t}\n\n\t\tif(gantt.config.drag_timeline){\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] !== true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis._mouseDown = false;\n\t};\n\n\tprivate _startDrag = (event: any) : void => {\n\t\tconst gantt = this._gantt;\n\t\tthis._originAutoscroll = gantt.config.autoscroll;\n\t\tgantt.config.autoscroll = false;\n\n\t\tgantt.$root.classList.add(\"gantt_noselect\");\n\t\tthis._originalReadonly = gantt.config.readonly;\n\t\tgantt.config.readonly = true;\n\n\t\tif(gantt.config.drag_timeline && gantt.config.drag_timeline.render){\n\t\t\tgantt.render();\n\t\t}\n\n\t\tthis._trace = [];\n\t\tthis._mouseDown = true;\n\t\tconst { x, y } = this._getScrollPosition(this._timeline);\n\t\tthis._scrollState = { x, y };\n\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\n\t\tthis._trace.push(this._startPoint);\n\t};\n}","export default function(gantt) {\n\n\t(function () {\n\t\tvar modalsStack = [];\n\n\t\tfunction isModal() {\n\t\t\treturn !!modalsStack.length;\n\t\t}\n\n\t\tfunction afterPopup(box) {\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (!isModal()){\n\t\t\t\t\tif(!gantt.$destroyed){\n\t\t\t\t\t\tgantt.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t}\n\n\t\tfunction startModal(box) {\n\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\n\t\t\tgantt.event(box, \"keydown\", trapFocus);\n\t\t\tmodalsStack.push(box);\n\t\t\t//gantt.$keyboardNavigation.dispatcher.disable();\n\t\t}\n\n\t\tfunction endModal() {\n\t\t\tvar box = modalsStack.pop();\n\t\t\tif (box) {\n\t\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\n\t\t\t}\n\t\t\tafterPopup(box);\n\n\t\t}\n\n\n\t\tfunction isTopModal(box) {\n\t\t\treturn box == modalsStack[modalsStack.length - 1];\n\t\t}\n\n\t\tfunction trapFocus(event) {\n\t\t\tvar target = event.currentTarget;\n\t\t\tif (!isTopModal(target)) return;\n\n\t\t\tgantt.$keyboardNavigation.trapFocus(target, event);\n\t\t}\n\n\t\tfunction traceLightbox() {\n\t\t\tstartModal(gantt.getLightbox());\n\t\t}\n\n\t\tgantt.attachEvent(\"onLightbox\", traceLightbox);\n\t\tgantt.attachEvent(\"onAfterLightbox\", endModal);\n\t\tgantt.attachEvent(\"onLightboxChange\", function () {\n\t\t\tendModal();\n\t\t\ttraceLightbox();\n\t\t});\n\n\n\t\tgantt.attachEvent(\"onAfterQuickInfo\", function () {\n\t\t\tafterPopup();\n\t\t});\n\n\t\tgantt.attachEvent(\"onMessagePopup\", function (box) {\n\t\t\tsaveFocus();\n\t\t\tstartModal(box);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterMessagePopup\", function () {\n\t\t\tendModal();\n\t\t\trestoreFocus();\n\t\t});\n\n\t\tvar focusElement = null;\n\n\t\tfunction saveFocus() {\n\t\t\tfocusElement = gantt.utils.dom.getActiveElement();\n\t\t}\n\n\t\tfunction restoreFocus() {\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (focusElement) {\n\t\t\t\t\tfocusElement.focus();\n\t\t\t\t\tfocusElement = null;\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t}\n\n\t\tgantt.$keyboardNavigation.isModal = isModal;\n\n\n\t})();\n\n};","\ninterface IQuickInfoContainer{\n\tparent: HTMLElement;\n\txViewport: HTMLElement;\n\tyViewport: HTMLElement;\n}\n\nexport class QuickInfo {\n\tprivate _quickInfoTask: TaskID;\n\tprivate _quickInfoBoxId: number | string;\n\tprivate _quickInfoBox: HTMLElement;\n\tprivate _quickInfoReadonly: boolean | null;\n\tprivate _container: HTMLElement;\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t}\n\n\t// show at coordinates:\n\t// show(x: number, y: number)\n\t// show for a task:\n\t// show(id: TaskID)\n\tshow : {\n\t\t(x: number, y: number) : void;\n\t\t(id: TaskID) : void;\n\t} = (id: TaskID | number, y? : number) : void => {\n\t\tif (y === undefined) {\n\t\t\tthis._showForTask(id);\n\t\t} else {\n\t\t\tthis._showAtCoordinates(id as number, y);\n\t\t}\n\t};\n\n\thide = (forced?: boolean) : any => {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = this._quickInfoBox;\n\t\tthis._quickInfoBoxId = 0;\n\t\tconst taskId = this._quickInfoTask;\n\t\tthis._quickInfoTask = null;\n\n\t\tif (qi && qi.parentNode){\n\n\t\t\tif (gantt.config.quick_info_detached) {\n\t\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\n\t\t\t\treturn qi.parentNode.removeChild(qi);\n\t\t\t}\n\n\t\t\tqi.className += \" gantt_qi_hidden\";\n\t\t\tif (qi.style.right === \"auto\"){\n\t\t\t\tqi.style.left = \"-350px\";\n\t\t\t} else {\n\t\t\t\tqi.style.right = \"-350px\";\n\t\t\t}\n\n\t\t\tif (forced) {\n\t\t\t\tqi.style.left = qi.style.right = \"\";\n\t\t\t\tqi.parentNode.removeChild(qi);\n\t\t\t}\n\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\n\t\t}\n\t};\n\n\tgetNode = (): HTMLElement => {\n\t\tif(this._quickInfoBox) {\n\t\t\treturn this._quickInfoBox;\n\t\t}\n\t\treturn null;\n\t};\n\n\tsetContainer = (container: string|HTMLElement): void => {\n\t\tif(container){\n\t\t\tthis._container = typeof container === \"string\" ? document.getElementById(container) : container;\n\t\t}\n\t};\n\n\tsetContent = (content?: IQuickInfoContent) => {\n\t\tconst gantt = this._gantt;\n\n\t\tconst defaultContent = {\n\t\t\ttaskId: null,\n\t\t\theader: {\n\t\t\t\ttitle: \"\",\n\t\t\t\tdate: \"\"\n\t\t\t},\n\t\t\tcontent: \"\",\n\t\t\tbuttons: gantt.config.quickinfo_buttons\n\t\t};\n\n\t\tif(!content){\n\t\t\tcontent = defaultContent;\n\t\t}\n\n\t\tif(!content.taskId){\n\t\t\tcontent.taskId = defaultContent.taskId;\n\t\t}\n\n\t\tif(!content.header){\n\t\t\tcontent.header = defaultContent.header;\n\t\t}\n\n\t\tif(!content.header.title){\n\t\t\tcontent.header.title = defaultContent.header.title;\n\t\t}\n\t\tif(!content.header.date){\n\t\t\tcontent.header.date = defaultContent.header.date;\n\t\t}\n\t\tif(!content.content){\n\t\t\tcontent.content = defaultContent.content;\n\t\t}\n\t\tif(!content.buttons){\n\t\t\tcontent.buttons = defaultContent.buttons;\n\t\t}\n\n\n\t\tlet qi = this.getNode();\n\t\tif(!qi){\n\t\t\tqi = this._createQuickInfoElement();\n\t\t}\n\n\t\tif(content.taskId){\n\t\t\tthis._quickInfoBoxId = content.taskId;\n\t\t}\n\n\t\tconst titleBox = qi.querySelector(\".gantt_cal_qi_title\") as HTMLElement;\n\t\tconst titleContent = titleBox.querySelector(\".gantt_cal_qi_tcontent\");\n\t\tconst titleDate = titleBox.querySelector(\".gantt_cal_qi_tdate\");\n\t\tconst main = qi.querySelector(\".gantt_cal_qi_content\");\n\t\tconst controls = qi.querySelector(\".gantt_cal_qi_controls\") as HTMLElement;\n\n\t\tgantt._waiAria.quickInfoHeader(qi, [content.header.title, content.header.date].join(\" \"));\n\n\t\ttitleContent.innerHTML = content.header.title;\n\t\ttitleDate.innerHTML = content.header.date;\n\n\t\tif(!content.header.title && !content.header.date){\n\t\t\ttitleBox.style.display = \"none\";\n\t\t}else{\n\t\t\ttitleBox.style.display = \"\";\n\t\t}\n\t\tmain.innerHTML = content.content;\n\n\t\tconst buttons = content.buttons;\n\t\tif(!buttons.length){\n\t\t\tcontrols.style.display = \"none\";\n\t\t}else{\n\t\t\tcontrols.style.display = \"\";\n\t\t}\n\t\tlet html = \"\";\n\t\tfor (let i = 0; i < buttons.length; i++){\n\n\t\t\tconst ariaAttr = gantt._waiAria.quickInfoButtonAttrString(gantt.locale.labels[buttons[i]]);\n\n\t\t\thtml += `<div class=\"gantt_qi_big_icon ${buttons[i]} dhx_gantt_${buttons[i]}\" title=\"${gantt.locale.labels[buttons[i]]}\" ${ariaAttr}>\n            <div class='dhx_menu_icon dhx_gantt_icon ${buttons[i]} gantt_menu_icon dhx_gantt_${buttons[i]}'></div>\n            <div>${gantt.locale.labels[buttons[i]]}</div>\n         </div>`;\n\t\t}\n\t\tcontrols.innerHTML = html;\n\n\t\tgantt.eventRemove(qi, \"click\", this._qiButtonClickHandler);\n\t\tgantt.eventRemove(qi, \"keypress\", this._qiKeyPressHandler);\n\n\t\tgantt.event(qi, \"click\", this._qiButtonClickHandler);\n\t\tgantt.event(qi, \"keypress\", this._qiKeyPressHandler);\n\t};\n\n\tprivate _qiButtonClickHandler = (ev) => {\n\t\tthis._qi_button_click(ev.target);\n\t};\n\n\tprivate _qiKeyPressHandler = (e) => {\n\n\t\tconst code = e.which;\n\t\tif (code === 13 || code === 32){\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._qi_button_click(e.target);\n\t\t\t},1);\n\t\t}\n\t};\n\n\tprivate _showAtCoordinates(x: number, y: number) : void {\n\t\tthis.hide(true);\n\t\tthis._quickInfoBoxId = 0;\n\t\tthis._quickInfoTask = null;\n\t\tif(!this._quickInfoBox){\n\t\t\tthis._createQuickInfoElement();\n\t\t\tthis.setContent();\n\t\t}\n\n\t\tthis._appendAtCoordinates(x, y);\n\t\tthis._gantt.callEvent(\"onQuickInfo\", [null]);\n\t}\n\n\tprivate _showForTask(id: TaskID) : void {\n\t\tconst gantt = this._gantt;\n\t\tif ((\n\t\t\tid === this._quickInfoBoxId &&\n\t\t\tgantt.utils.dom.isChildOf(this._quickInfoBox, document.body)\n\t\t) || !gantt.config.show_quick_info) {\n\t\t\t// not show if the quick info is already displayed for this task, or if it shouldn't be displayed\n\t\t\treturn;\n\t\t}\n\t\tthis.hide(true);\n\t\tconst offset = 6; // offset TASK <> QI-BOX in 'px'\n\t\tconst container = this._getContainer();\n\t\tconst pos = this._get_event_counter_part(id, offset, container.xViewport, container.yViewport);\n\n\t\tif (pos){\n\t\t\tthis._quickInfoBox = this._init_quick_info(id);\n\t\t\tthis._quickInfoTask = id;\n\t\t\tthis._quickInfoBox.className = this._prepare_quick_info_classname(id);\n\n\t\t\tthis._fill_quick_data(id);\n\t\t\tthis._show_quick_info(pos, offset);\n\t\t\tgantt.callEvent(\"onQuickInfo\", [id]);\n\t\t}\n\t}\n\n\tprivate _get_event_counter_part(id: TaskID, offset: number, xViewport: HTMLElement, yViewport: HTMLElement) : any {\n\t\tconst gantt = this._gantt;\n\t\tlet domEv = gantt.getTaskNode(id);\n\t\tif (!domEv) {\n\t\t\tdomEv = gantt.getTaskRowNode(id);\n\t\t\tif (!domEv) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tlet left = 0;\n\t\tconst top = offset + domEv.offsetTop + domEv.offsetHeight;\n\n\t\tlet node = domEv;\n\n\t\tif (gantt.utils.dom.isChildOf(node, xViewport)) {\n\t\t\twhile (node && node !== xViewport){\n\t\t\t\tleft += node.offsetLeft;\n\t\t\t\tnode = node.offsetParent;\n\t\t\t}\n\t\t}\n\n\t\tconst scroll = gantt.getScrollState();\n\n\t\tif(node){\n\t\t\tconst dx = (left + domEv.offsetWidth/2) - scroll.x > (xViewport.offsetWidth/2) ? 1 : 0;\n\t\t\tconst dy = (top + domEv.offsetHeight/2) - scroll.y > (yViewport.offsetHeight/2) ? 1 : 0;\n\n\t\t\treturn { left, top, dx, dy, width:domEv.offsetWidth, height:domEv.offsetHeight };\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _createQuickInfoElement() : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = document.createElement(\"div\");\n\t\tqi.className += \"gantt_cal_quick_info\";\n\t\tgantt._waiAria.quickInfoAttr(qi);\n\n\t\t// title\n\t\tconst ariaAttr = gantt._waiAria.quickInfoHeaderAttrString();\n\t\tvar html = `\n\t\t<div class=\"gantt_cal_qi_tcontrols\">\n\t\t\t<a class=\"gantt_cal_qi_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\t\t</div>\n\t\t<div class=\"gantt_cal_qi_title\" ${ariaAttr}>\n\t\t\t\t\n\t\t\t\t<div class=\"gantt_cal_qi_tcontent\"></div>\n\t\t\t\t<div class=\"gantt_cal_qi_tdate\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"gantt_cal_qi_content\"></div>`;\n\n\t\t//buttons\n\t\thtml += \"<div class=\\\"gantt_cal_qi_controls\\\">\";\n\n\t\thtml += \"</div>\";\n\n\t\tqi.innerHTML = html;\n\n\n\t\tif (gantt.config.quick_info_detached) {\n\t\t\tconst container = this._getContainer();\n\t\t\tgantt.event(container.parent, \"scroll\", () => { this.hide(); });\n\t\t}\n\n\t\tthis._quickInfoBox = qi;\n\t\treturn qi;\n\t}\n\n\tprivate _init_quick_info(id: TaskID) : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tconst task = gantt.getTask(id);\n\t\t\n\n\t\tif(typeof this._quickInfoReadonly === \"boolean\"){\n\t\t\tif(gantt.isReadonly(task) !== this._quickInfoReadonly){\n\t\t\t\tthis.hide(true);\n\t\t\t\tthis._quickInfoBox = null;\n\t\t\t}\n\t\t}\n\n\t\tthis._quickInfoReadonly = gantt.isReadonly(task);\n\n\t\tif (!this._quickInfoBox){\n\t\t\tthis._quickInfoBox = this._createQuickInfoElement();\n\t\t}\n\n\t\treturn this._quickInfoBox;\n\t}\n\n\tprivate _prepare_quick_info_classname(id: TaskID) : string {\n\t\tconst gantt = this._gantt;\n\t\tconst task = gantt.getTask(id);\n\t\tconst taskType = gantt.getTaskType(task);\n\n\t\tlet css = `gantt_cal_quick_info gantt_${taskType}`;\n\t\tconst template = gantt.templates.quick_info_class(task.start_date, task.end_date, task);\n\n\t\tif(template){\n\t\t\tcss += \" \" + template;\n\t\t}\n\t\treturn css;\n\t}\n\n\tprivate _fill_quick_data(id: TaskID) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst ev = gantt.getTask(id);\n\n\t\tthis._quickInfoBoxId = id;\n\n\t\tlet allowedButtons = [];\n\t\tif (this._quickInfoReadonly){\n\t\t\tconst buttons = gantt.config.quickinfo_buttons;\n\t\t\tconst isEditor = {icon_delete: true, icon_edit: true};\n\t\t\tfor (let i = 0; i < buttons.length; i++){\n\t\t\t\tif(this._quickInfoReadonly && isEditor[buttons[i]]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tallowedButtons.push(buttons[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tallowedButtons = gantt.config.quickinfo_buttons;\n\t\t}\n\n\t\tthis.setContent({\n\t\t\theader: {\n\t\t\t\ttitle: gantt.templates.quick_info_title(ev.start_date, ev.end_date, ev),\n\t\t\t\tdate: gantt.templates.quick_info_date(ev.start_date, ev.end_date, ev)\n\t\t\t},\n\t\t\tcontent: gantt.templates.quick_info_content(ev.start_date, ev.end_date, ev),\n\t\t\tbuttons: allowedButtons\n\t\t});\n\t}\n\n\tprivate _appendAtCoordinates(x: number, y: number): void {\n\t\tconst qi = this._quickInfoBox;\n\t\tconst container = this._getContainer();\n\t\tif (!qi.parentNode ||\n\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\n\t\t\tcontainer.parent.appendChild(qi);\n\t\t}\n\n\t\tqi.style.left = x + \"px\";\n\t\tqi.style.top = y + \"px\";\n\t}\n\n\tprivate _show_quick_info(pos: any, offset: number) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = this._quickInfoBox;\n\t\tif (gantt.config.quick_info_detached) {\n\t\t\tconst container = this._getContainer();\n\t\t\tif (!qi.parentNode ||\n\t\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\n\t\t\t\tcontainer.parent.appendChild(qi);\n\t\t\t}\n\t\t\tconst width = qi.offsetWidth;\n\t\t\tconst popupHeight = qi.offsetHeight;\n\n\t\t\tconst scrolls = gantt.getScrollState();\n\t\t\tconst xViewport = container.xViewport;\n\t\t\tconst yViewport = container.yViewport;\n\t\t\tconst screenWidth = xViewport.offsetWidth + scrolls.x - width;\n\n\t\t\tconst relativePopupTop = pos.top - scrolls.y;\n\t\t\tconst relativePopupBottom = relativePopupTop + popupHeight;\n\n\t\t\tlet top = pos.top;\n\t\t\tif(relativePopupBottom > yViewport.offsetHeight / 2){\n\t\t\t\ttop = pos.top - (popupHeight + pos.height + 2*offset);\n\t\t\t\tif(top < scrolls.y && relativePopupBottom <= yViewport.offsetHeight){\n\t\t\t\t\ttop = pos.top;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (top < scrolls.y) {\n\t\t\t\ttop = scrolls.y;\n\t\t\t}\n\n\t\t\tconst x = Math.min(Math.max(scrolls.x, pos.left - pos.dx*(width - pos.width)), screenWidth);\n\t\t\tconst y = top;\n\n\t\t\tthis._appendAtCoordinates(x, y);\n\t\t} else {\n\t\t\tqi.style.top = 20 + \"px\";\n\t\t\tif (pos.dx === 1){\n\t\t\t\tqi.style.right = \"auto\";\n\t\t\t\tqi.style.left = \"-300px\";\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tqi.style.left = \"10px\";\n\t\t\t\t},1);\n\t\t\t} else {\n\t\t\t\tqi.style.left = \"auto\";\n\t\t\t\tqi.style.right = \"-300px\";\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tqi.style.right = \"10px\";\n\t\t\t\t},1);\n\t\t\t}\n\t\t\tqi.className += \" gantt_qi_\"+(pos.dx === 1 ? \"left\" : \"right\");\n\t\t\tgantt.$root.appendChild(qi);\n\t\t}\n\t}\n\n\tprivate _qi_button_click(node: any) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst box = this._quickInfoBox;\n\t\tif (!node || node === box){\n\t\t\treturn;\n\t\t}\n\t\tif(node.closest(\".gantt_cal_qi_close_btn\")){\n\t\t\tthis.hide();\n\t\t\treturn;\n\t\t}\n\n\t\tconst mask = node.className;\n\t\tif (mask.indexOf(\"_icon\") !== -1){\n\t\t\tconst id = this._quickInfoBoxId;\n\t\t\tgantt.$click.buttons[mask.split(\" \")[1].replace(\"icon_\",\"\")](id);\n\t\t} else {\n\t\t\tthis._qi_button_click(node.parentNode);\n\t\t}\n\t}\n\n\tprivate _getContainer(): IQuickInfoContainer{\n\t\tconst gantt = this._gantt;\n\t\tlet container = this._container ? this._container : gantt.$task_data;\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\n\t\t\treturn {\n\t\t\t\tparent: container,\n\t\t\t\txViewport: gantt.$task,\n\t\t\t\tyViewport: gantt.$task_data\n\t\t\t};\n\t\t}\n\t\tcontainer = this._container ? this._container : gantt.$grid_data;\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\n\t\t\treturn {\n\t\t\t\tparent: container,\n\t\t\t\txViewport: gantt.$grid,\n\t\t\t\tyViewport: gantt.$grid_data\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tparent: this._container ? this._container : gantt.$layout,\n\t\t\txViewport: gantt.$layout,\n\t\t\tyViewport: gantt.$layout\n\t\t};\n\t}\n}\n","import * as helpers from \"./helpers\";\n\nvar plainObjectConstructor = ({}).constructor.toString();\nfunction isCustomType(object){\n\tvar constructorString = object.constructor.toString();\n\n\treturn constructorString !== plainObjectConstructor;\n}\n\nfunction copy(object) {\n\tvar i, result; // iterator, types array, result\n\n\tif (object && typeof object == \"object\") {\n\n\t\tswitch (true){\n\t\t\tcase (helpers.isDate(object)):\n\t\t\t\tresult = new Date(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isArray(object)):\n\t\t\t\tresult = new Array(object.length);\n\t\t\t\tfor(i = 0; i < object.length; i++){\n\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t/*\t\tcase (helpers.isStringObject(object)):\n\t\t\t\tresult = new String(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isNumberObject(object)):\n\t\t\t\tresult = new Number(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isBooleanObject(object)):\n\t\t\t\tresult = new Boolean(object);\n\t\t\t\tbreak;*/\n\t\t\tdefault:\n\t\t\t\tif(isCustomType(object)){\n\t\t\t\t\tresult = Object.create(object);\n\t\t\t\t}else{\n\t\t\t\t\tresult = {};\n\t\t\t\t}\n\n\t\t\t\tfor (i in object) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.apply(object, [i]))\n\t\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn result || object;\n}\n\nfunction mixin (target, source, force){\n\tfor (var f in source)\n\t\tif (((target[f] === undefined) || force)) target[f]=source[f];\n\treturn target;\n}\n\nfunction defined(obj) {\n\treturn typeof(obj) != \"undefined\";\n}\n\nvar seed;\nfunction uid() {\n\tif (!seed)\n\t\tseed = (new Date()).valueOf();\n\n\tseed++;\n\treturn seed;\n}\n\n//creates function with specified \"this\" pointer\nfunction bind(functor, object){\n\tif(functor.bind)\n\t\treturn functor.bind(object);\n\telse\n\t\treturn function(){ return functor.apply(object,arguments); };\n}\n\nfunction event(el, event, handler, capture){\n\tif (el.addEventListener)\n\t\tel.addEventListener(event, handler, capture === undefined ? false : capture);\n\n\telse if (el.attachEvent)\n\t\tel.attachEvent(\"on\"+event, handler);\n}\n\nfunction eventRemove(el, event, handler, capture){\n\tif (el.removeEventListener)\n\t\tel.removeEventListener(event, handler, capture === undefined ? false : capture);\n\n\telse if (el.detachEvent)\n\t\tel.detachEvent(\"on\"+event, handler);\n}\n\nexport {\n\tcopy,\n\tdefined,\n\tmixin,\n\tuid,\n\tbind,\n\tevent,\n\teventRemove\n};","import * as utils from \"../../../utils/utils\";\n\nfunction createScope(addEvent, removeEvent) {\n\taddEvent = addEvent || utils.event;\n\tremoveEvent = removeEvent || utils.eventRemove;\n\n\tvar handlers = [];\n\n\tvar eventScope = {\n\t\tattach: function(el, event, callback, capture){\n\t\t\thandlers.push({element: el, event:event, callback: callback, capture: capture});\n\t\t\taddEvent(el, event, callback, capture);\n\t\t},\n\t\tdetach: function(el, event, callback, capture){\n\t\t\tremoveEvent(el, event, callback, capture);\n\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\tvar handler = handlers[i];\n\t\t\t\tif (handler.element === el && handler.event === event && handler.callback === callback && handler.capture === capture) {\n\t\t\t\t\thandlers.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdetachAll: function () {\n\t\t\tvar staticArray = handlers.slice();\n\t\t\t// original handlers array can be spliced on every iteration\n\t\t\tfor (var i = 0; i < staticArray.length; i++){\n\t\t\t\tvar handler = staticArray[i];\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, handler.capture);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, undefined);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, false);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, true);\n\t\t\t}\n\t\t\thandlers.splice(0, handlers.length);\n\t\t},\n\t\textend: function(){\n\t\t\treturn createScope(this.event, this.eventRemove);\n\t\t}\n\t};\n\n\treturn eventScope;\n}\n\nexport default createScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\n\n/* eslint-disable no-restricted-globals */\n\ninterface IViewPosition{\n\ttop: number;\n\tleft: number;\n}\n\ninterface IViewBox extends IViewPosition{\n\twidth: number;\n\theight: number;\n\tbottom: number;\n\tright: number;\n}\n\nexport class Tooltip {\n\tprivate _root: HTMLElement;\n\tprivate _tooltipNode: HTMLElement;\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any){\n\t\tthis._gantt = gantt;\n\t}\n\n\tgetNode() : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tif (!this._tooltipNode){\n\t\t\tthis._tooltipNode = document.createElement(\"div\");\n\t\t\tthis._tooltipNode.className = \"gantt_tooltip\";\n\t\t\tgantt._waiAria.tooltipAttr(this._tooltipNode);\n\t\t}\n\t\treturn this._tooltipNode;\n\t}\n\n\tsetViewport(node: HTMLElement):Tooltip{\n\t\tthis._root = node;\n\t\treturn this;\n\t}\n\n\tshow(left: number, top: number): Tooltip;\n\tshow(event: MouseEvent): Tooltip;\n\tshow(left: number | MouseEvent, top?: number): Tooltip {\n\t\tconst gantt = this._gantt;\n\t\tconst container = document.body;\n\t\tconst node = this.getNode();\n\n\t\tif(!domHelpers.isChildOf(node, container)){\n\t\t\tthis.hide();\n\t\t\t// GS-2463. Don't put the node beyond the body coordinates\n\t\t\t// as it may trigger the resize event\n\t\t\tnode.style.top = node.style.top || \"0px\";\n\t\t\tnode.style.left = node.style.left || \"0px\";\n\t\t\tcontainer.appendChild(node);\n\t\t}\n\n\t\tif (this._isLikeMouseEvent(left)) {\n\t\t\tconst position = this._calculateTooltipPosition(left as MouseEvent);\n\t\t\ttop = position.top;\n\t\t\tleft = position.left;\n\t\t}\n\n\t\tnode.style.top = top + \"px\";\n\t\tnode.style.left = left + \"px\";\n\n\t\tgantt._waiAria.tooltipVisibleAttr(node);\n\t\treturn this;\n\t}\n\thide() : Tooltip{\n\t\tconst gantt = this._gantt;\n\t\tconst node = this.getNode();\n\t\tif(node && node.parentNode){\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t\tgantt._waiAria.tooltipHiddenAttr(node);\n\t\treturn this;\n\t}\n\n\tsetContent(html: string) : Tooltip{\n\t\tconst node = this.getNode();\n\t\tnode.innerHTML = html;\n\t\treturn this;\n\t}\n\n\t// it is for salesforce, because it proxies event to it own events\n\tprivate _isLikeMouseEvent(event: any): boolean {\n\t\tif (!event || typeof event !== \"object\") {\n\t\t\treturn false;\n\t\t}\n\t\treturn \"clientX\" in event && \"clientY\" in event;\n\t}\n\n\tprivate _getViewPort() : HTMLElement {\n\t\treturn this._root || document.body;\n\t}\n\n\n\tprivate _calculateTooltipPosition(event: MouseEvent): IViewPosition{\n\t\tconst gantt = this._gantt;\n\t\t// top/left coordinates inside the viewport by mouse position\n\t\tconst viewport =  this._getViewPortSize();\n\t\tconst tooltipNode = this.getNode();\n\t\tconst tooltip: IViewBox = {\n\t\t\ttop:0,\n\t\t\tleft: 0,\n\t\t\twidth: tooltipNode.offsetWidth,\n\t\t\theight: tooltipNode.offsetHeight,\n\t\t\tbottom: 0,\n\t\t\tright: 0\n\t\t};\n\n\t\tconst offsetX = gantt.config.tooltip_offset_x;\n\t\tconst offsetY = gantt.config.tooltip_offset_y;\n\n\t\tconst container = document.body;\n\t\tconst mouse = domHelpers.getRelativeEventPosition(event, container);\n\t\tconst containerPos = domHelpers.getNodePosition(container);\n\t\tmouse.y += containerPos.y; // to fix margin collapsing\n\n\t\ttooltip.top = mouse.y;\n\t\ttooltip.left = mouse.x;\n\t\ttooltip.top += offsetY;\n\t\ttooltip.left += offsetX;\n\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\ttooltip.right = tooltip.left + tooltip.width;\n\n\t\tconst scrollTop = window.scrollY + container.scrollTop; // to fix margin collapsing\n\t\t// edge cases when the tooltip element can be partially hidden by edges of the viewport\n\t\tif(tooltip.top < viewport.top - scrollTop){\n\t\t\ttooltip.top = viewport.top;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}else if(tooltip.bottom > viewport.bottom){\n\t\t\ttooltip.bottom = viewport.bottom;\n\t\t\ttooltip.top = tooltip.bottom - tooltip.height;\n\t\t}\n\n\t\tif(tooltip.left < viewport.left){\n\t\t\ttooltip.left = viewport.left;\n\t\t\ttooltip.right = viewport.left + tooltip.width;\n\t\t}else if(tooltip.right > viewport.right){\n\t\t\ttooltip.right = viewport.right;\n\t\t\ttooltip.left = tooltip.right - tooltip.width;\n\t\t}\n\n\t\tif(mouse.x >= tooltip.left && mouse.x <= tooltip.right) {\n\t\t\ttooltip.left = mouse.x - tooltip.width - offsetX;\n\t\t\ttooltip.right = tooltip.left + tooltip.width;\n\t\t}\n\n\t\tif(mouse.y >= tooltip.top && mouse.y <= tooltip.bottom) {\n\t\t\ttooltip.top = mouse.y - tooltip.height - offsetY;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}\n\n\t\treturn tooltip;\n\t}\n\n\tprivate _getViewPortSize() : IViewBox {\n\t\tconst gantt = this._gantt;\n\t\tconst container = this._getViewPort();\n\t\tlet viewport = container;\n\t\tlet scrollTop = window.scrollY + document.body.scrollTop;\n\t\tlet scrollLeft = window.scrollX + document.body.scrollLeft;\n\t\tlet pos;\n\t\t// support for the initial tooltip mode where the tooltip element was attached to the data area of gantt\n\t\tif(container === gantt.$task_data){\n\t\t\tviewport = gantt.$task;\n\t\t\tscrollTop = 0;\n\t\t\tscrollLeft = 0;\n\t\t\tpos = domHelpers.getNodePosition(gantt.$task);\n\t\t}else{\n\t\t\tpos = domHelpers.getNodePosition(viewport);\n\t\t}\n\t\treturn {\n\t\t\tleft:pos.x + scrollLeft,\n\t\t\ttop: pos.y + scrollTop,\n\t\t\twidth: pos.width,\n\t\t\theight: pos.height,\n\t\t\tbottom: pos.y + pos.height + scrollTop,\n\t\t\tright: pos.x + pos.width + scrollLeft\n\t\t};\n\t}\n}\n","import domEventsScope from \"../../core/ui/utils/dom_event_scope\";\nimport * as domHelpers from \"../../core/ui/utils/dom_helpers\";\nimport * as helpers from \"../../utils/helpers\";\nimport { Tooltip } from \"./tooltip\";\n\ninterface ITrackerTarget {\n\tselector: string;\n\tonmouseenter: (event: MouseEvent, node: HTMLElement) => void;\n\tonmousemove: (event: MouseEvent, node: HTMLElement) => void;\n\tonmouseleave: (event: MouseEvent, node: HTMLElement) => void;\n\tglobal: boolean;\n}\n\ninterface ITooltipConfig {\n\tselector: string;\n\thtml: (event: MouseEvent, node: HTMLElement) => string;\n\tglobal: boolean;\n}\n\nexport class TooltipManager{\n\ttooltip: Tooltip;\n\tprotected _domEvents: any;\n\tprivate _listeners: object = {};\n\tprivate _gantt: any;\n\tprivate delayShow: any;\n\tprivate delayHide: any;\n\n\tconstructor(gantt: any) {\n\t\tthis.tooltip = new Tooltip(gantt);\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = domEventsScope();\n\t\tthis._initDelayedFunctions();\n\t}\n\n\tdestructor(): void{\n\t\tthis.tooltip.hide();\n\t\tthis._domEvents.detachAll();\n\t}\n\thideTooltip(): void{\n\t\tthis.delayHide();\n\t}\n\tattach(config: ITrackerTarget): void {\n\t\tlet root = document.body;\n\t\tconst gantt = this._gantt;\n\t\tif(!config.global){\n\t\t\troot = gantt.$root;\n\t\t}\n\n\t\tlet watchableTarget = null;\n\t\tconst handler = (event) => {\n\t\t\tconst eventTarget = domHelpers.getTargetNode(event);\n\t\t\tconst targetNode = domHelpers.closest(eventTarget, config.selector);\n\t\t\tif(domHelpers.isChildOf(eventTarget, this.tooltip.getNode())){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst doOnMouseEnter = () => {\n\t\t\t\twatchableTarget = targetNode;\n\t\t\t\tconfig.onmouseenter(event, targetNode);\n\t\t\t};\n\n\t\t\tif(watchableTarget){\n\t\t\t\tif(targetNode && targetNode === watchableTarget){\n\t\t\t\t\tconfig.onmousemove(event, targetNode);\n\t\t\t\t}else{\n\t\t\t\t\tconfig.onmouseleave(event, watchableTarget);\n\t\t\t\t\twatchableTarget = null;\n\n\t\t\t\t\tif(targetNode && targetNode !== watchableTarget){\n\t\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(targetNode){\n\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.detach(config.selector);\n\t\tthis._domEvents.attach(root, \"mousemove\", handler);\n\t\tthis._listeners[config.selector] = {\n\t\t\tnode: root,\n\t\t\thandler\n\t\t};\n\t}\n\n\tdetach(selector: string): void {\n\t\tconst listener = this._listeners[selector];\n\t\tif(listener){\n\t\t\tthis._domEvents.detach(listener.node, \"mousemove\", listener.handler);\n\t\t}\n\t}\n\n\ttooltipFor(config: ITooltipConfig): void {\n\t\tconst cloneDomEvent = (event: MouseEvent) => {\n\t\t\tlet clone = event;\n\t\t\t// making events survive timeout in ie\n\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\tif(document[\"createEventObject\"] && !document.createEvent){\n\t\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\t\tclone = document[\"createEventObject\"](event);\n\t\t\t}\n\t\t\treturn clone;\n\t\t};\n\t\tthis._initDelayedFunctions();\n\t\tthis.attach({\n\t\t\tselector: config.selector,\n\t\t\tglobal: config.global,\n\t\t\tonmouseenter:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmousemove:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}else{\n\t\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\t\tthis.delayHide();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmouseleave:() => {\n\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\tthis.delayHide();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _initDelayedFunctions(){\n\t\tconst gantt = this._gantt;\n\t\t// reset delayed functions in order to apply current values of tooltip_timeout\n\t\tif(this.delayShow){\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t}\n\t\tif(this.delayHide){\n\t\t\tthis.delayHide.$cancelTimeout();\n\t\t}\n\t\tthis.tooltip.hide();\n\n\t\tthis.delayShow = helpers.delay((event: MouseEvent, html: string) => {\n\t\t\tif(gantt.callEvent(\"onBeforeTooltip\", [event]) === false) {\n\t\t\t\tthis.tooltip.hide();\n\t\t\t} else {\n\t\t\t\tthis.tooltip.setContent(html);\n\t\t\t\tthis.tooltip.show(event);\n\t\t\t}\n\t\t}, gantt.config.tooltip_timeout || 1);\n\n\t\tthis.delayHide = helpers.delay(() => {\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\tthis.tooltip.hide();\n\t\t}, gantt.config.tooltip_hide_timeout || 1);\n\t}\n\n}","import { IInlineEditState, IMonitor, IUndo, IUndoCommand, TActionType, TEntityType, TUndoValue } from \"./types\";\n\nconst noTrack = {\n\tonBeforeUndo: \"onAfterUndo\",\n\tonBeforeRedo: \"onAfterRedo\"\n};\n\nconst batchActions = [\n\t\"onTaskDragStart\",\n\t\"onAfterTaskUpdate\",\n\t\"onAfterParentExpand\",\n\t\"onAfterTaskDelete\",\n\t\"onBeforeBatchUpdate\"\n];\n\nexport class Monitor implements IMonitor {\n\tprivate _batchAction = null;\n\tprivate _batchMode = false;\n\tprivate _ignore = false;\n\tprivate _ignoreMoveEvents = false;\n\tprivate _initialTasks = {};\n\tprivate _initialLinks = {};\n\tprivate _nestedTasks =  {};\n\tprivate _nestedLinks = {};\n\tprivate _timeout;\n\tprivate _gantt: any;\n\tprivate _undo: IUndo;\n\n\tconstructor(undo: IUndo, gantt: any) {\n\t\tthis._undo = undo;\n\t\tthis._gantt = gantt;\n\t\tthis._attachEvents();\n\t}\n\n\tstore(id: TaskID | LinkID, type: TEntityType, overwrite: boolean = false) {\n\t\tif (type === this._gantt.config.undo_types.task) {\n\t\t\treturn this._storeTask(id, overwrite);\n\t\t}\n\t\tif (type === this._gantt.config.undo_types.link) {\n\t\t\treturn this._storeLink(id, overwrite);\n\t\t}\n\t\treturn false;\n\t}\n\tisMoveEventsIgnored() {\n\t\treturn this._ignoreMoveEvents;\n\t}\n\ttoggleIgnoreMoveEvents(newValue?: boolean) {\n\t\tthis._ignoreMoveEvents = newValue || false;\n\t}\n\tstartIgnore() {\n\t\tthis._ignore = true;\n\t}\n\tstopIgnore() {\n\t\tthis._ignore = false;\n\t}\n\tstartBatchAction() {\n\t\t// try catching updates made from event handlers using timeout\n\t\tif (!this._timeout){\n\t\t\tthis._timeout = setTimeout(() => {\n\t\t\t\tthis.stopBatchAction();\n\t\t\t\tthis._timeout = null;\n\t\t\t}, 10);\n\t\t}\n\n\n\t\tif (this._ignore || this._batchMode) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._batchMode = true;\n\t\tthis._batchAction = this._undo.action.create();\n\t}\n\tstopBatchAction() {\n\t\tif (this._ignore) {\n\t\t\treturn;\n\t\t}\n\t\tconst undo = this._undo;\n\t\tif (this._batchAction) {\n\t\t\tundo.logAction(this._batchAction);\n\t\t}\n\t\tthis._batchMode = false;\n\t\tthis._batchAction = null;\n\t}\n\tonTaskAdded(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.add);\n\t\t}\n\t}\n\tonTaskUpdated(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.update);\n\t\t}\n\t}\n\tonTaskMoved(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\t(task as any).$local_index = this._gantt.getTaskIndex(task.id);\n\t\t\tconst oldValue = this.getInitialTask(task.id);\n\t\t\tif((task as any).$local_index === oldValue.$local_index &&\n\t\t\t\tthis._gantt.getParent(task) === this._gantt.getParent(oldValue)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\tthis._storeEntityCommand(\n\t\t\t\ttask,\n\t\t\t\tthis.getInitialTask(task.id),\n\t\t\t\tthis._undo.command.type.move,\n\t\t\t\tthis._undo.command.entity.task\n\t\t\t);\n\t\t}\n\t}\n\tonTaskDeleted(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.remove);\n\t\t\tif (this._nestedTasks[task.id]) {\n\t\t\t\tconst children = this._nestedTasks[task.id];\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tthis._storeTaskCommand(children[i], this._undo.command.type.remove);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._nestedLinks[task.id]) {\n\t\t\t\tconst childrenLinks = this._nestedLinks[task.id];\n\t\t\t\tfor (let i = 0; i < childrenLinks.length; i++) {\n\t\t\t\t\tthis._storeLinkCommand(childrenLinks[i], this._undo.command.type.remove);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tonLinkAdded(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.add);\n\t\t}\n\t}\n\tonLinkUpdated(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.update);\n\t\t}\n\t}\n\tonLinkDeleted(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.remove);\n\t\t}\n\t}\n\tsetNestedTasks(id: TaskID, taskIds: TaskID[]) {\n\t\tconst gantt = this._gantt;\n\t\tlet task = null;\n\t\tconst tasks = [];\n\t\tlet\tlinkIds = this._getLinks(gantt.getTask(id));\n\n\t\tfor (let i = 0; i < taskIds.length; i++) {\n\t\t\ttask = this.setInitialTask(taskIds[i]);\n\t\t\tlinkIds = linkIds.concat(this._getLinks(task));\n\t\t\ttasks.push(task);\n\t\t}\n\n\t\tconst uniqueLinks = {};\n\t\tfor (let i = 0; i < linkIds.length; i++) {\n\t\t\tuniqueLinks[linkIds[i]] = true;\n\t\t}\n\t\tconst links = [];\n\t\tfor (const i in uniqueLinks) {\n\t\t\tlinks.push(this.setInitialLink(i));\n\t\t}\n\t\tthis._nestedTasks[id] = tasks;\n\t\tthis._nestedLinks[id] = links;\n\t}\n\tsetInitialTask(id: TaskID, overwrite?: boolean) {\n\t\tconst gantt = this._gantt;\n\t\tif (overwrite || (!this._initialTasks[id] || !this._batchMode)) {\n\t\t\tconst task = gantt.copy(gantt.getTask(id));\n\t\t\ttask.$index = gantt.getGlobalTaskIndex(id);\n\t\t\ttask.$local_index = gantt.getTaskIndex(id);\n\t\t\tthis.setInitialTaskObject(id, task);\n\t\t}\n\t\treturn this._initialTasks[id];\n\t}\n\tgetInitialTask(id: TaskID) {\n\t\treturn this._initialTasks[id];\n\t}\n\tclearInitialTasks() {\n\t\tthis._initialTasks = {};\n\t}\n\tsetInitialTaskObject(id: TaskID, object: ITask) {\n\t\tthis._initialTasks[id] = object;\n\t}\n\tsetInitialLink(id: LinkID, overwrite?: boolean) {\n\t\tif (!this._initialLinks[id] || !this._batchMode) {\n\t\t\tthis._initialLinks[id] = this._gantt.copy(this._gantt.getLink(id));\n\t\t}\n\t\treturn this._initialLinks[id];\n\t}\n\tgetInitialLink(id: LinkID) {\n\t\treturn this._initialLinks[id];\n\t}\n\tclearInitialLinks() {\n\t\tthis._initialLinks = {};\n\t}\n\tprivate _attachEvents() {\n\t\tlet deleteCacheCooldown = null;\n\t\tconst gantt = this._gantt;\n\n\t\tconst saveInitialAll = () => {\n\t\t\tif (!deleteCacheCooldown) {\n\t\t\t\tdeleteCacheCooldown = setTimeout(() => {\n\t\t\t\t\tdeleteCacheCooldown = null;\n\t\t\t\t});\n\n\t\t\t\tthis.clearInitialTasks();\n\t\t\t\tgantt.eachTask((task: ITask) => {\n\t\t\t\t\tthis.setInitialTask(task.id);\n\t\t\t\t});\n\n\t\t\t\tthis.clearInitialLinks();\n\t\t\t\tgantt.getLinks().forEach((link: ILink) => {\n\t\t\t\t\tthis.setInitialLink(link.id);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tconst getMoveObjectByTaskId = (id: TaskID) => {\n\t\t\treturn gantt.copy(gantt.getTask(id));\n\t\t};\n\n\t\tfor (const i in noTrack) {\n\t\t\tgantt.attachEvent(i, () => {\n\t\t\t\tthis.startIgnore();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(noTrack[i], () => {\n\t\t\t\tthis.stopIgnore();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tfor (let i  = 0; i < batchActions.length; i++) {\n\t\t\tgantt.attachEvent(batchActions[i], () => {\n\t\t\t\tthis.startBatchAction();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tgantt.attachEvent(\"onParse\", () => {\n\t\t\tthis._undo.clearUndoStack();\n\t\t\tthis._undo.clearRedoStack();\n\t\t\tsaveInitialAll();\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", (id: TaskID, task: ITask) => {\n\t\t\tthis.setInitialTask(id, true);\n\t\t\tthis.onTaskAdded(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskUpdated(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterParentExpand\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskUpdated(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskDeleted(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkAdd\", (id: LinkID, link: ILink) => {\n\t\t\tthis.setInitialLink(id, true);\n\t\t\tthis.onLinkAdded(link);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", (id: LinkID, link: ILink) => {\n\t\t\tthis.onLinkUpdated(link);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkDelete\", (id: LinkID, link: ILink) => {\n\t\t\tthis.onLinkDeleted(link);\n\t\t});\n\t\tgantt.attachEvent(\"onRowDragEnd\", (id: TaskID, target: TaskID) => {\n\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\n\t\t\tthis.toggleIgnoreMoveEvents();\n\t\t\treturn true;\n\t\t});\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", (id: TaskID) => {\n\t\t\tthis.store(id, gantt.config.undo_types.task);\n\t\t\tconst nested = [];\n\n\t\t\t// remember task indexes in case their being deleted in a loop, so they could be restored in the correct order\n\t\t\tsaveInitialAll();\n\n\t\t\tgantt.eachTask((task: ITask) => {\n\t\t\t\tnested.push(task.id);\n\t\t\t}, id);\n\t\t\tthis.setNestedTasks(id, nested);\n\t\t\treturn true;\n\t\t});\n\t\tconst datastore = gantt.getDatastore(\"task\");\n\n\t\tdatastore.attachEvent(\"onBeforeItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\n\t\t\tif (!this.isMoveEventsIgnored()) {\n\t\t\t\tsaveInitialAll();\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tdatastore.attachEvent(\"onAfterItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\n\t\t\tif (!this.isMoveEventsIgnored()) {\n\t\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onRowDragStart\", (id: TaskID, target: TaskID, e: Event) => {\n\t\t\tthis.toggleIgnoreMoveEvents(true);\n\t\t\tsaveInitialAll();\n\t\t\treturn true;\n\t\t});\n\n\t\tlet dragId = null;\n\t\tlet projectDrag = false;\n\t\tgantt.attachEvent(\"onBeforeTaskDrag\", (taskId: TaskID) => {\n\t\t\tdragId = gantt.getState().drag_id;\n\t\t\tif (dragId === taskId){\n\t\t\t\tconst task = gantt.getTask(taskId);\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project){\n\t\t\t\t\tprojectDrag = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// GS-99. Store the initial task dates before multiple drag\n\t\t\tif (gantt.plugins().multiselect){\n\t\t\t\tconst selectedIds = gantt.getSelectedTasks();\n\t\t\t\tif (selectedIds.length > 1){\n\t\t\t\t\tselectedIds.forEach((id)=>{\n\t\t\t\t\t\tthis.store(id, gantt.config.undo_types.task, true);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.store(taskId, gantt.config.undo_types.task);\n\t\t});\n\n\t\tgantt.attachEvent(\"onAfterTaskDrag\", (taskId: TaskID) => {\n\t\t\t// if we drag multiple tasks and other tasks move to another date after that,\n\t\t\t// auto-scheduling/correct work time should occur in anoher command.\n\t\t\t// otherwise, when we undo the changes, the task constraint is not restored correctly\n\t\t\tconst multipleDrag = projectDrag || (gantt.plugins().multiselect && gantt.getSelectedTasks().length > 1);\n\t\t\tif (multipleDrag && dragId === taskId){\n\t\t\t\tprojectDrag = false;\n\t\t\t\tdragId = null;\n\t\t\t\tthis.stopBatchAction();\n\t\t\t}\n\t\t\t// GS-99. When dragging multiple tasks, we need to store the initial tasks\n\t\t\tthis.store(taskId, gantt.config.undo_types.task, true);\n\t\t});\n\n\t\tgantt.attachEvent(\"onLightbox\", (taskId: TaskID) => this.store(taskId, gantt.config.undo_types.task));\n\n\t\tgantt.attachEvent(\"onBeforeTaskAutoSchedule\", (task: ITask) => {\n\t\t\tthis.store(task.id, gantt.config.undo_types.task, true);\n\t\t\treturn true;\n\t\t});\n\n\t\tif (gantt.ext.inlineEditors) {\n\t\t\t// remove the onGanttLayoutReady wrapper when GS-1288 is merged\n\t\t\tlet onBeforeEditStartId = null;\n\t\t\tlet onEditStart = null;\n\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", () => {\n\t\t\t\tif (onBeforeEditStartId) {\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onBeforeEditStartId);\n\t\t\t\t}\n\t\t\t\tif (onEditStart) {\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onEditStart);\n\t\t\t\t}\n\n\t\t\t\tonEditStart = gantt.ext.inlineEditors.attachEvent(\"onEditStart\", (state: IInlineEditState) => {\n\t\t\t\t\tthis.store(state.id, gantt.config.undo_types.task);\n\t\t\t\t});\n\n\t\t\t\t// GS-99. If another inline editor is opened and we open a new inline editor,\n\t\t\t\t// we shouldn't use the batchAction\n\t\t\t\tonBeforeEditStartId = gantt.ext.inlineEditors.attachEvent(\"onBeforeEditStart\", (state: IInlineEditState) => {\n\t\t\t\t\tthis.stopBatchAction();\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _storeCommand(command: IUndoCommand) {\n\t\tconst undo = this._undo;\n\t\tundo.updateConfigs();\n\n\t\tif (!undo.undoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._batchMode) {\n\t\t\tthis._batchAction.commands.push(command);\n\t\t} else {\n\t\t\tconst action = undo.action.create([command]);\n\t\t\tundo.logAction(action);\n\t\t}\n\t}\n\tprivate _storeEntityCommand(obj: TUndoValue, old: TUndoValue, actionType: TActionType, entityType: TEntityType) {\n\t\tconst undo = this._undo;\n\t\tconst command = undo.command.create(obj, old, actionType, entityType);\n\t\tthis._storeCommand(command);\n\t}\n\tprivate _storeTaskCommand(obj: ITask, type: TActionType) {\n\t\tif(this._gantt.isTaskExists(obj.id)){\n\t\t\t(obj as any).$local_index = this._gantt.getTaskIndex(obj.id);\n\t\t}\n\n\t\tthis._storeEntityCommand(obj, this.getInitialTask(obj.id), type, this._undo.command.entity.task);\n\t}\n\tprivate _storeLinkCommand(obj: ILink, type: TActionType) {\n\t\tthis._storeEntityCommand(obj, this.getInitialLink(obj.id), type, this._undo.command.entity.link);\n\t}\n\tprivate _getLinks(task: ITask) {\n\t\treturn task.$source.concat(task.$target);\n\t}\n\tprivate _storeTask(taskId: TaskID, overwrite: boolean = false) {\n\t\tconst gantt = this._gantt;\n\t\tthis.setInitialTask(taskId, overwrite);\n\t\tgantt.eachTask((child: ITask) => {\n\t\t\tthis.setInitialTask(child.id);\n\t\t}, taskId);\n\t\treturn true;\n\t}\n\tprivate _storeLink(linkId: LinkID, overwrite: boolean = false) {\n\t\tthis.setInitialLink(linkId, overwrite);\n\t\treturn true;\n\t}\n}","import { IUndo, IUndoCommand, IUndoCommands, IUndoPropAction, IUndoPropCommand, TActionType, TEntityType, TUndoStack, TUndoValue } from \"./types\";\n\nconst MAX_UNDO_STEPS = 100;\n\nexport class Undo implements IUndo {\n\n\tmaxSteps = MAX_UNDO_STEPS;\n\tundoEnabled = true;\n\tredoEnabled = true;\n\taction: IUndoPropAction = {\n\t\tcreate: (commands?: IUndoCommand[]): IUndoCommands => {\n\t\t\treturn { commands: (commands ? commands.slice() : []) };\n\t\t},\n\t\tinvert: (action: IUndoCommands): IUndoCommands => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst revert = gantt.copy(action);\n\t\t\tconst commands = this.command;\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\n\t\t\t\tconst command = revert.commands[i] = commands.invert(revert.commands[i]);\n\t\t\t\tif (command.type === commands.type.update || command.type === commands.type.move) {\n\t\t\t\t\t[command.value, command.oldValue] = [command.oldValue, command.value];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn revert as IUndoCommands;\n\t\t}\n\t};\n\tcommand: IUndoPropCommand = {\n\t\t// entities that require different processing for undoing-redoing changes (gantt.config.undo_types)\n\t\tentity: null,\n\n\t\t// types of traced actions (gantt.config.undo_actions)\n\t\ttype: null,\n\n\t\tcreate: (value: TUndoValue, oldValue: TUndoValue, type: TActionType, entity: TEntityType): IUndoCommand => {\n\t\t\tconst gantt = this._gantt;\n\t\t\treturn {\n\t\t\t\tentity,\n\t\t\t\ttype,\n\t\t\t\tvalue: gantt.copy(value),\n\t\t\t\toldValue: gantt.copy(oldValue || value)\n\t\t\t};\n\t\t},\n\t\tinvert: (command: IUndoCommand): IUndoCommand => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst revert = gantt.copy(command);\n\t\t\trevert.type = this.command.inverseCommands(command.type);\n\t\t\treturn revert;\n\t\t},\n\t\tinverseCommands: (command: TActionType): TActionType => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst types = this.command.type;\n\t\t\tswitch (command) {\n\t\t\t\tcase types.update:\n\t\t\t\t\treturn types.update;\n\t\t\t\tcase types.remove:\n\t\t\t\t\treturn types.add;\n\t\t\t\tcase types.add:\n\t\t\t\t\treturn types.remove;\n\t\t\t\tcase types.move:\n\t\t\t\t\treturn types.move;\n\t\t\t\tdefault:\n\t\t\t\t\tgantt.assert(false, \"Invalid command \"+ command);\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t};\n\n\tprivate _undoStack = [];\n\tprivate _redoStack = [];\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any){\n\t\tthis._gantt = gantt;\n\t}\n\tgetUndoStack() {\n\t\treturn this._undoStack;\n\t}\n\tsetUndoStack(stack: []) {\n\t\tthis._undoStack = stack;\n\t}\n\n\tgetRedoStack() {\n\t\treturn this._redoStack;\n\t}\n\tsetRedoStack(stack: []) {\n\t\tthis._redoStack = stack;\n\t}\n\n\tclearUndoStack() {\n\t\tthis._undoStack = [];\n\t}\n\n\tclearRedoStack() {\n\t\tthis._redoStack = [];\n\t}\n\n\tupdateConfigs() {\n\t\tconst gantt = this._gantt;\n\t\tthis.maxSteps = gantt.config.undo_steps || MAX_UNDO_STEPS;\n\t\tthis.command.entity = gantt.config.undo_types;\n\t\tthis.command.type = gantt.config.undo_actions;\n\t\tthis.undoEnabled = !!gantt.config.undo;\n\t\tthis.redoEnabled = !!gantt.config.redo; // GS-873, Redo should work even when the `gantt.config.undo` is disabled.\n\t}\n\n\tundo() {\n\t\tconst gantt = this._gantt;\n\t\tthis.updateConfigs();\n\t\tif (!this.undoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = this._pop(this._undoStack);\n\t\tif (action) {\n\t\t\tthis._reorderCommands(action);\n\t\t}\n\t\tif (gantt.callEvent(\"onBeforeUndo\", [action]) !== false) {\n\t\t\tif (action) {\n\t\t\t\tthis._applyAction(this.action.invert(action));\n\t\t\t\tthis._push(this._redoStack, gantt.copy(action));\n\t\t\t\tgantt.callEvent(\"onAfterUndo\", [action]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tgantt.callEvent(\"onAfterUndo\", [null]);\n\t}\n\n\tredo() {\n\t\tconst gantt = this._gantt;\n\t\tthis.updateConfigs();\n\t\tif (!this.redoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = this._pop(this._redoStack);\n\t\tif (action) {\n\t\t\tthis._reorderCommands(action);\n\t\t}\n\n\t\tif (gantt.callEvent(\"onBeforeRedo\", [action]) !== false) {\n\t\t\tif (action) {\n\t\t\t\tthis._applyAction(action);\n\t\t\t\tthis._push(this._undoStack, gantt.copy(action));\n\t\t\t\tgantt.callEvent(\"onAfterRedo\", [action]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tgantt.callEvent(\"onAfterRedo\", [null]);\n\t}\n\n\t// storeUndo:\n\tlogAction(action: IUndoCommands) {\n\t\tthis._push(this._undoStack, action);\n\t\tthis._redoStack = [];\n\t}\n\n\tprivate _push(stack: TUndoStack, action: IUndoCommands): IUndoCommands {\n\t\tconst gantt = this._gantt;\n\t\tif (!action.commands.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = stack === this._undoStack ? \"onBeforeUndoStack\" : \"onBeforeRedoStack\";\n\t\tif (gantt.callEvent(event, [action]) === false){\n\t\t\treturn;\n\t\t}\n\t\t// commands can be removed from event handler\n\t\tif (!action.commands.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tstack.push(action);\n\t\twhile (stack.length > this.maxSteps) {\n\t\t\tstack.shift();\n\t\t}\n\t\treturn action;\n\t}\n\n\tprivate _pop(stack: TUndoStack): IUndoCommands {\n\t\treturn stack.pop();\n\t}\n\n\tprivate _reorderCommands(action) {\n\t\t// firstly process tasks and only then links\n\t\t// in order to ensure links are added not earlier than their tasks\n\t\t// firstly to 'move' actions and only then updates\n\t\tconst weights = { any: 0, link:1, task:2 };\n\t\tconst actionWeights = { move: 1, any:0 };\n\t\taction.commands.sort(function(a, b) {\n\t\t\tif (a.entity === \"task\" && b.entity === \"task\") {\n\t\t\t\tif (a.type !== b.type) {\n\t\t\t\t\treturn (actionWeights[b.type] || 0) - (actionWeights[a.type] || 0);\n\t\t\t\t} else if (a.type === \"move\" && a.oldValue && b.oldValue && b.oldValue.parent === a.oldValue.parent) {\n\t\t\t\t\treturn a.oldValue.$index - b.oldValue.$index;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst weightA = weights[a.entity] || weights.any;\n\t\t\t\tconst weightB = weights[b.entity] || weights.any;\n\t\t\t\treturn weightB - weightA;\n\t\t\t}\n\n\t\t});\n\t}\n\n\tprivate _applyAction(action: IUndoCommands) {\n\t\tlet command = null;\n\t\tconst entities = this.command.entity;\n\t\tconst actions = this.command.type;\n\t\tconst gantt = this._gantt;\n\t\tconst methods = {};\n\t\tmethods[entities.task] = {\n\t\t\tadd: \"addTask\",\n\t\t\tget: \"getTask\",\n\t\t\tupdate: \"updateTask\",\n\t\t\tremove: \"deleteTask\",\n\t\t\tmove: \"moveTask\",\n\t\t\tisExists: \"isTaskExists\"\n\t\t};\n\t\tmethods[entities.link] = {\n\t\t\tadd: \"addLink\",\n\t\t\tget: \"getLink\",\n\t\t\tupdate: \"updateLink\",\n\t\t\tremove: \"deleteLink\",\n\t\t\tisExists: \"isLinkExists\"\n\t\t};\n\n\t\tgantt.batchUpdate(function() {\n\t\t\t// it is logical to undo actions from the last one to the first one\n\t\t\t// but we have to do it from the first one because the order\n\t\t\t// of tasks ($index and $local_index) depends on the existing tasks\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\n\t\t\t\tcommand = action.commands[i];\n\t\t\t\tconst method = methods[command.entity][command.type];\n\t\t\t\tconst getMethod = methods[command.entity].get;\n\t\t\t\tconst check = methods[command.entity].isExists;\n\n\t\t\t\tif (command.type === actions.add) {\n\t\t\t\t\tgantt[method](command.oldValue, command.oldValue.parent, command.oldValue.$local_index);\n\t\t\t\t} else if (command.type === actions.remove) {\n\t\t\t\t\tif (gantt[check](command.value.id)) {\n\t\t\t\t\t\tgantt[method](command.value.id);\n\t\t\t\t\t}\n\t\t\t\t} else if (command.type === actions.update) {\n\t\t\t\t\tconst item = gantt[getMethod](command.value.id);\n\t\t\t\t\tfor(const prop in command.value){\n\t\t\t\t\t\tconst internalProperty = prop.startsWith(\"$\") || prop.startsWith(\"_\");\n\t\t\t\t\t\tconst whitelist = [\"$open\"];\n\t\t\t\t\t\tlet copyProperty = !internalProperty;\n\t\t\t\t\t\tif (whitelist.indexOf(prop) > -1){\n\t\t\t\t\t\t\tcopyProperty = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(copyProperty){\n\t\t\t\t\t\t\titem[prop] = command.value[prop];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tgantt[method](command.value.id);\n\t\t\t\t} else if (command.type === actions.move) {\n\t\t\t\t\tgantt[method](command.value.id, command.value.$local_index, command.value.parent);\n\t\t\t\t\t// GS-680: We should send the changes to the server after we undo vertical reorder\n\t\t\t\t\tgantt.callEvent(\"onRowDragEnd\", [command.value.id]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}","\nimport click_drag from \"./click_drag\";\nimport drag_timeline from \"./drag_timeline\";\nimport export_api from \"./export_api\";\nimport fullscreen from \"./fullscreen\";\nimport keyboard_navigation from \"./keyboard_navigation\";\nimport marker from \"./marker\";\nimport multiselect from \"./multiselect\";\nimport quick_info from \"./quick_info\";\nimport tooltip from \"./tooltip\";\nimport undo from \"./undo\";\n\nexport default {\n\tclick_drag,\n\tdrag_timeline,\n\tfullscreen,\n\tkeyboard_navigation,\n\tquick_info,\n\ttooltip,\n\tundo,\n\tmarker,\n\tmultiselect,\n\texport_api\n};","import { EventsManager } from \"./eventsManager\";\nimport { ISelectedRegionConfig, SelectedRegion } from \"./selectedRegion\";\n\nexport default function(gantt: any){\n\tif (!gantt.ext) {\n\t\tgantt.ext = {};\n\t}\n\n\tconst defaultConfig: ISelectedRegionConfig = {\n\t\tclassName: \"gantt_click_drag_rect\",\n\t\tuseRequestAnimationFrame: true,\n\t\tcallback: undefined,\n\t\tsingleRow: false\n\t};\n\n\tconst eventsManager = new EventsManager(gantt);\n\n\tgantt.ext.clickDrag = eventsManager;\n\n\tgantt.attachEvent(\"onGanttReady\", () => {\n\t\tconst config: ISelectedRegionConfig = { viewPort: gantt.$task_data, ...defaultConfig };\n\t\tif (gantt.config.click_drag){\n\t\t\tconst clickDrag = gantt.config.click_drag;\n\t\t\tconfig.render = clickDrag.render || defaultConfig.render;\n\t\t\tconfig.className = clickDrag.className || defaultConfig.className;\n\t\t\tconfig.callback = clickDrag.callback || defaultConfig.callback;\n\t\t\tconfig.viewPort = clickDrag.viewPort || gantt.$task_data;\n\t\t\tconfig.useRequestAnimationFrame = clickDrag.useRequestAnimationFrame === undefined ?\n\t\t\t\tdefaultConfig.useRequestAnimationFrame : clickDrag.useRequestAnimationFrame;\n\n\t\t\tconfig.singleRow = clickDrag.singleRow === undefined ? defaultConfig.singleRow : clickDrag.singleRow;\n\t\t\tconst timeline = gantt.$ui.getView(\"timeline\");\n\t\t\tconst selectedRegion = new SelectedRegion(config, gantt, timeline);\n\t\t\tgantt.ext.clickDrag.attach(selectedRegion, clickDrag.useKey, clickDrag.ignore);\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", () => {\n\t\teventsManager.destructor();\n\t});\n\n}","import { EventsManager } from \"./eventsManager\";\nexport default function(gantt: any){\n\tif (!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.dragTimeline = {\n\t\tcreate: () => EventsManager.create(gantt)\n\t};\n\n\tgantt.config.drag_timeline = {\n\t\tenabled: true,\n\t\trender: false\n\t};\n}","export default function(gantt: any){\n\ninterface IBody extends HTMLElement {\n\tmsRequestFullscreen?: () => void;\n\tmozRequestFullScreen?: () => void;\n\twebkitRequestFullscreen?: (ALLOW_KEYBOARD_INPUT: any) => void;\n}\n\n\ninterface IConsole extends Console {\n\twarning?: (str: string) => void;\n}\n\ninterface IDocument extends Document {\n\tfullscreenElement: Element;\n\tmozFullScreenElement?: Element;\n\twebkitFullscreenElement?: Element;\n\tmsFullscreenElement?: Element;\n\twebkitFullscreenEnabled?: boolean;\n\tmozFullScreenEnabled?: boolean;\n\tmsFullscreenEnabled?: boolean;\n\tmsExitFullscreen?: () => void;\n\tmozCancelFullScreen?: () => void;\n\twebkitExitFullscreen?: () => void;\n}\n\ninterface IElement extends Element {\n\tALLOW_KEYBOARD_INPUT?: boolean;\n}\n\ninterface IElementSizes extends ISizes {\n\tmodified: boolean;\n}\n\ninterface ISizes {\n\twidth: null | string;\n\theight: null | string;\n\ttop: null | string;\n\tleft: null | string;\n\tposition: null | string;\n\tzIndex: null | number;\n}\n\nfunction isExpanded() {\n\tconst element = ((document as IDocument).fullscreenElement ||\n\t\t(document as IDocument).mozFullScreenElement ||\n\t\t(document as IDocument).webkitFullscreenElement ||\n\t\t(document as IDocument).msFullscreenElement);\n\treturn !!(element && element === document.body);\n}\n\nfunction isFullscreenAvailable() {\n\ttry {\n\t\treturn (document as IDocument).fullscreenEnabled ||\n\t\t\t(document as IDocument).webkitFullscreenEnabled ||\n\t\t\t(document as IDocument).mozFullScreenEnabled ||\n\t\t\t(document as IDocument).msFullscreenEnabled;\n\t} catch (e) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\"Fullscreen is not available:\", e); \n\t}\n}\n\nconst state = gantt.$services.getService(\"state\");\nstate.registerProvider(\"fullscreen\", () => {\n\tif (isFullscreenAvailable()){\n\t\treturn { fullscreen: isExpanded() };\n\t} else {\n\t\treturn undefined;\n\t}\n});\n\nlet backupBodyPadding = {\n\toverflow: null,\n\tpadding: null,\n\tpaddingTop: null,\n\tpaddingRight: null,\n\tpaddingBottom: null,\n\tpaddingLeft: null\n};\n\nconst backupElementSizes: IElementSizes = {\n\twidth: null,\n\theight: null,\n\ttop: null,\n\tleft: null,\n\tposition: null,\n\tzIndex: null,\n\tmodified: false\n};\n\nlet backupPositioning = null;\nfunction resetParentPositioning(root){\n\tlet parent = root.parentNode;\n\tconst positions = [];\n\twhile(parent && parent.style){\n\t\tpositions.push({\n\t\t\telement: parent,\n\t\t\toriginalPositioning: parent.style.position\n\t\t});\n\t\tparent.style.position = \"static\";\n\t\tparent = parent.parentNode;\n\t}\n\treturn positions;\n}\n\nfunction restoreParentPositioning(positions: any[]){\n\tpositions.forEach(record => {\n\t\trecord.element.style.position = record.originalPositioning;\n\t});\n}\n\n// expand gantt root element to fullscreen automatically\nfunction setFullScreenSizes() {\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\n\tconst body = document.body;\n\tupdateSizes(root.style, backupElementSizes);\n\tbackupBodyPadding = {\n\t\toverflow: body.style.overflow,\n\t\tpadding: body.style.padding ? body.style.padding : null,\n\t\tpaddingTop: body.style.paddingTop ? body.style.paddingTop : null,\n\t\tpaddingRight: body.style.paddingRight ? body.style.paddingRight : null,\n\t\tpaddingBottom: body.style.paddingBottom ? body.style.paddingBottom : null,\n\t\tpaddingLeft: body.style.paddingLeft ? body.style.paddingLeft : null\n\t};\n\n\tif (body.style.padding) {\n\t\tbody.style.padding = \"0\";\n\t}\n\tif (body.style.paddingTop) {\n\t\tbody.style.paddingTop = \"0\";\n\t}\n\tif (body.style.paddingRight) {\n\t\tbody.style.paddingRight = \"0\";\n\t}\n\tif (body.style.paddingBottom) {\n\t\tbody.style.paddingBottom = \"0\";\n\t}\n\tif (body.style.paddingLeft) {\n\t\tbody.style.paddingLeft = \"0\";\n\t}\n\n\tbody.style.overflow = \"hidden\";\n\n\troot.style.width = \"100vw\";\n\troot.style.height = \"100vh\";\n\troot.style.top = \"0px\";\n\troot.style.left = \"0px\";\n\troot.style.position = \"absolute\";\n\troot.style.zIndex = 1;\n\tbackupElementSizes.modified = true;\n\tbackupPositioning = resetParentPositioning(root);\n}\n\nfunction restoreSizes() {\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\n\tconst body = document.body;\n\tif (backupElementSizes.modified) {\n\t\tif (backupBodyPadding.padding) {\n\t\t\tbody.style.padding = backupBodyPadding.padding;\n\t\t}\n\t\tif (backupBodyPadding.paddingTop) {\n\t\t\tbody.style.paddingTop = backupBodyPadding.paddingTop;\n\t\t}\n\t\tif (backupBodyPadding.paddingRight) {\n\t\t\tbody.style.paddingRight = backupBodyPadding.paddingRight;\n\t\t}\n\t\tif (backupBodyPadding.paddingBottom) {\n\t\t\tbody.style.paddingBottom = backupBodyPadding.paddingBottom;\n\t\t}\n\t\tif (backupBodyPadding.paddingLeft) {\n\t\t\tbody.style.paddingLeft = backupBodyPadding.paddingLeft;\n\t\t}\n\n\t\tbody.style.overflow = backupBodyPadding.overflow;\n\t\tbackupBodyPadding = {\n\t\t\toverflow: null,\n\t\t\tpadding: null,\n\t\t\tpaddingTop: null,\n\t\t\tpaddingRight: null,\n\t\t\tpaddingBottom: null,\n\t\t\tpaddingLeft: null\n\t\t};\n\t\tupdateSizes(backupElementSizes, root.style);\n\t\tbackupElementSizes.modified = false;\n\t}\n\trestoreParentPositioning(backupPositioning);\n\tbackupPositioning = null;\n}\n\nfunction updateSizes(source: ISizes, target: ISizes) {\n\ttarget.width = source.width;\n\ttarget.height = source.height;\n\ttarget.top = source.top;\n\ttarget.left = source.left;\n\ttarget.position = source.position;\n\ttarget.zIndex = source.zIndex;\n}\n\nfunction addDOMEvents() {\n\tgantt.event(document, \"webkitfullscreenchange\", onFullScreenChange);\n\tgantt.event(document, \"mozfullscreenchange\", onFullScreenChange);\n\tgantt.event(document, \"MSFullscreenChange\", onFullScreenChange);\n\t// For IE on Win 10\n\tgantt.event(document, \"fullscreenChange\", onFullScreenChange);\n\tgantt.event(document, \"fullscreenchange\", onFullScreenChange);\n}\n\nlet expandGantt = false;\nfunction onFullScreenChange() {\n\tif (!gantt.$container) {\n\t\t// do nothing if gantt is not yet initialized\n\t\treturn;\n\t}\n\tlet event: \"onExpand\" | \"onCollapse\";\n\tconst isBodyExpanded = isExpanded();\n\n\tif (isBodyExpanded) {\n\t\tif (expandGantt) {\n\t\t\tevent = \"onExpand\";\n\t\t\tsetFullScreenSizes();\n\t\t}\n\t} else if (expandGantt) {\n\t\texpandGantt = false;\n\t\tevent = \"onCollapse\";\n\t\trestoreSizes();\n\t}\n\tsetTimeout(() => {\n\t\tgantt.render();\n\t});\n\tsetTimeout(() => {\n\t\tgantt.callEvent(event, [gantt.ext.fullscreen.getFullscreenElement()]);\n\t});\n}\n\nfunction cantFullscreen() {\n\tif (!gantt.$container) { // check is gantt initialized or not\n\t\treturn true;\n\t}\n\tif (!gantt.ext.fullscreen.getFullscreenElement()) {\n\t\treturn true;\n\t}\n\tif (!isFullscreenAvailable()) {\n\t\t// eslint-disable-next-line no-console\n\t\tconst method = (console as IConsole).warning || console.log;\n\t\tmethod(\"The `fullscreen` feature not being allowed, or full-screen mode not being supported\");\n\t\treturn true;\n\t}\n\treturn false;\n}\n\ngantt.ext.fullscreen = {\n\texpand(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isExpanded()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!gantt.callEvent(\"onBeforeExpand\", [this.getFullscreenElement()])) {\n\t\t\treturn;\n\t\t}\n\t\texpandGantt = true;\n\n\t\t// we switch body to fullscreen and then expand fullscreen element to viewport\n\t\t// we do it to correct display common elements: lightboxes, tooltip etc.\n\t\tconst element = document.body as IBody;\n\t\tconst requestArguments = element.webkitRequestFullscreen ?\n\t\t\t[(Element as unknown as IElement).ALLOW_KEYBOARD_INPUT] : [];\n\n\t\tconst requestFullscreen = element.msRequestFullscreen ||\n\t\t\telement.mozRequestFullScreen ||\n\t\t\telement.webkitRequestFullscreen ||\n\t\t\telement.requestFullscreen;\n\n\t\tif (requestFullscreen) {\n\t\t\trequestFullscreen.apply(element, requestArguments);\n\t\t}\n\t},\n\tcollapse(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!isExpanded()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!gantt.callEvent(\"onBeforeCollapse\", [this.getFullscreenElement()])) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst requestExitFullscreen = (document as IDocument).msExitFullscreen ||\n\t\t\t(document as IDocument).mozCancelFullScreen ||\n\t\t\t(document as IDocument).webkitExitFullscreen ||\n\t\t\t(document as IDocument).exitFullscreen;\n\n\t\tif (requestExitFullscreen) {\n\t\t\trequestExitFullscreen.apply(document);\n\t\t}\n\t},\n\ttoggle(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!isExpanded()) {\n\t\t\tthis.expand();\n\t\t} else {\n\t\t\tthis.collapse();\n\t\t}\n\n\t},\n\tgetFullscreenElement(): HTMLElement {\n\t\treturn gantt.$root;\n\t}\n};\n\ngantt.expand = function() {\n\tgantt.ext.fullscreen.expand();\n};\n\ngantt.collapse = function(){\n\tgantt.ext.fullscreen.collapse();\n};\n\ngantt.attachEvent(\"onGanttReady\", addDOMEvents);\n\n}","import eventable from \"../utils/eventable\";\nimport * as domHelpers from \"../core/ui/utils/dom_helpers\";\n\nimport keyboard_shortcuts from \"./keyboard_navigation/common/keyboard_shortcuts\";\nimport eventhandler from \"./keyboard_navigation/common/eventhandler\";\nimport trap_modal_focus from \"./keyboard_navigation/common/trap_modal_focus\";\nimport gantt_node from \"./keyboard_navigation/elements/gantt_node\";\nimport nav_node from \"./keyboard_navigation/elements/nav_node\";\nimport header_cell from \"./keyboard_navigation/elements/header_cell\";\nimport task_row from \"./keyboard_navigation/elements/task_row\";\nimport task_cell from \"./keyboard_navigation/elements/task_cell\";\nimport modals from \"./keyboard_navigation/modals\";\nimport core from \"./keyboard_navigation/core\";\n\n\n\nexport default function(gantt){\n\tfunction setupKeyNav(gantt){\n\t\tgantt.config.keyboard_navigation = true;\n\t\tgantt.config.keyboard_navigation_cells = false;\n\n\t\tgantt.$keyboardNavigation = {};\n\n\t\tgantt._compose = function(){\n\t\t\tvar parts = Array.prototype.slice.call(arguments, 0);\n\t\t\tvar res = {};\n\t\t\tfor(var i = 0; i < parts.length; i++){\n\t\t\t\tvar obj = parts[i];\n\t\t\t\tif(typeof obj == \"function\"){\n\t\t\t\t\tobj = new obj();\n\t\t\t\t}\n\n\t\t\t\tfor(var p in obj){\n\t\t\t\t\tres[p] = obj[p];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\n\t\tkeyboard_shortcuts(gantt);\n\t\teventhandler(gantt);\n\t\ttrap_modal_focus(gantt);\n\t\tgantt_node(gantt);\n\t\tnav_node(gantt);\n\t\theader_cell(gantt);\n\t\ttask_row(gantt);\n\t\ttask_cell(gantt);\n\t\tmodals(gantt);\n\t\tcore(gantt);\n\n\n\t\t(function(){\n\t\t\tvar dispatcher = gantt.$keyboardNavigation.dispatcher;\n\n\t\t\tdispatcher.isTaskFocused = function(id){\n\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskRow || node instanceof gantt.$keyboardNavigation.TaskCell) {\n\t\t\t\t\tif (node.taskId == id) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tvar keyDownHandler = function(e){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return;\n\n\t\t\t\tif (isNoKeyboardNavigationElement(e) || isLightboxElement(e)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn dispatcher.keyDownHandler(e);\n\t\t\t};\n\n\t\t\tvar focusHandler = function(e){\n\t\t\t\tif(dispatcher.$preventDefault){\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tgantt.$container.blur();\n\t\t\t\t\treturn false;\n\t\t\t\t// do nothing if key-nav focus is already planned\n\t\t\t\t} else if (!dispatcher.awaitsFocus()) {\n\t\t\t\t\t// otherwise - re-focus key-nav element on gantt focus\n\t\t\t\t\tdispatcher.focusGlobalNode();\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tvar reFocusActiveNode = function(){\n\t\t\t\tif(!dispatcher.isEnabled())\n\t\t\t\t\treturn;\n\n\t\t\t\tconst outsideGantt = !domHelpers.isChildOf(document.activeElement, gantt.$container) && document.activeElement.localName != \"body\";\n\t\t\t\tvar activeNode = dispatcher.getActiveNode();\n\t\t\t\tif(!activeNode || outsideGantt)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar domElement = activeNode.getNode();\n\t\t\t\tvar top, left;\n\t\t\t\tif(domElement && domElement.parentNode){\n\t\t\t\t\ttop = domElement.parentNode.scrollTop;\n\t\t\t\t\tleft = domElement.parentNode.scrollLeft;\n\n\t\t\t\t}\n\n\t\t\t\tactiveNode.focus(true);\n\n\t\t\t\tif(domElement && domElement.parentNode){\n\t\t\t\t\tdomElement.parentNode.scrollTop = top;\n\t\t\t\t\tdomElement.parentNode.scrollLeft = left;\n\t\t\t\t}\n\t\t\t};\n\n\n\t\t\tgantt.attachEvent(\"onDataRender\", function(){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\treFocusActiveNode();\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\t\t\tif(!gantt.$root) return;\n\t\t\t\tgantt.eventRemove(gantt.$root, \"keydown\", keyDownHandler);\n\t\t\t\tgantt.eventRemove(gantt.$container, \"focus\", focusHandler);\n\t\t\t\tgantt.eventRemove(gantt.$container, \"mousedown\", mousedownHandler);\n\n\t\t\t\tif(gantt.config.keyboard_navigation){\n\n\t\t\t\t\tgantt.event(gantt.$root, \"keydown\", keyDownHandler);\n\t\t\t\t\tgantt.event(gantt.$container, \"focus\", focusHandler);\n\t\t\t\t\tgantt.event(gantt.$container, \"mousedown\", mousedownHandler);\n\t\t\t\t\tgantt.$container.setAttribute(\"tabindex\", \"0\");\n\n\t\t\t\t}else{\n\t\t\t\t\tgantt.$container.removeAttribute(\"tabindex\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction getTaskNodeConstructor(){\n\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskCell;\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskRow;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction isInlineEditorCell(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\");\n\t\t\t}\n\t\t\t// GS-1445. Cancel keyboard navigation within custom elements\n\t\t\tfunction isNoKeyboardNavigationElement(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".no_keyboard_navigation\");\n\t\t\t}\n\t\t\tfunction isLightboxElement(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_cal_light\");\n\t\t\t}\n\n\t\t\tfunction mousedownHandler(e){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return true;\n\n\t\t\t\tif (isNoKeyboardNavigationElement(e)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar focusNode;\n\t\t\t\tvar locateTask = dispatcher.fromDomElement(e);\n\t\t\t\tif(locateTask){\n\t\t\t\t\t//var node = getTaskNodeConstructor();\n\t\t\t\t\tif(dispatcher.activeNode instanceof gantt.$keyboardNavigation.TaskCell && domHelpers.isChildOf(e.target, gantt.$task)){\n\t\t\t\t\t\tlocateTask = new gantt.$keyboardNavigation.TaskCell(locateTask.taskId, dispatcher.activeNode.columnIndex);\n\t\t\t\t\t}\n\t\t\t\t\tfocusNode = locateTask;\n\t\t\t\t}\n\t\t\t\tif (focusNode) {\n\t\t\t\t\tif (!dispatcher.isEnabled()) {\n\t\t\t\t\t\tdispatcher.activeNode = focusNode;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatcher.delay(function () {\n\t\t\t\t\t\t\tdispatcher.setActiveNode(focusNode);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// empty click should drop focus from gantt, insert of reselecting default node\n\t\t\t\t\tdispatcher.$preventDefault = true;\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tdispatcher.$preventDefault = false;\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar onReady = gantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\t// restore focus on repainted tasks\n\t\t\t\tgantt.detachEvent(onReady);\n\n\t\t\t\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(id){\n\t\t\t\t\tif (gantt.config.keyboard_navigation && dispatcher.isEnabled()) {\n\t\t\t\t\t\tconst currentNode = dispatcher.getActiveNode();\n\t\t\t\t\t\tconst grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tconst top = grid.getItemTop(id);\n\t\t\t\t\t\tconst gridDataTopScroll = grid.$grid_data.scrollTop;\n\t\t\t\t\t\tconst gridDataBottomScroll = gridDataTopScroll + grid.$grid_data.getBoundingClientRect().height;\n\t\t\t\t\t\tif(currentNode && currentNode.taskId == id){\n\t\t\t\t\t\t\t// GS-2539:  Don't refocus the node if it is selected and outside the visible range in the grid\n\t\t\t\t\t\t\tif(gridDataTopScroll <= top && gridDataBottomScroll >= top){\n\t\t\t\t\t\t\t\treFocusActiveNode();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(gantt._smart_render){\n\t\t\t\t\tvar updateRender = gantt._smart_render._redrawTasks;\n\t\t\t\t\tgantt._smart_render._redrawTasks = function(renderers, items){\n\t\t\t\t\t\tif(gantt.config.keyboard_navigation && dispatcher.isEnabled()){\n\t\t\t\t\t\t\tvar currentNode = dispatcher.getActiveNode();\n\t\t\t\t\t\t\tif(currentNode && currentNode.taskId !== undefined){\n\t\t\t\t\t\t\t\tvar focusedItemVisible = false;\n\t\t\t\t\t\t\t\tfor(var i = 0; i < items.length; i++){\n\t\t\t\t\t\t\t\t\tif(items[i].id == currentNode.taskId && items[i].start_date){\n\t\t\t\t\t\t\t\t\t\tfocusedItemVisible = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(!focusedItemVisible){\n\t\t\t\t\t\t\t\t\titems.push(gantt.getTask(currentNode.taskId));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar res = updateRender.apply(this, arguments);\n\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\tlet createdTaskId = null;\n\t\t\tlet keepFocusOnNewTask = false;\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (task) {\n\t\t\t\tcreatedTaskId = task.id;\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function(id,item){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\t\t\t\tif(dispatcher.isEnabled()){\n\n\t\t\t\t\t// GS-1394. After adding a new task, the focus shouldn't change to the placeholder task\n\t\t\t\t\tif (id == createdTaskId) {\n\t\t\t\t\t\tkeepFocusOnNewTask = true;\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tkeepFocusOnNewTask = false;\n\t\t\t\t\t\t\tcreatedTaskId = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (keepFocusOnNewTask && item.type == gantt.config.types.placeholder) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar columnIndex = 0;\n\t\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskCell){\n\t\t\t\t\t\tcolumnIndex = node.columnIndex;\n\t\t\t\t\t}\n\t\t\t\t\tvar nodeConstructor = getTaskNodeConstructor();\n\n\t\t\t\t\tif (item.type == gantt.config.types.placeholder && gantt.config.placeholder_task.focusOnCreate === false) {\n\t\t\t\t\t\t// do not focus on the placeholder task\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatcher.setActiveNode(new nodeConstructor(id, columnIndex));\n\t\t\t\t\t}\n\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function(oldId, newId){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\n\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\tif(dispatcher.isTaskFocused(oldId)){\n\t\t\t\t\tnode.taskId = newId;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tvar interval = setInterval(function(){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\tif(!dispatcher.isEnabled()){\n\t\t\t\t\tdispatcher.enable();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}, 500);\n\n\t\t\tgantt.attachEvent(\"onDestroy\", function(){\n\t\t\t\tclearInterval(interval);\n\t\t\t});\n\n\t\t\tfunction getScopeName(obj){\n\t\t\t\tif(obj instanceof gantt.$keyboardNavigation.GanttNode){\n\t\t\t\t\treturn \"gantt\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.HeaderCell){\n\t\t\t\t\treturn \"headerCell\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskRow){\n\t\t\t\t\treturn \"taskRow\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskCell){\n\t\t\t\t\treturn \"taskCell\";\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfunction getScope(mode){\n\t\t\t\tvar scopes = {\n\t\t\t\t\t\"gantt\":gantt.$keyboardNavigation.GanttNode,\n\t\t\t\t\t\"headerCell\": gantt.$keyboardNavigation.HeaderCell,\n\t\t\t\t\t\"taskRow\": gantt.$keyboardNavigation.TaskRow,\n\t\t\t\t\t\"taskCell\": gantt.$keyboardNavigation.TaskCell\n\t\t\t\t};\n\n\t\t\t\treturn scopes[mode] || scopes.gantt;\n\t\t\t}\n\n\t\t\tfunction findVisibleColumnIndex(columnName) {\n\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\tfor (var i = 0; i < columns.length; i++){\n\t\t\t\t\tif(columns[i].name == columnName){\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tvar keyNavFacade = {};\n\t\t\teventable(keyNavFacade);\n\t\t\tgantt.mixin(keyNavFacade, {\n\t\t\t\taddShortcut: function(shortcut, handler, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tscopeObject.prototype.bind(shortcut, handler);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetShortcutHandler: function(shortcut, scope){\n\t\t\t\t\tvar commands = gantt.$keyboardNavigation.shortcuts.parse(shortcut);\n\t\t\t\t\tif(commands.length){\n\t\t\t\t\t\treturn keyNavFacade.getCommandHandler(commands[0], scope);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetCommandHandler: function(command, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tif(command){\n\t\t\t\t\t\t\treturn scopeObject.prototype.findHandler(command);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveShortcut: function(shortcut, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tscopeObject.prototype.unbind(shortcut);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfocus: function(config){\n\t\t\t\t\tvar type = config ? config.type : null;\n\t\t\t\t\tvar constructor = getScope(type);\n\t\t\t\t\tvar node;\n\t\t\t\t\tswitch (type){\n\t\t\t\t\t\tcase \"taskCell\":\n\t\t\t\t\t\t\tnode = new constructor(config.id, findVisibleColumnIndex(config.column));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"taskRow\":\n\t\t\t\t\t\t\tnode = new constructor(config.id);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"headerCell\":\n\t\t\t\t\t\t\tnode = new constructor(findVisibleColumnIndex(config.column));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tdispatcher.delay(function(){\n\t\t\t\t\t\tif(node){\n\t\t\t\t\t\t\tdispatcher.setActiveNode(node);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\t\t\tif(!dispatcher.getActiveNode()){\n\n\t\t\t\t\t\t\t\tdispatcher.setDefaultNode();\n\t\t\t\t\t\t\t}else{\n\n\t\t\t\t\t\t\t\tif(!dispatcher.awaitsFocus()){\n\t\t\t\t\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tgetActiveNode: function(){\n\t\t\t\t\tif(dispatcher.isEnabled()){\n\t\t\t\t\t\tvar node = dispatcher.getActiveNode();\n\t\t\t\t\t\tvar scope = getScopeName(node);\n\t\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\t\tswitch (scope){\n\t\t\t\t\t\t\tcase \"taskCell\":\n\t\t\t\t\t\t\t\treturn {type:\"taskCell\", id:node.taskId, column:columns[node.columnIndex].name};\n\t\t\t\t\t\t\tcase \"taskRow\":\n\t\t\t\t\t\t\t\treturn {type:\"taskRow\", id:node.taskId};\n\t\t\t\t\t\t\tcase \"headerCell\":\n\t\t\t\t\t\t\t\treturn {type:\"headerCell\", column:columns[node.index].name};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.$keyboardNavigation.facade = keyNavFacade;\n\n\t\t\tgantt.ext.keyboardNavigation = keyNavFacade;\n\t\t\tgantt.focus = function(){\n\t\t\t\tkeyNavFacade.focus();\n\t\t\t};\n\t\t\tgantt.addShortcut = keyNavFacade.addShortcut;\n\t\t\tgantt.getShortcutHandler = keyNavFacade.getShortcutHandler;\n\t\t\tgantt.removeShortcut = keyNavFacade.removeShortcut;\n\t\t})();\n\n\n\t}\n\n\tsetupKeyNav(gantt);\n\n\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.shortcuts = {\n\t\tcreateCommand: function () {\n\t\t\treturn {\n\t\t\t\tmodifiers: {\n\t\t\t\t\t\"shift\": false,\n\t\t\t\t\t\"alt\": false,\n\t\t\t\t\t\"ctrl\": false,\n\t\t\t\t\t\"meta\": false\n\t\t\t\t},\n\t\t\t\tkeyCode: null\n\t\t\t};\n\t\t},\n\t\tparse: function (shortcut) {\n\t\t\tvar commands = [];\n\n\t\t\tvar expr = this.getExpressions(this.trim(shortcut));\n\t\t\tfor (var i = 0; i < expr.length; i++) {\n\t\t\t\tvar words = this.getWords(expr[i]);\n\n\t\t\t\tvar command = this.createCommand();\n\n\t\t\t\tfor (var j = 0; j < words.length; j++) {\n\t\t\t\t\tif (this.commandKeys[words[j]]) {\n\t\t\t\t\t\tcommand.modifiers[words[j]] = true;\n\t\t\t\t\t} else if (this.specialKeys[words[j]]) {\n\t\t\t\t\t\tcommand.keyCode = this.specialKeys[words[j]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcommand.keyCode = words[j].charCodeAt(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcommands.push(command);\n\t\t\t}\n\t\t\treturn commands;\n\t\t},\n\n\t\tgetCommandFromEvent: function (domEvent) {\n\t\t\tvar command = this.createCommand();\n\t\t\tcommand.modifiers.shift = !!domEvent.shiftKey;\n\t\t\tcommand.modifiers.alt = !!domEvent.altKey;\n\t\t\tcommand.modifiers.ctrl = !!domEvent.ctrlKey;\n\t\t\tcommand.modifiers.meta = !!domEvent.metaKey;\n\t\t\tcommand.keyCode = domEvent.which || domEvent.keyCode;\n\n\t\t\tif(command.keyCode >= 96 && command.keyCode <= 105){\n\t\t\t\t// numpad keys 96-105 -> 48-57\n\t\t\t\tcommand.keyCode -= 48;//convert numpad  number code to regular number code\n\t\t\t}\n\n\t\t\tvar printableKey = String.fromCharCode(command.keyCode);\n\t\t\tif (printableKey) {\n\t\t\t\tcommand.keyCode = printableKey.toLowerCase().charCodeAt(0);\n\t\t\t}\n\t\t\treturn command;\n\t\t},\n\n\t\tgetHashFromEvent: function (domEvent) {\n\t\t\treturn this.getHash(this.getCommandFromEvent(domEvent));\n\t\t},\n\n\t\tgetHash: function (command) {\n\t\t\tvar parts = [];\n\t\t\tfor (var i in command.modifiers) {\n\t\t\t\tif (command.modifiers[i]) {\n\t\t\t\t\tparts.push(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tparts.push(command.keyCode);\n\n\t\t\treturn parts.join(this.junctionChar);\n\t\t},\n\n\t\tgetExpressions: function (shortcut) {\n\t\t\treturn shortcut.split(this.junctionChar);\n\t\t},\n\t\tgetWords: function (term) {\n\t\t\treturn term.split(this.combinationChar);\n\t\t},\n\t\ttrim: function (shortcut) {\n\t\t\treturn shortcut.replace(/\\s/g, \"\");\n\t\t},\n\t\tjunctionChar: \",\",\n\t\tcombinationChar: \"+\",\n\t\tcommandKeys: {\n\t\t\t\"shift\": 16,\n\t\t\t\"alt\": 18,\n\t\t\t\"ctrl\": 17,\n\t\t\t\"meta\": true\n\t\t},\n\t\tspecialKeys: {\n\t\t\t\"backspace\": 8,\n\t\t\t\"tab\": 9,\n\t\t\t\"enter\": 13,\n\t\t\t\"esc\": 27,\n\t\t\t\"space\": 32,\n\t\t\t\"up\": 38,\n\t\t\t\"down\": 40,\n\t\t\t\"left\": 37,\n\t\t\t\"right\": 39,\n\t\t\t\"home\": 36,\n\t\t\t\"end\": 35,\n\t\t\t\"pageup\": 33,\n\t\t\t\"pagedown\": 34,\n\t\t\t\"delete\": 46,\n\t\t\t\"insert\": 45,\n\t\t\t\"plus\": 107,\n\t\t\t\"f1\": 112,\n\t\t\t\"f2\": 113,\n\t\t\t\"f3\": 114,\n\t\t\t\"f4\": 115,\n\t\t\t\"f5\": 116,\n\t\t\t\"f6\": 117,\n\t\t\t\"f7\": 118,\n\t\t\t\"f8\": 119,\n\t\t\t\"f9\": 120,\n\t\t\t\"f10\": 121,\n\t\t\t\"f11\": 122,\n\t\t\t\"f12\": 123\n\t\t}\n\t};\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.EventHandler = {\n\t\t_handlers: null,\n\t\tfindHandler: function (command) {\n\t\t\tif (!this._handlers) this._handlers = {};\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\t\t\tvar hash = shortcuts.getHash(command);\n\n\t\t\treturn this._handlers[hash];\n\t\t},\n\n\t\tdoAction: function (command, e) {\n\t\t\tvar handler = this.findHandler(command);\n\t\t\tif (handler) {\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeAction\", [command, e]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandler.call(this, e);\n\n\t\t\t\tif (e.preventDefault) e.preventDefault();\n\t\t\t\telse e.returnValue = false;\n\n\t\t\t}\n\t\t},\n\t\tbind: function (shortcut, handler) {\n\t\t\tif (!this._handlers) this._handlers = {};\n\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\n\t\t\tvar commands = shortcuts.parse(shortcut);\n\t\t\tfor (var i = 0; i < commands.length; i++) {\n\t\t\t\tthis._handlers[shortcuts.getHash(commands[i])] = handler;\n\t\t\t}\n\t\t},\n\t\tunbind: function (shortcut) {\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\n\t\t\tvar commands = shortcuts.parse(shortcut);\n\t\t\tfor (var i = 0; i < commands.length; i++) {\n\t\t\t\tif (this._handlers[shortcuts.getHash(commands[i])]) {\n\t\t\t\t\tdelete this._handlers[shortcuts.getHash(commands[i])];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tbindAll: function (map) {\n\t\t\tfor (var i in map) {\n\t\t\t\tthis.bind(i, map[i]);\n\t\t\t}\n\t\t},\n\t\tinitKeys: function () {\n\t\t\tif (!this._handlers)\n\t\t\t\tthis._handlers = {};\n\t\t\tif (this.keys) {\n\t\t\t\tthis.bindAll(this.keys);\n\t\t\t}\n\t\t}\n\t};\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\t(function () {\n\t\t\n\t\tgantt.$keyboardNavigation.getFocusableNodes = domHelpers.getFocusableNodes;\n\n\t\tgantt.$keyboardNavigation.trapFocus = function trapFocus(root, e) {\n\t\t\tif (e.keyCode != 9) return false;\n\n\t\t\tvar focusable = gantt.$keyboardNavigation.getFocusableNodes(root);\n\t\t\tvar currentFocus = domHelpers.getActiveElement();\n\t\t\tvar currentIndex = -1;\n\t\t\tfor (var i = 0; i < focusable.length; i++) {\n\t\t\t\tif (focusable[i] == currentFocus) {\n\t\t\t\t\tcurrentIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (e.shiftKey) {\n\t\t\t\t// back tab\n\t\t\t\tif (currentIndex <= 0) {\n\t\t\t\t\t// go to the last element if we focused on the first\n\t\t\t\t\tvar lastItem = focusable[focusable.length - 1];\n\t\t\t\t\tif (lastItem) {\n\t\t\t\t\t\tlastItem.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// forward tab\n\t\t\t\tif (currentIndex >= focusable.length - 1) {\n\t\t\t\t\t// forward tab from last element should go back to the first element\n\t\t\t\t\tvar firstItem = focusable[0];\n\t\t\t\t\tif (firstItem) {\n\t\t\t\t\t\tfirstItem.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t})();\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.GanttNode = function () {\n\t};\n\n\tgantt.$keyboardNavigation.GanttNode.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.EventHandler,\n\t\t{\n\n\t\t\tfocus: function () {\n\t\t\t\tgantt.focus();\n\t\t\t},\n\n\t\t\tblur: function () {\n\n\t\t\t},\n\n\t\t\tisEnabled: function () {\n\t\t\t\treturn gantt.$container.hasAttribute(\"tabindex\");\n\t\t\t},\n\n\t\t\tscrollHorizontal: function scrollHorizontal(dir) {\n\t\t\t\tvar date = gantt.dateFromPos(gantt.getScrollState().x);\n\t\t\t\tvar scale = gantt.getScale();\n\t\t\t\tvar step = dir < 0 ? -scale.step : scale.step;\n\t\t\t\tdate = gantt.date.add(date, step, scale.unit);\n\t\t\t\tgantt.scrollTo(gantt.posFromDate(date));\n\t\t\t},\n\n\t\t\tscrollVertical: function scrollVertical(dir) {\n\t\t\t\tvar top = gantt.getScrollState().y;\n\t\t\t\tvar step = gantt.config.row_height;\n\t\t\t\tgantt.scrollTo(null, top + (dir < 0 ? -1 : 1) * step);\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"alt+left\": function (e) {\n\t\t\t\t\tthis.scrollHorizontal(-1);\n\t\t\t\t},\n\t\t\t\t\"alt+right\": function (e) {\n\t\t\t\t\tthis.scrollHorizontal(1);\n\t\t\t\t},\n\t\t\t\t\"alt+up\": function (e) {\n\t\t\t\t\tthis.scrollVertical(-1);\n\t\t\t\t},\n\t\t\t\t\"alt+down\": function (e) {\n\t\t\t\t\tthis.scrollVertical(1);\n\t\t\t\t},\n\n\t\t\t\t// undo\n\t\t\t\t\"ctrl+z\": function () {\n\t\t\t\t\tif (gantt.undo) gantt.undo();\n\t\t\t\t},\n\n\t\t\t\t// redo\n\t\t\t\t\"ctrl+r\": function () {\n\t\t\t\t\tif (gantt.redo) gantt.redo();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\tgantt.$keyboardNavigation.GanttNode.prototype.bindAll(gantt.$keyboardNavigation.GanttNode.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.KeyNavNode = function () {\n\t};\n\n\tgantt.$keyboardNavigation.KeyNavNode.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.EventHandler,\n\t\t{\n\t\t\tisValid: function () {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tmoveTo: function (element) {\n\t\t\t\tgantt.$keyboardNavigation.dispatcher.setActiveNode(element);\n\t\t\t},\n\n\t\t\tcompareTo: function (b) {\n\t\t\t\t// good enough comparison of two random objects\n\t\t\t\tif (!b) return false;\n\t\t\t\tfor (var i in this) {\n\t\t\t\t\tif (!!this[i] != !!b[i]) return false;\n\n\t\t\t\t\tvar canStringifyThis = !!(this[i] && this[i].toString);\n\t\t\t\t\tvar canStringifyThat = !!(b[i] && b[i].toString);\n\t\t\t\t\tif (canStringifyThat != canStringifyThis) return false;\n\t\t\t\t\tif (!(canStringifyThat && canStringifyThis)) {\n\t\t\t\t\t\tif (b[i] != this[i]) return false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (b[i].toString() != this[i].toString())\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t},\n\t\t\tfocus: function () {\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif(!node)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeFocus\", [node]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t\tif(!node.$eventAttached){\n\t\t\t\t\t\tnode.$eventAttached = true;\n\t\t\t\t\t\tgantt.event(node, \"focus\",function(e){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t}\n\t\t\t\t\t//node.className += \" gantt_focused\";\n\t\t\t\t\tif (gantt.utils.dom.isChildOf(document.activeElement, node)){\n\t\t\t\t\t\tnode = document.activeElement;\n\t\t\t\t\t}\n\t\t\t\t\tif (node.focus) node.focus();\n\n\t\t\t\t\teventFacade.callEvent(\"onFocus\", [this.getNode()]);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tblur: function () {\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif (node) {\n\t\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\t\t\t\t\teventFacade.callEvent(\"onBlur\", [node]);\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t\t//node.className = (node.className || \"\").replace(/ ?gantt_focused/g, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\tgantt.$keyboardNavigation.HeaderCell = function (index) {\n\t\tthis.index = index || 0;\n\t};\n\n\tgantt.$keyboardNavigation.HeaderCell.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.KeyNavNode,\n\t\t{\n\t\t\t_handlers: null,\n\n\t\t\tisValid: function () {\n\t\t\t\tif (!gantt.config.show_grid) {\n\t\t\t\t\tif (gantt.getVisibleTaskCount())\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn !!gantt.getGridColumns()[this.index] || !gantt.getVisibleTaskCount();\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\tif (!gantt.config.show_grid) {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow();\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tvar visibleColumns = gantt.getGridColumns();\n\t\t\t\tvar index = this.index;\n\t\t\t\twhile (index >= 0) {\n\t\t\t\t\tif (visibleColumns[index])\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\tif (visibleColumns[index]) {\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tvar cellElement = domHelpers.locateClassName(el, \"gantt_grid_head_cell\");\n\t\t\t\tif(cellElement){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\twhile(cellElement && cellElement.previousSibling){\n\t\t\t\t\t\tcellElement = cellElement.previousSibling;\n\t\t\t\t\t\tindex += 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tvar cells = gantt.$grid_scale.childNodes;\n\t\t\t\treturn cells[this.index];\n\t\t\t},\n\n\n\t\t\tkeys: {\n\n\t\t\t\t\"left\": function () {\n\t\t\t\t\tif (this.index > 0) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index - 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"right\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tif (this.index < columns.length - 1) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index + 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar taskRow;\n\t\t\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\t\t\tif (gantt.isTaskExists(rootLevel[0])) {\n\t\t\t\t\t\ttaskRow = rootLevel[0];\n\t\t\t\t\t}\n\t\t\t\t\tif (taskRow) {\n\t\t\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(taskRow, this.index));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(taskRow));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"end\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(columns.length - 1));\n\t\t\t\t},\n\t\t\t\t\"home\": function () {\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(0));\n\t\t\t\t},\n\n\n\t\t\t\t// press header button\n\t\t\t\t\"enter, space\": function () {\n\t\t\t\t\tvar node = domHelpers.getActiveElement();\n\t\t\t\t\tnode.click();\n\t\t\t\t},\n\n\t\t\t\t// add new task\n\t\t\t\t\"ctrl+enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.createTask({}, this.taskId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\tgantt.$keyboardNavigation.HeaderCell.prototype.bindAll(gantt.$keyboardNavigation.HeaderCell.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.TaskRow = function (taskId) {\n\t\tif (!taskId) {\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\tif (rootLevel[0]) {\n\t\t\t\ttaskId = rootLevel[0];\n\t\t\t}\n\t\t}\n\t\tthis.taskId = taskId;\n\t\tif (gantt.isTaskExists(this.taskId)) {\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\n\t\t\tthis.splitItem = !!gantt.getTask(this.taskId).$split_subtask;\n\t\t\tthis.parentId = gantt.getParent(this.taskId);\n\t\t}\n\t};\n\n\tgantt.$keyboardNavigation.TaskRow.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.KeyNavNode,\n\t\t{\n\t\t\t_handlers: null,\n\t\t\tisValid: function () {\n\t\t\t\treturn gantt.isTaskExists(this.taskId) && (gantt.getTaskIndex(this.taskId) > -1);\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\tif (!gantt.getVisibleTaskCount()) {\n\t\t\t\t\tvar header = new gantt.$keyboardNavigation.HeaderCell();\n\t\t\t\t\tif (!header.isValid()) return null;\n\t\t\t\t\telse return header;\n\t\t\t\t} else {\n\n\t\t\t\t\tif(!this.splitItem){\n\t\t\t\t\t\tvar nextIndex = -1;\n\t\t\t\t\t\t// GS-1393. When Gantt tries to restore the focus, it should rely on the global index\n\t\t\t\t\t\tif (gantt.getTaskByIndex(this.globalIndex - 1)) {\n\t\t\t\t\t\t\tnextIndex = this.globalIndex - 1;\n\t\t\t\t\t\t} else if (gantt.getTaskByIndex(this.globalIndex + 1)) {\n\t\t\t\t\t\t\tnextIndex = this.globalIndex + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar globalIndex = this.globalIndex;\n\t\t\t\t\t\t\twhile (globalIndex >= 0) {\n\t\t\t\t\t\t\t\tif (gantt.getTaskByIndex(globalIndex)) {\n\t\t\t\t\t\t\t\t\tnextIndex = globalIndex;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tglobalIndex--;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nextIndex > -1) {\n\t\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(nextIndex).id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(this.parentId);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tif(gantt.config.keyboard_navigation_cells){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar taskId = gantt.locate(el);\n\t\t\t\tif(gantt.isTaskExists(taskId)){\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(taskId);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && gantt.isTaskVisible(this.taskId)) {\n\t\t\t\t\tif (gantt.config.show_grid) {\n\t\t\t\t\t\treturn gantt.$grid.querySelector(\".gantt_row[\" + gantt.config.task_attribute + \"='\" + this.taskId + \"']\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfocus: function (keptFocus) {\n\t\t\t\tif(!keptFocus) {\n\t\t\t\t\tconst pos = gantt.getTaskPosition(gantt.getTask(this.taskId));\n\t\t\t\t\tconst height = gantt.getTaskHeight(this.taskId);\n\t\t\t\t\tconst scroll = gantt.getScrollState();\n\n\t\t\t\t\tlet viewWidth;\n\t\t\t\t\tif(gantt.$task){\n\t\t\t\t\t\tviewWidth = gantt.$task.offsetWidth;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tviewWidth = scroll.inner_width;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet viewHeight;\n\t\t\t\t\tif(gantt.$grid_data || gantt.$task_data){\n\t\t\t\t\t\tviewHeight = (gantt.$grid_data || gantt.$task_data).offsetHeight;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tviewHeight = scroll.inner_height;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (pos.top < scroll.y || pos.top + height > (scroll.y + viewHeight)) {\n\t\t\t\t\t\t// GS-2346: additional scrolling to be sure that the task will be in the required range\n\t\t\t\t\t\tgantt.scrollTo(null, pos.top - 20);\n\t\t\t\t\t} else if (gantt.config.scroll_on_click && gantt.config.show_chart) {\n\t\t\t\t\t\t// horizontal scroll activated\n\t\t\t\t\t\tif (pos.left > (scroll.x + viewWidth)) { // scroll forward to the start of the task\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left - gantt.config.task_scroll_offset);\n\t\t\t\t\t\t} else if (pos.left + pos.width < scroll.x) {  // scroll back to the end of the task\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left + pos.width - gantt.config.task_scroll_offset);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgantt.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this, [keptFocus]);\n\n\t\t\t\t// GS-152 if there are scrollbars with custom names, change their scroll position\n\t\t\t\tscrollGrid();\n\n\t\t\t\tfunction scrollGrid() {\n\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\tvar scrollPositionX = parseInt(grid.$grid.scrollLeft);\n\t\t\t\t\tvar scrollPositionY = parseInt(grid.$grid_data.scrollTop);\n\n\t\t\t\t\tvar attachedScrollbarHorizontal = grid.$config.scrollX;\n\n\t\t\t\t\tif (attachedScrollbarHorizontal && grid.$config.scrollable) {\n\t\t\t\t\t\tvar scrollbarHorizontal = gantt.$ui.getView(attachedScrollbarHorizontal);\n\t\t\t\t\t\tif (scrollbarHorizontal) {\n\t\t\t\t\t\t\tscrollbarHorizontal.scrollTo(scrollPositionX, scrollPositionY);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar attachedScrollbarVertical = grid.$config.scrollY;\n\n\t\t\t\t\tif (attachedScrollbarVertical) {\n\t\t\t\t\t\tvar scrollbarVertical = gantt.$ui.getView(attachedScrollbarVertical);\n\t\t\t\t\t\tif (scrollbarVertical) {\n\t\t\t\t\t\t\tscrollbarVertical.scrollTo(scrollPositionX, scrollPositionY);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"pagedown\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"pageup\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(0).id));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"up\": function () {\n\t\t\t\t\tvar nextElement = null;\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskRow(prevTask);\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(nextElement);\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(nextTask));\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"shift+down\": function(){\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && !gantt.getTask(this.taskId).$open){\n\t\t\t\t\t\tgantt.open(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+up\": function(){\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && gantt.getTask(this.taskId).$open){\n\t\t\t\t\t\tgantt.close(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+right\": function() {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar prevId = gantt.getPrevSibling(this.taskId);\n\t\t\t\t\tif(gantt.isTaskExists(prevId) && !gantt.isChildOf(this.taskId, prevId)){\n\t\t\t\t\t\tvar parent = gantt.getTask(prevId);\n\t\t\t\t\t\tparent.$open = true;\n\t\t\t\t\t\tvar result = gantt.moveTask(this.taskId, -1, prevId);\n\t\t\t\t\t\tif(result !== false)\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+left\": function() {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar parent = gantt.getParent(this.taskId);\n\t\t\t\t\tif(gantt.isTaskExists(parent)){\n\t\t\t\t\t\tvar result =  gantt.moveTask(this.taskId, gantt.getTaskIndex(parent) + 1, gantt.getParent(parent));\n\t\t\t\t\t\tif(result !== false)\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// select\n\t\t\t\t\"space\": function (e) {\n\t\t\t\t\tif (!gantt.isSelectedTask(this.taskId)) {\n\t\t\t\t\t\tgantt.selectTask(this.taskId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt.unselectTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// collapse\n\t\t\t\t\"ctrl+left\": function (e) {\n\t\t\t\t\tgantt.close(this.taskId);\n\t\t\t\t},\n\t\t\t\t// expand\n\t\t\t\t\"ctrl+right\": function (e) {\n\t\t\t\t\tgantt.open(this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// delete task\n\t\t\t\t\"delete\": function (e) {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.$click.buttons[\"delete\"](this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// open lightbox\n\t\t\t\t\"enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.showLightbox(this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// add subtask\n\t\t\t\t\"ctrl+enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.createTask({}, this.taskId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\tgantt.$keyboardNavigation.TaskRow.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\nimport {replaceValidZeroId} from \"../../../utils/helpers\";\n\nexport default function(gantt) {\n\n\n\tgantt.$keyboardNavigation.TaskCell = function (taskId, index) {\n\t\ttaskId = replaceValidZeroId(taskId, gantt.config.root_id);\n\t\tif (!taskId) {\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\tif (rootLevel[0]) {\n\t\t\t\ttaskId = rootLevel[0];\n\t\t\t}\n\t\t}\n\t\tthis.taskId = taskId;\n\t\tthis.columnIndex = index || 0;\n\t\t// provided task may not exist, in this case node will be detectes as invalid\n\t\tif (gantt.isTaskExists(this.taskId)) {\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\n\t\t}\n\t};\n\n\tgantt.$keyboardNavigation.TaskCell.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.TaskRow,\n\t\t{\n\t\t\t_handlers: null,\n\t\t\tisValid: function () {\n\n\t\t\t\treturn gantt.$keyboardNavigation.TaskRow.prototype.isValid.call(this) && !!gantt.getGridColumns()[this.columnIndex];\n\t\t\t},\n\t\t\tfallback: function () {\n\n\t\t\t\tvar node = gantt.$keyboardNavigation.TaskRow.prototype.fallback.call(this);\n\t\t\t\tvar result = node;\n\t\t\t\tif (node instanceof gantt.$keyboardNavigation.TaskRow) {\n\t\t\t\t\tvar visibleColumns = gantt.getGridColumns();\n\t\t\t\t\tvar index = this.columnIndex;\n\t\t\t\t\twhile (index >= 0) {\n\t\t\t\t\t\tif (visibleColumns[index])\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tindex--;\n\t\t\t\t\t}\n\t\t\t\t\tif (visibleColumns[index]) {\n\t\t\t\t\t\tresult = new gantt.$keyboardNavigation.TaskCell(node.taskId, index);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar taskId = gantt.locate(el);\n\t\t\t\tif(gantt.isTaskExists(taskId)){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tvar cellElement = domHelpers.locateAttribute(el, \"data-column-index\");\n\n\t\t\t\t\tif(cellElement){\n\t\t\t\t\t\tindex = cellElement.getAttribute(\"data-column-index\")*1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskCell(taskId, index);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && gantt.isTaskVisible(this.taskId)) {\n\t\t\t\t\tif (gantt.config.show_grid) {\n\t\t\t\t\t\tvar row = gantt.$grid.querySelector(\".gantt_row[\" + gantt.config.task_attribute + \"='\" + this.taskId + \"']\");\n\t\t\t\t\t\tif(!row)\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\treturn row.querySelector(\"[data-column-index='\"+this.columnIndex+\"']\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"up\": function () {\n\n\t\t\t\t\tvar nextElement = null;\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell(this.columnIndex);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskCell(prevTask, this.columnIndex);\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(nextElement);\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(nextTask, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"left\": function () {\n\t\t\t\t\tif (this.columnIndex > 0) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex - 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"right\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tif (this.columnIndex < columns.length - 1) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex + 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"end\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, columns.length - 1));\n\t\t\t\t},\n\t\t\t\t\"home\": function () {\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, 0));\n\t\t\t\t},\n\t\t\t\t\"pagedown\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"pageup\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(0).id, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskCell.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.dispatcher = {\n\t\tisActive: false,\n\t\tactiveNode: null,\n\t\tglobalNode: new gantt.$keyboardNavigation.GanttNode(),\n\n\t\tenable: function () {\n\t\t\tthis.isActive = true;\n\t\t\tthis.setActiveNode(this.getActiveNode());\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.isActive = false;\n\t\t},\n\n\t\tisEnabled: function () {\n\t\t\treturn !!this.isActive;\n\t\t},\n\n\t\tgetDefaultNode: function () {\n\t\t\tvar node;\n\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskCell();\n\t\t\t} else {\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskRow();\n\t\t\t}\n\n\t\t\tif (!node.isValid()) {\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\tsetDefaultNode: function () {\n\t\t\tthis.setActiveNode(this.getDefaultNode());\n\t\t},\n\n\t\tgetActiveNode: function () {\n\t\t\tvar node = this.activeNode;\n\t\t\tif (node && !node.isValid()) {\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\tfromDomElement: function(e){\n\t\t\tvar inputs = [\n\t\t\t\tgantt.$keyboardNavigation.TaskRow,\n\t\t\t\tgantt.$keyboardNavigation.TaskCell,\n\t\t\t\tgantt.$keyboardNavigation.HeaderCell\n\t\t\t];\n\t\t\tfor(var i = 0; i < inputs.length; i++){\n\t\t\t\tif(inputs[i].prototype.fromDomElement){\n\t\t\t\t\tvar node = inputs[i].prototype.fromDomElement(e);\n\t\t\t\t\tif(node) return node;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tfocusGlobalNode: function () {\n\t\t\tthis.blurNode(this.globalNode);\n\t\t\tthis.focusNode(this.globalNode);\n\t\t},\n\n\t\tsetActiveNode: function (el) {\n\t\t\t//console.trace()\n\t\t\tvar focusChanged = true;\n\t\t\tif (this.activeNode) {\n\t\t\t\tif (this.activeNode.compareTo(el)) {\n\t\t\t\t\tfocusChanged = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isEnabled()) {\n\t\t\t\tif(focusChanged)\n\t\t\t\t\tthis.blurNode(this.activeNode);\n\n\t\t\t\tthis.activeNode = el;\n\t\t\t\tthis.focusNode(this.activeNode, !focusChanged);\n\t\t\t}\n\t\t},\n\n\t\tfocusNode: function (el, keptFocus) {\n\t\t\tif (el && el.focus) {\n\t\t\t\tel.focus(keptFocus);\n\t\t\t}\n\t\t},\n\t\tblurNode: function (el) {\n\t\t\tif (el && el.blur) {\n\t\t\t\tel.blur();\n\t\t\t}\n\t\t},\n\n\t\tkeyDownHandler: function (e) {\n\n\t\t\tif (gantt.$keyboardNavigation.isModal())\n\t\t\t\treturn;\n\n\t\t\tif (!this.isEnabled())\n\t\t\t\treturn;\n\n\t\t\tif(e.defaultPrevented){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar ganttNode = this.globalNode;\n\n\t\t\tvar command = gantt.$keyboardNavigation.shortcuts.getCommandFromEvent(e);\n\n\t\t\tvar activeElement = this.getActiveNode();\n\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\t\t\tif(eventFacade.callEvent(\"onKeyDown\", [command, e]) === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeElement) {\n\t\t\t\tthis.setDefaultNode();\n\t\t\t} else if (activeElement.findHandler(command)) {\n\t\t\t\tactiveElement.doAction(command, e);\n\t\t\t} else if (ganttNode.findHandler(command)) {\n\t\t\t\tganttNode.doAction(command, e);\n\t\t\t}\n\n\t\t},\n\t\t_timeout: null,\n\t\tawaitsFocus: function(){\n\t\t\treturn this._timeout !== null;\n\t\t},\n\t\tdelay: function(callback, delay){\n\n\t\t\tclearTimeout(this._timeout);\n\t\t\tthis._timeout = setTimeout(gantt.bind(function(){\n\t\t\t\tthis._timeout = null;\n\t\t\t\tcallback();\n\t\t\t}, this)  , delay || 1);\n\n\t\t},\n\t\tclearDelay: function(){\n\t\t\tclearTimeout(this._timeout);\n\t\t}\n\t};\n\n};","import { QuickInfo } from \"./quickInfo\";\n\nexport default function(gantt: any){\n\nif (!gantt.ext) {\n\tgantt.ext = {};\n}\ngantt.ext.quickInfo = new QuickInfo(gantt);\n\ngantt.config.quickinfo_buttons = [\"icon_edit\", \"icon_delete\"];\ngantt.config.quick_info_detached = true;\ngantt.config.show_quick_info = true;\n\ngantt.templates.quick_info_title = function(start, end, ev){ return ev.text.substr(0,50); };\ngantt.templates.quick_info_content = function(start, end, ev){ return ev.details || ev.text; };\ngantt.templates.quick_info_date = function(start, end, ev){\n\treturn gantt.templates.task_time(start, end, ev);\n};\ngantt.templates.quick_info_class = function(start, end, task){ return \"\"; };\n\ngantt.attachEvent(\"onTaskClick\", function(id,e){\n\t// GS-1460 Don't show Quick Info when clicking on the \"+\" button\n\tif (!gantt.utils.dom.closest(e.target, \".gantt_add\")){\n\t\tsetTimeout(function() {\n\t\t\tgantt.ext.quickInfo.show(id);\n\t\t}, 0);\n\t}\n\n\treturn true;\n});\n\nconst events = [\"onViewChange\", \"onLightbox\", \"onBeforeTaskDelete\", \"onBeforeDrag\"];\nconst hidingFunction = function(){\n\tgantt.ext.quickInfo.hide();\n\treturn true;\n};\nfor (let i=0; i<events.length; i++){\n\tgantt.attachEvent(events[i], hidingFunction);\n}\n// GS-957: We don't want to hide QuickInfo when we click on it.\ngantt.attachEvent(\"onEmptyClick\", function(e){\n\tlet hideQuickInfo = true;\n\tconst parent = document.querySelector(\".gantt_cal_quick_info\");\n\tif (parent){\n\t\tconst quickInfoClick = gantt.utils.dom.isChildOf(e.target, parent);\n\t\tif (quickInfoClick){\n\t\t\thideQuickInfo = false;\n\t\t}\n\t}\n\tif (hideQuickInfo){\n\t\thidingFunction();\n\t}\n});\nfunction clearQuickInfo() {\n\tgantt.ext.quickInfo.hide();\n\tgantt.ext.quickInfo._quickInfoBox = null;\n\treturn true;\n}\ngantt.attachEvent(\"onGanttReady\", clearQuickInfo);\ngantt.attachEvent(\"onDestroy\", clearQuickInfo);\n\n// eslint-disable-next-line no-restricted-globals\ngantt.event(window, \"keydown\", function(e){\n\tif (e.keyCode === 27){\n\t\tgantt.ext.quickInfo.hide();\n\t}\n});\n\ngantt.showQuickInfo = function(){\n\tgantt.ext.quickInfo.show.apply(gantt.ext.quickInfo, arguments);\n};\ngantt.hideQuickInfo = function(){\n\tgantt.ext.quickInfo.hide.apply(gantt.ext.quickInfo, arguments);\n};\n\n}","import {TooltipManager} from \"./tooltipManager\";\n\nexport default function(gantt: any){\n\ngantt.config.tooltip_timeout = 30;\ngantt.config.tooltip_offset_y = 20;\ngantt.config.tooltip_offset_x = 10;\ngantt.config.tooltip_hide_timeout = 30;\n\n\n\nconst tooltipManager = new TooltipManager(gantt);\n\ngantt.ext.tooltips = tooltipManager;\n\ngantt.attachEvent(\"onGanttReady\", function(){\n\t//GS-2230: in case if `getGanttInstance` created without container\n\tif(!gantt.$root) return;\n\ttooltipManager.tooltipFor({\n\t\tselector: \"[\"+gantt.config.task_attribute+\"]:not(.gantt_task_row)\",\n\t\thtml: (event: MouseEvent) => {\n\t\t\tif (gantt.config.touch && !gantt.config.touch_tooltip) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst targetTaskId = gantt.locate(event);\n\t\t\tif(gantt.isTaskExists(targetTaskId)){\n\t\t\t\tconst task = gantt.getTask(targetTaskId);\n\t\t\t\treturn gantt.templates.tooltip_text(task.start_date, task.end_date, task);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tglobal: false\n\t});\n});\n\ngantt.attachEvent(\"onDestroy\", function() {\n\ttooltipManager.destructor();\n});\n\ngantt.attachEvent(\"onLightbox\", function() {\n\ttooltipManager.hideTooltip();\n});\nconst isLinkCreate = () => {\n\tconst state = gantt.getState();\n\treturn !!state.link_source_id;\n};\ngantt.attachEvent(\"onBeforeTooltip\", function() {\n\tif (isLinkCreate()){\n\t\treturn false;\n\t}\n});\n\ngantt.attachEvent(\"onGanttScroll\", function(){\n\ttooltipManager.hideTooltip();\n});\n\n}","import { Monitor } from \"./monitor\";\nimport { IMonitor, IUndoCommand, TEntityType, TUndoStack } from \"./types\";\nimport { Undo } from \"./undo\";\n\nexport default function(gantt: any){\n\nconst _undo = new Undo(gantt);\nconst monitor: IMonitor = new Monitor(_undo, gantt);\n\ngantt.config.undo = true;\ngantt.config.redo = true;\n\n/**\n * entities that require different processing for undoing-redoing changes\n * @type {{link: string, task: string}}\n */\ngantt.config.undo_types = {\n\tlink: \"link\",\n\ttask: \"task\"\n};\n\n/**\n * types of traced actions\n * @type {{update: string, remove: string, add: string}}\n */\ngantt.config.undo_actions = {\n\tupdate: \"update\",\n\tremove: \"remove\", // remove item from datastore\n\tadd: \"add\",\n\tmove: \"move\" // move task in grid\n};\n\nif (!gantt.ext) {\n\tgantt.ext = {};\n}\n\ngantt.ext.undo = {\n\tundo: () => _undo.undo(),\n\tredo: () => _undo.redo(),\n\tgetUndoStack: () => _undo.getUndoStack(),\n\tsetUndoStack: (stack:[]) => _undo.setUndoStack(stack),\n\tgetRedoStack: () => _undo.getRedoStack(),\n\tsetRedoStack: (stack:[]) => _undo.setRedoStack(stack),\n\tclearUndoStack: () => _undo.clearUndoStack(),\n\tclearRedoStack: () => _undo.clearRedoStack(),\n\tsaveState: (id: TaskID | LinkID, type: TEntityType) => monitor.store(id, type, true),\n\tgetInitialState: (id: TaskID | LinkID, type: TEntityType) => {\n\t\tif(type === gantt.config.undo_types.link){\n\t\t\treturn monitor.getInitialLink(id);\n\t\t}else{\n\t\t\treturn monitor.getInitialTask(id);\n\t\t}\n\t}\n};\n\ngantt.undo = gantt.ext.undo.undo;\ngantt.redo = gantt.ext.undo.redo;\ngantt.getUndoStack = gantt.ext.undo.getUndoStack;\ngantt.getRedoStack = gantt.ext.undo.getRedoStack;\ngantt.clearUndoStack = gantt.ext.undo.clearUndoStack;\ngantt.clearRedoStack = gantt.ext.undo.clearRedoStack;\n\nfunction updTask(task: ITask, oldId: TaskID, newId: TaskID) {\n\tif (!task) { return; }\n\n\tif (task.id === oldId) {\n\t\ttask.id = newId;\n\t}\n\n\tif (task.parent === oldId) {\n\t\ttask.parent = newId;\n\t}\n}\n\nfunction changeTaskCommandId(command: IUndoCommand, oldId: TaskID, newId: TaskID) {\n\tupdTask(command.value, oldId, newId);\n\tupdTask(command.oldValue, oldId, newId);\n}\n\nfunction updLink(link: ILink, oldTaskId: TaskID, newTaskId: TaskID) {\n\tif (!link) { return; }\n\tif (link.source === oldTaskId) {\n\t\tlink.source = newTaskId;\n\t}\n\tif (link.target === oldTaskId) {\n\t\tlink.target = newTaskId;\n\t}\n}\n\nfunction changeLinkCommandId(command: IUndoCommand, oldId: LinkID, newId: LinkID) {\n\tupdLink(command.value, oldId, newId);\n\tupdLink(command.oldValue, oldId, newId);\n}\n\nfunction updateTasksIds(log: TUndoStack, oldId: TaskID, newId: TaskID) {\n\tconst undo = _undo;\n\n\tfor (let i = 0; i < log.length; i++) {\n\t\tconst entry = log[i];\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\n\t\t\tif (entry.commands[j].entity === undo.command.entity.task) {\n\t\t\t\tchangeTaskCommandId(entry.commands[j], oldId, newId);\n\t\t\t} else if (entry.commands[j].entity === undo.command.entity.link) {\n\t\t\t\tchangeLinkCommandId(entry.commands[j], oldId, newId);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateLinksIds(log: TUndoStack, oldId: LinkID, newId: LinkID) {\n\tconst undo = _undo;\n\n\tfor (let i = 0; i < log.length; i++) {\n\t\tconst entry = log[i];\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\n\t\t\tconst command = entry.commands[j];\n\t\t\tif (command.entity === undo.command.entity.link) {\n\t\t\t\tif (command.value && command.value.id === oldId) {\n\t\t\t\t\tcommand.value.id = newId;\n\t\t\t\t}\n\t\t\t\tif (command.oldValue && command.oldValue.id === oldId) {\n\t\t\t\t\tcommand.oldValue.id = newId;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\ngantt.attachEvent(\"onTaskIdChange\", (oldId: TaskID, newId: TaskID) => {\n\tconst undo = _undo;\n\tupdateTasksIds(undo.getUndoStack(), oldId, newId);\n\tupdateTasksIds(undo.getRedoStack(), oldId, newId);\n});\n\ngantt.attachEvent(\"onLinkIdChange\", (oldId: LinkID, newId: LinkID) => {\n\tconst undo = _undo;\n\tupdateLinksIds(undo.getUndoStack(), oldId, newId);\n\tupdateLinksIds(undo.getRedoStack(), oldId, newId);\n});\n\ngantt.attachEvent(\"onGanttReady\", () => {\n\t_undo.updateConfigs();\n});\n\n}","\nexport default function(gantt){\n\nif(!gantt._markers) {\n\tgantt._markers = gantt.createDatastore({\n\t\tname: \"marker\",\n\t\tinitItem: function (marker) {\n\t\t\tmarker.id = marker.id || gantt.uid();\n\t\t\treturn marker;\n\t\t}\n\t});\n}\n\ngantt.config.show_markers = true;\n\nfunction render_marker(marker){\n\tif(!gantt.config.show_markers)\n\t\treturn false;\n\n\tif(!marker.start_date)\n\t\treturn false;\n\n\tvar state = gantt.getState();\n\tif(+marker.start_date > +state.max_date)\n\t\treturn;\n\tif((!marker.end_date || +marker.end_date < +state.min_date) && +marker.start_date < +state.min_date)\n\t\treturn;\n\n\tvar div = document.createElement(\"div\");\n\n\tdiv.setAttribute(\"data-marker-id\", marker.id);\n\n\tvar css = \"gantt_marker\";\n\tif(gantt.templates.marker_class)\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\n\n\tif(marker.css){\n\t\tcss += \" \" + marker.css;\n\t}\n\n\tif(gantt.templates.marker_class)\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\n\n\tif(marker.title){\n\t\tdiv.title = marker.title;\n\t}\n\tdiv.className = css;\n\n\tvar start = gantt.posFromDate(marker.start_date);\n\tdiv.style.left = start + \"px\";\n\tlet markerHeight = Math.max(gantt.getRowTop(gantt.getVisibleTaskCount()), 0) + \"px\";\n\tif (gantt.config.timeline_placeholder && gantt.$task_data){\n\t\tmarkerHeight = gantt.$task_data.scrollHeight + \"px\";\n\t}\n\tdiv.style.height = markerHeight;\n\tif(marker.end_date){\n\t\tvar end = gantt.posFromDate(marker.end_date);\n\t\tdiv.style.width = Math.max((end - start), 0) + \"px\";\n\n\t}\n\n\tif(marker.text){\n\t\tdiv.innerHTML = \"<div class='gantt_marker_content' >\" + marker.text + \"</div>\";\n\t}\n\n\treturn div;\n}\n\nfunction initMarkerArea(){\n\tif(!gantt.$task_data)\n\t\treturn;\n\n\tvar markerArea = document.createElement(\"div\");\n\tmarkerArea.className = \"gantt_marker_area\";\n\tgantt.$task_data.appendChild(markerArea);\n\tgantt.$marker_area = markerArea;\n}\n\ngantt.attachEvent(\"onBeforeGanttRender\", function(){\n\tif(!gantt.$marker_area)\n\t\tinitMarkerArea();\n});\n\ngantt.attachEvent(\"onDataRender\", function(){\n\tif(!gantt.$marker_area){\n\t\tinitMarkerArea();\n\t\tgantt.renderMarkers();\n\t}\n});\n\ngantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t// GS-1304 - markers should attach when layout is initialized, both on gantt.init and gantt.resetLayout\n\t// wait for \"onBeforeGanttRender\", so all layout elements will be in DOM\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tinitMarkerArea();\n\n\t\tvar layers = gantt.$services.getService(\"layers\");\n\t\tvar markerRenderer = layers.createDataRender({\n\t\t\tname: \"marker\",\n\t\t\tdefaultContainer: function(){ return gantt.$marker_area;}\n\t\t});\n\t\tmarkerRenderer.addLayer(render_marker);\n\t}, {once: true});\n});\n\ngantt.getMarker = function(id){\n\tif(!this._markers) return null;\n\n\treturn this._markers.getItem(id);\n};\n\ngantt.addMarker = function(marker){\n\treturn this._markers.addItem(marker);\n};\n\ngantt.deleteMarker = function(id){\n\tif(!this._markers.exists(id))\n\t\treturn false;\n\n\tthis._markers.removeItem(id);\n\treturn true;\n};\ngantt.updateMarker = function(id){\n\tthis._markers.refresh(id);\n};\n\ngantt._getMarkers = function(){\n\treturn this._markers.getItems();\n};\n\ngantt.renderMarkers = function () {\n\tthis._markers.refresh();\n};\n\n};","import {replaceValidZeroId} from \"../utils/helpers\";\n\nexport default function(gantt){\n\ngantt.config.multiselect = true;\ngantt.config.multiselect_one_level = false;\n\ngantt._multiselect = {\n\t_selected: {},\n\t_one_level: false,\n\t_active: true,\n\t_first_selected_when_shift: null,\n\tgetDefaultSelected: function() {\n\t\tvar selected = this.getSelected();\n\t\treturn selected.length ? selected[selected.length - 1] : null;\n\t},\n\tsetFirstSelected: function(id) {\n\t\tthis._first_selected_when_shift = id;\n\t},\n\tgetFirstSelected: function() {\n\t\treturn this._first_selected_when_shift;\n\t},\n\tisActive: function() {\n\t\tthis.updateState();\n\t\treturn this._active;\n\t},\n\tupdateState: function() {\n\t\tthis._one_level = gantt.config.multiselect_one_level;\n\t\tvar active = this._active;\n\t\tthis._active = gantt.config.select_task;\n\t\tif (this._active != active) {\n\t\t\tthis.reset();\n\t\t}\n\t},\n\treset: function () {\n\t\tthis._selected = {};\n\t},\n\tsetLastSelected: function (id) {\n\t\tgantt.$data.tasksStore.silent(function(){\n\t\t\tvar store = gantt.$data.tasksStore;\n\t\t\tif (id)\n\t\t\t\tstore.select(id+\"\");\n\t\t\telse\n\t\t\t\tstore.unselect(null);\n\t\t});\n\t},\n\tgetLastSelected: function () {\n\t\tvar last = gantt.$data.tasksStore.getSelectedId();\n\t\tif (last && gantt.isTaskExists(last))\n\t\t\treturn last;\n\t\treturn null;\n\t},\n\tselect: function (id, e) {\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, true, e]) && gantt.callEvent(\"onBeforeTaskSelected\", [id])) {\n\t\t\tthis._selected[id] = true;\n\t\t\tthis.setLastSelected(id);\n\t\t\tthis.afterSelect(id);\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, true, e]);\n\t\t\tgantt.callEvent(\"onTaskSelected\", [id]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\ttoggle: function (id, e) {\n\t\tif (this._selected[id]) {\n\t\t\tthis.unselect(id, e);\n\t\t} else {\n\t\t\tthis.select(id, e);\n\t\t}\n\t},\n\tunselect: function (id, e) {\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, false, e])) {\n\t\t\tthis._selected[id] = false;\n\t\t\tif (this.getLastSelected() == id)\n\t\t\t\tthis.setLastSelected(this.getDefaultSelected());\n\t\t\tthis.afterSelect(id);\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, false, e]);\n\t\t\tgantt.callEvent(\"onTaskUnselected\", [id]);\n\t\t}\n\t},\n\tisSelected: function (id) {\n\t\treturn !!(gantt.isTaskExists(id) && this._selected[id]);\n\t},\n\tgetSelected: function () {\n\t\tvar res = [];\n\t\tfor (var i in this._selected) {\n\t\t\tif (this._selected[i] && gantt.isTaskExists(i)) {\n\t\t\t\tres.push(i);\n\t\t\t} else {\n\t\t\t\tthis._selected[i] = false;\n\t\t\t}\n\t\t}\n\t\tres.sort(function(a, b) {\n\t\t\treturn gantt.getGlobalTaskIndex(a) > gantt.getGlobalTaskIndex(b) ? 1 : -1;\n\t\t});\n\t\treturn res;\n\t},\n\tforSelected: function (callback) {\n\t\tvar selected = this.getSelected();\n\t\tfor (var i = 0; i < selected.length; i++) {\n\t\t\tcallback(selected[i]);\n\t\t}\n\t},\n\tisSameLevel: function(id) {\n\t\tif (!this._one_level)\n\t\t\treturn true;\n\t\tvar last = this.getLastSelected();\n\t\tif (!last)\n\t\t\treturn true;\n\t\tif (!(gantt.isTaskExists(last) && gantt.isTaskExists(id)))\n\t\t\treturn true;\n\t\treturn !!(gantt.calculateTaskLevel(gantt.getTask(last)) == gantt.calculateTaskLevel(gantt.getTask(id)));\n\t},\n\tafterSelect: function(id) {\n\t\tif (gantt.isTaskExists(id)){\n\t\t\t// FIXME: quick workaround to prevent re-filtering inside refresh on multiselect\n\t\t\tgantt._quickRefresh(function(){\n\t\t\t\tgantt.refreshTask(id);\n\t\t\t});\n\t\t}\n\t},\n\tdoSelection: function(e) {\n\t\tif (!this.isActive())\n\t\t\treturn false;\n\n\t\t// deny selection when click on 'expand' or 'collapse' icons\n\t\tif (gantt._is_icon_open_click(e))\n\t\t\treturn false;\n\n\t\tvar target_ev = gantt.locate(e);\n\t\tif (!target_ev)\n\t\t\treturn false;\n\n\t\tif (!gantt.callEvent(\"onBeforeMultiSelect\", [e]))\n\t\t\treturn false;\n\n\t\tvar selected = this.getSelected();\n\t\tvar defaultLast = this.getFirstSelected();\n\t\tvar isLast = false;\n\t\tvar last = this.getLastSelected();\n\t\tvar multiSelect = gantt.config.multiselect;\n\n\n\t\tvar singleSelection = (function () {\n\t\t\t// GS-719: If the multiselect extension is added we still need a way\n\t\t\t// to open the inline editors after clicking on the cells in the grid\n\t\t\tvar controller = gantt.ext.inlineEditors;\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (gantt.config.inline_editors_multiselect_open && cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t} else {\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setFirstSelected(target_ev);\n\n\t\t\tif (!this.isSelected(target_ev)) {\n\t\t\t\tthis.select(target_ev, e);\n\t\t\t}\n\t\t\tselected = this.getSelected();\n\t\t\tfor (var i = 0; i < selected.length; i++) {\n\t\t\t\tif (selected[i] !== target_ev) {\n\t\t\t\t\tthis.unselect(selected[i], e);\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind(this);\n\n\t\tvar blockSelection = (function(){\n\t\t\tif (!last)\n\t\t\t\tlast = target_ev;\n\t\t\telse if (target_ev) {\n\t\t\t\tvar first_indx = gantt.getGlobalTaskIndex(this.getFirstSelected());\n\t\t\t\tvar target_indx = gantt.getGlobalTaskIndex(target_ev);\n\t\t\t\tvar last_indx = gantt.getGlobalTaskIndex(last);\n\t\t\t\t// GS-1969: if the selected tasks are collapsed, need to remove them\n\t\t\t\tif(first_indx == -1 || last_indx == -1){\n\t\t\t\t\tfirst_indx = target_indx;\n\t\t\t\t\tthis.reset();\n\t\t\t\t}\n\t\t\t\t// clear prev selection\n\t\t\t\tvar tmp = last;\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\n\t\t\t\t\tthis.unselect(tmp, e);\n\t\t\t\t\ttmp = (first_indx > last_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\n\t\t\t\t}\n\t\t\t\ttmp = target_ev;\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\n\t\t\t\t\tif (this.select(tmp, e) && !isLast) {\n\t\t\t\t\t\tisLast = true;\n\t\t\t\t\t\tdefaultLast = tmp;\n\t\t\t\t\t}\n\t\t\t\t\ttmp = (first_indx > target_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind(this);\n\n\n\t\tif (multiSelect && (e.ctrlKey || e.metaKey)) {\n\t\t\tif (!this.isSelected(target_ev))\n\t\t\t\tthis.setFirstSelected(target_ev);\n\n\t\t\tif (target_ev) {\n\t\t\t\tthis.toggle(target_ev, e);\n\t\t\t}\n\t\t}\n\n\t\telse if (multiSelect && e.shiftKey) {\n\t\t\tif (!gantt.isTaskExists(this.getFirstSelected()) || this.getFirstSelected() === null) {\n\t\t\t\tthis.setFirstSelected(target_ev);\n\t\t\t}\n\n\t\t\tif (selected.length) { // select a group of tasks\n\t\t\t\tblockSelection();\n\t\t\t}\n\t\t\telse { // select a task when no task is selected and Shift is pressed\n\t\t\t\tsingleSelection();\n\t\t\t}\n\t\t}\n\t\t\n\t\telse { // no key press or no multiple selection on the mouse click\n\t\t\tsingleSelection();\n\t\t}\n\n\n\t\tif (this.isSelected(target_ev)) {\n\t\t\tthis.setLastSelected(target_ev);\n\t\t} else if (defaultLast) {\n\t\t\tif (target_ev == last)\n\t\t\t\tthis.setLastSelected(e.shiftKey ? defaultLast : this.getDefaultSelected());\n\t\t} else {\n\t\t\tthis.setLastSelected(null);\n\t\t}\n\n\t\tif (!this.getSelected().length)\n\t\t\tthis.setLastSelected(null);\n\n\t\tif (!this.getLastSelected() || !this.isSelected(this.getFirstSelected()))\n\t\t\tthis.setFirstSelected(this.getLastSelected());\n\n\t\treturn true;\n\t}\n};\n\n(function(){\n\tvar old_selectTask = gantt.selectTask;\n\tgantt.selectTask = function(id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tif (!id)\n\t\t\treturn false;\n\t\tvar multiselect = gantt._multiselect;\n\t\tvar res = id;\n\t\tif (multiselect.isActive()) {\n\t\t\tif (multiselect.select(id, null)) {\n\t\t\t\tmultiselect.setLastSelected(id);\n\t\t\t}\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t} else {\n\t\t\tres = old_selectTask.call(this, id);\n\t\t}\n\t\treturn res;\n\t};\n\n\tvar old_unselectTask = gantt.unselectTask;\n\tgantt.unselectTask = function(id) {\n\t\tvar multiselect = gantt._multiselect;\n\t\tvar isActive = multiselect.isActive();\n\t\tid = id || multiselect.getLastSelected();\n\t\tif(id && isActive) {\n\t\t\tmultiselect.unselect(id, null);\n\t\t\tif (id == multiselect.getLastSelected())\n\t\t\t\tmultiselect.setLastSelected(null);\n\t\t\tgantt.refreshTask(id);\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t}\n\t\tvar res = id;\n\t\tif (!isActive)\n\t\t\tres = old_unselectTask.call(this, id);\n\t\treturn res;\n\t};\n\n\tgantt.toggleTaskSelection = function(id) {\n\t\tvar multiselect = gantt._multiselect;\n\t\tif (id && multiselect.isActive()) {\n\t\t\tmultiselect.toggle(id);\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t}\n\t};\n\tgantt.getSelectedTasks = function() {\n\t\tvar multiselect = gantt._multiselect;\n\t\tmultiselect.isActive();\n\t\treturn multiselect.getSelected();\n\t};\n\tgantt.eachSelectedTask = function(callback){\n\t\treturn this._multiselect.forSelected(callback);\n\t};\n\tgantt.isSelectedTask = function(id){\n\t\treturn this._multiselect.isSelected(id);\n\t};\n\tgantt.getLastSelectedTask = function(){\n\t\treturn this._multiselect.getLastSelected();\n\t};\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tvar old_isSelected = gantt.$data.tasksStore.isSelected;\n\t\tgantt.$data.tasksStore.isSelected = function(id){\n\t\t\tif (gantt._multiselect.isActive()) {\n\t\t\t\treturn gantt._multiselect.isSelected(id);\n\t\t\t}\n\t\t\treturn old_isSelected.call(this, id);\n\t\t};\n\t});\n})();\n\ngantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n\tvar multiselect = gantt._multiselect;\n\tif (!multiselect.isActive())\n\t\treturn true;\n\tif (gantt.isSelectedTask(id)) {\n\t\tmultiselect.unselect(id, null);\n\t\tmultiselect.select(new_id, null);\n\t}\n});\n\ngantt.attachEvent(\"onAfterTaskDelete\", function (id, item) {\n\tvar multiselect = gantt._multiselect;\n\tif (!multiselect.isActive())\n\t\treturn true;\n\n\tif (multiselect._selected[id]) {\n\t\t// GS-1057: don't unselect the task here because the task is already unselected \n\t\t// it was in the select.js file before it was deleted\n\t\t// multiselect.unselect(id, null);\n\t\tmultiselect._selected[id] = false;\n\t\tmultiselect.setLastSelected(multiselect.getDefaultSelected());\n\t}\n\n\tmultiselect.forSelected(function (task_id) {\n\t\tif (!gantt.isTaskExists(task_id))\n\t\t\tmultiselect.unselect(task_id, null);\n\t});\n});\n\ngantt.attachEvent(\"onBeforeTaskMultiSelect\", function(id, state, e){\n\tconst multiselect = gantt._multiselect;\n\tif (state && multiselect.isActive()) {\n\t\t//GS-1321: prevent unselecting task\n\t\tlet oldSelectedId = gantt.getSelectedId();\n\t\tlet oldSelectedTask = null;\n\t\tif (oldSelectedId) {\n\t\t\toldSelectedTask = gantt.getTask(oldSelectedId);\n\t\t}\n\t\tlet newSelectedTask = gantt.getTask(id);\n\t\tlet differentTreeLevel = false;\n\t\tif (oldSelectedTask && oldSelectedTask.$level != newSelectedTask.$level){\n\t\t\tdifferentTreeLevel = true;\n\t\t}\n\n\t\tif (gantt.config.multiselect_one_level && differentTreeLevel && !e.ctrlKey && !e.shiftKey) {\n\t\t\treturn true;\n\t\t}\n\t\tif (multiselect._one_level) {\n\t\t\treturn multiselect.isSameLevel(id);\n\t\t}\n\t}\n\treturn true;\n});\n\ngantt.attachEvent(\"onTaskClick\", function(id, e) {\n\tif (gantt._multiselect.doSelection(e))\n\t\tgantt.callEvent(\"onMultiSelect\", [e]);\n\treturn true;\n});\n\n};","/* eslint-disable */\n\nexport default function(gantt: any) {\n\n\tgantt.ext = gantt.ext || {};\n\n\tgantt.ext.export_api = gantt.ext.export_api || {\n\n\t\t_apiUrl: \"https://export.dhtmlx.com/gantt\",\n\n\t\t_preparePDFConfigRaw(config, type){\n\t\t\tlet previousDateRage:any = null;\n\t\t\tif (config.start && config.end){\n\t\t\t\tpreviousDateRage = {\n\t\t\t\t\tstart_date: gantt.config.start_date,\n\t\t\t\t\tend_date: gantt.config.end_date,\n\t\t\t\t};\n\t\t\t\tgantt.config.start_date = gantt.date.str_to_date(gantt.config.date_format)(config.start);\n\t\t\t\tgantt.config.end_date = gantt.date.str_to_date(gantt.config.date_format)(config.end);\n\t\t\t}\n\n\t\t\tconfig = gantt.mixin(config, {\n\t\t\t\tname: \"gantt.\" + type, data: gantt.ext.export_api._serializeHtml()\n\t\t\t});\n\n\t\t\tif (previousDateRage){\n\t\t\t\tgantt.config.start_date = previousDateRage.start_date;\n\t\t\t\tgantt.config.end_date = previousDateRage.end_date;\n\t\t\t}\n\t\t},\n\n\t\t_prepareConfigPDF(config, type){\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.\" + type,\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\n\t\t\t\tconfig: gantt.config\n\t\t\t});\n\t\t\tgantt.ext.export_api._fixColumns(config.config.columns);\n\t\t\treturn config;\n\t\t},\n\n\t\t_pdfExportRouter(config, type){\n\t\t\tif (config && config.raw) {\n\t\t\t\tgantt.ext.export_api._preparePDFConfigRaw(config, type);\n\t\t\t} else {\n\t\t\t\tconfig = gantt.ext.export_api._prepareConfigPDF(config, type);\n\t\t\t}\n\t\t\tconfig.version = gantt.version;\n\t\t\tgantt.ext.export_api._sendToExport(config, type);\n\t\t},\n\n\t\texportToPDF(config) {\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"pdf\");\n\t\t},\n\n\t\texportToPNG(config) {\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"png\");\n\t\t},\n\n\n\t\texportToICal(config) {\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.ical\",\n\t\t\t\tdata: gantt.ext.export_api._serializePlain().data,\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\t\t\tgantt.ext.export_api._sendToExport(config, \"ical\");\n\t\t},\n\n\t\texportToExcel(config) {\n\t\t\tconfig = config || {};\n\n\t\t\tlet tasks;\n\t\t\tlet dates;\n\t\t\tlet state;\n\t\t\tlet scroll;\n\t\t\t// GS-2124, we need to get all task nodes to correctly obtain the colors\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\n\t\t\tif (config.visual === \"base-colors\"){\n\t\t\t\tgantt.config.smart_rendering = false;\n\t\t\t}\n\n\t\t\tif (config.start || config.end) {\n\t\t\t\tstate = gantt.getState();\n\t\t\t\tdates = [gantt.config.start_date, gantt.config.end_date];\n\t\t\t\tscroll = gantt.getScrollState();\n\t\t\t\tconst convert = gantt.date.str_to_date(gantt.config.date_format);\n\t\t\t\ttasks = gantt.eachTask;\n\n\t\t\t\tif (config.start){\n\t\t\t\t\tgantt.config.start_date = convert(config.start);\n\t\t\t\t}\n\t\t\t\tif (config.end){\n\t\t\t\t\tgantt.config.end_date = convert(config.end);\n\t\t\t\t}\n\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\n\t\t\t\tgantt.eachTask = gantt.ext.export_api._eachTaskTimed(gantt.config.start_date, gantt.config.end_date);\n\t\t\t} else if (config.visual === \"base-colors\"){\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\t\t\t}\n\n\t\t\tgantt._no_progress_colors = config.visual === \"base-colors\";\n\n\t\t\tconfig = gantt.mixin(config, {\n\t\t\t\tname: \"gantt.xlsx\",\n\t\t\t\ttitle: \"Tasks\",\n\t\t\t\tdata: gantt.ext.export_api._serializeTimeline(config).data,\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid({ rawDates: true }),\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\n\t\t\tif (config.visual){\n\t\t\t\tconfig.scales = gantt.ext.export_api._serializeScales(config);\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._sendToExport(config, \"excel\");\n\n\t\t\tif (config.start || config.end) {\n\t\t\t\tgantt.config.start_date = state.min_date;\n\t\t\t\tgantt.config.end_date = state.max_date;\n\t\t\t\tgantt.eachTask = tasks;\n\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.scrollTo(scroll.x, scroll.y);\n\n\t\t\t\tgantt.config.start_date = dates[0];\n\t\t\t\tgantt.config.end_date = dates[1];\n\t\t\t}\n\t\t},\n\n\t\texportToJSON(config) {\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.json\",\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\n\t\t\t\tconfig: gantt.config,\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid(),\n\t\t\t\tworktime: gantt.ext.export_api._getWorktimeSettings(),\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\t\t\tgantt.ext.export_api._sendToExport(config, \"json\");\n\t\t},\n\n\n\t\timportFromExcel(config) {\n\t\t\ttry {\n\t\t\t\tconst formData = config.data;\n\t\t\t\tif (formData instanceof File) {\n\t\t\t\t\tconst data = new FormData();\n\t\t\t\t\tdata.append(\"file\", formData);\n\t\t\t\t\tconfig.data = data;\n\t\t\t\t}\n\t\t\t} catch (error) {}\n\t\t\tgantt.ext.export_api._sendImportAjaxExcel(config);\n\t\t},\n\n\t\timportFromMSProject(config) {\n\t\t\tconst formData = config.data;\n\t\t\ttry {\n\t\t\t\tif (formData  instanceof File) {\n\t\t\t\t\tconst data = new FormData();\n\t\t\t\t\tdata.append(\"file\", formData);\n\t\t\t\t\tconfig.data = data;\n\t\t\t\t}\n\t\t\t} catch (error) {}\n\t\t\tgantt.ext.export_api._sendImportAjaxMSP(config);\n\t\t},\n\n\t\timportFromPrimaveraP6(config) {\n\t\t\tconfig.type = \"primaveraP6-parse\";\n\t\t\treturn gantt.importFromMSProject(config);\n\t\t},\n\n\t\texportToMSProject(config) {\n\t\t\tconfig = config || {};\n\t\t\tconfig.skip_circular_links = config.skip_circular_links === undefined ? true : !!config.skip_circular_links;\n\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\n\t\t\tconst oldXmlDate = gantt.config.xml_date;\n\t\t\tconst oldDateFormat = gantt.config.date_format;\n\n\t\t\tconst exportServiceDateFormat = \"%d-%m-%Y %H:%i:%s\";\n\n\t\t\tgantt.config.xml_date = exportServiceDateFormat;\n\t\t\tgantt.config.date_format = exportServiceDateFormat;\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(exportServiceDateFormat);\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(exportServiceDateFormat);\n\t\t\tconst data = gantt.ext.export_api._serializeAll();\n\n\t\t\tgantt.ext.export_api._customProjectProperties(data, config);\n\n\t\t\tgantt.ext.export_api._customTaskProperties(data, config);\n\n\t\t\tif (config.skip_circular_links) {\n\t\t\t\tgantt.ext.export_api._clearRecLinks(data);\n\t\t\t}\n\n\t\t\tconfig = gantt.ext.export_api._exportConfig(data, config);\n\n\t\t\tgantt.ext.export_api._sendToExport(config, config.type || \"msproject\");\n\t\t\tgantt.config.xml_date = oldXmlDate;\n\t\t\tgantt.config.date_format = oldDateFormat;\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\n\t\t\tgantt.templates.format_date = oldFormatDate;\n\n\t\t\tgantt.config.$custom_data = null;\n\t\t\tgantt.config.custom = null;\n\t\t},\n\n\t\texportToPrimaveraP6(config) {\n\t\t\tconfig = config || {};\n\t\t\tconfig.type = \"primaveraP6\";\n\t\t\treturn gantt.exportToMSProject(config);\n\t\t},\n\n\t\t_fixColumns(columns) {\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\tcolumns[i].label = columns[i].label || gantt.locale.labels[\"column_\" + columns[i].name];\n\t\t\t\tif (typeof columns[i].width === \"string\") {\n\t\t\t\t\tcolumns[i].width = columns[i].width * 1;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_xdr(url, pack, cb) {\n\t\t\tgantt.ajax.post(url, pack, cb);\n\t\t},\n\n\t\t_markColumns(base) {\n\t\t\tconst columns = base.config.columns;\n\t\t\tif (columns){\n\t\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\t\tif (columns[i].template){\n\t\t\t\t\t\tcolumns[i].$template = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_sendImportAjaxExcel(config) {\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst store = config.store || 0;\n\t\t\tconst formData = config.data;\n\t\t\tconst callback = config.callback;\n\n\t\t\tformData.append(\"type\", \"excel-parse\");\n\t\t\tformData.append(\"data\", JSON.stringify({\n\t\t\t\tsheet: config.sheet || 0\n\t\t\t}));\n\n\t\t\tif (store){\n\t\t\t\tformData.append(\"store\", store);\n\t\t\t}\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.onreadystatechange = function(e) {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onload = function() {\n\t\t\t\tconst fail = xhr.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(info);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.send(formData);\n\t\t},\n\n\n\t\t_ajaxToExport(data, type, callback) {\n\t\t\tdelete data.callback;\n\n\t\t\tconst url = data.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst pack = \"type=\" + type + \"&store=1&data=\" + encodeURIComponent(JSON.stringify(data));\n\n\t\t\tconst cb = function(loader) {\n\t\t\t\tconst xdoc = loader.xmlDoc || loader;\n\t\t\t\tconst fail = xdoc.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xdoc.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\t\t\t\tcallback(info);\n\t\t\t};\n\n\t\t\tgantt.ext.export_api._xdr(url, pack, cb);\n\t\t},\n\t\t_serializableGanttConfig(config) {\n\t\t\tconst result = gantt.mixin({}, config);\n\n\t\t\tif (result.columns) {\n\t\t\t\tresult.columns = result.columns.map(function(col) {\n\t\t\t\t\tconst copy = gantt.mixin({}, col);\n\t\t\t\t\tdelete copy.editor;\n\t\t\t\t\treturn copy;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tdelete result.editor_types;\n\t\t\treturn result;\n\t\t},\n\n\t\t_sendToExport(data, type) {\n\t\t\tconst convert = gantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\n\t\t\tif(!data.skin){\n\t\t\t\tdata.skin = gantt.skin;\n\t\t\t}\n\t\t\tif (data.config) {\n\t\t\t\tdata.config = gantt.copy(gantt.ext.export_api._serializableGanttConfig(data.config));\n\t\t\t\tgantt.ext.export_api._markColumns(data, type);\n\n\t\t\t\tif (data.config.start_date && data.config.end_date) {\n\t\t\t\t\tif (data.config.start_date instanceof Date) {\n\t\t\t\t\t\tdata.config.start_date = convert(data.config.start_date);\n\t\t\t\t\t}\n\t\t\t\t\tif (data.config.end_date instanceof Date) {\n\t\t\t\t\t\tdata.config.end_date = convert(data.config.end_date);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (data.callback) {\n\t\t\t\treturn gantt.ext.export_api._ajaxToExport(data, type, data.callback);\n\t\t\t}\n\n\t\t\tconst form = gantt.ext.export_api._createHiddenForm();\n\t\t\tform.firstChild.action = data.server || gantt.ext.export_api._apiUrl;\n\t\t\tform.firstChild.childNodes[0].value = JSON.stringify(data);\n\t\t\tform.firstChild.childNodes[1].value = type;\n\t\t\tform.firstChild.submit();\n\t\t},\n\n\t\t_createHiddenForm() {\n\t\t\tif (!gantt.ext.export_api._hidden_export_form) {\n\t\t\t\tconst t = gantt.ext.export_api._hidden_export_form = document.createElement(\"div\");\n\t\t\t\tt.style.display = \"none\";\n\t\t\t\tt.innerHTML = \"<form method='POST' target='_blank'><textarea name='data' style='width:0px; height:0px;' readonly='true'></textarea><input type='hidden' name='type' value=''></form>\";\n\t\t\t\tdocument.body.appendChild(t);\n\t\t\t}\n\t\t\treturn gantt.ext.export_api._hidden_export_form;\n\t\t},\n\n\n\t\t_copyObjectBase(obj) {\n\t\t\tconst copy = {\n\t\t\t\tstart_date: undefined,\n\t\t\t\tend_date: undefined,\n\t\t\t\tconstraint_date: undefined,\n\t\t\t\tdeadline: undefined\n\t\t\t};\n\t\t\tfor (const key in obj) {\n\t\t\t\tif (key.charAt(0) === \"$\" || key === \"baselines\"){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tcopy[key] = obj[key];\n\t\t\t}\n\t\t\tconst formatDate = gantt.templates.xml_format || gantt.templates.format_date;\n\n\t\t\tcopy.start_date = formatDate(copy.start_date);\n\t\t\tif (copy.end_date){\n\t\t\t\tcopy.end_date = formatDate(copy.end_date);\n\t\t\t}\n\t\t\tif (copy.constraint_date){\n\t\t\t\tcopy.constraint_date = formatDate(copy.constraint_date);\n\t\t\t}\n\t\t\tif (copy.deadline){\n\t\t\t\tcopy.deadline = formatDate(copy.deadline);\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\n\t\t_color_box: null,\n\t\t_color_hash: {},\n\n\t\t_getStyles(css) {\n\t\t\tif (!gantt.ext.export_api._color_box) {\n\t\t\t\tgantt.ext.export_api._color_box = document.createElement(\"DIV\");\n\t\t\t\tgantt.ext.export_api._color_box.style.cssText = \"position:absolute; display:none;\";\n\t\t\t\tdocument.body.appendChild(gantt.ext.export_api._color_box);\n\t\t\t}\n\t\t\tif (gantt.ext.export_api._color_hash[css]){\n\t\t\t\treturn gantt.ext.export_api._color_hash[css];\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._color_box.className = css;\n\t\t\tconst color = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"color\");\n\t\t\tconst backgroundColor = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"backgroundColor\");\n\t\t\treturn (gantt.ext.export_api._color_hash[css] = color + \";\" + backgroundColor);\n\t\t},\n\n\n\t\t_getMinutesWorktimeSettings(parsedRanges) {\n\t\t\tconst minutes:any = [];\n\t\t\tparsedRanges.forEach(function(range) {\n\t\t\t\tminutes.push(range.startMinute);\n\t\t\t\tminutes.push(range.endMinute);\n\t\t\t});\n\t\t\treturn minutes;\n\t\t},\n\n\t\t_getWorktimeSettings() {\n\n\t\t\tconst defaultWorkTimes = {\n\t\t\t\thours: [0, 24],\n\t\t\t\tminutes: null,\n\t\t\t\tdates: { 0: true, 1: true, 2: true, 3: true, 4: true, 5: true, 6: true }\n\t\t\t};\n\n\t\t\tlet time;\n\t\t\tif (!gantt.config.work_time) {\n\t\t\t\ttime = defaultWorkTimes;\n\t\t\t} else {\n\t\t\t\tconst wTime = gantt._working_time_helper;\n\t\t\t\tif (wTime && wTime.get_calendar) {\n\t\t\t\t\ttime = wTime.get_calendar();\n\t\t\t\t} else if (wTime) {\n\t\t\t\t\ttime = {\n\t\t\t\t\t\thours: wTime.hours,\n\t\t\t\t\t\tminutes: null,\n\t\t\t\t\t\tdates: wTime.dates\n\t\t\t\t\t};\n\t\t\t\t} else if (gantt.config.worktimes && gantt.config.worktimes.global) {\n\t\t\t\t\tconst settings = gantt.config.worktimes.global;\n\n\t\t\t\t\tif (settings.parsed) {\n\t\t\t\t\t\tconst minutes = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.hours);\n\t\t\t\t\t\ttime = {\n\t\t\t\t\t\t\thours: null,\n\t\t\t\t\t\t\tminutes,\n\t\t\t\t\t\t\tdates: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tfor (const i in settings.parsed.dates) {\n\t\t\t\t\t\t\tif (Array.isArray(settings.parsed.dates[i])) {\n\t\t\t\t\t\t\t\ttime.dates[i] = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.dates[i]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttime.dates[i] = settings.parsed.dates[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttime = {\n\t\t\t\t\t\t\thours: settings.hours,\n\t\t\t\t\t\t\tminutes: null,\n\t\t\t\t\t\t\tdates: settings.dates\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\ttime = defaultWorkTimes;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn time;\n\t\t},\n\n\n\t\t_eachTaskTimed(start, end) {\n\t\t\treturn function(code, parent, master) {\n\t\t\t\tparent = parent || gantt.config.root_id;\n\t\t\t\tmaster = master || gantt;\n\n\t\t\t\tconst branch = gantt.getChildren(parent);\n\t\t\t\tif (branch){\n\t\t\t\t\tfor (let i = 0; i < branch.length; i++) {\n\t\t\t\t\t\tconst item = gantt._pull[branch[i]];\n\t\t\t\t\t\tif ((!start || item.end_date > start) && (!end || item.start_date < end)){\n\t\t\t\t\t\t\tcode.call(master, item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (gantt.hasChild(item.id)){\n\t\t\t\t\t\t\tgantt.eachTask(code, item.id, master);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\n\t\t// patch broken json serialization in gantt 2.1\n\t\t_originalCopyObject: gantt.json._copyObject,\n\n\n\t\t_copyObjectPlain(obj) {\n\t\t\tconst text = gantt.templates.task_text(obj.start_date, obj.end_date, obj);\n\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(obj);\n\t\t\tcopy.text = text || copy.text;\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_getColor(node, style) {\n\t\t\tconst value = node.currentStyle ? node.currentStyle[style] : getComputedStyle(node, null)[style];\n\t\t\tconst rgb = value.replace(/\\s/g, \"\").match(/^rgba?\\((\\d+),(\\d+),(\\d+)/i);\n\t\t\treturn ((rgb && rgb.length === 4) ?\n\t\t\t\t(\"0\" + parseInt(rgb[1], 10).toString(16)).slice(-2) +\n\t\t\t\t(\"0\" + parseInt(rgb[2], 10).toString(16)).slice(-2) +\n\t\t\t\t(\"0\" + parseInt(rgb[3], 10).toString(16)).slice(-2) : value).replace(\"#\", \"\");\n\t\t},\n\n\n\t\t// excel serialization\n\t\t_copyObjectTable(obj) {\n\t\t\t// Excel interprets UTC time as local time in every timezone, send local time instead of actual UTC time.\n\t\t\t// https://github.com/SheetJS/js-xlsx/issues/126#issuecomment-60531614\n\t\t\tconst toISOstring = gantt.date.date_to_str(\"%Y-%m-%dT%H:%i:%s.000Z\");\n\n\t\t\tconst copy = gantt.ext.export_api._copyObjectColumns(obj, gantt.ext.export_api._copyObjectPlain(obj));\n\t\t\tif (copy.start_date){\n\t\t\t\tcopy.start_date = toISOstring(obj.start_date);\n\t\t\t}\n\t\t\tif (copy.end_date){\n\t\t\t\tcopy.end_date = toISOstring(obj.end_date);\n\t\t\t}\n\n\t\t\t// private gantt._day_index_by_date was replaced by public gantt.columnIndexByDate in gantt 5.0\n\t\t\tconst getDayIndex = gantt._day_index_by_date ? gantt._day_index_by_date : gantt.columnIndexByDate;\n\n\t\t\tcopy.$start = getDayIndex.call(gantt, obj.start_date);\n\t\t\tcopy.$end = getDayIndex.call(gantt, obj.end_date);\n\n\t\t\t// GS-2100. Correct bar position considering hidden cells\n\t\t\tlet hiddenCells = 0;\n\t\t\tconst scaleCellsWidth = gantt.getScale().width;\n\t\t\tif (scaleCellsWidth.indexOf(0) > -1) {\n\t\t\t\tlet i = 0;\n\t\t\t\tfor (i; i < copy.$start; i++) {\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\n\t\t\t\t\t\thiddenCells++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcopy.$start -= hiddenCells;\n\n\t\t\t\tfor (i; i < copy.$end; i++) {\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\n\t\t\t\t\t\thiddenCells++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcopy.$end -= hiddenCells;\n\t\t\t}\n\n\t\t\tcopy.$level = obj.$level;\n\t\t\tcopy.$type = obj.$rendered_type;\n\n\t\t\tconst tmps = gantt.templates;\n\t\t\tcopy.$text = tmps.task_text(obj.start, obj.end_date, obj);\n\t\t\tcopy.$left = tmps.leftside_text ? tmps.leftside_text(obj.start, obj.end_date, obj) : \"\";\n\t\t\tcopy.$right = tmps.rightside_text ? tmps.rightside_text(obj.start, obj.end_date, obj) : \"\";\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectColors(obj) {\n\t\t\tconst copy = gantt.ext.export_api._copyObjectTable(obj);\n\n\t\t\tconst node = gantt.getTaskNode(obj.id);\n\t\t\tif (node && node.firstChild) {\n\t\t\t\tlet color = gantt.ext.export_api._getColor((gantt._no_progress_colors ? node : node.firstChild), \"backgroundColor\");\n\t\t\t\tif (color === \"363636\"){\n\t\t\t\t\tcolor = gantt.ext.export_api._getColor(node, \"backgroundColor\");\n\t\t\t\t}\n\n\t\t\t\tcopy.$color = color;\n\t\t\t} else if (obj.color){\n\t\t\t\tcopy.$color = obj.color;\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectColumns(obj, copy) {\n\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\n\t\t\t\tconst ct = gantt.config.columns[i].template;\n\t\t\t\tif (ct) {\n\t\t\t\t\tlet val = ct(obj);\n\t\t\t\t\tif (val instanceof Date){\n\t\t\t\t\t\tval = gantt.templates.date_grid(val, obj);\n\t\t\t\t\t}\n\t\t\t\t\tcopy[\"_\" + i] = val;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectAll(obj) {\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(obj);\n\n\t\t\tconst templates = [\n\t\t\t\t\"leftside_text\",\n\t\t\t\t\"rightside_text\",\n\t\t\t\t\"task_text\",\n\t\t\t\t\"progress_text\",\n\t\t\t\t\"task_class\"\n\t\t\t];\n\n\t\t\t// serialize all text templates\n\t\t\tfor (let i = 0; i < templates.length; i++) {\n\t\t\t\tconst template = gantt.templates[templates[i]];\n\t\t\t\tif (template){\n\t\t\t\t\tcopy[\"$\" + i] = template(obj.start_date, obj.end_date, obj);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._copyObjectColumns(obj, copy);\n\t\t\tcopy.open = obj.$open;\n\t\t\treturn copy;\n\t\t},\n\n\n\t\t_serializeHtml() {\n\t\t\tconst smartScales = gantt.config.smart_scales;\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\n\t\t\tif (smartScales || smartRendering) {\n\t\t\t\tgantt.config.smart_rendering = false;\n\t\t\t\tgantt.config.smart_scales = false;\n\t\t\t\tgantt.render();\n\t\t\t}\n\n\t\t\tconst html = gantt.$container.parentNode.innerHTML;\n\n\t\t\tif (smartScales || smartRendering) {\n\t\t\t\tgantt.config.smart_scales = smartScales;\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\t\t\t\tgantt.render();\n\t\t\t}\n\n\t\t\treturn html;\n\t\t},\n\n\t\t_serializeAll() {\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectAll;\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\t\t\treturn data;\n\t\t},\n\n\t\t_serializePlain() {\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectPlain;\n\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\n\t\t\tgantt.templates.format_date = oldFormatDate;\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\n\t\t\tdelete data.links;\n\t\t\treturn data;\n\t\t},\n\n\t\t_getRaw() {\n\t\t\t// support Gantt < 5.0\n\t\t\tif (gantt._scale_helpers) {\n\t\t\t\tconst scales = gantt._get_scales();\n\t\t\t\tconst\tminWidth = gantt.config.min_column_width;\n\t\t\t\tconst\tautosizeMinWidth = gantt._get_resize_options().x ? Math.max(gantt.config.autosize_min_width, 0) : gantt.config.$task.offsetWidth;\n\t\t\t\tconst\theight = gantt.config.config.scale_height - 1;\n\t\t\t\treturn gantt._scale_helpers.prepareConfigs(scales, minWidth, autosizeMinWidth, height);\n\t\t\t} else { // Gantt >= 5.0\n\t\t\t\tconst timeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\tif (timeline) {\n\t\t\t\t\tlet availWidth = timeline.$config.width;\n\t\t\t\t\tif (gantt.config.autosize === \"x\" || gantt.config.autosize === \"xy\") {\n\t\t\t\t\t\tavailWidth = Math.max(gantt.config.autosize_min_width, 0);\n\t\t\t\t\t}\n\t\t\t\t\tconst state = gantt.getState();\n\t\t\t\t\tconst\tscales = timeline._getScales();\n\t\t\t\t\tconst\tminWidth = gantt.config.min_column_width;\n\t\t\t\t\tconst\theight = gantt.config.scale_height - 1;\n\t\t\t\t\tconst\trtl = gantt.config.rtl;\n\t\t\t\t\treturn timeline.$scaleHelper.prepareConfigs(scales, minWidth, availWidth, height, state.min_date, state.max_date, rtl);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_serializeTimeline(config) {\n\t\t\tgantt.json._copyObject = config.visual ? gantt.ext.export_api._copyObjectColors : gantt.ext.export_api._copyObjectTable;\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\n\t\t\tdelete data.links;\n\n\t\t\tif (config.cellColors) {\n\t\t\t\tconst css = gantt.templates.timeline_cell_class || gantt.templates.task_cell_class;\n\t\t\t\tif (css) {\n\t\t\t\t\tconst raw = gantt.ext.export_api._getRaw();\n\t\t\t\t\tlet steps = raw[0].trace_x;\n\t\t\t\t\tfor (let i = 1; i < raw.length; i++){\n\t\t\t\t\t\tif (raw[i].trace_x.length > steps.length){\n\t\t\t\t\t\t\tsteps = raw[i].trace_x;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let i = 0; i < data.data.length; i++) {\n\t\t\t\t\t\tdata.data[i].styles = [];\n\t\t\t\t\t\tconst task = gantt.getTask(data.data[i].id);\n\t\t\t\t\t\tfor (let j = 0; j < steps.length; j++) {\n\t\t\t\t\t\t\tconst date = steps[j];\n\t\t\t\t\t\t\tconst cellCss = css(task, date);\n\t\t\t\t\t\t\tif (cellCss){\n\t\t\t\t\t\t\t\tdata.data[i].styles.push({ index: j, styles: gantt.ext.export_api._getStyles(cellCss) });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn data;\n\t\t},\n\n\t\t_serializeScales(config) {\n\t\t\tconst scales:any = [];\n\t\t\tconst raw = gantt.ext.export_api._getRaw();\n\n\t\t\tlet min = Infinity;\n\t\t\tlet max = 0;\n\t\t\tfor (let i = 0; i < raw.length; i++) {\n\t\t\t\tmin = Math.min(min, raw[i].col_width);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < raw.length; i++) {\n\t\t\t\tlet start = 0;\n\t\t\t\tlet end = 0;\n\t\t\t\tconst row:any = [];\n\n\t\t\t\tscales.push(row);\n\t\t\t\tconst step = raw[i];\n\t\t\t\tmax = Math.max(max, step.trace_x.length);\n\t\t\t\tconst template = step.format || step.template || (step.date ? gantt.date.date_to_str(step.date) : gantt.config.date_scale);\n\n\t\t\t\tfor (let j = 0; j < step.trace_x.length; j++) {\n\t\t\t\t\tconst date = step.trace_x[j];\n\t\t\t\t\tend = start + Math.round(step.width[j] / min);\n\n\t\t\t\t\tconst scaleCell = { text: template(date), start, end, styles: \"\" };\n\n\t\t\t\t\tif (config.cellColors) {\n\t\t\t\t\t\tconst css = step.css || gantt.templates.scaleCell_class;\n\t\t\t\t\t\tif (css) {\n\t\t\t\t\t\t\tconst scaleCss = css(date);\n\t\t\t\t\t\t\tif (scaleCss){\n\t\t\t\t\t\t\t\tscaleCell.styles = gantt.ext.export_api._getStyles(scaleCss);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(scaleCell);\n\t\t\t\t\tstart = end;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { width: max, height: scales.length, data: scales };\n\t\t},\n\n\t\t_serializeGrid(config) {\n\t\t\tgantt.exportMode = true;\n\n\t\t\tconst columns:any = [];\n\t\t\tconst cols = gantt.config.columns;\n\n\t\t\tlet ccount = 0;\n\t\t\tfor (let i = 0; i < cols.length; i++) {\n\t\t\t\tif (cols[i].name === \"add\" || cols[i].name === \"buttons\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcolumns[ccount] = {\n\t\t\t\t\tid: ((cols[i].template) ? (\"_\" + i) : cols[i].name),\n\t\t\t\t\theader: cols[i].label || gantt.locale.labels[\"column_\" + cols[i].name],\n\t\t\t\t\twidth: (cols[i].width ? Math.floor(cols[i].width / 4) : \"\"),\n\t\t\t\t\ttree: cols[i].tree || false\n\t\t\t\t};\n\n\t\t\t\tif (cols[i].name === \"duration\"){\n\t\t\t\t\tcolumns[ccount].type = \"number\";\n\t\t\t\t}\n\t\t\t\tif (cols[i].name === \"start_date\" || cols[i].name === \"end_date\") {\n\t\t\t\t\tcolumns[ccount].type = \"date\";\n\t\t\t\t\tif (config && config.rawDates){\n\t\t\t\t\t\tcolumns[ccount].id = cols[i].name;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tccount++;\n\t\t\t}\n\n\t\t\tgantt.exportMode = false;\n\t\t\treturn columns;\n\t\t},\n\n\t\t_exportSerialize() {\n\t\t\tgantt.exportMode = true;\n\n\t\t\tconst xmlFormat = gantt.templates.xml_format;\n\t\t\tconst formatDate = gantt.templates.format_date;\n\n\t\t\t// use configuration date format for serialization so date could be parsed on the export\n\t\t\t// required when custom format date function is defined\n\t\t\tgantt.templates.xml_format =\n\t\t\t\tgantt.templates.format_date =\n\t\t\t\tgantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\n\n\t\t\tconst data = gantt.serialize();\n\n\t\t\tgantt.templates.xml_format = xmlFormat;\n\t\t\tgantt.templates.format_date = formatDate;\n\t\t\tgantt.exportMode = false;\n\t\t\treturn data;\n\t\t},\n\n\n\t\t_setLevel(data) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif (data[i].parent == 0) {\n\t\t\t\t\tdata[i]._lvl = 1;\n\t\t\t\t}\n\t\t\t\tfor (let j = i + 1; j < data.length; j++) {\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\tif (data[i].id == data[j].parent) {\n\t\t\t\t\t\tdata[j]._lvl = data[i]._lvl + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_clearLevel(data) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tdelete data[i]._lvl;\n\t\t\t}\n\t\t},\n\n\t\t_clearRecLinks(data) {\n\t\t\tgantt.ext.export_api._setLevel(data.data);\n\t\t\tconst tasks = {};\n\t\t\tfor (let i = 0; i < data.data.length; i++) {\n\t\t\t\ttasks[data.data[i].id] = data.data[i];\n\t\t\t}\n\n\t\t\tconst links = {};\n\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\n\t\t\t\tconst link = data.links[i];\n\t\t\t\tif (gantt.isTaskExists(link.source) && gantt.isTaskExists(link.target) &&\n\t\t\t\t\ttasks[link.source] && tasks[link.target]) {\n\t\t\t\t\tlinks[link.id] = link;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const j in links) {\n\t\t\t\tgantt.ext.export_api._makeLinksSameLevel(links[j], tasks);\n\t\t\t}\n\n\t\t\tconst skippedLinks = {};\n\t\t\tfor (const j in tasks) {\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(tasks[j], links, tasks, {}, skippedLinks, null);\n\t\t\t}\n\n\t\t\tif (Object.keys(links)) {\n\t\t\t\tgantt.ext.export_api._clearLinksSameLevel(links, tasks);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\n\t\t\t\tif (!links[data.links[i].id]) {\n\t\t\t\t\tdata.links.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._clearLevel(data.data);\n\t\t},\n\n\t\t_clearCircDependencies(task, links, tasks, usedTasks, skippedLinks, prevLink) {\n\t\t\tconst sources = task.$_source;\n\t\t\tif (!sources) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (usedTasks[task.id]) {\n\t\t\t\tgantt.ext.export_api._onCircDependencyFind(prevLink, links, usedTasks, skippedLinks);\n\t\t\t}\n\n\t\t\tusedTasks[task.id] = true;\n\n\t\t\tconst targets = {};\n\n\t\t\tfor (let i = 0; i < sources.length; i++) {\n\t\t\t\tif (skippedLinks[sources[i]]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst curLink = links[sources[i]];\n\t\t\t\tconst targetTask = tasks[curLink._target];\n\t\t\t\tif (targets[targetTask.id]) { // two link from one task to another\n\t\t\t\t\tgantt.ext.export_api._onCircDependencyFind(curLink, links, usedTasks, skippedLinks);\n\t\t\t\t}\n\t\t\t\ttargets[targetTask.id] = true;\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(targetTask, links, tasks, usedTasks, skippedLinks, curLink);\n\t\t\t}\n\t\t\tusedTasks[task.id] = false;\n\t\t},\n\n\t\t_onCircDependencyFind(link, links, usedTasks, skippedLinks) {\n\t\t\tif (link) {\n\t\t\t\tif (gantt.callEvent(\"onExportCircularDependency\", [link.id, link])) {\n\t\t\t\t\tdelete links[link.id];\n\t\t\t\t}\n\n\t\t\t\tdelete usedTasks[link._source];\n\t\t\t\tdelete usedTasks[link._target];\n\t\t\t\tskippedLinks[link.id] = true;\n\t\t\t}\n\t\t},\n\n\t\t_makeLinksSameLevel(link, tasks) {\n\t\t\tlet task;\n\t\t\tlet targetLvl;\n\t\t\tconst linkT = {\n\t\t\t\ttarget: tasks[link.target],\n\t\t\t\tsource: tasks[link.source]\n\t\t\t};\n\t\t\t// tslint:disable-next-line triple-equals\n\t\t\tif (linkT.target._lvl != linkT.source._lvl) {\n\t\t\t\tif (linkT.target._lvl < linkT.source._lvl) {\n\t\t\t\t\ttask = \"source\";\n\t\t\t\t\ttargetLvl = linkT.target._lvl;\n\t\t\t\t} else {\n\t\t\t\t\ttask = \"target\";\n\t\t\t\t\ttargetLvl = linkT.source._lvl;\n\t\t\t\t}\n\n\t\t\t\tdo {\n\t\t\t\t\tconst parent = tasks[linkT[task].parent];\n\t\t\t\t\tif (!parent) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlinkT[task] = parent;\n\t\t\t\t} while (linkT[task]._lvl < targetLvl);\n\n\t\t\t\tlet sourceParent = tasks[linkT.source.parent];\n\t\t\t\tlet\ttargetParent = tasks[linkT.target.parent];\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\twhile (sourceParent && targetParent && sourceParent.id != targetParent.id) {\n\t\t\t\t\tlinkT.source = sourceParent;\n\t\t\t\t\tlinkT.target = targetParent;\n\t\t\t\t\tsourceParent = tasks[linkT.source.parent];\n\t\t\t\t\ttargetParent = tasks[linkT.target.parent];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlink._target = linkT.target.id;\n\t\t\tlink._source = linkT.source.id;\n\n\t\t\tif (!linkT.target.$_target){\n\t\t\t\tlinkT.target.$_target = [];\n\t\t\t}\n\t\t\tlinkT.target.$_target.push(link.id);\n\n\t\t\tif (!linkT.source.$_source){\n\t\t\t\tlinkT.source.$_source = [];\n\t\t\t}\n\t\t\tlinkT.source.$_source.push(link.id);\n\t\t},\n\n\t\t_clearLinksSameLevel(links, tasks) {\n\t\t\tfor (const link in links) {\n\t\t\t\tdelete links[link]._target;\n\t\t\t\tdelete links[link]._source;\n\t\t\t}\n\n\t\t\tfor (const task in tasks) {\n\t\t\t\tdelete tasks[task].$_source;\n\t\t\t\tdelete tasks[task].$_target;\n\t\t\t}\n\t\t},\n\n\n\t\t_customProjectProperties(data, config) {\n\t\t\tif (config && config.project) {\n\t\t\t\tfor (const i in config.project) {\n\t\t\t\t\tif (!gantt.config.$custom_data){\n\t\t\t\t\t\tgantt.config.$custom_data = {};\n\t\t\t\t\t}\n\t\t\t\t\tgantt.config.$custom_data[i] = typeof config.project[i] === \"function\" ? config.project[i](gantt.config) : config.project[i];\n\t\t\t\t}\n\t\t\t\tdelete config.project;\n\t\t\t}\n\t\t},\n\n\t\t_customTaskProperties(data, config) {\n\t\t\tif (config && config.tasks) {\n\t\t\t\tdata.data.forEach(function(el) {\n\t\t\t\t\tfor (const i in config.tasks) {\n\t\t\t\t\t\tif (!el.$custom_data){\n\t\t\t\t\t\t\tel.$custom_data = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tel.$custom_data[i] = typeof config.tasks[i] === \"function\" ? config.tasks[i](el, gantt.config) : config.tasks[i];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdelete config.tasks;\n\t\t\t}\n\t\t},\n\n\t\t_exportConfig(data, config) {\n\t\t\tconst projectName = config.name || \"gantt.xml\";\n\t\t\tdelete config.name;\n\n\t\t\tgantt.config.custom = config;\n\n\t\t\tconst time = gantt.ext.export_api._getWorktimeSettings();\n\n\t\t\tconst projectDates = gantt.getSubtaskDates();\n\t\t\tif (projectDates.start_date && projectDates.end_date) {\n\t\t\t\tconst formatDate = gantt.templates.format_date || gantt.templates.xml_format;\n\t\t\t\tgantt.config.start_end = {\n\t\t\t\t\tstart_date: formatDate(projectDates.start_date),\n\t\t\t\t\tend_date: formatDate(projectDates.end_date)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst manual = config.auto_scheduling === undefined ? false : !!config.auto_scheduling;\n\n\t\t\tconst res = {\n\t\t\t\tcallback: config.callback || null,\n\t\t\t\tconfig: gantt.config,\n\t\t\t\tdata,\n\t\t\t\tmanual,\n\t\t\t\tname: projectName,\n\t\t\t\tworktime: time\n\t\t\t};\n\t\t\tfor (const i in config) {\n\t\t\t\tres[i] = config[i];\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\n\n\t\t_sendImportAjaxMSP(config) {\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst store = config.store || 0;\n\t\t\tconst formData = config.data;\n\t\t\tconst callback = config.callback;\n\n\t\t\tconst settings = {\n\t\t\t\tdurationUnit: config.durationUnit || undefined,\n\t\t\t\tprojectProperties: config.projectProperties || undefined,\n\t\t\t\ttaskProperties: config.taskProperties || undefined\n\t\t\t};\n\n\t\t\tformData.append(\"type\", config.type || \"msproject-parse\");\n\t\t\tformData.append(\"data\", JSON.stringify(settings));\n\n\t\t\tif (store){\n\t\t\t\tformData.append(\"store\", store);\n\t\t\t}\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.onreadystatechange = function(e) {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onload = function(){\n\t\t\t\tconst fail = xhr.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(info);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.send(formData);\n\t\t}\n\n\t};\n\n\n\tgantt.exportToPDF = gantt.ext.export_api.exportToPDF;\n\tgantt.exportToPNG = gantt.ext.export_api.exportToPNG;\n\tgantt.exportToICal = gantt.ext.export_api.exportToICal;\n\tgantt.exportToExcel = gantt.ext.export_api.exportToExcel;\n\tgantt.exportToJSON = gantt.ext.export_api.exportToJSON;\n\tgantt.importFromExcel = gantt.ext.export_api.importFromExcel;\n\tgantt.importFromMSProject = gantt.ext.export_api.importFromMSProject;\n\tgantt.exportToMSProject = gantt.ext.export_api.exportToMSProject;\n\tgantt.importFromPrimaveraP6 = gantt.ext.export_api.importFromPrimaveraP6;\n\tgantt.exportToPrimaveraP6 = gantt.ext.export_api.exportToPrimaveraP6;\n\n\n\treturn gantt.ext.export_api;\n}\n","export default {\n\tKEY_CODES: {\n\t\tUP: 38,\n\t\tDOWN: 40,\n\t\tLEFT: 37,\n\t\tRIGHT: 39,\n\t\tSPACE: 32,\n\t\tENTER: 13,\n\t\tDELETE: 46,\n\t\tESC: 27,\n\t\tTAB: 9\n\t}\n};","export default class ExtensionsManager{\n\tprivate _extensions:{[key:string]: GanttPlugin };\n\n\tconstructor(config: {[key:string]: GanttPlugin }){\n\t\tthis._extensions = {};\n\t\tfor(const i in config){\n\t\t\tthis._extensions[i] = config[i];\n\t\t}\n\t}\n\n\taddExtension = (name: string, ext: GanttPlugin) => {\n\t\tthis._extensions[name] = ext;\n\t};\n\n\tgetExtension = (name: string): GanttPlugin => {\n\t\treturn this._extensions[name];\n\t};\n}","type DurationUnits = \"minute\" | \"hour\" | \"day\" | \"week\" | \"month\" | \"year\";\ntype Align = \"left\" | \"center\" | \"right\";\ntype SectionType = \"textarea\"\n\t\t\t\t\t| \"time\"\n\t\t\t\t\t| \"duration\"\n\t\t\t\t\t| \"select\"\n\t\t\t\t\t| \"typeselect\"\n\t\t\t\t\t| \"parent\"\n\t\t\t\t\t| \"template\"\n\t\t\t\t\t| \"checkbox\"\n\t\t\t\t\t| \"radio\"\n\t\t\t\t\t| \"resources\"\n\t\t\t\t\t| \"constraint\";\n\ntype LightboxSection = Array<ILightboxSection\n\t| ILightboxTimeAndDurationSection\n\t| ILightboxInputControl\n\t| ILightboxSelectControl\n\t| ILightboxParentControl\n\t| ILightboxTypeselectControl>;\n\ntype LayoutView = \"grid\"\n\t| \"timeline\"\n\t| \"resizer\"\n\t| \"scrollbar\"\n\t| \"resourceGrid\"\n\t| \"resourceTimeline\";\n\ninterface IColumnItem {\n\tname: string;\n\tlabel?: string;\n\ttree?: boolean;\n\talign?: Align;\n\thide?: boolean;\n\tmax_width?: number;\n\tmin_width?: number;\n\tresize?: boolean;\n\ttemplate?: (obj: any) => string;\n\twidth?: number | \"*\";\n}\n\nexport type TModifierKeys = \"metaKey\" | \"ctrlKey\" | \"altKey\" | \"shiftKey\" | false | undefined;\n\nexport interface IScale {\n\tcss?: () => string;\n\tdate?: string;\n\tstep: number;\n\ttemplate?: (date: Date) => string;\n\tunit: DurationUnits;\n}\n\ninterface ILightboxSection {\n\tname: string;\n\tmap_to: string;\n\ttype: SectionType;\n\theight?: number;\n\tfocus?: boolean;\n}\n\ninterface ILightboxTimeAndDurationSection extends ILightboxSection {\n\treadonly: boolean;\n\tyear_range: number[] | number;\n\tsingle_date: boolean;\n\ttime_format: string;\n}\n\ninterface ILightboxInputControl extends ILightboxSection {\n\tdefault_value?: any;\n\toptions?: Array<{key: string, label: string}>;\n}\n\ninterface ILightboxSelectControl extends ILightboxInputControl {\n\tonchange: () => boolean | undefined;\n}\n\ninterface ILightboxParentControl extends ILightboxSection {\n\tallow_root: boolean;\n\troot_label: string;\n\tsort?: (a: any, b: any) => -1 | 0 | 1;\n\tfilter?: (task: string | number | object) => boolean;\n\ttemplate?: (start: Date, end: Date, ev: object) => string;\n}\n\ninterface ILightboxTypeselectControl extends ILightboxSection {\n\tfilter?: (typeName: string) => boolean;\n}\n\n\ninterface ILayoutScrollbar {\n\tview: \"scrollbar\";\n\tscroll?: \"x\" | \"y\";\n\tid: string;\n\theight?: number;\n\twidth?: number;\n}\n\ninterface ILayoutView {\n\tview: LayoutView;\n\tid?: string;\n\tscrollX?: string;\n\tscrollY?: string;\n\tconfig?: object;\n}\n\ninterface ILayoutGrid extends ILayoutView {\n\tview: \"grid\";\n\tbind?: string;\n}\n\ninterface ILayoutTimeline extends ILayoutView {\n\tview: \"timeline\";\n\tbindLinks?: string;\n\tlayers?: any[];\n}\n\ninterface ILayoutResizer {\n\tview?: undefined;\n\tresizer: boolean;\n\twidth: number;\n}\n\ninterface ILayoutResourceGrid extends ILayoutView {\n\tview: \"resourceGrid\";\n\twidth: number;\n\tgroup: \"string\";\n}\n\ninterface ILayoutResourceTimeline extends ILayoutView {\n\tview: \"resourceTimeline\";\n\twidth: number;\n\tgroup: \"string\";\n}\n\ninterface ILayoutHtml {\n\thtml: string;\n\tcss: string;\n\twidth: number;\n}\n\ntype LayoutRow = ILayoutGrid\n\t| ILayoutTimeline\n\t| ILayoutResizer\n\t| ILayoutResourceGrid\n\t| ILayoutResourceTimeline\n\t| ILayoutHtml\n\t| ILayoutScrollbar\n\t| { cols: LayoutCol[] };\n\ntype LayoutCol = ILayoutGrid\n\t| ILayoutTimeline\n\t| ILayoutResizer\n\t| ILayoutResourceGrid\n\t| ILayoutResourceTimeline\n\t| ILayoutHtml\n\t| ILayoutScrollbar\n\t| { rows: LayoutRow[] };\n\ninterface ILayout {\n\tcss: string;\n\trows?: LayoutRow[];\n\tcols?: LayoutCol[];\n}\n\ntype TCsp = boolean | \"auto\";\n\ninterface IResourceConfig {\n\tdataprocessor_assignments?: boolean;\n\tdataprocessor_resources?: boolean;\n\teditable_resource_diagram?: boolean;\n\tresource_store?: {\n\t\ttype?: \"treeDataStore\"|\"dataStore\"|string;\n\t\tfetchTasks?: boolean;\n\t\tinitItem?: (item: any) => any;\n\t};\n\tlightbox_resources?: (resources: any[]) => any[];\n\n}\n\ninterface IGanttConfig {\n\tlayout: ILayout;\n\tlinks: {\n\t\tfinish_to_start: \"0\";\n\t\tstart_to_start: \"1\";\n\t\tfinish_to_finish: \"2\";\n\t\tstart_to_finish: \"3\";\n\t};\n\ttypes: {\n\t\ttask: string;\n\t\tproject: string;\n\t\tmilestone: string;\n\t};\n\tauto_types: boolean;\n\tduration_unit: DurationUnits;\n\twork_time: boolean;\n\tcorrect_work_time: boolean;\n\tdeadlines: boolean;\n\tskip_off_time: boolean;\n\tcascade_delete: boolean;\n\tautosize: boolean | string;\n\tautoscroll: boolean;\n\tshow_links: boolean;\n\tshow_task_cells: boolean;\n\tautosize_min_width: number;\n\tautoscroll_speed: number;\n\tdeepcopy_on_parse: boolean;\n\tstatic_background: boolean;\n\tstatic_background_cells: boolean;\n\tbranch_loading: boolean;\n\tbranch_loading_property: string;\n\tshow_loading: boolean;\n\tshow_chart: boolean;\n\tshow_grid: boolean;\n\tmin_duration: number;\n\tdate_format: string; // use instead xml_date\n\txml_date?: string; // deprecated\n\tstart_on_monday: boolean;\n\tserver_utc: boolean;\n\tshow_progress: boolean;\n\tfit_tasks: boolean;\n\tselect_task: boolean;\n\tscroll_on_click: boolean;\n\tsmart_rendering: boolean;\n\tpreserve_scroll: boolean;\n\treadonly: boolean;\n\tcontainer_resize_timeout: number;\n\n\t/*grid */\n\tdate_grid: string;\n\n\tdrag_links: boolean;\n\tdrag_progress: boolean;\n\tdrag_resize: boolean;\n\tdrag_project: boolean;\n\tdrag_move: boolean;\n\tdrag_mode: {\n\t\tresize: \"resize\",\n\t\tprogress: \"progress\",\n\t\tmove: \"move\",\n\t\tignore: \"ignore\"\n\t};\n\tround_dnd_dates: boolean;\n\tlink_wrapper_width: number;\n\troot_id: string | number;\n\n\tlink_arrow_size:number;\n\n\tautofit: boolean;\n\tcolumns: IColumnItem[];\n\n\t/* scale*/\n\t/* it will be deprecated */\n\tdate_scale?: string;\n\tstep?: number;\n\tscale_unit?: DurationUnits;\n\tsubscales?: IScale[];\n\t/* it will be deprecated end */\n\n\tscales: IScale[];\n\n\tscale_offset_minimal: boolean;\n\n\tinherit_scale_class: boolean;\n\n\n\ttime_step: number;\n\tduration_step: number;\n\n\n\ttask_date: string;\n\ttime_picker: string;\n\ttask_attribute: string;\n\tlink_attribute: string;\n\tlayer_attribute: string;\n\tbuttons_left: string[];\n\t_migrate_buttons: {\n\t\tdhx_save_btn: \"gantt_save_btn\",\n\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\n\t\tdhx_delete_btn: \"gantt_delete_btn\"\n\t};\n\n\tbuttons_right: string[];\n\n\n\tlightbox: {\n\t\tsections?: LightboxSection,\n\t\tproject_sections?: LightboxSection,\n\t\tmilestone_sections?: LightboxSection\n\t};\n\tdrag_lightbox: boolean;\n\tsort: boolean;\n\tdetails_on_create: boolean;\n\tdetails_on_dblclick: boolean;\n\tinitial_scroll: boolean;\n\ttask_scroll_offset: number;\n\n\torder_branch: boolean;\n\torder_branch_free: boolean;\n\n\t// task_height is deprecated, use 'bar_height` instead\n\ttask_height: number | \"full\" | undefined;\n\tbar_height: number | \"full\";\n\tmin_column_width: number;\n\tbar_height_padding: number,\n\trow_height: number,\n\n\t// min width for grid column (when resizing)\n\tmin_grid_column_width: number;\n\t// name of the attribute with column index for resize element\n\tgrid_resizer_column_attribute: string;\n\t// name of the attribute with column index for resize element\n\t// grid_resizer_attribute: string; // usage of this parameter is not found\n\n\t// grid width can be increased after the column has been resized\n\tkeep_grid_width: boolean;\n\n\t// grid width can be adjusted\n\tgrid_resize: boolean;\n\tgrid_elastic_columns: boolean;\n\tshow_tasks_outside_timescale: boolean;\n\tshow_unscheduled: boolean;\n\treadonly_property: string;\n\teditable_property: string;\n\tcalendar_property: string;\n\tresource_calendars: object;\n\tdynamic_resource_calendars: boolean;\n\tinherit_calendar: boolean;\n\ttype_renderers: object;\n\n\tresize_rows: boolean;\n\t// name of the attribute with row index for resize element\n\ttask_grid_row_resizer_attribute: string;\n\t// min height for row (when resizing)\n\tmin_task_grid_row_height: number;\n\n\topen_tree_initially: boolean;\n\toptimize_render: boolean;\n\tprevent_default_scroll: boolean;\n\tshow_errors: boolean;\n\twai_aria_attributes: boolean;\n\tsmart_scales: boolean;\n\trtl: boolean;\n\tplaceholder_task: boolean | object;\n\thorizontal_scroll_key: TModifierKeys;\n\tdrag_timeline: {\n\t\tuseKey: TModifierKeys;\n\t\tignore: string;\n\t\trender?: boolean;\n\t};\n\tdrag_multiple: boolean;\n\tcsp: TCsp;\n\n\tresources?: IResourceConfig;\n}\n\nexport default () => {\n\tconst result: IGanttConfig = {\n\t\tlayout: {\n\t\t\tcss: \"gantt_container\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{view: \"grid\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\n\t\t\t\t\t\t{resizer: true, width: 1},\n\t\t\t\t\t\t{view: \"timeline\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\n\t\t\t\t\t\t{view: \"scrollbar\", id: \"scrollVer\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{view: \"scrollbar\", id: \"scrollHor\", height: 20}\n\t\t\t]\n\t\t},\n\t\tlinks: {\n\t\t\tfinish_to_start: \"0\",\n\t\t\tstart_to_start: \"1\",\n\t\t\tfinish_to_finish: \"2\",\n\t\t\tstart_to_finish: \"3\"\n\t\t},\n\t\ttypes: {\n\t\t\ttask: \"task\",\n\t\t\tproject: \"project\",\n\t\t\tmilestone: \"milestone\"\n\t\t},\n\t\tauto_types: false,\n\t\tduration_unit: \"day\",\n\t\twork_time: false,\n\t\tcorrect_work_time: false,\n\t\tskip_off_time: false,\n\n\t\tcascade_delete: true,\n\n\t\tautosize: false,\n\t\tautosize_min_width: 0,\n\t\tautoscroll: true,\n\t\tautoscroll_speed: 30,\n\t\tdeepcopy_on_parse: false,\n\t\tshow_links: true,\n\t\tshow_task_cells: true,\n\t\t// replace backgroung of the task area with a canvas img\n\t\tstatic_background: false,\n\t\tstatic_background_cells: true,\n\t\tbranch_loading: false,\n\t\tbranch_loading_property: \"$has_child\",\n\t\tshow_loading: false,\n\t\tshow_chart: true,\n\t\tshow_grid: true,\n\t\tmin_duration: 60 * 60 * 1000,\n\t\tdate_format: \"%d-%m-%Y %H:%i\", // use instead xml_date\n\t\txml_date: undefined, // \"%d-%m-%Y %H:%i\", // deprecated\n\t\tstart_on_monday: true,\n\t\tserver_utc: false,\n\t\tshow_progress: true,\n\t\tfit_tasks: false,\n\t\tselect_task: true,\n\t\tscroll_on_click: true,\n\t\tsmart_rendering: true,\n\t\tpreserve_scroll: true,\n\t\treadonly: false,\n\t\tcontainer_resize_timeout: 20,\n\t\tdeadlines: true,\n\n\t\t/*grid */\n\t\tdate_grid: \"%Y-%m-%d\",\n\n\t\tdrag_links: true,\n\t\tdrag_progress: true,\n\t\tdrag_resize: true,\n\t\tdrag_project: false,\n\t\tdrag_move: true,\n\t\tdrag_mode: {\n\t\t\tresize: \"resize\",\n\t\t\tprogress: \"progress\",\n\t\t\tmove: \"move\",\n\t\t\tignore: \"ignore\"\n\t\t},\n\t\tround_dnd_dates: true,\n\t\tlink_wrapper_width: 20,\n\t\tlink_arrow_size:12,\n\t\troot_id: 0,\n\n\t\tautofit: false, // grid column automatic fit grid_width config\n\t\tcolumns: [\n\t\t\t{name: \"text\", tree: true, width: \"*\", resize: true},\n\t\t\t{name: \"start_date\", align: \"center\", resize: true},\n\t\t\t{name: \"duration\", align: \"center\"},\n\t\t\t{name: \"add\", width: 44}\n\t\t],\n\n\t\t/*scale*/\n\n\t\tscale_offset_minimal: true,\n\t\tinherit_scale_class: false,\n\n\t\tscales: [\n\t\t\t{\n\t\t\t\tunit: \"day\",\n\t\t\t\tstep: 1,\n\t\t\t\tdate: \"%d %M\"\n\t\t\t}\n\t\t],\n// \t\tdate_scale: \"%d %M\",\n\n\t\ttime_step: 60,\n\t\tduration_step: 1,\n\t\ttask_date: \"%d %F %Y\",\n\t\ttime_picker: \"%H:%i\",\n\t\ttask_attribute: \"data-task-id\",\n\t\tlink_attribute: \"data-link-id\",\n\t\tlayer_attribute: \"data-layer\",\n\t\tbuttons_left: [\n\t\t\t\"gantt_save_btn\",\n\t\t\t\"gantt_cancel_btn\"\n\t\t],\n\t\t_migrate_buttons: {\n\t\t\tdhx_save_btn: \"gantt_save_btn\",\n\t\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\n\t\t\tdhx_delete_btn: \"gantt_delete_btn\"\n\t\t},\n\t\tbuttons_right: [\n\t\t\t\"gantt_delete_btn\"\n\t\t],\n\t\tlightbox: {\n\t\t\tsections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"time\", type: \"duration\", map_to: \"auto\"}\n\t\t\t],\n\t\t\tproject_sections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\n\t\t\t\t{name: \"time\", type: \"duration\", readonly: true, map_to: \"auto\"}\n\t\t\t],\n\t\t\tmilestone_sections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\n\t\t\t\t{name: \"time\", type: \"duration\", single_date: true, map_to: \"auto\"}\n\t\t\t]\n\t\t},\n\t\tdrag_lightbox: true,\n\t\tsort: false,\n\t\tdetails_on_create: true,\n\t\tdetails_on_dblclick: true,\n\t\tinitial_scroll: true,\n\t\ttask_scroll_offset: 100,\n\n\t\torder_branch: false,\n\t\torder_branch_free: false,\n\n\t\t// task height is deprecated, use 'bar_height' instead\n\t\ttask_height: undefined,// number px of 'full' for row height\n\t\tbar_height: \"full\",\n\t\tbar_height_padding:9,\n\t\tmin_column_width: 70,\n\n\t\t// min width for grid column (when resizing)\n\t\tmin_grid_column_width: 70,\n\t\t// name of the attribute with column index for resize element\n\t\tgrid_resizer_column_attribute: \"data-column-index\",\n\t\t// name of the attribute with column index for resize element\n\t\t// grid_resizer_attribute: \"grid_resizer\", // - usage of this parameter is not found in code\n\n\t\t// grid width can be increased after the column has been resized\n\t\tkeep_grid_width: false,\n\n\t\t// grid width can be adjusted\n\t\tgrid_resize: false,\n\t\tgrid_elastic_columns: false,\n\t\tshow_tasks_outside_timescale: false,\n\t\tshow_unscheduled: true,\n\n\t\tresize_rows: false,\n\t\t// name of the attribute with row index for resize element\n\t\ttask_grid_row_resizer_attribute: \"data-row-index\",\n\t\t// min height for row (when resizing)\n\t\tmin_task_grid_row_height: 30,\n\t\trow_height: 36,\n\n\t\t//\n\t\treadonly_property: \"readonly\",\n\t\teditable_property: \"editable\",\n\t\tcalendar_property: \"calendar_id\",\n\t\tresource_calendars: {},\n\t\tdynamic_resource_calendars: false,\n\t\tinherit_calendar: false,\n\t\ttype_renderers: {},\n\n\t\topen_tree_initially: false,\n\t\toptimize_render: true,\n\t\tprevent_default_scroll: false,\n\t\tshow_errors: true,\n\t\twai_aria_attributes: true,\n\t\tsmart_scales: true,\n\t\trtl:false,\n\t\tplaceholder_task: false,\n\t\thorizontal_scroll_key: \"shiftKey\",\n\t\tdrag_timeline: {\n\t\t\tuseKey: undefined,\n\t\t\tignore: \".gantt_task_line, .gantt_task_link\",\n\t\t\trender: false\n\t\t},\n\t\tdrag_multiple: true,\n\t\tcsp: \"auto\"\n\t};\n\treturn result;\n};\n","/* eslint-disable no-restricted-globals */\nvar isWindowAwailable = typeof window !== \"undefined\";\n\n/* eslint-enable no-restricted-globals */\n\nexport default {\n\tisIE: isWindowAwailable && (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0),\n\tisIE6: isWindowAwailable && (!XMLHttpRequest && navigator.userAgent.indexOf(\"MSIE\") >= 0),\n\tisIE7: isWindowAwailable && (navigator.userAgent.indexOf(\"MSIE 7.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") < 0),\n\tisIE8: isWindowAwailable && (navigator.userAgent.indexOf(\"MSIE 8.0\") >= 0 && navigator.userAgent.indexOf(\"Trident\") >= 0),\n\tisOpera: isWindowAwailable && (navigator.userAgent.indexOf(\"Opera\") >= 0),\n\tisChrome: isWindowAwailable && (navigator.userAgent.indexOf(\"Chrome\") >= 0),\n\tisKHTML: isWindowAwailable && (navigator.userAgent.indexOf(\"Safari\") >= 0 || navigator.userAgent.indexOf(\"Konqueror\") >= 0),\n\tisFF: isWindowAwailable && (navigator.userAgent.indexOf(\"Firefox\") >= 0),\n\tisIPad: isWindowAwailable && (navigator.userAgent.search(/iPad/gi) >= 0),\n\tisEdge: isWindowAwailable && (navigator.userAgent.indexOf(\"Edge\")!=-1),\n\tisNode: (!isWindowAwailable || typeof navigator == \"undefined\" || (typeof PRODUCTION !== \"undefined\" && PRODUCTION === \"test\"))\n};\n","export default function serialize(data: object | string) {\n\tif (typeof data === \"string\" || typeof data === \"number\") {\n\t\treturn data;\n\t}\n\n\tlet result = \"\";\n\n\tfor (const key in data) {\n\t\tlet serialized = \"\";\n\t\tif (data.hasOwnProperty(key)) {\n\t\t\tif (typeof data[key] === \"string\") {\n\t\t\t\tserialized = encodeURIComponent(data[key]);\n\t\t\t} else if (typeof data[key] === \"number\") {\n\t\t\t\tserialized = String(data[key]);\n\t\t\t} else {\n\t\t\t\tserialized = encodeURIComponent(JSON.stringify(data[key]));\n\t\t\t}\n\t\t\tserialized = key + \"=\" + serialized;\n\n\t\t\tif (result.length) {\n\t\t\t\tserialized = \"&\" + serialized;\n\t\t\t}\n\t\t\tresult += serialized;\n\t\t}\n\t}\n\treturn result;\n}\n","import env from \"../../utils/env\";\nimport global from \"../../utils/global\";\nimport serialize from \"./serialize\";\n\nfunction createConfig(method, args) {\n\tvar result = {\n\t\tmethod: method\n\t};\n\n\tif (args.length === 0) {\n\t\tthrow new Error(\"Arguments list of query is wrong.\");\n\t}\n\tif (args.length === 1) {\n\t\tif (typeof args[0] === \"string\") {\n\t\t\tresult.url = args[0];\n\t\t\tresult.async = true;\n\t\t} else {\n\t\t\tresult.url = args[0].url;\n\t\t\tresult.async = (args[0].async || true);\n\t\t\tresult.callback = args[0].callback;\n\t\t\tresult.headers = args[0].headers;\n\t\t}\n\t\tif (method === \"POST\" || \"PUT\") {\n\t\t\tif (args[0].data) {\n\t\t\t\tif (typeof args[0].data !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[0].data);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[0].data;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tresult.url = args[0];\n\tswitch(method) {\n\t\tcase \"GET\":\n\t\tcase \"DELETE\":\n\t\t\tresult.callback = args[1];\n\t\t\tresult.headers = args[2];\n\t\tbreak;\n\t\tcase \"POST\":\n\t\tcase \"PUT\":\n\t\t\tif (args[1]) {\n\t\t\t\tif (typeof args[1] !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[1]);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[1];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t\tresult.callback = args[2];\n\t\t\tresult.headers = args[3];\n\t\tbreak;\n\t}\n\treturn result;\n}\n\nexport default function(gantt) {\n\treturn {\n\n\t\t// if false - dhxr param will added to prevent caching on client side (default),\n\t\t// if true - do not add extra params\n\t\tcache: true,\n\n\t\t// default method for load/loadStruct, post/get allowed\n\t\t// get - since 4.1.1, this should fix 412 error for macos safari\n\t\tmethod: \"get\",\n\n\t\tparse: function(data) {\n\t\t\tif (typeof data !== \"string\") return data;\n\n\t\t\tvar obj;\n\t\t\tdata = data.replace(/^[\\s]+/,\"\");\n\t\t\tif (typeof DOMParser !== \"undefined\" && !env.isIE) { // ff,ie9\n\t\t\t\tobj = (new DOMParser()).parseFromString(data, \"text/xml\");\n\t\t\t} else if (typeof global.ActiveXObject !== \"undefined\") {\n\t\t\t\tobj = new global.ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\t\tobj.async = \"false\";\n\t\t\t\tobj.loadXML(data);\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\t\txmltop: function(tagname, xhr, obj) {\n\t\t\tif (typeof xhr.status == \"undefined\" || xhr.status < 400) {\n\t\t\t\tvar xml = (!xhr.responseXML) ? this.parse(xhr.responseText || xhr) : (xhr.responseXML || xhr);\n\t\t\t\tif (xml && xml.documentElement !== null && !xml.getElementsByTagName(\"parsererror\").length) {\n\t\t\t\t\treturn xml.getElementsByTagName(tagname)[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (obj !== -1) gantt.callEvent(\"onLoadXMLError\",[\"Incorrect XML\", arguments[1], obj]);\n\t\t\treturn document.createElement(\"DIV\");\n\t\t},\n\t\txpath: function(xpathExp, docObj) {\n\t\t\tif (!docObj.nodeName) docObj = docObj.responseXML || docObj;\n\t\t\tif (env.isIE) {\n\t\t\t\treturn docObj.selectNodes(xpathExp)||[];\n\t\t\t} else {\n\t\t\t\tvar rows = [];\n\t\t\t\tvar first;\n\t\t\t\tvar col = (docObj.ownerDocument||docObj).evaluate(xpathExp, docObj, null, XPathResult.ANY_TYPE, null);\n\n\t\t\t\twhile (true){\n\t\t\t\t\tfirst = col.iterateNext();\n\t\t\t\t\tif(first){\n\t\t\t\t\t\trows.push(first);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn rows;\n\t\t\t}\n\t\t},\n\t\tquery: function(config) {\n\t\t\treturn this._call(\n\t\t\t\t(config.method || \"GET\"),\n\t\t\t\tconfig.url,\n\t\t\t\tconfig.data || \"\",\n\t\t\t\t(config.async || true),\n\t\t\t\tconfig.callback,\n\t\t\t\tconfig.headers\n\t\t\t);\n\t\t},\n\t\tget: function(url, onLoad, headers) {\n\t\t\tvar config = createConfig(\"GET\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tgetSync: function(url, headers) {\n\t\t\tvar config = createConfig(\"GET\", arguments);\n\t\t\tconfig.async = false;\n\t\t\treturn this.query(config);\n\t\t},\n\t\tput: function(url, postData, onLoad, headers) {\n\t\t\tvar config = createConfig(\"PUT\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tdel: function(url, onLoad, headers) {\n\t\t\t/**\n\t\t\t * https://tools.ietf.org/html/rfc7231#section-4.3.5\n\t\t\t * A payload within a DELETE request message has no defined semantics;\n\t\t\t * sending a payload body on a DELETE request might cause some existing\n\t\t\t * implementations to reject the request.\n\t\t\t */\n\t\t\tvar config = createConfig(\"DELETE\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tpost: function(url, postData, onLoad, headers) {\n\t\t\tif (arguments.length == 1) {\n\t\t\t\tpostData = \"\";\n\t\t\t} else if (arguments.length == 2 && typeof(postData) == \"function\") {\n\t\t\t\tonLoad = postData;\n\t\t\t\tpostData = \"\";\n\t\t\t}\n\t\t\tvar config = createConfig(\"POST\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tpostSync: function(url, postData, headers) {\n\t\t\tpostData = (postData === null ? \"\" : String(postData));\n\n\t\t\tvar config = createConfig(\"POST\", arguments);\n\t\t\tconfig.async = false;\n\t\t\treturn this.query(config);\n\t\t},\n\t\t_call: function(method, url, postData, async, onLoad, headers) {\n\t\t\treturn new gantt.Promise(function(resolve, reject) {\n\t\t\t\tvar t = (typeof XMLHttpRequest !== undefined ? new XMLHttpRequest() : new global.ActiveXObject(\"Microsoft.XMLHTTP\"));\n\t\t\t\tvar isQt = (navigator.userAgent.match(/AppleWebKit/) !== null && navigator.userAgent.match(/Qt/) !== null && navigator.userAgent.match(/Safari/) !== null);\n\n\t\t\t\tif (!!async) {\n\t\t\t\t\tt.onreadystatechange = function() {\n\t\t\t\t\t\tif ((t.readyState == 4) || (isQt && t.readyState == 3)) { // what for long response and status 404?\n\t\t\t\t\t\t\tif (t.status != 200 || t.responseText === \"\")\n\t\t\t\t\t\t\t\tif (!gantt.callEvent(\"onAjaxError\", [t])) return;\n\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\t\tonLoad.apply(global, [{xmlDoc:t, filePath:url}]); // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresolve(t);\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\t\tonLoad = null;\n\t\t\t\t\t\t\t\t\tt = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar noCache = !this || !this.cache;\n\t\t\t\tif (method == \"GET\" && noCache) {\n\t\t\t\t\turl += (url.indexOf(\"?\")>=0?\"&\":\"?\")+\"dhxr\"+new Date().getTime()+\"=1\";\n\t\t\t\t}\n\n\t\t\t\tt.open(method, url, async);\n\n\t\t\t\tif (headers){\n\t\t\t\t\tfor (var key in headers)\n\t\t\t\t\t\tt.setRequestHeader(key, headers[key]);\n\t\t\t\t} else if (method.toUpperCase() == \"POST\" || method == \"PUT\" || method == \"DELETE\") {\n\t\t\t\t\tt.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\t\t\t\t} else if (method == \"GET\") {\n\t\t\t\t\tpostData = null;\n\t\t\t\t}\n\n\t\t\t\tt.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\n\t\t\t\tt.send(postData);\n\n\t\t\t\tif (!async) return {xmlDoc:t, filePath:url}; // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t});\n\t\t},\n\t\turlSeparator: function(str){\n\t\t\tif (str.indexOf(\"?\") != -1)\n\t\t\t\treturn \"&\";\n\t\t\telse\n\t\t\t\treturn \"?\";\n\t\t}\n\t};\n};\n","const dateToStr = (format: string, utc: boolean, gantt) => {\n\tformat = format.replace(/%[a-zA-Z]/g, (a) => {\n\t\tswitch (a) {\n\t\t\tcase \"%d\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Date())+\"`;\n\t\t\tcase \"%m\":\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Month()+1))+\"`;\n\t\t\tcase \"%j\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Date()+\"`;\n\t\t\tcase \"%n\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Month()+1)+\"`;\n\t\t\tcase \"%y\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}FullYear()%100)+\"`;\n\t\t\tcase \"%Y\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}FullYear()+\"`;\n\t\t\tcase \"%D\":\n\t\t\t\treturn `\"+locale.date.day_short[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\n\t\t\tcase \"%l\":\n\t\t\t\treturn `\"+locale.date.day_full[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\n\t\t\tcase \"%M\":\n\t\t\t\treturn `\"+locale.date.month_short[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\n\t\t\tcase \"%F\":\n\t\t\t\treturn `\"+locale.date.month_full[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\n\t\t\tcase \"%h\":\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\n\t\t\tcase \"%g\":\n\t\t\t\treturn `\"+((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\n\t\t\tcase \"%G\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Hours()+\"`;\n\t\t\tcase \"%H\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Hours())+\"`;\n\t\t\tcase \"%i\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Minutes())+\"`;\n\t\t\tcase \"%a\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"pm\":\"am\")+\"`;\n\t\t\tcase \"%A\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"PM\":\"AM\")+\"`;\n\t\t\tcase \"%s\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Seconds())+\"`;\n\t\t\tcase \"%W\":\n\t\t\t\treturn `\"+to_fixed(getISOWeek(date))+\"`;\n\t\t\tcase \"%w\":\n\t\t\t\treturn `\"+to_fixed(getWeek(date))+\"`;\n\t\t\tdefault:\n\t\t\t\treturn a;\n\t\t}\n\t});\n\n\t// tslint:disable-next-line: function-constructor\n\tconst dateToStrFn = new Function(\"date\", \"to_fixed\", \"locale\", \"getISOWeek\", \"getWeek\", `return \"${format}\";`);\n\n\treturn (date: Date) => {\n\t\treturn dateToStrFn(date, gantt.date.to_fixed, gantt.locale, gantt.date.getISOWeek, gantt.date.getWeek);\n\t};\n};\n\n\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\n\tlet splt = \"var temp=date.match(/[a-zA-Z]+|[0-9]+/g);\";\n\tconst mask = format.match(/%[a-zA-Z]/g);\n\tfor (let i = 0; i < mask.length; i++) {\n\t\tswitch (mask[i]) {\n\t\t\tcase \"%j\":\n\t\t\tcase \"%d\":\n\t\t\t\tsplt += `set[2]=temp[${i}]||1;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%n\":\n\t\t\tcase \"%m\":\n\t\t\t\tsplt += `set[1]=(temp[${i}]||1)-1;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%y\":\n\t\t\t\tsplt += `set[0]=temp[${i}]*1+(temp[${i}]>50?1900:2000);`;\n\t\t\t\tbreak;\n\t\t\tcase \"%g\":\n\t\t\tcase \"%G\":\n\t\t\tcase \"%h\":\n\t\t\tcase \"%H\":\n\t\t\t\tsplt += `set[3]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%i\":\n\t\t\t\tsplt += `set[4]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%Y\":\n\t\t\t\tsplt += `set[0]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%a\":\n\t\t\tcase \"%A\":\n\t\t\t\tsplt += `set[3]=set[3]%12+((temp[${i}]||'').toLowerCase()=='am'?0:12);`;\n\t\t\t\tbreak;\n\t\t\tcase \"%s\":\n\t\t\t\tsplt += `set[5]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%M\":\n\t\t\t\tsplt += `set[1]=locale.date.month_short_hash[temp[${i}]]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%F\":\n\t\t\t\tsplt += `set[1]=locale.date.month_full_hash[temp[${i}]]||0;`;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tlet code = \"set[0],set[1],set[2],set[3],set[4],set[5]\";\n\tif (utc) { code = ` Date.UTC(${code})`; }\n\t// tslint:disable-next-line: function-constructor\n\tconst strToDateFn = new Function(\"date\", \"locale\", `var set=[0,0,1,0,0,0]; ${splt} return new Date(${code});`);\n\n\treturn (dateString) => {\n\t\treturn strToDateFn(dateString, gantt.locale);\n\t};\n};\n\nconst fastVersion = {\n\tdate_to_str: dateToStr,\n\tstr_to_date: strToDate\n};\n\nexport default fastVersion;","const dateToStr = (format: string, utc: boolean, gantt) => {\n\treturn (date) => {\n\t\treturn format.replace(/%[a-zA-Z]/g, (a) => {\n\t\t\tswitch (a) {\n\t\t\t\tcase \"%d\": return utc ? gantt.date.to_fixed(date.getUTCDate()) : gantt.date.to_fixed(date.getDate());\n\t\t\t\tcase \"%m\": return utc ? gantt.date.to_fixed((date.getUTCMonth() + 1)) : gantt.date.to_fixed((date.getMonth() + 1));\n\t\t\t\tcase \"%j\": return utc ? date.getUTCDate() : date.getDate();\n\t\t\t\tcase \"%n\": return utc ? (date.getUTCMonth() + 1) : (date.getMonth() + 1);\n\t\t\t\tcase \"%y\": return utc ? gantt.date.to_fixed(date.getUTCFullYear() % 100) : gantt.date.to_fixed(date.getFullYear() % 100);\n\t\t\t\tcase \"%Y\": return utc ? date.getUTCFullYear() : date.getFullYear();\n\t\t\t\tcase \"%D\": return utc ? gantt.locale.date.day_short[date.getUTCDay()] : gantt.locale.date.day_short[date.getDay()];\n\t\t\t\tcase \"%l\": return utc ? gantt.locale.date.day_full[date.getUTCDay()] : gantt.locale.date.day_full[date.getDay()];\n\t\t\t\tcase \"%M\": return utc ? gantt.locale.date.month_short[date.getUTCMonth()] : gantt.locale.date.month_short[date.getMonth()];\n\t\t\t\tcase \"%F\": return utc ? gantt.locale.date.month_full[date.getUTCMonth()] : gantt.locale.date.month_full[date.getMonth()];\n\t\t\t\tcase \"%h\": return utc ? gantt.date.to_fixed((date.getUTCHours() + 11) % 12 + 1) : gantt.date.to_fixed((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%g\": return utc ? ((date.getUTCHours() + 11) % 12 + 1) : ((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%G\": return utc ? date.getUTCHours() : date.getHours();\n\t\t\t\tcase \"%H\": return utc ? gantt.date.to_fixed(date.getUTCHours()) : gantt.date.to_fixed(date.getHours());\n\t\t\t\tcase \"%i\": return utc ? gantt.date.to_fixed(date.getUTCMinutes()) : gantt.date.to_fixed(date.getMinutes());\n\t\t\t\tcase \"%a\": return utc ? (date.getUTCHours() > 11 ? \"pm\" : \"am\") : (date.getHours() > 11 ? \"pm\" : \"am\");\n\t\t\t\tcase \"%A\": return utc ? (date.getUTCHours() > 11 ? \"PM\" : \"AM\") : (date.getHours() > 11 ? \"PM\" : \"AM\");\n\t\t\t\tcase \"%s\": return utc ? gantt.date.to_fixed(date.getUTCSeconds()) : gantt.date.to_fixed(date.getSeconds());\n\t\t\t\tcase \"%W\": return utc ? gantt.date.to_fixed(gantt.date.getUTCISOWeek(date)) : gantt.date.to_fixed(gantt.date.getISOWeek(date));\n\t\t\t\tdefault: return a;\n\t\t\t}\n\t\t});\n\t};\n};\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\n\treturn (date: string) => {\n\t\tconst set: Array<string|number> = [0, 0, 1, 0, 0, 0];\n\t\tconst temp = date.match(/[a-zA-Z]+|[0-9]+/g);\n\t\tconst mask = format.match(/%[a-zA-Z]/g);\n\n\t\tfor (let i = 0; i < mask.length; i++) {\n\t\t\tswitch (mask[i]) {\n\t\t\t\tcase \"%j\":\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tset[2] = temp[i] as unknown as number || 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%n\":\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tset[1] = (temp[i] as unknown as number || 1) - 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%y\":\n\t\t\t\t\tset[0] = temp[i] as unknown as number * 1 + ((temp[i] as unknown as number) > 50 ? 1900 : 2000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%g\":\n\t\t\t\tcase \"%G\":\n\t\t\t\tcase \"%h\":\n\t\t\t\tcase \"%H\":\n\t\t\t\t\tset[3] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%i\":\n\t\t\t\t\tset[4] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tset[0] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%a\":\n\t\t\t\tcase \"%A\":\n\t\t\t\t\tset[3] = set[3] as number % 12 + ((temp[i] || \"\").toLowerCase() === \"am\" ? 0 : 12);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%s\":\n\t\t\t\t\tset[5] = temp[i] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%M\":\n\t\t\t\t\tset[1] = gantt.locale.date.month_short_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%F\":\n\t\t\t\t\tset[1] = gantt.locale.date.month_full_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (utc) {\n\t\t\treturn new Date(Date.UTC(\n\t\t\t\tset[0] as number,\n\t\t\t\tset[1] as number,\n\t\t\t\tset[2] as number,\n\t\t\t\tset[3] as number,\n\t\t\t\tset[4] as number,\n\t\t\t\tset[5] as number\n\t\t\t));\n\t\t}\n\t\treturn new Date(\n\t\t\tset[0] as number,\n\t\t\tset[1] as number,\n\t\t\tset[2] as number,\n\t\t\tset[3] as number,\n\t\t\tset[4] as number,\n\t\t\tset[5] as number\n\t\t);\n\t};\n\n};\n\n\nconst cspVersion = {\n\tdate_to_str: dateToStr,\n\tstr_to_date: strToDate\n};\n\nexport default cspVersion;","/*\n %d - the day as a number with a leading zero ( 01 to 31 );\n %j - the day as a number without a leading zero ( 1 to 31 );\n %D - the day as an abbreviation ( Sun to Sat );\n %l - the day as a full name ( Sunday to Saturday );\n %W - the ISO-8601 week number of the year. Weeks start on Monday; 1)\n %m - the month as a number without a leading zero ( 1 to 12 );\n %n - the month as a number with a leading zero ( 01 to 12);\n %M - the month as an abbreviation ( Jan to Dec );\n %F - the month as a full name ( January to December );\n %y - the year as a two-digit number ( 00 to 99 );\n %Y - the year as a four-digit number ( 1900–9999 );\n %h - the hour based on the 12-hour clock ( 00 to 11 );\n %H - the hour based on the 24-hour clock ( 00 to 23 );\n %i - the minute as a number with a leading zero ( 00 to 59 );\n %s - the second as a number without a leading zero ( 00 to 59 ); 2)\n %a - displays am (for times from midnight until noon) and pm (for times from noon until midnight);\n %A - displays AM (for times from midnight until noon) and PM (for times from noon until midnight).\n*/\n\nimport fastVersion from \"./date_parsers/fast_version\";\nimport cspCompliantVersion from \"./date_parsers/csp_compliant_version\";\n\nexport default function(gantt) {\n\tvar canUseCsp = null;\n\tfunction cspAutoCheck() {\n\t\ttry {\n\t\t\tnew Function(\"canUseCsp = false;\");\n\t\t} catch(e) {\n\t\t\tcanUseCsp = true;\n\t\t}\n\t}\n\tfunction useCsp() {\n\t\tvar result = false;\n\t\tif (gantt.config.csp === \"auto\") {\n\t\t\tif(canUseCsp === null) {\n\t\t\t\tcspAutoCheck();\n\t\t\t}\n\t\t\tresult = canUseCsp;\n\t\t} else {\n\t\t\tresult = gantt.config.csp;\n\t\t}\n\t\treturn result;\n\t}\n\n\tvar dateHelper = {\n\t\tinit: function () {\n\t\t\tvar locale = gantt.locale;\n\n\t\t\tvar s = locale.date.month_short;\n\t\t\tvar t = locale.date.month_short_hash = {};\n\t\t\tfor (var i = 0; i < s.length; i++)\n\t\t\t\tt[s[i]] = i;\n\n\t\t\tvar s = locale.date.month_full;\n\t\t\tvar t = locale.date.month_full_hash = {};\n\t\t\tfor (var i = 0; i < s.length; i++)\n\t\t\t\tt[s[i]] = i;\n\t\t},\n\t\tdate_part: function (date) {\n\t\t\tvar old = new Date(date);\n\t\t\tdate.setHours(0);\n\t\t\tthis.hour_start(date);\n\t\t\tif (date.getHours() && //shift to yesterday on dst\n\t\t\t\t(date.getDate() < old.getDate() || date.getMonth() < old.getMonth() || date.getFullYear() < old.getFullYear()))\n\t\t\t\tdate.setTime(date.getTime() + 60 * 60 * 1000 * (24 - date.getHours()));\n\t\t\treturn date;\n\t\t},\n\t\ttime_part: function (date) {\n\t\t\treturn (date.valueOf() / 1000 - date.getTimezoneOffset() * 60) % 86400;\n\t\t},\n\t\tweek_start: function (date) {\n\t\t\tvar shift = date.getDay();\n\t\t\tif (gantt.config.start_on_monday) {\n\t\t\t\tif (shift === 0) shift = 6;\n\t\t\t\telse shift--;\n\t\t\t}\n\t\t\treturn this.date_part(this.add(date, -1 * shift, \"day\"));\n\t\t},\n\t\tmonth_start: function (date) {\n\t\t\tdate.setDate(1);\n\t\t\treturn this.date_part(date);\n\t\t},\n\t\tquarter_start: function (date) {\n\t\t\tthis.month_start(date);\n\t\t\tvar m = date.getMonth(),\n\t\t\t\tres_month;\n\n\t\t\tif (m >= 9) {\n\t\t\t\tres_month = 9;\n\t\t\t} else if (m >= 6) {\n\t\t\t\tres_month = 6;\n\t\t\t} else if (m >= 3) {\n\t\t\t\tres_month = 3;\n\t\t\t} else {\n\t\t\t\tres_month = 0;\n\t\t\t}\n\n\t\t\tdate.setMonth(res_month);\n\t\t\treturn date;\n\t\t},\n\t\tyear_start: function (date) {\n\t\t\tdate.setMonth(0);\n\t\t\treturn this.month_start(date);\n\t\t},\n\t\tday_start: function (date) {\n\t\t\treturn this.date_part(date);\n\t\t},\n\t\thour_start: function (date) {\n\t\t\tif (date.getMinutes())\n\t\t\t\tdate.setMinutes(0);\n\t\t\tthis.minute_start(date);\n\n\t\t\treturn date;\n\t\t},\n\t\tminute_start: function (date) {\n\t\t\tif (date.getSeconds())\n\t\t\t\tdate.setSeconds(0);\n\t\t\tif (date.getMilliseconds())\n\t\t\t\tdate.setMilliseconds(0);\n\t\t\treturn date;\n\t\t},\n\t\t_add_days: function (modifiedDate, inc, originalDate) {\n\n\t\t\tmodifiedDate.setDate(modifiedDate.getDate() + inc);\n\t\t\tvar incCondition = inc >= 0;\n\t\t\tvar getHoursCondition = !originalDate.getHours() && modifiedDate.getHours(); //shift to yesterday on dst\n\t\t\tvar getDateCondition = (modifiedDate.getDate() <= originalDate.getDate() || modifiedDate.getMonth() < originalDate.getMonth() || modifiedDate.getFullYear() < originalDate.getFullYear());\n\t\t\tif (incCondition && getHoursCondition && getDateCondition){\n\t\t\t\tmodifiedDate.setTime(modifiedDate.getTime() + 60 * 60 * 1000 * (24 - modifiedDate.getHours()));\n\t\t\t}\n\t\t\tvar worktimeCalculation = inc > 1;\n\t\t\tif (worktimeCalculation && getHoursCondition){\n\t\t\t\t// try to shift the modified Date to 00:00\n\t\t\t\tmodifiedDate.setHours(0);\n\t\t\t}\n\t\t\treturn modifiedDate;\n\t\t},\n\n\t\tadd: function (date, inc, mode) {\n\t\t\t/*jsl:ignore*/\n\t\t\tvar ndate = new Date(date.valueOf());\n\t\t\tswitch (mode) {\n\t\t\t\tcase \"day\":\n\t\t\t\t\tndate = this._add_days(ndate, inc, date);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"week\":\n\t\t\t\t\tndate = this._add_days(ndate, inc * 7, date);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"month\":\n\t\t\t\t\tndate.setMonth(ndate.getMonth() + inc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"year\":\n\t\t\t\t\tndate.setYear(ndate.getFullYear() + inc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hour\":\n\t\t\t\t\t/*\n\t\t\t\t\t\tadding hours/minutes via setHour(getHour() + inc) gives weird result when\n\t\t\t\t\t\tadding one hour to the time before switch to a Daylight Saving time\n\n\t\t\t\t\t\texample: //Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\n\t\t\t\t\t\tnew Date(2014, 02, 30, 1).setHours(2)\n\t\t\t\t\t\t>>Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\n\n\t\t\t\t\t\tsetTime seems working as expected\n\t\t\t\t\t */\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 60 * 1000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"minute\":\n\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 1000);\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn this[\"add_\" + mode](date, inc, mode);\n\t\t\t}\n\t\t\treturn ndate;\n\t\t\t/*jsl:end*/\n\t\t},\n\t\tadd_quarter: function (date, inc) {\n\t\t\treturn this.add(date, inc * 3, \"month\");\n\t\t},\n\n\t\tto_fixed: function (num) {\n\t\t\tif (num < 10) return \"0\" + num;\n\t\t\treturn num;\n\t\t},\n\t\tcopy: function (date) {\n\t\t\treturn new Date(date.valueOf());\n\t\t},\n\t\tdate_to_str: function (format, utc) {\n\t\t\tvar result = fastVersion;\n\t\t\tif (useCsp()) {\n\t\t\t\tresult = cspCompliantVersion;\n\t\t\t}\n\t\t\treturn result.date_to_str(format, utc, gantt);\n\t\t},\n\t\tstr_to_date: function (format, utc) {\n\t\t\tvar result = fastVersion;\n\t\t\tif (useCsp()) {\n\t\t\t\tresult = cspCompliantVersion;\n\t\t\t}\n\t\t\treturn result.str_to_date(format, utc, gantt);\n\t\t},\n\t\tgetISOWeek: function (ndate) {\n\t\t\treturn gantt.date._getWeekNumber(ndate, true);\n\t\t},\n\t\t_getWeekNumber: function(ndate, isoWeek){\n\t\t\tif (!ndate) return false;\n\t\t\tvar nday = ndate.getDay();\n\t\t\tif(isoWeek){\n\t\t\t\tif (nday === 0) {\n\t\t\t\t\tnday = 7;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar first_thursday = new Date(ndate.valueOf());\n\t\t\tfirst_thursday.setDate(ndate.getDate() + (4 - nday));\n\t\t\tvar year_number = first_thursday.getFullYear(); // year of the first Thursday\n\t\t\tvar ordinal_date = Math.round((first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) / 86400000); //ordinal date of the first Thursday - 1 (so not really ordinal date)\n\t\t\tvar week_number = 1 + Math.floor(ordinal_date / 7);\n\t\t\treturn week_number;\n\t\t},\n\n\t\tgetWeek: function(ndate){\n\t\t\treturn gantt.date._getWeekNumber(ndate, gantt.config.start_on_monday);\n\t\t},\n\t\tgetUTCISOWeek: function (ndate) {\n\t\t\treturn gantt.date.getISOWeek(ndate);\n\t\t},\n\t\tconvert_to_utc: function (date) {\n\t\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n\t\t},\n\t\tparseDate: function (date, format) {\n\t\t\t// raw date may be of type string, number (timestamp) or something else\n\t\t\t// do not check for instanceof Date explicitly, since we may swap native date with different date implementation at some point\n\t\t\tif (date && !date.getFullYear) {\n\t\t\t\tif (typeof(format) !== \"function\") {\n\t\t\t\t\tif (typeof(format) === \"string\") {\n\t\t\t\t\t\tif (format === \"parse_date\" || format === \"xml_date\") {\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates[format]) ? gantt.templates[format] : gantt.date.str_to_date(format);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (date) {\n\t\t\t\t\tdate = format(date);\n\t\t\t\t} else {\n\t\t\t\t\tdate = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn date;\n\t\t}\n\t};\n\treturn dateHelper;\n};","class t{constructor(t){const{url:e,token:s}=t;this._url=e,this._token=s,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Remote-Token\":this._token}}fetch(t,e){const s={credentials:\"include\",headers:this.headers()};return e&&(s.method=\"POST\",s.body=e),fetch(t,s).then(t=>t.json())}load(t){return t&&(this._url=t),this.fetch(this._url).then(t=>this.parse(t))}parse(t){const{key:e,websocket:s}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const s=this.api[e]={},i=t.api[e];for(const t in i)s[t]=this._wrapper(e+\".\"+t)}return s&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,s,i){let n=e;\"/\"===n[0]&&(n=document.location.protocol+\"//\"+document.location.host+e);n=n.replace(/^http(s|):/,\"ws$1:\");const o=-1!=n.indexOf(\"?\")?\"&\":\"?\";n=`${n}${o}token=${s}&ws=1`;const r=new WebSocket(n);return r.onclose=()=>setTimeout(()=>t.connect(),2e3),r.onmessage=e=>{const s=JSON.parse(e.data);switch(s.action){case\"result\":t.result(s.body,[]);break;case\"event\":t.fire(s.body.name,s.body.value);break;case\"start\":i();break;default:t.onError(s.data)}},r}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(t){return function(){const e=[].slice.call(arguments);let s=null;const i=new Promise((i,n)=>{s={data:{id:this._uid(),name:t,args:e},status:1,resolve:i,reject:n},this._queue.push(s)});return this.onCall(s,i),3===this._mode?this._send(s):setTimeout(()=>this._send(),1),i}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout(()=>this._send(),100);const e=t?[t]:this._queue.filter(t=>1===t.status);if(!e.length)return;const s=e.map(t=>(t.status=2,t.data));3!==this._mode?this.fetch(this._url,JSON.stringify(s)).catch(t=>this.onError(t)).then(t=>this.result(t,s)):this._socket.send(JSON.stringify({action:\"call\",body:s}))}result(t,e){const s={};if(t)for(let e=0;e<t.length;e++)s[t[e].id]=t[e];else for(let t=0;t<e.length;t++)s[e[t].id]={id:e[t].id,error:\"Network Error\",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],i=s[e.data.id];i&&(this.onResponse(e,i),i.error?e.reject(i.error):e.resolve(i.data),this._queue.splice(t,1))}}on(t,e){const s=this._uid();let i=this._events[t];const n=!!i;return n||(i=this._events[t]=[]),i.push({id:s,handler:e}),n||3!=this._mode||this._socket.send(JSON.stringify({action:\"subscribe\",name:t})),{name:t,id:s}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"subscribe\",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"unsubscribe\",key:t}));return void(this._events={})}const{id:e,name:s}=t,i=this._events[s];if(i){const t=i.filter(t=>t.id!=e);t.length?this._events[s]=t:(delete this._events[s],3==this._mode&&this._socket.send(JSON.stringify({action:\"unsubscribe\",name:s})))}}fire(t,e){const s=this._events[t];if(s)for(let t=0;t<s.length;t++)s[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}export{t as Client};\n//# sourceMappingURL=remote.es6.js.map\n","import * as remote_client from \"remote-client\";\nexport const remoteEvents = function(url, token) {\n    const remote = new remote_client.Client({\n      url,\n      token\n    });\n\n    // temporary patch, as we do not want credentials\n    remote.fetch = function (url, body) {\n      const req = {\n        headers: this.headers()\n      };\n      if (body) {\n        req.method = \"POST\";\n        req.body = body;\n      }\n\n      return fetch(url, req).then((res) => res.json());\n    };\n\n    this._ready = remote.load().then((back) => (this._remote = back));\n\n    function ready() {\n      return this._ready;\n    }\n  \n    function on(name, handler) {\n      this.ready().then((back) => {\n        if (typeof name === \"string\") back.on(name, handler);\n        else {\n          for (const key in name) {\n            back.on(key, name[key]);\n          }\n        }\n      });\n    }\n\n    this.ready = ready;\n    this.on = on;\n  };\n\n","function checkTimeout(host, updPerSecond){\n\tif (!updPerSecond)\n\t\treturn true;\n\t\n\tif (host._on_timeout)\n\t\treturn false;\n\t\n\tvar timeout = Math.ceil(1000/updPerSecond);\n\tif (timeout < 2) return true;\n\n\tsetTimeout(function(){\n\t\tdelete host._on_timeout;\n\t}, timeout);\n\n\thost._on_timeout = true;\n\treturn true;\n}\n\nexport default checkTimeout;","import * as utils from \"../../utils/utils\";\n\nvar StateService = (function(){\n\tvar stateProviders = {};\n\n\tfunction getState(name){\n\t\tvar provider = stateProviders[name];\n\t\tif(provider){\n\t\t\treturn stateProviders[name].method();\n\t\t}else{\n\t\t\tvar res = {};\n\t\t\tfor(var i in stateProviders){\n\t\t\t\tif(!stateProviders[i].internal)\n\t\t\t\t\tutils.mixin(res, stateProviders[i].method(), true);\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tfunction registerProvider(name, provider, internal){\n\t\tstateProviders[name] = { method: provider, internal: internal};\n\t}\n\n\tfunction unregisterProvider(name){\n\t\tdelete stateProviders[name];\n\t}\n\n\treturn {\n\t\tgetState: getState,\n\t\tregisterProvider: registerProvider,\n\t\tunregisterProvider: unregisterProvider\n\t};\n});\n\nexport default StateService;\n\n","// eslint-disable-next-line no-restricted-globals\nexport default Promise;","import * as utils from \"../../utils/utils\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nvar createTasksDatastoreFacade = function(){\n\treturn {\n\tgetTask: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tthis.assert(id, \"Invalid argument for gantt.getTask\");\n\t\tvar task = this.$data.tasksStore.getItem(id);\n\t\tthis.assert(task, \"Task not found id=\" + id);\n\t\treturn task;\n\t},\n\tgetTaskByTime: function (from, to) {\n\t\tvar p = this.$data.tasksStore.getItems();\n\n\t\tvar res = [];\n\n\t\tif (!(from || to)) {\n\t\t\tres = p;\n\t\t} else {\n\t\t\tfrom = +from || -Infinity;\n\t\t\tto = +to || Infinity;\n\t\t\tfor (var t = 0; t < p.length; t++){\n\t\t\t\tvar task = p[t];\n\t\t\t\tif (+task.start_date < to && +task.end_date > from)\n\t\t\t\t\tres.push(task);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t},\n\tisTaskExists: function (id) {\n\t\tif(!this.$data || !this.$data.tasksStore){\n\t\t\treturn false;\n\t\t}\n\t\treturn this.$data.tasksStore.exists(id);\n\t},\n\tupdateTask: function (id, item) {\n\t\tif (!utils.defined(item)) item = this.getTask(id);\n\t\tthis.$data.tasksStore.updateItem(id, item);\n\t\tif(this.isTaskExists(id))\n\t\t\tthis.refreshTask(id);\n\t},\n\taddTask: function (item, parent, index) {\n\t\tif (!utils.defined(item.id))\n\t\t\titem.id = utils.uid();\n\n\t\t//GS-761: assert unique ID\n\t\tif (this.isTaskExists(item.id)){\n\t\t\tvar task = this.getTask(item.id);\n\t\t\tif (task.$index != item.$index) {\n\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\n\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\n\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\n\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\n\t\t\t\t}\n\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\n\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\n\t\t\t\t}\n\n\t\t\t\treturn this.$data.tasksStore.updateItem(item.id, item);\n\t\t\t}\n\t\t}\n\n\n\t\tif (!utils.defined(parent)) parent = this.getParent(item) || 0;\n\t\tif (!this.isTaskExists(parent)) parent = this.config.root_id;\n\t\tthis.setParent(item, parent);\n\n\t\t// GS-1583. Save the $open state to the Undo Stack\n\t\tif (this.getState().lightbox && this.isTaskExists(parent)) {\n\t\t\tvar parentObj = this.getTask(parent);\n\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\n\t\t}\n\t\treturn this.$data.tasksStore.addItem(item, index, parent);\n\t},\n\tdeleteTask: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\treturn this.$data.tasksStore.removeItem(id);\n\t},\n\tgetTaskCount: function () {\n\t\treturn this.$data.tasksStore.count();\n\t},\n\tgetVisibleTaskCount: function () {\n\t\treturn this.$data.tasksStore.countVisible();\n\t},\n\tgetTaskIndex: function (id) {\n\t\treturn this.$data.tasksStore.getBranchIndex(id);\n\t},\n\tgetGlobalTaskIndex: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tthis.assert(id, \"Invalid argument\");\n\t\treturn this.$data.tasksStore.getIndexById(id);\n\t},\n\teachTask: function (code, parent, master) {\n\t\treturn this.$data.tasksStore.eachItem(utils.bind(code, master||this), parent);\n\t},\n\teachParent: function (callback, startTask, master) {\n\t\treturn this.$data.tasksStore.eachParent(utils.bind(callback, master || this), startTask);\n\t},\n\tchangeTaskId: function (oldid, newid) {\n\t\tthis.$data.tasksStore.changeId(oldid, newid);\n\t\tvar task = this.$data.tasksStore.getItem(newid);\n\n\t\tvar links = [];\n\n\t\tif (task.$source) {\n\t\t\tlinks = links.concat(task.$source);\n\t\t}\n\t\tif (task.$target) {\n\t\t\tlinks = links.concat(task.$target);\n\t\t}\n\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tvar link = this.getLink(links[i]);\n\t\t\tif (link.source == oldid) {\n\t\t\t\tlink.source = newid;\n\t\t\t}\n\t\t\tif (link.target == oldid) {\n\t\t\t\tlink.target = newid;\n\t\t\t}\n\t\t}\n\t},\n\tcalculateTaskLevel: function (item) {\n\t\treturn this.$data.tasksStore.calculateItemLevel(item);\n\t},\n\tgetNext: function (id) {\n\t\treturn this.$data.tasksStore.getNext(id);\n\t},\n\tgetPrev: function (id) {\n\t\treturn this.$data.tasksStore.getPrev(id);\n\t},\n\tgetParent: function (id) {\n\t\treturn this.$data.tasksStore.getParent(id);\n\t},\n\tsetParent: function (task, new_pid, silent) {\n\t\treturn this.$data.tasksStore.setParent(task, new_pid, silent);\n\t},\n\tgetSiblings: function (id) {\n\t\treturn this.$data.tasksStore.getSiblings(id).slice();\n\t},\n\tgetNextSibling: function (id) {\n\t\treturn this.$data.tasksStore.getNextSibling(id);\n\t},\n\tgetPrevSibling: function (id) {\n\t\treturn this.$data.tasksStore.getPrevSibling(id);\n\t},\n\tgetTaskByIndex: function(index){\n\t\tvar id = this.$data.tasksStore.getIdByIndex(index);\n\t\tif(this.isTaskExists(id)){\n\t\t\treturn this.getTask(id);\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t},\n\tgetChildren: function (id) {\n\t\tif(!this.hasChild(id)){\n\t\t\treturn [];\n\t\t}else{\n\t\t\treturn this.$data.tasksStore.getChildren(id).slice();\n\t\t}\n\t},\n\thasChild: function (id) {\n\t\treturn this.$data.tasksStore.hasChild(id);\n\t},\n\topen: function (id) {\n\t\tthis.$data.tasksStore.open(id);\n\t},\n\tclose: function (id) {\n\t\tthis.$data.tasksStore.close(id);\n\t},\n\tmoveTask: function (sid, tindex, parent) {\n\t\tparent = replaceValidZeroId(parent, this.config.root_id);\n\t\treturn this.$data.tasksStore.move.apply(this.$data.tasksStore, arguments);\n\t},\n\tsort: function(field, desc, parent, silent) {\n\t\tvar render = !silent;//4th argument to cancel redraw after sorting\n\n\t\tthis.$data.tasksStore.sort(field, desc, parent);\n\t\tthis.callEvent(\"onAfterSort\", [field, desc, parent]);\n\n\t\tif (render) {\n\t\t\tthis.render();\n\t\t}\n\t}\n};\n};\n\nexport default createTasksDatastoreFacade;\n\n\n","import * as utils from \"../../utils/utils\";\n\nvar $powerArray  = {\n\t$create: function(array){\n\t\treturn utils.mixin(array || [], this);\n\t},\n\t//remove element at specified position\n\t$removeAt:function(pos,len){\n\t\tif (pos>=0) this.splice(pos,(len||1));\n\t},\n\t//find element in collection and remove it\n\t$remove:function(value){\n\t\tthis.$removeAt(this.$find(value));\n\t},\n\t//add element to collection at specific position\n\t$insertAt:function(data,pos){\n\t\tif (!pos && pos!==0) \t//add to the end by default\n\t\t\tthis.push(data);\n\t\telse {\n\t\t\tvar b = this.splice(pos,(this.length-pos));\n\t\t\tthis[pos] = data;\n\t\t\tthis.push.apply(this,b); //reconstruct array without loosing this pointer\n\t\t}\n\t},\n\t//return index of element, -1 if it doesn't exists\n\t$find:function(data){\n\t\tfor (var i=0; i<this.length; i++)\n\t\t\tif (data==this[i]) return i;\n\t\treturn -1;\n\t},\n\t//execute some method for each element of array\n\t$each:function(functor,master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tfunctor.call((master||this),this[i]);\n\t},\n\t//create new array from source, by using results of functor\n\t$map:function(functor,master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tthis[i]=functor.call((master||this),this[i]);\n\t\treturn this;\n\t},\n\t$filter:function(functor, master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tif (!functor.call((master||this),this[i])){\n\t\t\t\tthis.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\treturn this;\n\t}\n};\n\nexport default $powerArray;","/**\n * Check the over task or draggble task is placeholder task\n */\n\nexport default function isPlaceholderTask(id, gantt, store, config) {\n\t// return false;\n\tvar config = gantt ? gantt.config : config;\n\tif (config && config.placeholder_task) {\n\t\tif (store.exists(id)){\n\t\t\tvar item = store.getItem(id);\n\t\t\treturn item.type === config.types.placeholder;\n\t\t}\n\t}\n\treturn false;\n};","import powerArray from \"./power_array\";\nimport * as utils from \"../../utils/utils\";\nimport eventable from \"../../utils/eventable\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\n\nvar DataStore = function(config){\n\tthis.pull = {};\n\tthis.$initItem = config.initItem;\n\tthis.visibleOrder = powerArray.$create();\n\tthis.fullOrder = powerArray.$create();\n\tthis._skip_refresh = false;\n\tthis._filterRule = null;\n\tthis._searchVisibleOrder = {};\n\tthis._indexRangeCache = {};\n\tthis._getItemsCache = null;\n\tthis.$config = config;\n\teventable(this);\n\n\tthis._attachDataChange(function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._getItemsCache = null;\n\t\treturn true;\n\t});\n\treturn this;\n};\nDataStore.prototype = {\n\n\t_attachDataChange: function(callback){\n\t\tthis.attachEvent(\"onClearAll\", callback);\n\t\tthis.attachEvent(\"onBeforeParse\", callback);\n\t\tthis.attachEvent(\"onBeforeUpdate\", callback);\n\t\tthis.attachEvent(\"onBeforeDelete\", callback);\n\t\tthis.attachEvent(\"onBeforeAdd\", callback);\n\t\tthis.attachEvent(\"onParse\", callback);\n\t\tthis.attachEvent(\"onBeforeFilter\", callback);\n\t},\n\t_parseInner: function(data){\n\t\tvar item = null,\n\t\t\tloaded = [];\n\t\tfor(var i = 0, len = data.length; i< len; i++){\n\t\t\titem = data[i];\n\t\t\tif(this.$initItem){\n\t\t\t\tif(this.$config.copyOnParse()){\n\t\t\t\t\titem = utils.copy(item);\n\t\t\t\t}\n\t\t\t\titem = this.$initItem(item);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.callEvent(\"onItemLoading\", [item])){\n\t\t\t\tif (!this.pull.hasOwnProperty(item.id)) {\n\t\t\t\t\tthis.fullOrder.push(item.id);\n\t\t\t\t}\n\t\t\t\tloaded.push(item);\n\t\t\t\tthis.pull[item.id] = item;\n\t\t\t}\n\t\t}\n\t\treturn loaded;\n\t},\n\tparse: function(data){\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\n\t\t}\n\t\tvar loaded = this._parseInner(data);\n\t\tif (!this.isSilent()) {\n\t\t\tthis.refresh();\n\t\t\tthis.callEvent(\"onParse\", [loaded]);\n\t\t}\n\t},\n\tgetItem: function(id){\n\t\treturn this.pull[id];\n\t},\n\n\t_updateOrder: function(code){\n\t\tcode.call(this.visibleOrder);\n\t\tcode.call(this.fullOrder);\n\t},\n\tupdateItem: function(id, item){\n\t\tif (!utils.defined(item)) item = this.getItem(id);\n\n\t\tif (!this.isSilent()) {\n\t\t\tif (this.callEvent(\"onBeforeUpdate\", [item.id, item]) === false) return false;\n\t\t}\n\t\t// This is how it worked before updating the properties:\n\t\t// this.pull[id]=item;\n\t\tutils.mixin(this.pull[id],item, true);\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onAfterUpdate\", [item.id, item]);\n\t\t\tthis.callEvent(\"onStoreUpdated\", [item.id, item, \"update\"]);\n\t\t}\n\t},\n\n\t_removeItemInner: function(id){\n\t\t//clear from collections\n\t\t//this.visibleOrder.$remove(id);\n\t\tthis._updateOrder(function(){ this.$remove(id);});\n\t\tdelete this.pull[id];\n\t},\n\n\tremoveItem: function(id){\n\t\t//utils.assert(this.exists(id), \"Not existing ID in remove command\"+id);\n\n\t\tvar obj = this.getItem(id);\t//save for later event\n\t\tif (!this.isSilent()) {\n\t\t\tif (this.callEvent(\"onBeforeDelete\", [obj.id, obj]) === false) return false;\n\t\t}\n\n\t\tthis.callEvent(\"onAfterDeleteConfirmed\", [obj.id, obj]);\n\t\tthis._removeItemInner(id);\n\t\t\n\t\tif (this.isSilent()) {\n\t\t\tthis.callEvent(\"onAfterSilentDelete\", [obj.id, obj]);\n\t\t}\n\n\t\tif (!this.isSilent()) {\n\t\t\tthis.filter();\n\t\t\tthis.callEvent(\"onAfterDelete\", [obj.id, obj]);\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"delete\"]);\n\t\t}\n\t},\n\n\t_addItemInner: function(item, index){\n\t\t//in case of treetable order is sent as 3rd parameter\n\t\t//var order = index;\n\n\t\tif(this.exists(item.id)){\n\t\t\tthis.silent(function(){this.updateItem(item.id, item);});\n\t\t}else{\n\t\t\tvar order = this.visibleOrder;\n\n\t\t\t//by default item is added to the end of the list\n\t\t\tvar data_size = order.length;\n\n\t\t\tif (!utils.defined(index) || index < 0)\n\t\t\t\tindex = data_size;\n\t\t\t//check to prevent too big indexes\n\t\t\tif (index > data_size){\n\t\t\t\t//dhx.log(\"Warning\",\"DataStore:add\",\"Index of out of bounds\");\n\t\t\t\tindex = Math.min(order.length,index);\n\t\t\t}\n\t\t}\n\n\n\t\t//gantt.assert(!this.exists(id), \"Not unique ID\");\n\n\t\tthis.pull[item.id]=item;\n\t\tif (!this.isSilent()){\n\t\t\tthis._updateOrder(function(){\n\t\t\t\tif(this.$find(item.id) === -1)\n\t\t\t\t\tthis.$insertAt(item.id,index);\n\t\t\t});\n\t\t}\n\t\tthis.filter();\n\t\t//order.$insertAt(item.id,index);\n\t},\n\n\n\tisVisible: function(id){\n\t\treturn this.visibleOrder.$find(id) > -1;\n\t},\n\tgetVisibleItems: function(){\n\t\treturn this.getIndexRange();\n\t},\n\n\taddItem: function(item, index){\n\t\tif (!utils.defined(item.id))\n\t\t\titem.id = utils.uid();\n\n\t\tif(this.$initItem){\n\t\t\titem = this.$initItem(item);\n\t\t}\n\n\t\tif (!this.isSilent()){\n\t\t\tif (this.callEvent(\"onBeforeAdd\", [item.id, item]) === false) return false;\n\t\t}\n\n\n\t\tthis._addItemInner(item, index);\n\n\t\tif (!this.isSilent()){\n\t\t\tthis.callEvent(\"onAfterAdd\",[item.id, item]);\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\",[item.id,item,\"add\"]);\n\t\t}\n\t\treturn item.id;\n\t},\n\n\t_changeIdInner: function(oldId, newId){\n\t\tif(this.pull[oldId])\n\t\t\tthis.pull[newId] = this.pull[oldId];\n\n\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\n\t\tthis.pull[newId].id = newId;\n\t\tthis._updateOrder(function(){\n\t\t\tthis[this.$find(oldId)] = newId;\n\t\t});\n\t\tthis._searchVisibleOrder[newId] = visibleOrder;\n\t\tdelete this._searchVisibleOrder[oldId];\n\n\t\t//this.visibleOrder[this.visibleOrder.$find(oldId)]=newId;\n\t\tdelete this.pull[oldId];\n\t},\n\tchangeId: function(oldId, newId){\n\t\tthis._changeIdInner(oldId, newId);\n\n\t\tthis.callEvent(\"onIdChange\", [oldId, newId]);\n\n\t},\n\texists: function(id){\n\t\treturn !!(this.pull[id]);\n\t},\n\n\t_moveInner: function(sindex, tindex){\n\t\tvar id = this.getIdByIndex(sindex);\n\n\t\tthis._updateOrder(function(){\n\t\t\tthis.$removeAt(sindex);\n\t\t\tthis.$insertAt(id,Math.min(this.length, tindex));\n\t\t});\n\t\t//this.visibleOrder.$removeAt(sindex);\t//remove at old position\n\t\t//if (sindex<tindex) tindex--;\t//correct shift, caused by element removing\n\t\t//this.visibleOrder.$insertAt(id,Math.min(this.visibleOrder.length, tindex));\t//insert at new position\n\t},\n\n\tmove: function(sindex, tindex){\n\t\t//gantt.assert(sindex>=0 && tindex>=0, \"DataStore::move\",\"Incorrect indexes\");\n\n\t\tvar id = this.getIdByIndex(sindex);\n\t\tvar obj = this.getItem(id);\n\t\tthis._moveInner(sindex, tindex);\n\n\t\tif (!this.isSilent()) {\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"move\"]);\n\t\t}\n\t},\n\tclearAll: function(){\n\t\tif(this.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\t// GS-956 We need to unselect the resource as its ID is cached\n\t\tthis.silent(function(){\n\t\t\tthis.unselect();\n\t\t});\n\t\tthis.pull = {};\n\t\tthis.visibleOrder = powerArray.$create();\n\t\tthis.fullOrder = powerArray.$create();\n\t\tif (this.isSilent()) return;\n\t\tthis.callEvent(\"onClearAll\",[]);\n\t\tthis.refresh();\n\t},\n\n\tsilent:function(code, master){\n\t\tvar alreadySilent = false;\n\t\tif(this.isSilent()) {\n\t\t\talreadySilent = true;\n\t\t}\n\t\tthis._skip_refresh = true;\n\t\tcode.call(master||this);\n\t\t\n\t\tif (!alreadySilent) {\n\t\t\tthis._skip_refresh = false;\n\t\t}\n\t},\n\tisSilent: function(){\n\t\treturn !!this._skip_refresh;\n\t},\n\n\tarraysEqual: function (arr1, arr2) {\n\t\tif(arr1.length !== arr2.length)\n\t\t\treturn false;\n\t\tfor(var i = 0; i < arr1.length; i++) {\n\t\t\tif(arr1[i] !== arr2[i])\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\trefresh: function(id, quick){\n\t\tif (this.isSilent()) return;\n\n\t\tvar item;\n\t\tif(id){\n\t\t\titem = this.getItem(id);\n\t\t}\n\n\t\tvar args;\n\t\tif (id){\n\t\t\targs = [id, item, \"paint\"];\n\t\t}else{\n\t\t\targs = [null,null,null];\n\t\t}\n\n\t\tif(this.callEvent(\"onBeforeStoreUpdate\", args) === false){\n\t\t\treturn;\n\t\t}\n\n\t\tvar skipFilter = this._quick_refresh && !this._mark_recompute;\n\t\tthis._mark_recompute = false;\n\t\tif(id){\n\t\t\t// if item changes visible order (e.g. expand-collapse branch) - do a complete repaint\n\t\t\tif(!quick && !skipFilter){\n\t\t\t\tvar oldOrder = this.visibleOrder;\n\t\t\t\tthis.filter();\n\t\t\t\tif(!this.arraysEqual(oldOrder, this.visibleOrder)){\n\t\t\t\t\tid = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}else if(!skipFilter){\n\t\t\tthis.filter();\n\t\t}\n\n\t\tif (id){\n\t\t\targs = [id, item, \"paint\"];\n\t\t}else{\n\t\t\targs = [null,null,null];\n\t\t}\n\n\t\tthis.callEvent(\"onStoreUpdated\",args);\n\t},\n\n\tcount: function(){\n\t\treturn this.fullOrder.length;\n\t},\n\tcountVisible: function(){\n\t\treturn this.visibleOrder.length;\n\t},\n\n\tsort: function(sort){},\n\n\tserialize: function(){},\n\n\teachItem: function(code){\n\t\tfor (var i=0; i<this.fullOrder.length; i++) {\n\t\t\tvar item = this.getItem(this.fullOrder[i]);\n\t\t\tcode.call(this, item);\n\t\t}\n\t},\n\n\tfind: function(filter) {\n\t\tvar result = [];\n\t\tthis.eachItem(function(item) {\n\t\t\tif(filter(item)){\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\tfilter: function(rule){\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onBeforeFilter\", []);\n\t\t}\n\t\tthis.callEvent(\"onPreFilter\", []);\n\t\tvar filteredOrder = powerArray.$create();\n\t\tvar placeholderIds = [];\n\t\tthis.eachItem(function(item){\n\t\t\tif(this.callEvent(\"onFilterItem\", [item.id, item])){\n\t\t\t\tif(isPlaceholderTask(item.id, null, this, this._ganttConfig)){\n\t\t\t\t\tplaceholderIds.push(item.id);\n\t\t\t\t} else {\n\t\t\t\t\tfilteredOrder.push(item.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor(var i = 0; i < placeholderIds.length; i++){\n\t\t\tfilteredOrder.push(placeholderIds[i]);\n\t\t}\n\n\t\tthis.visibleOrder = filteredOrder;\n\t\tthis._searchVisibleOrder = {};\n\t\tfor(var i = 0; i < this.visibleOrder.length; i++){\n\t\t\tthis._searchVisibleOrder[this.visibleOrder[i]] = i;\n\t\t}\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onFilter\", []);\n\t\t}\n\t},\n\n\tgetIndexRange: function(from, to){\n\t\tvar max = Math.min((to||Infinity),this.countVisible()-1);\n\t\tvar min = from||0;\n\n\t\tvar cacheKey = min + '-' + max;\n\t\tif(this._indexRangeCache[cacheKey]){\n\t\t\treturn this._indexRangeCache[cacheKey].slice();\n\t\t}\n\n\t\tvar ret= [];\n\t\tfor (var i=min; i <= max; i++)\n\t\t\tret.push(this.getItem(this.visibleOrder[i]));\n\n\t\tthis._indexRangeCache[cacheKey] = ret.slice();\n\t\treturn ret;\n\t},\n\tgetItems: function(){\n\t\tif(this._getItemsCache){\n\t\t\treturn this._getItemsCache.slice();\n\t\t}\n\n\t\tvar res = [];\n\t\tfor(var i in this.pull){\n\t\t\tres.push(this.pull[i]);\n\t\t}\n\t\tthis._getItemsCache = res.slice();\n\n\t\treturn res;\n\t},\n\n\tgetIdByIndex: function(index){\n\t\treturn this.visibleOrder[index];\n\t},\n\tgetIndexById: function(id){\n\t\tvar res = this._searchVisibleOrder[id];\n\t\tif(res === undefined){\n\t\t\tres = -1;\n\t\t}\n\t\treturn res;\n\t},\n\t_getNullIfUndefined: function(value){\n\t\tif(value === undefined){\n\t\t\treturn null;\n\t\t}else{\n\t\t\treturn value;\n\t\t}\n\t},\n\tgetFirst: function(){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[0]);\n\t},\n\tgetLast: function(){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.visibleOrder.length-1]);\n\t},\n\tgetNext: function(id){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) + 1]);\n\t},\n\tgetPrev: function(id){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) - 1]);\n\t},\n\tdestructor: function(){\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t\tthis.$destroyed = true;\n\t\tthis.pull = null;\n\t\tthis.$initItem = null;\n\t\tthis.visibleOrder = null;\n\t\tthis.fullOrder = null;\n\t\tthis._skip_refresh = null;\n\t\tthis._filterRule = null;\n\t\tthis._searchVisibleOrder = null;\n\t\tthis._indexRangeCache = {};\n\t}\n};\n\nexport default DataStore;","import powerArray from \"./power_array\";\nimport * as utils from \"../../utils/utils\";\nimport * as helpers from \"../../utils/helpers\";\nimport DataStore from \"./datastore\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nvar TreeDataStore = function(config){\n\tDataStore.apply(this, [config]);\n\tthis._branches = {};\n\n\tthis.pull = {};\n\t//GS-761 Update existing item instead of adding it to the new position\n\tthis.$initItem = function (item){\n\t\tvar loadedItem = item;\n\t\tif(config.initItem){\n\t\t\tloadedItem = config.initItem(loadedItem);\n\t\t}\n\t\tvar existingItem = this.getItem(item.id);\n\t\tif(existingItem && existingItem.parent != loadedItem.parent){\n\t\t\tthis.move(loadedItem.id, loadedItem.$index || -1, loadedItem.parent || this._ganttConfig.root_id);\n\t\t}\n\t\treturn loadedItem;\n\t};\n\tthis.$parentProperty = config.parentProperty || \"parent\";\n\n\tif(typeof config.rootId !== \"function\"){\n\t\tthis.$getRootId = (function(val){\n\t\t\treturn function(){return val;};\n\t\t})(config.rootId || 0);\n\t}else{\n\t\tthis.$getRootId = config.rootId;\n\t}\n\n\t// TODO: replace with live reference to gantt config\n\tthis.$openInitially = config.openInitially;\n\n\tthis.visibleOrder = powerArray.$create();\n\tthis.fullOrder = powerArray.$create();\n\tthis._searchVisibleOrder = {};\n\tthis._indexRangeCache = {};\n\tthis._eachItemMainRangeCache = null;\n\tthis._getItemsCache = null;\n\tthis._skip_refresh = false;\n\n\tthis._ganttConfig = null;\n\tif(config.getConfig){\n\t\tthis._ganttConfig = config.getConfig();\n\t}\n\n\tvar splitParents = {};\n\tvar splitItems = {};\n\n\tvar taskOpenState = {};\n\tvar taskVisibility = {};\n\tvar haveSplitItems = false;\n\n\tthis._attachDataChange(function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._eachItemMainRangeCache = null;\n\t\tthis._getItemsCache = null;\n\t\treturn true;\n\t});\n\n\tthis.attachEvent(\"onPreFilter\", function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._eachItemMainRangeCache = null;\n\n\t\tsplitParents = {};\n\t\tsplitItems = {};\n\t\ttaskOpenState = {};\n\t\ttaskVisibility = {};\n\t\thaveSplitItems = false;\n\n\t\tthis.eachItem(function(item){\n\t\t\tvar parent = this.getParent(item.id);\n\t\t\tif(item.$open && taskOpenState[parent] !== false){\n\t\t\t\ttaskOpenState[item.id] = true;\n\t\t\t}else{\n\t\t\t\ttaskOpenState[item.id] = false;\n\t\t\t}\n\n\t\t\tif(this._isSplitItem(item)){\n\t\t\t\thaveSplitItems = true;\n\t\t\t\tsplitParents[item.id] = true;\n\t\t\t\tsplitItems[item.id] = true;\n\t\t\t}\n\n\n\t\t\tif(haveSplitItems && splitItems[parent]){\n\t\t\t\tsplitItems[item.id] = true;\n\t\t\t}\n\n\n\t\t\tif(taskOpenState[parent] || taskOpenState[parent] === undefined){\n\t\t\t\ttaskVisibility[item.id] = true;\n\t\t\t}else{\n\t\t\t\ttaskVisibility[item.id] = false;\n\t\t\t}\n\t\t});\n\t});\n\n\tthis.attachEvent(\"onFilterItem\", function(id, item){\n\n\t\tvar canOpenSplitTasks = false;\n\t\tif(this._ganttConfig){\n\t\t\tvar canOpenSplitTasks = this._ganttConfig.open_split_tasks;\n\t\t}\n\n\t\tvar open = taskVisibility[item.id];\n\n\t\tif(haveSplitItems){\n\t\t\tif(open && splitItems[item.id] && !splitParents[item.id]){\n\t\t\t\topen = !!canOpenSplitTasks;\n\t\t\t}\n\n\t\t\tif(splitItems[item.id] && !splitParents[item.id]){\n\t\t\t\titem.$split_subtask = true;\n\t\t\t}\n\t\t}\n\n\t\titem.$expanded_branch = !!taskVisibility[item.id];\n\n\t\treturn !!open;\n\t});\n\n\tthis.attachEvent(\"onFilter\", function(){\n\t\tsplitParents = {};\n\t\tsplitItems = {};\n\n\t\ttaskOpenState = {};\n\t\ttaskVisibility = {};\n\t});\n\n\treturn this;\n};\n\nTreeDataStore.prototype = utils.mixin({\n\n\t\t_buildTree: function(data){\n\t\t\tvar item = null;\n\t\t\tvar rootId = this.$getRootId();\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\n\t\t\t\titem = data[i];\n\t\t\t\tthis.setParent(item, replaceValidZeroId(this.getParent(item), rootId) || rootId);\n\t\t\t}\n\n\t\t\t// calculating $level for each item\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\n\t\t\t\titem = data[i];\n\t\t\t\tthis._add_branch(item);\n\t\t\t\titem.$level = this.calculateItemLevel(item);\n\t\t\t\titem.$local_index = this.getBranchIndex(item.id);\n\n\t\t\t\tif (!utils.defined(item.$open)) {\n\t\t\t\t\titem.$open = utils.defined(item.open) ? item.open : this.$openInitially();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._updateOrder();\n\t\t},\n\t\t_isSplitItem: function(item){\n\t\t\treturn (item.render == \"split\" && this.hasChild(item.id));\n\t\t},\n\t\tparse: function(data){\n\t\t\tif (!this._skip_refresh) {\n\t\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\n\t\t\t}\n\t\t\tvar loaded = this._parseInner(data);\n\t\t\tthis._buildTree(loaded);\n\t\t\tthis.filter();\n\t\t\tif (!this._skip_refresh) {\n\t\t\t\tthis.callEvent(\"onParse\", [loaded]);\n\t\t\t}\n\t\t},\n\n\t\t_addItemInner: function(item, index){\n\n\t\t\tvar parent = this.getParent(item);\n\n\t\t\tif(!utils.defined(parent)){\n\t\t\t\tparent = this.$getRootId();\n\t\t\t\tthis.setParent(item, parent);\n\t\t\t}\n\n\t\t\tvar parentIndex = this.getIndexById(parent);\n\t\t\tvar targetIndex = parentIndex + Math.min(Math.max(index, 0), this.visibleOrder.length);\n\n\t\t\tif(targetIndex*1 !== targetIndex){\n\t\t\t\ttargetIndex = undefined;\n\t\t\t}\n\t\t\tDataStore.prototype._addItemInner.call(this, item, targetIndex);\n\t\t\tthis.setParent(item, parent);\n\n\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\n\t\t\t\tthis._move_branch(item, item.$rendered_parent);\n\t\t\t}\n\t\t\tthis._add_branch(item, index);\n\t\t},\n\t\t_changeIdInner: function(oldId, newId){\n\t\t\tvar children = this.getChildren(oldId);\n\t\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\n\n\t\t\tDataStore.prototype._changeIdInner.call(this, oldId, newId);\n\n\t\t\tvar parent = this.getParent(newId);\n\n\t\t\tthis._replace_branch_child(parent, oldId, newId);\n\n\t\t\tif(this._branches[oldId]){\n\t\t\t\tthis._branches[newId] = this._branches[oldId];\n\t\t\t}\n\t\t\tfor(var i = 0; i < children.length; i++){\n\t\t\t\tvar child = this.getItem(children[i]);\n\t\t\t\tchild[this.$parentProperty] = newId;\n\t\t\t\tchild.$rendered_parent = newId;\n\t\t\t}\n\n\t\t\tthis._searchVisibleOrder[newId] = visibleOrder;\n\t\t\tdelete this._branches[oldId];\n\t\t},\n\n\t\t_traverseBranches: function(code, parent){\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\tvar branch = this._branches[parent];\n\t\t\tif (branch) {\n\t\t\t\tfor (var i = 0; i < branch.length; i++) {\n\t\t\t\t\tvar itemId = branch[i];\n\t\t\t\t\tcode.call(this, itemId);\n\t\t\t\t\tif (this._branches[itemId])\n\t\t\t\t\t\tthis._traverseBranches(code, itemId);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_updateOrder: function(code){\n\n\t\t\tthis.fullOrder = powerArray.$create();\n\t\t\tthis._traverseBranches(function(taskId){\n\t\t\t\tthis.fullOrder.push(taskId);\n\t\t\t});\n\n\t\t\tif(code)\n\t\t\t\tDataStore.prototype._updateOrder.call(this, code);\n\t\t},\n\n\t\t_removeItemInner: function(id){\n\n\t\t\tvar items = [];\n\t\t\tthis.eachItem(function(child){\n\t\t\t\titems.push(child);\n\t\t\t}, id);\n\n\t\t\titems.push(this.getItem(id));\n\n\t\t\tfor(var i = 0; i < items.length; i++){\n\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\n\t\t\t\tDataStore.prototype._removeItemInner.call(this, items[i].id);\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\n\t\t\t}\n\t\t},\n\n\t\tmove: function(sid, tindex, parent){\n\t\t\t//target id as 4th parameter\n\t\t\tvar id = arguments[3];\n\t\t\tvar config = this._ganttConfig || {};\n\t\t\tvar root_id = config.root_id || 0;\n\t\t\tid = replaceValidZeroId(id, root_id);\n\t\t\tif (id) {\n\t\t\t\tif (id === sid) return;\n\n\t\t\t\tparent = this.getParent(id);\n\t\t\t\ttindex = this.getBranchIndex(id);\n\t\t\t}\n\t\t\tif(sid == parent){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\tvar source = this.getItem(sid);\n\t\t\tvar source_pid = this.getParent(source.id);\n\n\t\t\tvar tbranch = this.getChildren(parent);\n\n\t\t\tif (tindex == -1)\n\t\t\t\ttindex = tbranch.length + 1;\n\t\t\tif (source_pid == parent) {\n\t\t\t\tvar sindex = this.getBranchIndex(sid);\n\t\t\t\tif (sindex == tindex) return;\n\t\t\t}\n\n\t\t\tif(this.callEvent(\"onBeforeItemMove\", [sid, parent, tindex]) === false)\n\t\t\t\treturn false;\n\n\t\t\tvar placeholderIds = [];\n\t\t\tfor(var i = 0; i < tbranch.length; i++){\n\t\t\t\tif (isPlaceholderTask(tbranch[i], null, this, this._ganttConfig)){\n\t\t\t\t\tplaceholderIds.push(tbranch[i]);\n\t\t\t\t\ttbranch.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._replace_branch_child(source_pid, sid);\n\t\t\ttbranch = this.getChildren(parent);\n\n\t\t\tvar tid = tbranch[tindex];\n\t\t\ttid = replaceValidZeroId(tid, root_id);\n\t\t\tif (!tid) //adding as last element\n\t\t\t\ttbranch.push(sid);\n\t\t\telse\n\t\t\t\ttbranch = tbranch.slice(0, tindex).concat([ sid ]).concat(tbranch.slice(tindex));\n\n\t\t\tif (placeholderIds.length){\n\t\t\t\ttbranch = tbranch.concat(placeholderIds);\n\t\t\t}\n\t\t\t// GS-2423 to return initial parent to the task before it will be moved\n\t\t\tif (source.$rendered_parent !== source_pid && source_pid !== parent){\n\t\t\t\tsource.$rendered_parent = source_pid;\n\t\t\t}\n\t\t\tthis.setParent(source, parent);\n\t\t\tthis._branches[parent] = tbranch;\n\n\t\t\tvar diff = this.calculateItemLevel(source) - source.$level;\n\t\t\tsource.$level += diff;\n\t\t\tthis.eachItem(function(item){\n\t\t\t\titem.$level += diff;\n\t\t\t}, source.id, this);\n\n\n\t\t\tthis._moveInner(this.getIndexById(sid), this.getIndexById(parent) + tindex);\n\n\t\t\tthis.callEvent(\"onAfterItemMove\", [sid, parent, tindex]);\n\t\t\tthis.refresh();\n\t\t},\n\n\t\tgetBranchIndex: function(id){\n\t\t\tvar branch = this.getChildren(this.getParent(id));\n\t\t\tlet index = branch.indexOf(id + \"\");\n\t\t\tif (index == -1){\n\t\t\t\tindex = branch.indexOf(+id);\n\t\t\t}\n\t\t\treturn index;\n\t\t},\n\t\thasChild: function(id){\n\t\t\tvar branch = this._branches[id];\n\t\t\treturn branch && branch.length;\n\t\t},\n\t\tgetChildren: function(id){\n\t\t\tvar branch = this._branches[id];\n\t\t\treturn branch ? branch : powerArray.$create();\n\t\t},\n\n\t\tisChildOf: function(childId, parentId){\n\t\t\tif (!this.exists(childId))\n\t\t\t\treturn false;\n\t\t\tif (parentId === this.$getRootId())\n\t\t\t\treturn true;\n\n\t\t\tif (!this.hasChild(parentId))\n\t\t\t\treturn false;\n\n\t\t\tvar item = this.getItem(childId);\n\t\t\tvar pid = this.getParent(childId);\n\n\t\t\tvar parent = this.getItem(parentId);\n\t\t\tif(parent.$level >= item.$level){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\twhile (item && this.exists(pid)) {\n\t\t\t\titem = this.getItem(pid);\n\n\t\t\t\tif (item && item.id == parentId)\n\t\t\t\t\treturn true;\n\t\t\t\tpid = this.getParent(item);\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tgetSiblings: function(id){\n\t\t\tif(!this.exists(id)){\n\t\t\t\treturn powerArray.$create();\n\t\t\t}\n\t\t\tvar parent = this.getParent(id);\n\t\t\treturn this.getChildren(parent);\n\n\t\t},\n\t\tgetNextSibling: function(id){\n\t\t\tvar siblings = this.getSiblings(id);\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\n\t\t\t\tif(siblings[i] == id){\n\t\t\t\t\tvar nextSibling = siblings[i+1];\n\t\t\t\t\tif (nextSibling === 0 && i > 0){\n\t\t\t\t\t\tnextSibling = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\treturn nextSibling || null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetPrevSibling: function(id){\n\t\t\tvar siblings = this.getSiblings(id);\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\n\t\t\t\tif(siblings[i] == id){\n\t\t\t\t\tvar previousSibling = siblings[i-1];\n\t\t\t\t\tif (previousSibling === 0 && i > 0){\n\t\t\t\t\t\tpreviousSibling = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\treturn previousSibling || null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetParent: function(id){\n\t\t\tvar item = null;\n\t\t\tif(id.id !== undefined){\n\t\t\t\titem = id;\n\t\t\t}else{\n\t\t\t\titem = this.getItem(id);\n\t\t\t}\n\n\t\t\tvar parent;\n\t\t\tif(item){\n\t\t\t\tparent = item[this.$parentProperty];\n\t\t\t}else{\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\treturn parent;\n\n\t\t},\n\n\t\tclearAll: function(){\n\t\t\tthis._branches = {};\n\t\t\tDataStore.prototype.clearAll.call(this);\n\t\t},\n\n\t\tcalculateItemLevel: function(item){\n\t\t\tvar level = 0;\n\t\t\tthis.eachParent(function(){\n\t\t\t\tlevel++;\n\t\t\t}, item);\n\t\t\treturn level;\n\t\t},\n\n\t\t_setParentInner: function(item, new_pid, silent){\n\t\t\tif(!silent){\n\t\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\n\t\t\t\t\tthis._move_branch(item, item.$rendered_parent, new_pid);\n\t\t\t\t}else{\n\t\t\t\t\tthis._move_branch(item, item[this.$parentProperty], new_pid);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsetParent: function(item, new_pid, silent){\n\t\t\tthis._setParentInner(item, new_pid, silent);\n\n\t\t\titem[this.$parentProperty] = new_pid;\n\t\t},\n\n\t\t_eachItemCached: function(code, cache){\n\t\t\tfor(var i = 0, len = cache.length; i < len; i++){\n\t\t\t\tcode.call(this, cache[i]);\n\t\t\t}\n\t\t},\n\t\t_eachItemIterate: function(code, startId, cache){\n\t\t\tvar itemsStack = this.getChildren(startId);\n\t\t\tif(itemsStack.length){\n\t\t\t\titemsStack = itemsStack.slice().reverse();\n\t\t\t}\n\t\t\twhile(itemsStack.length){\n\t\t\t\tvar itemId = itemsStack.pop();\n\t\t\t\tvar item = this.getItem(itemId);\n\t\t\t\tcode.call(this, item);\n\t\t\t\tif(cache){\n\t\t\t\t\tcache.push(item);\n\t\t\t\t}\n\n\t\t\t\tif(this.hasChild(item.id)){\n\t\t\t\t\tvar children = this.getChildren(item.id);\n\t\t\t\t\tvar len = children.length;\n\t\t\t\t\tfor(var i = len - 1; i >= 0; i--){\n\t\t\t\t\t\titemsStack.push(children[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\teachItem: function(code, parent){\n\t\t\tvar rootId = this.$getRootId();\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = rootId;\n\t\t\t}\n\t\t\tvar startId = replaceValidZeroId(parent, rootId) || rootId;\n\n\t\t\tvar useCache = false;\n\t\t\tvar buildCache = false;\n\t\t\tvar cache = null;\n\t\t\tif(startId === rootId){\n\t\t\t\tif(this._eachItemMainRangeCache){\n\t\t\t\t\tuseCache = true;\n\t\t\t\t\tcache = this._eachItemMainRangeCache;\n\t\t\t\t}else{\n\t\t\t\t\tbuildCache = true;\n\t\t\t\t\tcache = this._eachItemMainRangeCache = [];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(useCache){\n\t\t\t\tthis._eachItemCached(code, cache);\n\t\t\t}else{\n\t\t\t\tthis._eachItemIterate(code, startId, buildCache ? cache : null);\n\t\t\t}\n\t\t},\n\t\teachParent: function(code, startItem) {\n\t\t\tvar parentsHash = {};\n\t\t\tvar item = startItem;\n\t\t\tvar parent = this.getParent(item);\n\n\t\t\twhile (this.exists(parent)) {\n\t\t\t\tif (parentsHash[parent]) {\n\t\t\t\t\tthrow new Error(\"Invalid tasks tree. Cyclic reference has been detected on task \" + parent);\n\t\t\t\t}\n\t\t\t\tparentsHash[parent] = true;\n\t\t\t\titem = this.getItem(parent);\n\t\t\t\tcode.call(this, item);\n\t\t\t\tparent = this.getParent(item);\n\t\t\t}\n\t\t},\n\t\t_add_branch: function(item, index, parent){\n\t\t\tvar pid = parent === undefined ? this.getParent(item) : parent;\n\t\t\tif (!this.hasChild(pid))\n\t\t\t\tthis._branches[pid] = powerArray.$create();\n\t\t\tvar branch = this.getChildren(pid);\n\t\t\tvar added_already = branch.indexOf(item.id + \"\") > -1 || branch.indexOf(+item.id) > -1;\n\t\t\tif(!added_already){\n\t\t\t\tif(index*1 == index){\n\n\t\t\t\t\tbranch.splice(index, 0, item.id);\n\t\t\t\t}else{\n\t\t\t\t\tbranch.push(item.id);\n\t\t\t\t}\n\n\t\t\t\titem.$rendered_parent = pid;\n\t\t\t}\n\t\t},\n\t\t_move_branch: function(item, old_parent, new_parent){\n\t\t\tthis._eachItemMainRangeCache = null;\n\t\t\t//this.setParent(item, new_parent);\n\t\t\t//this._sync_parent(task);\n\t\t\tthis._replace_branch_child(old_parent, item.id);\n\t\t\tif(this.exists(new_parent) || new_parent == this.$getRootId()){\n\n\t\t\t\tthis._add_branch(item, undefined, new_parent);\n\t\t\t}else{\n\t\t\t\tdelete this._branches[item.id];\n\t\t\t}\n\t\t\titem.$level =  this.calculateItemLevel(item);\n\t\t\tthis.eachItem(function(child){\n\t\t\t\tchild.$level = this.calculateItemLevel(child);\n\t\t\t}, item.id);\n\t\t},\n\n\t\t_replace_branch_child: function(node, old_id, new_id){\n\t\t\tvar branch = this.getChildren(node);\n\t\t\tif (branch && node !== undefined){\n\t\t\t\tvar newbranch = powerArray.$create();\n\n\t\t\t\tlet index = branch.indexOf(old_id + \"\");\n\t\t\t\tif (index == -1 && !isNaN(+old_id)){\n\t\t\t\t\tindex = branch.indexOf(+old_id);\n\t\t\t\t} \n\n\t\t\t\tif (index > -1){\n\t\t\t\t\tif (new_id){\n\t\t\t\t\t\tbranch.splice(index, 1, new_id);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbranch.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnewbranch = branch;\n\n\t\t\t\tthis._branches[node] = newbranch;\n\t\t\t}\n\n\t\t},\n\n\t\tsort: function(field, desc, parent){\n\t\t\tif (!this.exists(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\n\t\t\tif (!field) field = \"order\";\n\t\t\tvar criteria = (typeof(field) == \"string\") ? (function(a, b) {\n\t\t\t\tif (a[field] == b[field] ||\n\t\t\t\t\t(helpers.isDate(a[field]) && helpers.isDate(b[field]) && a[field].valueOf() == b[field].valueOf()))\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tvar result = a[field] > b[field];\n\t\t\t\treturn result ? 1 : -1;\n\t\t\t}) : field;\n\n\t\t\tif (desc) {\n\t\t\t\tvar original_criteria = criteria;\n\t\t\t\tcriteria = function (a, b) {\n\t\t\t\t\treturn original_criteria(b, a);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar els = this.getChildren(parent);\n\n\t\t\tif (els){\n\t\t\t\tvar temp = [];\n\t\t\t\tfor (var i = els.length - 1; i >= 0; i--)\n\t\t\t\t\ttemp[i] = this.getItem(els[i]);\n\n\t\t\t\ttemp.sort(criteria);\n\n\t\t\t\tfor (var i = 0; i < temp.length; i++) {\n\t\t\t\t\tels[i] = temp[i].id;\n\t\t\t\t\tthis.sort(field, desc, els[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tfilter: function(rule){\n\t\t\tfor(let i in this.pull){\n\t\t\t\tconst renderedParent = this.pull[i].$rendered_parent;\n\t\t\t\tconst actualParent = this.getParent(this.pull[i]);\n\t\t\t\tif(renderedParent !== actualParent){\n\t\t\t\t\tthis._move_branch(this.pull[i], renderedParent, actualParent);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn DataStore.prototype.filter.apply(this, arguments);\n\t\t},\n\n\t\topen: function(id){\n\t\t\tif(this.exists(id)){\n\t\t\t\tthis.getItem(id).$open = true;\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\n\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\tthis.callEvent(\"onItemOpen\", [id]);\n\t\t\t}\n\t\t},\n\n\t\tclose: function(id){\n\t\t\tif(this.exists(id)){\n\t\t\t\tthis.getItem(id).$open = false;\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\n\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\tthis.callEvent(\"onItemClose\", [id]);\n\t\t\t}\n\t\t},\n\n\t\tdestructor: function(){\n\t\t\tDataStore.prototype.destructor.call(this);\n\t\t\tthis._branches = null;\n\t\t\tthis._indexRangeCache = {};\n\t\t\tthis._eachItemMainRangeCache = null;\n\t\t}\n\t},\n\tDataStore.prototype\n);\n\nexport default TreeDataStore;","import env from \"./env\";\n\nexport default function(gantt){\n\treturn env.isNode || !gantt.$root;\n};","import isHeadless from \"../../utils/is_headless\";\n\nconst storeRenderCreator = function(name, gantt){\n\n\tconst store = gantt.getDatastore(name);\n\n\tconst itemRepainter = {\n\t\trenderItem: function(id, renderer){\n\n\t\t\tconst renders = renderer.getLayers();\n\n\t\t\tconst item = store.getItem(id);\n\t\t\tif(item && store.isVisible(id)) {\n\t\t\t\tfor (let i = 0; i < renders.length; i++)\n\t\t\t\t\trenders[i].render_item(item);\n\t\t\t}\n\t\t},\n\t\trenderItems: function(renderer){\n\t\t\tconst renderers = renderer.getLayers();\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\n\t\t\t\trenderers[i].clear();\n\t\t\t}\n\n\t\t\tlet allData = null;\n\n\t\t\tconst loadedRanges = {};\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\n\t\t\t\tconst layer = renderers[i];\n\t\t\t\tlet layerData;\n\t\t\t\tif(layer.get_visible_range){\n\n\t\t\t\t\tvar range = layer.get_visible_range(store);\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\n\t\t\t\t\t\tvar key = range.start + \" - \" + range.end;\n\t\t\t\t\t\tif(loadedRanges[key]){\n\t\t\t\t\t\t\tlayerData = loadedRanges[key];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tlayerData = store.getIndexRange(range.start, range.end);\n\t\t\t\t\t\t\tloadedRanges[key] = layerData;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(range.ids !== undefined){\n\t\t\t\t\t\tlayerData = range.ids.map(function(id){\n\t\t\t\t\t\t\treturn store.getItem(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(!allData){\n\t\t\t\t\t\tallData = store.getVisibleItems();\n\t\t\t\t\t}\n\t\t\t\t\tlayerData = allData;\n\t\t\t\t}\n\n\t\t\t\tif (layer.prepare_data) {\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\n\t\t\t\t\tlayer.prepare_data(layerData);\n\t\t\t\t}\n\n\t\t\t\trenderers[i].render_items(layerData);\n\t\t\t}\n\t\t},\n\t\tupdateItems: function(layer) {\n\t\t\tif(layer.update_items){\n\t\t\t\tlet data = [];\n\t\t\t\tif(layer.get_visible_range){\n\n\t\t\t\t\tvar range = layer.get_visible_range(store);\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\n\t\t\t\t\t\tdata = store.getIndexRange(range.start, range.end);\n\t\t\t\t\t}\n\t\t\t\t\tif(range.ids !== undefined){\n\t\t\t\t\t\tlet extraDataArr = range.ids.map(function(id){\n\t\t\t\t\t\t\treturn store.getItem(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// GS-2502: range.ids might not exist in other datastores\n\t\t\t\t\t\tif(extraDataArr.length > 0){\n\t\t\t\t\t\t\textraDataArr = extraDataArr.filter(element => element !== undefined);\n\t\t\t\t\t\t\tdata = data.concat(extraDataArr);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif((range.start == undefined || range.end == undefined) && range.ids == undefined)  {\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdata = store.getVisibleItems();\n\t\t\t\t}\n\n\t\t\t\tif (layer.prepare_data) {\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\n\t\t\t\t\tlayer.prepare_data(data, layer);\n\t\t\t\t}\n\t\t\t\tlayer.update_items(data);\n\t\t\t}\n\t\t}\n\t};\n\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer){\n\t\t\trenderer.onUpdateRequest = function(layer){\n\t\t\t\titemRepainter.updateItems(layer);\n\t\t\t};\n\t\t}\n\t});\n\n\tfunction skipRepaint(gantt){\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tif(state.getState(\"batchUpdate\").batch_update){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(skipRepaint(gantt)){\n\t\t\treturn;\n\t\t}\n\t\tif(!id || action == \"move\" || action == \"delete\"){\n\t\t\tstore.callEvent(\"onBeforeRefreshAll\", []);\n\t\t\tstore.callEvent(\"onAfterRefreshAll\", []);\n\t\t}else{\n\t\t\tstore.callEvent(\"onBeforeRefreshItem\", [item.id]);\n\t\t\tstore.callEvent(\"onAfterRefreshItem\", [item.id]);\n\t\t}\n\t});\n\n\tstore.attachEvent(\"onAfterRefreshAll\", function(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer && !skipRepaint(gantt)){\n\t\t\titemRepainter.renderItems(renderer);\n\t\t}\n\t});\n\tstore.attachEvent(\"onAfterRefreshItem\", function(id){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer){\n\t\t\titemRepainter.renderItem(id, renderer);\n\t\t}\n\t});\n\n\t// TODO: probably can be done more in a more efficient way\n\tstore.attachEvent(\"onItemOpen\", function(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.render();\n\t});\n\n\tstore.attachEvent(\"onItemClose\", function(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.render();\n\t});\n\n\tfunction refreshId(renders, oldId, newId, item) {\n\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\trenders[i].change_id(oldId, newId);\n\t\t}\n\t}\n\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\t// in case of linked datastores (tasks <-> links), id change should recalculate something in linked datastore before any repaint\n\t\t// use onBeforeIdChange for this hook.\n\t\t// TODO: use something more reasonable instead\n\t\tstore.callEvent(\"onBeforeIdChange\", [oldId, newId]);\n\n\t\tif(skipRepaint(gantt)){\n\t\t\treturn;\n\t\t}\n\t\tif(!store.isSilent()){\n\t\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\t\tif(renderer){ // missing check for renderer GS-1814\n\t\t\t\trefreshId(renderer.getLayers(), oldId, newId, store.getItem(newId));\n\t\t\t\titemRepainter.renderItem(newId, renderer);\n\t\t\t}else{\n\t\t\t\t// GS-1814 repaint ui to apply new id when the datastore don't have own renderer\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}\n\t});\n\n};\n\nexport default {\n\tbindDataStore: storeRenderCreator\n};","import * as utils from \"../../utils/utils\";\nimport createTasksFacade from \"./datastore_tasks\";\nimport createLinksFacade from \"./datastore_links\";\nimport DataStore from \"../datastore/datastore\";\nimport TreeDataStore from \"../datastore/treedatastore\";\nimport createDatastoreSelect from \"../datastore/select\";\nimport datastoreRender from \"../datastore/datastore_render\";\nimport isHeadless from \"../../utils/is_headless\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nfunction getDatastores(){\n\tvar storeNames = this.$services.getService(\"datastores\");\n\tvar res = [];\n\tfor(var i = 0; i < storeNames.length; i++){\n\t\tvar store = this.getDatastore(storeNames[i]);\n\t\tif(!store.$destroyed){\n\t\t\tres.push(store);\n\t\t}\n\t}\n\treturn res;\n}\n\nvar createDatastoreFacade = function(){\n\treturn {\n\tcreateDatastore: function(config){\n\n\t\tvar $StoreType = (config.type || \"\").toLowerCase() == \"treedatastore\" ? TreeDataStore : DataStore;\n\n\t\tif (config) {\n\t\t\tvar self = this;\n\t\t\tconfig.openInitially = function(){ return self.config.open_tree_initially; };\n\t\t\tconfig.copyOnParse = function(){ return self.config.deepcopy_on_parse; };\n\t\t}\n\n\t\tvar store = new $StoreType(config);\n\t\tthis.mixin(store, createDatastoreSelect(store));\n\n\t\tif (config.name) {\n\t\t\tvar servicePrefix = \"datastore:\";\n\t\t\tvar storeAccessName = servicePrefix + config.name;\n\n\t\t\tstore.attachEvent(\"onDestroy\", function(){\n\t\t\t\tthis.$services.dropService(storeAccessName);\n\t\t\t\tvar storeList = this.$services.getService(\"datastores\");\n\t\t\t\tfor(var i = 0; i < storeList.length; i++){\n\t\t\t\t\tif(storeList[i] === config.name){\n\t\t\t\t\t\tstoreList.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this));\n\n\t\t\tthis.$services.dropService(storeAccessName);\n\t\t\tthis.$services.setService(storeAccessName, function() { return store; } );\n\n\t\t\tvar storeList = this.$services.getService(\"datastores\");\n\t\t\tif (!storeList) {\n\t\t\t\tstoreList = [];\n\t\t\t\tthis.$services.setService(\"datastores\", function() { return storeList; });\n\t\t\t\tstoreList.push(config.name);\n\t\t\t} else if (storeList.indexOf(config.name) < 0) {\n\t\t\t\tstoreList.push(config.name);\n\t\t\t}\n\n\t\t\tdatastoreRender.bindDataStore(config.name, this);\n\n\t\t}\n\n\t\treturn store;\n\t},\n\tgetDatastore: function(name){\n\t\treturn this.$services.getService(\"datastore:\" + name);\n\t},\n\t_getDatastores: getDatastores,\n\n\trefreshData: function () {\n\t\tvar scrollState;\n\t\tif(!isHeadless(this)){\n\t\t\tscrollState = this.getScrollState();\n\t\t}\n\n\t\tthis.callEvent(\"onBeforeDataRender\", []);\n\n\t\tvar stores = getDatastores.call(this);\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].refresh();\n\t\t}\n\n\t\tif(this.config.preserve_scroll && !isHeadless(this) && (scrollState.x || scrollState.y)){\n\t\t\tthis.scrollTo(scrollState.x, scrollState.y);\n\t\t}\n\t\tthis.callEvent(\"onDataRender\", []);\n\n\t},\n\n\tisChildOf: function(childId, parentId){\n\t\treturn this.$data.tasksStore.isChildOf(childId, parentId);\n\t},\n\n\trefreshTask: function (taskId, refresh_links) {\n\t\tvar task = this.getTask(taskId);\n\t\tvar self = this;\n\t\tfunction refreshLinks(){\n\t\t\tif (refresh_links !== undefined && !refresh_links)\n\t\t\t\treturn;\n\t\t\tfor (var i = 0; i < task.$source.length; i++) {\n\t\t\t\tself.refreshLink(task.$source[i]);\n\t\t\t}\n\t\t\tfor (var i = 0; i < task.$target.length; i++) {\n\t\t\t\tself.refreshLink(task.$target[i]);\n\t\t\t}\n\t\t}\n\n\t\tif (task && this.isTaskVisible(taskId)) {\n\t\t\tthis.$data.tasksStore.refresh(taskId, !!this.getState(\"tasksDnd\").drag_id || refresh_links === false);// do quick refresh during drag and drop\n\t\t\trefreshLinks();\n\t\t}else if(this.isTaskExists(taskId) && this.isTaskExists(this.getParent(taskId)) && !this._bulk_dnd){\n\t\t\tthis.refreshTask(this.getParent(taskId));\n\n\t\t\tvar hasSplitParent = false;\n\t\t\tthis.eachParent(function(parent){\n\t\t\t\tif(hasSplitParent || this.isSplitTask(parent)){\n\t\t\t\t\thasSplitParent = true;\n\t\t\t\t}\n\t\t\t}, taskId);\n\t\t\tif(hasSplitParent){\n\t\t\t\trefreshLinks();\n\t\t\t}\n\t\t}\n\n\t},\n\trefreshLink: function (linkId) {\n\t\tthis.$data.linksStore.refresh(linkId, !!this.getState(\"tasksDnd\").drag_id);// do quick refresh during drag and drop\n\t},\n\n\tsilent: function(code){\n\t\tvar gantt = this;\n\t\tgantt.$data.tasksStore.silent(function(){\n\t\t\tgantt.$data.linksStore.silent(function(){\n\t\t\t\tcode();\n\t\t\t});\n\t\t});\n\t},\n\n\tclearAll: function () {\n\t\tvar stores = getDatastores.call(this);\n\t\t\n\t\t// clear all stores without invoking clearAll event\n\t\t// in order to prevent calling handlers when only some stores are cleared\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].silent(function(){\n\t\t\t\tstores[i].clearAll();\t\n\t\t\t});\n\t\t}\n\t\t// run clearAll again to invoke events\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].clearAll();\t\n\t\t}\n\n\t\tthis._update_flags();\n\t\tthis.userdata = {};\n\t\tthis.callEvent(\"onClear\", []);\n\t\tthis.render();\n\t},\n\t_clear_data: function () {\n\t\tthis.$data.tasksStore.clearAll();\n\t\tthis.$data.linksStore.clearAll();\n\t\tthis._update_flags();\n\t\tthis.userdata = {};\n\t},\n\n\tselectTask: function(id){\n\t\tvar store = this.$data.tasksStore;\n\t\tif(!this.config.select_task)\n\t\t\treturn false;\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tif (id){\n\t\t\tlet oldSelectId = this.getSelectedId();\n\t\t\t// Don't repaint the resource panel as the data didn't change\n\t\t\tstore._skipResourceRepaint = true;\n\t\t\tstore.select(id);\n\t\t\tstore._skipResourceRepaint = false;\n\t\t\t// GS-730. Split task is not included in the tree, \n\t\t\t// so the datastore renderer will think that the task is not visible\n\t\t\tif (oldSelectId && store.pull[oldSelectId].$split_subtask && oldSelectId != id) {\n\t\t\t\tthis.refreshTask(oldSelectId);\n\t\t\t}\n\t\t\tif (store.pull[id].$split_subtask && oldSelectId != id) {// GS-1850. Do not repaint split task after double click\n\t\t\t\tthis.refreshTask(id);\n\t\t\t}\n\t\t}\n\t\treturn store.getSelectedId();\n\t},\n\tunselectTask: function(id){\n\t\tvar store = this.$data.tasksStore;\n\t\tstore.unselect(id);\n\t\t// GS-730. Split task is not included in the tree, \n\t\t// so the datastore renderer will think that the task is not visible\n\t\tif (id && store.pull[id].$split_subtask) {\n\t\t\tthis.refreshTask(id);\n\t\t}\n\t},\n\tisSelectedTask: function(id){\n\t\treturn this.$data.tasksStore.isSelected(id);\n\t},\n\tgetSelectedId: function() {\n\t\treturn this.$data.tasksStore.getSelectedId();\n\t}\n};\n};\n\nfunction createFacade(){\n\tvar res = utils.mixin({}, createDatastoreFacade());\n\tutils.mixin(res, createTasksFacade());\n\tutils.mixin(res, createLinksFacade());\n\treturn res;\n}\n\n\n\n\nexport default {create: createFacade};","function createDataStoreSelectMixin(store){\n\tvar selectedId = null;\n\n\tvar deleteItem = store._removeItemInner;\n\t\n\tfunction unselect(id){\n\t\tselectedId = null;\n\t\tthis.callEvent(\"onAfterUnselect\", [id]);\n\t}\n\n\tstore._removeItemInner = function(id){\n\t\tif(selectedId == id){\n\t\t\tunselect.call(this, id);\n\t\t}\n\n\t\tif(selectedId && this.eachItem){\n\t\t\tthis.eachItem(function(subItem){\n\t\t\t\tif(subItem.id == selectedId){\n\t\t\t\t\tunselect.call(this, subItem.id);\n\t\t\t\t}\n\t\t\t}, id);\n\t\t}\n\n\t\treturn deleteItem.apply(this, arguments);\n\t};\n\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId) {\n\t\tif (store.getSelectedId() == oldId) {\n\t\t\tstore.silent(function () {\n\t\t\t\tstore.unselect(oldId);\n\t\t\t\tstore.select(newId);\n\t\t\t});\n\t\t}\n\t});\n\n\treturn {\n\t\tselect: function(id){\n\t\t\tif (id){\n\n\t\t\t\tif(selectedId == id)\n\t\t\t\t\treturn selectedId;\n\n\t\t\t\tif(!this._skip_refresh) {\n\t\t\t\t\tif (!this.callEvent(\"onBeforeSelect\", [id])) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.unselect();\n\n\t\t\t\tselectedId = id;\n\n\t\t\t\tif(!this._skip_refresh) {\n\t\t\t\t\tthis.refresh(id);\n\t\t\t\t\tthis.callEvent(\"onAfterSelect\", [id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn selectedId;\n\t\t},\n\t\tgetSelectedId: function(){\n\t\t\treturn selectedId;\n\t\t},\n\t\tisSelected: function(id){\n\t\t\treturn id == selectedId;\n\t\t},\n\t\tunselect: function(id){\n\t\t\tvar id = id || selectedId;\n\t\t\tif(!id)\n\t\t\t\treturn;\n\t\t\tselectedId = null;\n\t\t\tif(!this._skip_refresh){\n\t\t\t\tthis.refresh(id);\n\t\t\t\tunselect.call(this, id);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createDataStoreSelectMixin;","import * as utils from \"../../utils/utils\";\n\n\nvar createLinksStoreFacade = function(){\n\treturn {\n\tgetLinkCount: function () {\n\t\treturn this.$data.linksStore.count();\n\t},\n\n\tgetLink : function (id) {\n\t\treturn this.$data.linksStore.getItem(id);\n\t},\n\n\tgetLinks : function () {\n\t\treturn this.$data.linksStore.getItems();\n\t},\n\n\tisLinkExists : function (id) {\n\t\treturn this.$data.linksStore.exists(id);\n\t},\n\n\taddLink : function (link) {\n\t\tconst newLink = this.$data.linksStore.addItem(link);\n\t\t// GS-1222. Update fullOrder otherwise the link won't appear after render\n\t\tif (this.$data.linksStore.isSilent()){\n\t\t\tthis.$data.linksStore.fullOrder.push(newLink);\n\t\t}\n\t\treturn newLink;\n\t},\n\n\tupdateLink : function (id, data) {\n\t\tif (!utils.defined(data))\n\t\t\tdata = this.getLink(id);\n\t\tthis.$data.linksStore.updateItem(id, data);\n\t},\n\n\tdeleteLink : function (id) {\n\t\treturn this.$data.linksStore.removeItem(id);\n\t},\n\n\tchangeLinkId : function (oldid, newid) {\n\t\treturn this.$data.linksStore.changeId(oldid, newid);\n\t}\n};\n};\n\nexport default createLinksStoreFacade;","import * as utils from \"../../../utils/utils\";\n\nfunction ScaleHelper(gantt){\n\tvar dateHelper = gantt.date;\n\tvar services = gantt.$services;\n\n\treturn {\n\t\tgetSum: function (sizes, from, to) {\n\t\t\tif (to === undefined)\n\t\t\t\tto = sizes.length - 1;\n\t\t\tif (from === undefined)\n\t\t\t\tfrom = 0;\n\n\t\t\tvar summ = 0;\n\t\t\tfor (var i = from; i <= to; i++)\n\t\t\t\tsumm += sizes[i];\n\n\t\t\treturn summ;\n\t\t},\n\t\tsetSumWidth: function (sum_width, scale, from, to) {\n\t\t\tvar parts = scale.width;\n\n\t\t\tif (to === undefined)\n\t\t\t\tto = parts.length - 1;\n\t\t\tif (from === undefined)\n\t\t\t\tfrom = 0;\n\t\t\tvar length = to - from + 1;\n\n\t\t\tif (from > parts.length - 1 || length <= 0 || to > parts.length - 1)\n\t\t\t\treturn;\n\n\t\t\tvar oldWidth = this.getSum(parts, from, to);\n\n\t\t\tvar diff = sum_width - oldWidth;\n\n\t\t\tthis.adjustSize(diff, parts, from, to);\n\t\t\tthis.adjustSize(-diff, parts, to + 1);\n\n\t\t\tscale.full_width = this.getSum(parts);\n\t\t},\n\t\tsplitSize: function (width, count) {\n\t\t\tvar arr = [];\n\t\t\tfor (var i = 0; i < count; i++) arr[i] = 0;\n\n\t\t\tthis.adjustSize(width, arr);\n\t\t\treturn arr;\n\n\t\t},\n\t\tadjustSize: function (width, parts, from, to) {\n\t\t\tif (!from)\n\t\t\t\tfrom = 0;\n\t\t\tif (to === undefined)\n\t\t\t\tto = parts.length - 1;\n\n\t\t\tvar length = to - from + 1;\n\n\t\t\tvar full = this.getSum(parts, from, to);\n\n\t\t\tfor (var i = from; i <= to; i++) {\n\t\t\t\tvar share = Math.floor(width * (full ? (parts[i] / full) : (1 / length)));\n\n\t\t\t\tfull -= parts[i];\n\t\t\t\twidth -= share;\n\t\t\t\tlength--;\n\n\t\t\t\tparts[i] += share;\n\t\t\t}\n\t\t\tparts[parts.length - 1] += width;\n\t\t},\n\t\tsortScales: function (scales) {\n\t\t\tfunction cellSize(unit, step) {\n\t\t\t\tvar d = new Date(1970, 0, 1);\n\t\t\t\treturn dateHelper.add(d, step, unit) - d;\n\t\t\t}\n\n\t\t\tscales.sort(function (a, b) {\n\t\t\t\tif (cellSize(a.unit, a.step) < cellSize(b.unit, b.step)) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if (cellSize(a.unit, a.step) > cellSize(b.unit, b.step)) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (var i = 0; i < scales.length; i++) {\n\t\t\t\tscales[i].index = i;\n\t\t\t}\n\t\t},\n\t\t_isLegacyMode: function(config){\n\t\t\tvar scaleConfig = config || gantt.config;\n\t\t\treturn scaleConfig.scale_unit || scaleConfig.date_scale || scaleConfig.subscales;\n\t\t},\n\t\t_prepareScaleObject: function(scale){\n\t\t\tvar format = scale.format;\n\t\t\tif(!format){\n\t\t\t\tformat = scale.template || scale.date || \"%d %M\";\n\t\t\t}\n\n\t\t\tif(typeof format === \"string\"){\n\t\t\t\tformat = gantt.date.date_to_str(format);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tunit: scale.unit || \"day\",\n\t\t\t\tstep: scale.step || 1,\n\t\t\t\tformat: format,\n\t\t\t\tcss: scale.css\n\t\t\t};\n\t\t},\n\t\tprimaryScale: function(config) {\n\t\t\tvar templates = services.getService(\"templateLoader\");\n\t\t\tvar legacyMode = this._isLegacyMode(config);\n\n\t\t\tvar scaleConfig = config || gantt.config;\n\n\t\t\tvar result;\n\t\t\tif(legacyMode){\n\t\t\t\ttemplates.initTemplate(\"date_scale\", undefined, undefined, scaleConfig, gantt.config.templates);\n\t\t\t\tresult = {\n\t\t\t\t\tunit: gantt.config.scale_unit,\n\t\t\t\t\tstep: gantt.config.step,\n\t\t\t\t\ttemplate: gantt.templates.date_scale,\n\t\t\t\t\tdate: gantt.config.date_scale,\n\t\t\t\t\tcss: gantt.templates.scale_cell_class\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\tvar primaryScale = scaleConfig.scales[0];\n\t\t\t\tresult = {\n\t\t\t\t\tunit: primaryScale.unit,\n\t\t\t\t\tstep: primaryScale.step,\n\t\t\t\t\ttemplate: primaryScale.template,\n\t\t\t\t\tformat: primaryScale.format,\n\t\t\t\t\tdate: primaryScale.date,\n\t\t\t\t\tcss: primaryScale.css || gantt.templates.scale_cell_class\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn this._prepareScaleObject(result);\n\t\t},\n\t\tgetSubScales: function(config) {\n\t\t\tvar legacyMode = this._isLegacyMode(config);\n\t\t\tvar scaleConfig = config || gantt.config;\n\t\t\tvar scales;\n\t\t\tif(legacyMode){\n\t\t\t\tlet docLink = \"https://docs.dhtmlx.com/gantt/migrating.html#:~:text=%3D%20false%3B-,Time%20scale%20settings,-Configuration%20of%20time\";\n\t\t\t\tif (gantt.env.isFF){\n\t\t\t\t\tdocLink = \"https://docs.dhtmlx.com/gantt/migrating.html#6162\";\n\t\t\t\t}\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.warn(`You are using the obsolete scale configuration.\nIt will stop working in the future versions.\nPlease migrate the configuration to the newer version:\n${docLink}`);\n\t\t\t\tscales = scaleConfig.subscales || [];\n\t\t\t}else{\n\t\t\t\tscales = scaleConfig.scales.slice(1);\n\t\t\t}\n\t\t\t\n\t\t\treturn scales.map(function(scale){\n\t\t\t\treturn this._prepareScaleObject(scale);\n\t\t\t}.bind(this));\n\t\t},\n\n\t\tprepareConfigs: function (scales, min_coll_width, container_width, scale_height, minDate, maxDate, rtl) {\n\t\t\tvar heights = this.splitSize(scale_height, scales.length);\n\t\t\tvar full_width = container_width;\n\n\t\t\tvar configs = [];\n\t\t\tfor (var i = scales.length - 1; i >= 0; i--) {\n\t\t\t\tvar main_scale = (i == scales.length - 1);\n\t\t\t\tvar cfg = this.initScaleConfig(scales[i], minDate, maxDate);\n\t\t\t\tif (main_scale) {\n\t\t\t\t\tthis.processIgnores(cfg);\n\t\t\t\t}\n\n\t\t\t\tthis.initColSizes(cfg, min_coll_width, full_width, heights[i]);\n\t\t\t\tthis.limitVisibleRange(cfg);\n\n\t\t\t\tif (main_scale) {\n\t\t\t\t\tfull_width = cfg.full_width;\n\t\t\t\t}\n\n\t\t\t\tconfigs.unshift(cfg);\n\t\t\t}\n\n\n\t\t\tfor (var i = 0; i < configs.length - 1; i++) {\n\t\t\t\tthis.alineScaleColumns(configs[configs.length - 1], configs[i]);\n\t\t\t}\n\t\t\tfor (var i = 0; i < configs.length; i++) {\n\n\t\t\t\tif(rtl){\n\t\t\t\t\tthis.reverseScale(configs[i]);\n\t\t\t\t}\n\t\t\t\tthis.setPosSettings(configs[i]);\n\t\t\t}\n\t\t\treturn configs;\n\n\t\t},\n\n\t\treverseScale: function(scale){\n\t\t\tscale.width = scale.width.reverse();\n\t\t\tscale.trace_x = scale.trace_x.reverse();\n\n\t\t\tvar indexes = scale.trace_indexes;\n\t\t\tscale.trace_indexes = {};\n\t\t\tscale.trace_index_transition = {};\n\t\t\tscale.rtl = true;\n\t\t\tfor(var i = 0; i < scale.trace_x.length; i++){\n\t\t\t\tscale.trace_indexes[scale.trace_x[i].valueOf()] = i;\n\t\t\t\tscale.trace_index_transition[indexes[scale.trace_x[i].valueOf()]] = i;\n\t\t\t}\n\t\t\treturn scale;\n\t\t},\n\n\t\tsetPosSettings: function (config) {\n\t\t\tfor (var i = 0, len = config.trace_x.length; i < len; i++) {\n\t\t\t\tconfig.left.push((config.width[i - 1] || 0) + (config.left[i - 1] || 0));\n\t\t\t}\n\t\t},\n\n\t\t_ignore_time_config: function (date, scale) {\n\n\t\t\tif (gantt.config.skip_off_time) {\n\t\t\t\tvar skip = true;\n\t\t\t\tvar probe = date;\n\n\t\t\t\t// check dates in case custom scale unit, e.g. {unit: \"month\", step: 3}\n\t\t\t\tfor (var i = 0; i < scale.step; i++) {\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tprobe = dateHelper.add(date, i, scale.unit);\n\t\t\t\t\t}\n\n\t\t\t\t\tskip = skip && !this.isWorkTime(probe, scale.unit);\n\t\t\t\t}\n\n\t\t\t\treturn skip;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t//defined in an extension\n\t\tprocessIgnores: function (config) {\n\t\t\tconfig.ignore_x = {};\n\t\t\tconfig.display_count = config.count;\n\t\t},\n\t\tinitColSizes: function (config, min_col_width, full_width, line_height) {\n\t\t\tvar cont_width = full_width;\n\n\t\t\tconfig.height = line_height;\n\n\t\t\tvar column_count = config.display_count === undefined ? config.count : config.display_count;\n\n\t\t\tif (!column_count)\n\t\t\t\tcolumn_count = 1;\n\n\t\t\tconfig.col_width = Math.floor(cont_width / column_count);\n\n\t\t\tif (min_col_width) {\n\t\t\t\tif (config.col_width < min_col_width) {\n\t\t\t\t\tconfig.col_width = min_col_width;\n\t\t\t\t\tcont_width = config.col_width * column_count;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconfig.width = [];\n\t\t\tvar ignores = config.ignore_x || {};\n\t\t\tfor (var i = 0; i < config.trace_x.length; i++) {\n\t\t\t\tif (ignores[config.trace_x[i].valueOf()] || (config.display_count == config.count)) {\n\t\t\t\t\tconfig.width[i] = 0;\n\t\t\t\t} else {\n\t\t\t\t\t// width of month columns should be proportional month duration\n\t\t\t\t\tvar width = 1;\n\t\t\t\t\tif (config.unit == \"month\") {\n\t\t\t\t\t\tvar days = Math.round((dateHelper.add(config.trace_x[i], config.step, config.unit) - config.trace_x[i]) / (1000 * 60 * 60 * 24));\n\t\t\t\t\t\twidth = days;\n\t\t\t\t\t}\n\t\t\t\t\tconfig.width[i] = width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.adjustSize(cont_width - this.getSum(config.width)/* 1 width per column from the code above */, config.width);\n\t\t\tconfig.full_width = this.getSum(config.width);\n\t\t},\n\t\tinitScaleConfig: function (config, min_date, max_date) {\n\t\t\tvar cfg = utils.mixin({\n\t\t\t\tcount: 0,\n\t\t\t\tcol_width: 0,\n\t\t\t\tfull_width: 0,\n\t\t\t\theight: 0,\n\t\t\t\twidth: [],\n\t\t\t\tleft: [],\n\t\t\t\ttrace_x: [],\n\t\t\t\ttrace_indexes: {},\n\t\t\t\tmin_date: new Date(min_date),\n\t\t\t\tmax_date: new Date(max_date)\n\t\t\t}, config);\n\n\t\t\tthis.eachColumn(config.unit, config.step, min_date, max_date, function (date) {\n\t\t\t\tcfg.count++;\n\t\t\t\tcfg.trace_x.push(new Date(date));\n\t\t\t\tcfg.trace_indexes[date.valueOf()] = cfg.trace_x.length - 1;\n\t\t\t});\n\n\t\t\tcfg.trace_x_ascending = cfg.trace_x.slice();\n\t\t\treturn cfg;\n\t\t},\n\t\titerateScales: function (lower_scale, upper_scale, from, to, callback) {\n\t\t\tvar upper_dates = upper_scale.trace_x;\n\t\t\tvar lower_dates = lower_scale.trace_x;\n\n\t\t\tvar prev = from || 0;\n\t\t\tvar end = to || (lower_dates.length - 1);\n\t\t\tvar prevUpper = 0;\n\n\n\t\t\tfor (var up = 1; up < upper_dates.length; up++) {\n\t\t\t\tvar target_index = (lower_scale.trace_indexes[+upper_dates[up]]);\n\t\t\t\tif (target_index !== undefined && target_index <= end) {\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback.apply(this, [prevUpper, up, prev, target_index]);\n\t\t\t\t\t}\n\t\t\t\t\tprev = target_index;\n\t\t\t\t\tprevUpper = up;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\talineScaleColumns: function (lower_scale, upper_scale, from, to) {\n\t\t\tthis.iterateScales(lower_scale, upper_scale, from, to, function (upper_start, upper_end, lower_start, lower_end) {\n\t\t\t\tvar targetWidth = this.getSum(lower_scale.width, lower_start, lower_end - 1);\n\t\t\t\tvar actualWidth = this.getSum(upper_scale.width, upper_start, upper_end - 1);\n\t\t\t\tif (actualWidth != targetWidth) {\n\t\t\t\t\tthis.setSumWidth(targetWidth, upper_scale, upper_start, upper_end - 1);\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\teachColumn: function (unit, step, min_date, max_date, callback) {\n\t\t\tvar start = new Date(min_date),\n\t\t\t\tend = new Date(max_date);\n\t\t\tif (dateHelper[unit + \"_start\"]) {\n\t\t\t\tstart = dateHelper[unit + \"_start\"](start);\n\t\t\t}\n\n\t\t\tvar curr = new Date(start);\n\t\t\tif (+curr >= +end) {\n\t\t\t\tend = dateHelper.add(curr, step, unit);\n\t\t\t}\n\t\t\twhile (+curr < +end) {\n\t\t\t\tcallback.call(this, new Date(curr));\n\t\t\t\tvar tzOffset = curr.getTimezoneOffset();\n\t\t\t\tcurr = dateHelper.add(curr, step, unit);\n\t\t\t\tcurr = gantt._correct_dst_change(curr, tzOffset, step, unit);\n\t\t\t\tif (dateHelper[unit + '_start'])\n\t\t\t\t\tcurr = dateHelper[unit + \"_start\"](curr);\n\t\t\t}\n\t\t},\n\t\tlimitVisibleRange: function (cfg) {\n\t\t\tvar dates = cfg.trace_x;\n\n\t\t\tvar left = 0, right = cfg.width.length - 1;\n\t\t\tvar diff = 0;\n\t\t\tif (+dates[0] < +cfg.min_date && left != right) {\n\t\t\t\tvar width = Math.floor(cfg.width[0] * ((dates[1] - cfg.min_date) / (dates[1] - dates[0])));\n\t\t\t\tdiff += cfg.width[0] - width;\n\t\t\t\tcfg.width[0] = width;\n\n\t\t\t\tdates[0] = new Date(cfg.min_date);\n\t\t\t}\n\n\t\t\tvar last = dates.length - 1;\n\t\t\tvar lastDate = dates[last];\n\t\t\tvar outDate = dateHelper.add(lastDate, cfg.step, cfg.unit);\n\t\t\tif (+outDate > +cfg.max_date && last > 0) {\n\t\t\t\tvar width = cfg.width[last] - Math.floor(cfg.width[last] * ((outDate - cfg.max_date) / (outDate - lastDate)));\n\t\t\t\tdiff += cfg.width[last] - width;\n\t\t\t\tcfg.width[last] = width;\n\t\t\t}\n\n\t\t\tif (diff) {\n\t\t\t\tvar full = this.getSum(cfg.width);\n\t\t\t\tvar shared = 0;\n\t\t\t\tfor (var i = 0; i < cfg.width.length; i++) {\n\t\t\t\t\tvar share = Math.floor(diff * (cfg.width[i] / full));\n\t\t\t\t\tcfg.width[i] += share;\n\t\t\t\t\tshared += share;\n\t\t\t\t}\n\t\t\t\tthis.adjustSize(diff - shared, cfg.width);\n\t\t\t}\n\n\t\t}\n\t};\n}\n\nexport default ScaleHelper;\n","import ScaleHelper from \"./ui/timeline/scales_ignore\";\nimport PrimaryScaleHelper from \"./ui/timeline/scales\";\n\nfunction resolveConfigRange(unit, gantt){\n\tvar range = {\n\t\tstart_date:null,\n\t\tend_date:null\n\t};\n\n\tif (gantt.config.start_date && gantt.config.end_date) {\n\t\trange.start_date = gantt.date[unit + \"_start\"](new Date(gantt.config.start_date));\n\n\t\tvar end = new Date(gantt.config.end_date);\n\t\tvar start_interval = gantt.date[unit + \"_start\"](new Date(end));\n\t\tif (+end != +start_interval) {\n\t\t\tend = gantt.date.add(start_interval, 1, unit);\n\t\t} else {\n\t\t\tend = start_interval;\n\t\t}\n\n\t\trange.end_date = end;\n\t}\n\treturn range;\n}\n\nfunction _scale_range_unit(gantt) {\n\tvar primaryScale = (new PrimaryScaleHelper(gantt)).primaryScale();\n\tvar unit = primaryScale.unit;\n\tvar step = primaryScale.step;\n\tif (gantt.config.scale_offset_minimal) {\n\n\t\tvar helper = new ScaleHelper(gantt);\n\t\tvar scales = [helper.primaryScale()].concat(helper.getSubScales());\n\n\t\thelper.sortScales(scales);\n\t\tunit = scales[scales.length - 1].unit;\n\t\tstep = scales[scales.length - 1].step || 1;\n\t}\n\treturn { unit:unit, step:step };\n}\n\nfunction _init_tasks_range(gantt) {\n\tvar cfg = _scale_range_unit(gantt);\n\tvar unit = cfg.unit,\n\t\tstep = cfg.step;\n\tvar range = resolveConfigRange(unit, gantt);\n\n\t// GS-1544: Show correct date range if we have tasks or only projects\n\tif(!(range.start_date && range.end_date)){\n\t\tvar onlyProjectTasks = true;\n\t\tvar tasks = gantt.getTaskByTime();\n\t\tfor (var i = 0; i < tasks.length; i++) {\n\t\t\tvar task = tasks[i];\n\t\t\tif (task.type !== gantt.config.types.project){\n\t\t\t\tonlyProjectTasks = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (tasks.length && onlyProjectTasks){\n\t\t\tvar start_date = tasks[0].start_date;\n\t\t\tvar end_date = gantt.date.add(start_date, 1, gantt.config.duration_unit);\n\t\t\trange = {\n\t\t\t\tstart_date: new Date(start_date),\n\t\t\t\tend_date: new Date(end_date)\n\t\t\t};\n\t\t} else{\n\t\t\trange = gantt.getSubtaskDates();\n\t\t}\n\n\t\tif(!range.start_date || !range.end_date){\n\t\t\trange = {\n\t\t\t\tstart_date: new Date(),\n\t\t\t\tend_date: new Date()\n\t\t\t};\n\t\t}\n\t\t// extend the displayed date range including the constraints, deadlines and baselines\n\t\tgantt.eachTask(function(task){\n\t\t\tif (gantt.config.deadlines !== false && task.deadline){\n\t\t\t\textendRangeForDates(range, task.deadline, task.deadline);\n\t\t\t}\n\t\t\tif (task.constraint_date && task.constraint_type){\n\t\t\t\tif (gantt.config.constraint_types && task.constraint_type !== gantt.config.constraint_types.ASAP && task.constraint_type !== gantt.config.constraint_types.ALAP){\n\t\t\t\t\textendRangeForDates(range, task.constraint_date, task.constraint_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (gantt.config.baselines !== false && task.baselines){\n\t\t\t\ttask.baselines.forEach(function(baseline){\n\t\t\t\t\textendRangeForDates(range, baseline.start_date, baseline.end_date);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\trange.start_date = gantt.date[unit + \"_start\"](range.start_date);\n\t\trange.start_date = gantt.calculateEndDate({\n\t\t\tstart_date: gantt.date[unit + \"_start\"](range.start_date),\n\t\t\tduration: -1,\n\t\t\tunit: unit,\n\t\t\tstep:step\n\t\t});//one free column before first task\n\n\t\trange.end_date = gantt.date[unit + \"_start\"](range.end_date);\n\t\trange.end_date = gantt.calculateEndDate({start_date: range.end_date, duration: 2, unit: unit, step:step});//one free column after last task\n\t}\n\n\tgantt._min_date = range.start_date;\n\tgantt._max_date = range.end_date;\n}\n\nfunction extendRangeForDates(range, start_date, end_date){\n\tif (start_date < range.start_date){\n\t\trange.start_date = new Date(start_date);\n\t}\n\tif (end_date > range.end_date){\n\t\trange.end_date = new Date(end_date);\n\t}\n}\n\nfunction _adjust_scales(gantt) {\n\tif (gantt.config.fit_tasks) {\n\t\tvar old_min = +gantt._min_date,\n\t\t\told_max = +gantt._max_date;\n\t\t//this._init_tasks_range();\n\t\tif (+gantt._min_date != old_min || +gantt._max_date != old_max) {\n\t\t\tgantt.render();\n\n\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport default function updateTasksRange(gantt){\n\t_init_tasks_range(gantt);\n\t_adjust_scales(gantt);\n};\n","function copyLinkIdsArray(gantt, linkIds, targetHash){\n\tfor(var i = 0; i < linkIds.length; i++) {\n\t\tif(gantt.isLinkExists(linkIds[i])){\n\t\t\ttargetHash[linkIds[i]] = gantt.getLink(linkIds[i]);\n\t\t}\n\t}\n}\n\nfunction copyLinkIds(gantt, task, targetHash){\n\tcopyLinkIdsArray(gantt, task.$source, targetHash);\n\tcopyLinkIdsArray(gantt, task.$target, targetHash);\n}\n\nfunction getSubtreeLinks(gantt, rootId){\n\tvar res = {};\n\n\tif(gantt.isTaskExists(rootId)){\n\t\tcopyLinkIds(gantt, gantt.getTask(rootId), res);\n\t}\n\n\tgantt.eachTask(function(child){\n\t\tcopyLinkIds(gantt, child, res);\n\t}, rootId);\n\n\treturn res;\n}\n\nfunction getSubtreeTasks(gantt, rootId){\n\tvar res = {};\n\n\tgantt.eachTask(function(child){\n\t\tres[child.id] = child;\n\t}, rootId);\n\n\treturn res;\n}\n\nexport default {\n\tgetSubtreeLinks: getSubtreeLinks,\n\tgetSubtreeTasks: getSubtreeTasks\n};","import * as helpers from \"../../utils/helpers\";\nimport treeHelper from \"../../utils/task_tree_helpers\";\n\n\nexport default class DataProcessorEvents {\n\tprotected _dataProcessorHandlers: any[];\n\tprotected $gantt: any;\n\tprotected $dp: any;\n\n\tconstructor(gantt: any, dp: any) {\n\t\tthis.$gantt = gantt;\n\t\tthis.$dp = dp;\n\t\tthis._dataProcessorHandlers = [];\n\t}\n\n\tattach() {\n\t\tconst dp = this.$dp;\n\t\tconst gantt = this.$gantt;\n\t\tconst cascadeDelete = {};\n\n\t\tconst clientSideDelete = (id) => {\n\t\t\treturn this.clientSideDelete(id, dp, gantt);\n\t\t};\n\n\t\tfunction getTaskLinks(task) {\n\t\t\tlet _links = [];\n\n\t\t\tif (task.$source) {\n\t\t\t\t_links = _links.concat(task.$source);\n\t\t\t}\n\t\t\tif (task.$target) {\n\t\t\t\t_links = _links.concat(task.$target);\n\t\t\t}\n\n\t\t\treturn _links;\n\t\t}\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskAdd\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true, \"inserted\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskUpdate\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true);\n\n\t\t\t\t// gantt can be destroyed/reinitialized after dp.setUpdated\n\t\t\t\tif(gantt._sendTaskOrder){\n\t\t\t\t\tgantt._sendTaskOrder(id, item);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onBeforeTaskDelete\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.config.cascade_delete) {\n\t\t\t\tcascadeDelete[id] = {\n\t\t\t\t\ttasks: treeHelper.getSubtreeTasks(gantt, id),\n\t\t\t\t\tlinks: treeHelper.getSubtreeLinks(gantt, id)\n\t\t\t\t};\n\t\t\t}\n\t\t\t// GS-631. Keep the deleted item in Gantt until we receive the successful response from the server\n\t\t\tif (dp.deleteAfterConfirmation) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true, \"deleted\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskDelete\", function(id, item) { // tslint:disable-line\n\t\t\tdp.setGanttMode(\"tasks\");\n\n\t\t\t// not send delete request if item is not inserted into the db - just remove it from the client\n\t\t\tconst needDbDelete = !clientSideDelete(id);\n\t\t\tconst needCascadeDelete = gantt.config.cascade_delete && cascadeDelete[id];\n\t\t\tif (!needDbDelete && !needCascadeDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (needCascadeDelete) {\n\t\t\t\tconst dpMode = dp.updateMode;\n\t\t\t\tdp.setUpdateMode(\"off\");\n\n\t\t\t\tconst cascade = cascadeDelete[id];\n\t\t\t\tfor (const i in cascade.tasks) {\n\t\t\t\t\tif (!clientSideDelete(i)) {\n\t\t\t\t\t\tdp.storeItem(cascade.tasks[i]);\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tfor (const i in cascade.links) {\n\t\t\t\t\tif (!clientSideDelete(i)) {\n\t\t\t\t\t\tdp.storeItem(cascade.links[i]);\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcascadeDelete[id] = null;\n\n\t\t\t\tif (dpMode !== \"off\") {\n\t\t\t\t\tdp.sendAllData();\n\t\t\t\t}\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdateMode(dpMode);\n\t\t\t}\n\n\t\t\tif (needDbDelete){\n\t\t\t\tdp.storeItem(item);\n\t\t\t\tif (!dp.deleteAfterConfirmation){\n\t\t\t\t\tdp.setUpdated(id, true, \"deleted\");\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (dp.updateMode !== \"off\" && !dp._tSend) {\n\t\t\t\tdp.sendAllData();\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkUpdate\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isLinkExists(id)) {\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkAdd\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isLinkExists(id)) {\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkDelete\", function(id, item) { // tslint:disable-line\n\t\t\tdp.setGanttMode(\"links\");\n\n\t\t\tconst needDbDelete = !clientSideDelete(id);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onRowDragEnd\", function(id, target) { // tslint:disable-line\n\t\t\tgantt._sendTaskOrder(id, gantt.getTask(id));\n\t\t}));\n\n\t\tlet tasks = null;\n\t\tlet links = null;\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onTaskIdChange\", function(oldId, newId) { // tslint:disable-line\n\t\t\tif (!dp._waitMode) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst children = gantt.getChildren(newId);\n\t\t\tif (children.length) {\n\t\t\t\ttasks = tasks || {};\n\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tconst ch = this.getTask(children[i]);\n\t\t\t\t\ttasks[ch.id] = ch;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst item = this.getTask(newId);\n\t\t\tconst itemLinks = getTaskLinks(item);\n\n\t\t\tif (itemLinks.length) {\n\t\t\t\tlinks = links || {};\n\n\t\t\t\tfor (let i = 0; i < itemLinks.length; i++) {\n\t\t\t\t\tconst link = this.getLink(itemLinks[i]);\n\t\t\t\t\tlinks[link.id] = link;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tdp.attachEvent(\"onAfterUpdateFinish\", function() {\n\t\t\tif (tasks || links) {\n\t\t\t\tgantt.batchUpdate(function() {\n\t\t\t\t\tfor (const id in tasks) {\n\t\t\t\t\t\tgantt.updateTask(tasks[id].id);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const id in links) {\n\t\t\t\t\t\tgantt.updateLink(links[id].id);\n\t\t\t\t\t}\n\t\t\t\t\ttasks = null;\n\t\t\t\t\tlinks = null;\n\t\t\t\t});\n\t\t\t\tif (tasks) {\n\t\t\t\t\tgantt._dp.setGanttMode(\"tasks\");\n\t\t\t\t} else {\n\t\t\t\t\tgantt._dp.setGanttMode(\"links\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tdp.attachEvent(\"onBeforeDataSending\", function() {\n\t\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet url = this._serverProcessor;\n\t\t\tif (this._tMode === \"REST-JSON\" || this._tMode === \"REST\") {\n\t\t\t\tconst mode = this._ganttMode;\n\n\t\t\t\turl = url.substring(0, url.indexOf(\"?\") > -1 ? url.indexOf(\"?\") : url.length);\n\t\t\t\t// editing=true&\n\t\t\t\tthis.serverProcessor = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + mode;\n\t\t\t} else {\n\t\t\t\tconst pluralizedMode = this._ganttMode + \"s\";\n\t\t\t\tthis.serverProcessor = url + gantt.ajax.urlSeparator(url) + \"gantt_mode=\" + pluralizedMode;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\n\t\tdp.attachEvent(\"insertCallback\", function insertCallback(upd, id, parent, mode) { // tslint:disable-line\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\n\t\t\tconst methods = {\n\t\t\t\tadd: gantt.addTask,\n\t\t\t\tisExist: gantt.isTaskExists\n\t\t\t};\n\t\t\tif (mode === \"links\") {\n\t\t\t\tmethods.add = gantt.addLink;\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\n\t\t\t}\n\t\t\tif (methods.isExist.call(gantt, id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdata.id = id;\n\t\t\tmethods.add.call(gantt, data);\n\t\t});\n\n\t\tdp.attachEvent(\"updateCallback\", function updateCallback(upd, id) {\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\n\t\t\tif (!gantt.isTaskExists(id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst objData = gantt.getTask(id);\n\t\t\tfor (const key in data) {\n\t\t\t\tlet property = data[key];\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase \"id\":\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase \"start_date\":\n\t\t\t\t\tcase \"end_date\":\n\t\t\t\t\t\tproperty = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date(property) : gantt.templates.parse_date(property);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"duration\":\n\t\t\t\t\t\tobjData.end_date = gantt.calculateEndDate({start_date: objData.start_date, duration: property, task:objData});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tobjData[key] = property;\n\t\t\t}\n\t\t\tgantt.updateTask(id);\n\t\t\tgantt.refreshData();\n\t\t});\n\t\tdp.attachEvent(\"deleteCallback\", function deleteCallback(upd, id, parent, mode) { // tslint:disable-line\n\t\t\tconst methods = {\n\t\t\t\tdelete: gantt.deleteTask,\n\t\t\t\tisExist: gantt.isTaskExists\n\t\t\t};\n\t\t\tif (mode === \"links\") {\n\t\t\t\tmethods.delete = gantt.deleteLink;\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\n\t\t\t} else if(mode === \"assignment\") {\n\t\t\t\tmethods.delete = function(val) {\n\t\t\t\t\tgantt.$data.assignmentsStore.remove(val);\n\t\t\t\t};\n\t\t\t\tmethods.isExist = function(val){\n\t\t\t\t\treturn gantt.$data.assignmentsStore.exists(val);\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (methods.isExist.call(gantt, id)) {\n\t\t\t\tmethods.delete.call(gantt, id);\n\t\t\t}\n\t\t});\n\n\t\tthis.handleResourceCRUD(dp, gantt);\n\t\tthis.handleResourceAssignmentCRUD(dp, gantt);\n\t\tthis.handleBaselineCRUD(dp, gantt);\n\t}\n\n\tclientSideDelete(id, dp, gantt){\n\t\tconst updated = dp.updatedRows.slice();\n\t\tlet clientOnly = false;\n\n\t\tif(gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"true_deleted\"){\n\t\t\tclientOnly = true;\n\t\t\tdp.setUpdated(id,false);\n\t\t}\n\n\t\tfor (let i = 0; i < updated.length && !dp._in_progress[id]; i++) {\n\t\t\tif (updated[i] === id) {\n\t\t\t\tif (gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"inserted\") {\n\t\t\t\t\tclientOnly = true;\n\t\t\t\t}\n\t\t\t\tdp.setUpdated(id,false);\n\t\t\t}\n\t\t}\n\t\treturn clientOnly;\n\t}\n\n\thandleResourceAssignmentCRUD(dp, gantt){\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_assignments !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst assignmentsStore = gantt.getDatastore(gantt.config.resource_assignment_store);\n\t\tconst insertedTasks = {};\n\t\tconst pendingAssignments = {};\n\n\t\tgantt.attachEvent(\"onBeforeTaskAdd\", function(id, task){\n\t\t\tinsertedTasks[id] = true;\n\t\t\treturn true;\n\t\t});\n\n\t\tfunction putAssignmentToQueue(item){\n\t\t\tpendingAssignments[item.id] = item;\n\t\t\tinsertedTasks[item.task_id] = true;\n\t\t}\n\n\t\tfunction insertResourceAssignment(assignment){\n\t\t\tconst id = assignment.id;\n\t\t\tif (assignmentsStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"assignment\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t\tdelete pendingAssignments[id];\n\t\t}\n\n\t\tgantt.attachEvent(\"onTaskIdChange\", function(id, newId){\n\t\t\tdelete insertedTasks[id];\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tif(insertedTasks[item.task_id]){\n\t\t\t\t// inserting assignment of new task\n\t\t\t\t// task is not saved yet, need to wait till it gets permanent id and save assigmnents after that\n\t\t\t\tputAssignmentToQueue(item);\n\t\t\t}else{\n\t\t\t\tinsertResourceAssignment(item);\n\t\t\t}\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (assignmentsStore.exists(id)) {\n\t\t\t\tif(pendingAssignments[id]){\n\t\t\t\t\tinsertResourceAssignment(item);\n\t\t\t\t}else{\n\t\t\t\t\tdp.setGanttMode(\"assignment\");\n\t\t\t\t\tdp.setUpdated(id, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"assignment\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\n\t}\n\n\thandleResourceCRUD(dp, gantt){\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_resources !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourcesStore = gantt.getDatastore(gantt.config.resource_store);\n\n\t\tfunction insertResource(resource){\n\t\t\tconst id = resource.id;\n\t\t\tif (resourcesStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"resource\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}\n\n\t\tresourcesStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tinsertResource(item);\n\t\t});\n\n\t\tresourcesStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (resourcesStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"resource\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t});\n\n\t\tresourcesStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"resource\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\n\t}\n\n\thandleBaselineCRUD(dp, gantt){\n\t\tif(!gantt.config.baselines || gantt.config.baselines.dataprocessor_baselines !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst baselineStore = gantt.getDatastore(gantt.config.baselines.datastore);\n\n\t\tfunction insertResource(resource){\n\t\t\tconst id = resource.id;\n\t\t\tif (baselineStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"baseline\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}\n\n\t\tbaselineStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tinsertResource(item);\n\t\t});\n\n\t\tbaselineStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (baselineStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"baseline\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t});\n\n\t\tbaselineStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"baseline\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\t}\n\n\tdetach() {\n\t\thelpers.forEach(this._dataProcessorHandlers, (e) => {\n\t\t\tthis.$gantt.detachEvent(e);\n\t\t});\n\t\tthis._dataProcessorHandlers = [];\n\t}\n}\n","import * as utils from \"../../utils/utils\";\n\nexport default class SimpleStorage {\n\tpublic static create = () : SimpleStorage => {\n\t\treturn new SimpleStorage();\n\t};\n\n\tprotected _storage: { [id: string]: any; };\n\n\tprotected constructor() {\n\t\tthis._storage = {};\n\t}\n\n\tpublic clear = (): void => {\n\t\tthis._storage = {};\n\t};\n\n\tpublic storeItem = (item: any): void => {\n\t\tthis._storage[item.id] = utils.copy(item);\n\t};\n\n\tpublic getStoredItem = (id: string): any => {\n\t\treturn this._storage[id] || null;\n\t};\n}","import eventable from \"../../utils/eventable\";\nimport * as helpers from \"../../utils/helpers\";\nimport * as utils from \"../../utils/utils\";\nimport DataProcessorEvents from \"./data_processor_events\";\nimport extendGantt from \"./extend_gantt\";\nimport SimpleStorage from \"./simple_storage\";\nimport global from \"../../utils/global\";\n\nexport interface DataProcessor { // tslint:disable-line\n\t$gantt: any;\n\tdetachAllEvents: any;\n\tattachEvent: any;\n\tcallEvent: any;\n\n\tserverProcessor: string;\n\taction_param: string;\n\tupdatedRows: any[];\n\tautoUpdate: boolean;\n\tupdateMode: string;\n\tmessages: any[];\n\tstyles: object;\n\tdnd: any;\n\tdeleteAfterConfirmation?: any;\n}\n\nexport function createDataProcessor(config: any) {\n\tlet router;\n\tlet tMode;\n\tlet headers;\n\tif (config instanceof Function) {\n\t\trouter = config;\n\t} else if (config.hasOwnProperty(\"router\")) {\n\t\trouter = config.router;\n\t} else if (config.hasOwnProperty(\"assignment\") || config.hasOwnProperty(\"baseline\") || config.hasOwnProperty(\"link\") || config.hasOwnProperty(\"task\")) {\n\t\trouter = config;\n\t} else if(config.hasOwnProperty(\"headers\")){\n\t\t// GS-2312 for custom headers\n\t\theaders = config.headers;\n\t}\n\tif (router) {\n\t\ttMode = \"CUSTOM\";\n\t} else {\n\t\ttMode = config.mode || \"REST-JSON\";\n\t}\n\tconst gantt = this; // tslint:disable-line\n\tconst dp = new DataProcessor(config.url);\n\n\n\tdp.init(gantt);\n\tdp.setTransactionMode({\n\t\tmode: tMode,\n\t\trouter,\n\t\theaders\n\t}, config.batchUpdate);\n\tif(config.deleteAfterConfirmation){\n\t\tdp.deleteAfterConfirmation = config.deleteAfterConfirmation;\n\t}\n\treturn dp;\n}\n\nexport class DataProcessor {\n\tpublic modes: object;\n\tpublic serverProcessor: string;\n\tpublic action_param: string; // tslint:disable-line\n\tpublic updatedRows: any[];\n\tpublic autoUpdate: boolean;\n\tpublic updateMode: string;\n\tpublic messages: any[];\n\tpublic styles: object;\n\tpublic dnd: any;\n\n\tprotected _tMode: string;\n\tprotected _headers: any;\n\tprotected _payload: any;\n\tprotected _postDelim: string;\n\tprotected _waitMode: number;\n\tprotected _in_progress: object; // tslint:disable-line\n\tprotected _invalid: object;\n\tprotected _storage: SimpleStorage;\n\tprotected _tSend: boolean;\n\tprotected _serializeAsJson: boolean;\n\tprotected _router: any;\n\tprotected _utf: boolean;\n\tprotected _methods: any[];\n\tprotected _user: any;\n\tprotected _uActions: object;\n\tprotected _needUpdate: boolean;\n\tprotected _ganttMode: \"task\"|\"link\";\n\tprotected _routerParametersFormat: \"parameters\"|\"object\";\n\n\tprotected _silent_mode: any; // tslint:disable-line\n\tprotected _updateBusy: any;\n\tprotected _serverProcessor: any;\n\tprotected _initialized: boolean;\n\n\tconstructor(serverProcessorURL?) {\n\t\tthis.serverProcessor = serverProcessorURL;\n\t\tthis.action_param = \"!nativeeditor_status\";\n\n\t\tthis.updatedRows = []; // ids of updated rows\n\n\t\tthis.autoUpdate = true;\n\t\tthis.updateMode = \"cell\";\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tthis._postDelim = \"_\";\n\t\tthis._routerParametersFormat = \"parameters\";\n\n\t\tthis._waitMode = 0;\n\t\tthis._in_progress = {}; // ?\n\t\tthis._storage = SimpleStorage.create();\n\t\tthis._invalid = {};\n\t\tthis.messages = [];\n\n\t\tthis.styles = {\n\t\t\tupdated: \"font-weight:bold;\",\n\t\t\tinserted: \"font-weight:bold;\",\n\t\t\tdeleted: \"text-decoration : line-through;\",\n\t\t\tinvalid: \"background-color:FFE0E0;\",\n\t\t\tinvalid_cell: \"border-bottom:2px solid red;\",\n\t\t\terror: \"color:red;\",\n\t\t\tclear: \"font-weight:normal;text-decoration:none;\"\n\t\t};\n\t\tthis.enableUTFencoding(true);\n\t\teventable(this);\n\t}\n\n\tsetTransactionMode(mode:any, total?:any) {\n\t\tif (typeof mode === \"object\") {\n\t\t\tthis._tMode = mode.mode || this._tMode;\n\n\t\t\tif (utils.defined(mode.headers)) {\n\t\t\t\tthis._headers = mode.headers;\n\t\t\t}\n\n\t\t\tif (utils.defined(mode.payload)) {\n\t\t\t\tthis._payload = mode.payload;\n\t\t\t}\n\t\t\tthis._tSend = !!total;\n\t\t} else {\n\t\t\tthis._tMode = mode;\n\t\t\tthis._tSend = total;\n\t\t}\n\n\t\tif (this._tMode === \"REST\") {\n\t\t\tthis._tSend = false;\n\t\t}\n\n\t\tif (this._tMode === \"JSON\" || this._tMode === \"REST-JSON\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._serializeAsJson = true;\n\t\t\tthis._headers = this._headers || {};\n\t\t\tthis._headers[\"Content-Type\"] = \"application/json\";\n\t\t}else{\n\t\t\tif(this._headers && !this._headers[\"Content-Type\"]){\n\t\t\t\tthis._headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n\t\t\t}\n\t\t}\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._router = mode.router;\n\t\t}\n\t}\n\n\tescape(data:any) {\n\t\tif (this._utf) {\n\t\t\treturn encodeURIComponent(data);\n\t\t} else {\n\t\t\treturn escape(data);\n\t\t}\n\t}\n\n\t/**\n\t * @desc: allows to set escaping mode\n\t * @param: true - utf based escaping, simple - use current page encoding\n\t * @type: public\n\t */\n\tenableUTFencoding(mode:boolean) {\n\t\tthis._utf = !!mode;\n\t}\n\n\t/**\n\t * @desc: get state of updating\n\t * @returns:   true - all in sync with server, false - some items not updated yet.\n\t * @type: public\n\t */\n\tgetSyncState() {\n\t\treturn !this.updatedRows.length;\n\t}\n\n\t/**\n\t * @desc: set if rows should be send to server automatically\n\t * @param: mode - \"row\" - based on row selection changed, \"cell\" - based on cell editing finished, \"off\" - manual data sending\n\t * @type: public\n\t */\n\tsetUpdateMode(mode: string, dnd: any) {\n\t\tthis.autoUpdate = (mode === \"cell\");\n\t\tthis.updateMode = mode;\n\t\tthis.dnd = dnd;\n\t}\n\n\tignore(code: any, master: any) {\n\t\tthis._silent_mode = true;\n\t\tcode.call(master || global);\n\t\tthis._silent_mode = false;\n\t}\n\n\t/**\n\t * @desc: mark row as updated/normal. check mandatory fields, initiate autoupdate (if turned on)\n\t * @param: rowId - id of row to set update-status for\n\t * @param: state - true for \"updated\", false for \"not updated\"\n\t * @param: mode - update mode name\n\t * @type: public\n\t */\n\tsetUpdated(rowId:number|string, state: boolean, mode?: string) {\n\t\tif (this._silent_mode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ind = this.findRow(rowId);\n\n\t\tmode = mode || \"updated\";\n\t\tconst existing = this.$gantt.getUserData(rowId, this.action_param, this._ganttMode);\n\t\tif (existing && mode === \"updated\") {\n\t\t\tmode = existing;\n\t\t}\n\t\tif (state) {\n\t\t\tthis.set_invalid(rowId, false); // clear previous error flag\n\t\t\tthis.updatedRows[ind] = rowId;\n\t\t\tthis.$gantt.setUserData(rowId, this.action_param, mode, this._ganttMode);\n\t\t\tif (this._in_progress[rowId]) {\n\t\t\t\tthis._in_progress[rowId] = \"wait\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this.is_invalid(rowId)) {\n\t\t\t\tthis.updatedRows.splice(ind, 1);\n\t\t\t\tthis.$gantt.setUserData(rowId, this.action_param, \"\", this._ganttMode);\n\t\t\t}\n\t\t}\n\n\t\tthis.markRow(rowId, state, mode);\n\t\tif (state && this.autoUpdate) {\n\t\t\tthis.sendData(rowId);\n\t\t}\n\t}\n\n\tmarkRow(id: number | string, state: boolean, mode: string) {\n\t\tlet str = \"\";\n\t\tconst invalid = this.is_invalid(id);\n\t\tif (invalid) {\n\t\t\tstr = this.styles[invalid];\n\t\t\tstate = true;\n\t\t}\n\t\tif (this.callEvent(\"onRowMark\", [id, state, mode, invalid])) {\n\t\t\t// default logic\n\t\t\tstr = this.styles[state ? mode : \"clear\"] + \" \" + str;\n\n\t\t\tthis.$gantt[this._methods[0]](id, str);\n\n\t\t\tif (invalid && invalid.details) {\n\t\t\t\tstr += this.styles[invalid + \"_cell\"];\n\t\t\t\tfor (let i = 0; i < invalid.details.length; i++) {\n\t\t\t\t\tif (invalid.details[i]) {\n\t\t\t\t\t\tthis.$gantt[this._methods[1]](id, i, str);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActionByState(state: string):string {\n\t\tif (state === \"inserted\") {\n\t\t\treturn \"create\";\n\t\t}\n\n\t\tif (state === \"updated\") {\n\t\t\treturn \"update\";\n\t\t}\n\n\t\tif (state === \"deleted\") {\n\t\t\treturn \"delete\";\n\t\t}\n\n\t\t// reorder\n\t\treturn \"update\";\n\t}\n\n\tgetState(id: number | string) {\n\t\treturn this.$gantt.getUserData(id, this.action_param, this._ganttMode);\n\t}\n\n\tis_invalid(id: number | string) {\n\t\treturn this._invalid[id];\n\t}\n\n\tset_invalid(id: number | string, mode: any, details?) {\n\t\tif (details) {\n\t\t\tmode = {\n\t\t\t\tvalue: mode,\n\t\t\t\tdetails,\n\t\t\t\ttoString: function() { // tslint:disable-line\n\t\t\t\t\treturn this.value.toString();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tthis._invalid[id] = mode;\n\t}\n\n\t/**\n\t * @desc: check mandatory fields and verify values of cells, initiate update (if specified). Can be redefined in order to provide custom validation\n\t * @param: rowId - id of row to set update-status for\n\t * @type: public\n\t */\n\t// tslint:disable-next-line\n\tcheckBeforeUpdate(rowId: number | string) {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @desc: send row(s) values to server\n\t * @param: rowId - id of row which data to send. If not specified, then all \"updated\" rows will be send\n\t * @type: public\n\t */\n\tsendData(rowId?: any) {\n\t\tif (this.$gantt.editStop) {\n\t\t\tthis.$gantt.editStop();\n\t\t}\n\n\t\tif (typeof rowId === \"undefined\" || this._tSend) {\n\n\t\t\tconst pendingUpdateModes = [];\n\t\t\tif(this.modes){\n\t\t\t\tconst knownModes = [\"task\", \"link\", \"assignment\", \"baseline\"];\n\t\t\t\tknownModes.forEach((mode) => {\n\t\t\t\t\tif(this.modes[mode] && this.modes[mode].updatedRows.length){\n\t\t\t\t\t\tpendingUpdateModes.push(mode);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (pendingUpdateModes.length){\n\t\t\t\tfor(let i = 0; i < pendingUpdateModes.length; i++){\n\t\t\t\t\tthis.setGanttMode(pendingUpdateModes[i]);\n\t\t\t\t\tthis.sendAllData();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\treturn this.sendAllData();\n\t\t\t}\n\t\t}\n\t\tif (this._in_progress[rowId]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tif (!this.checkBeforeUpdate(rowId) && this.callEvent(\"onValidationError\", [rowId, this.messages])) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t}\n\n\tserialize(data: any, id: any) {\n\t\tif (this._serializeAsJson) {\n\t\t\treturn  this._serializeAsJSON(data);\n\t\t}\n\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\t\tif (typeof id !== \"undefined\") {\n\t\t\treturn this.serialize_one(data, \"\");\n\t\t} else {\n\t\t\tconst stack = [];\n\t\t\tconst keys = [];\n\t\t\tfor (const key in data) {\n\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\tstack.push(this.serialize_one(data[key], key + this._postDelim));\n\t\t\t\t\tkeys.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstack.push(\"ids=\" + this.escape(keys.join(\",\")));\n\t\t\tif (this.$gantt.security_key) {\n\t\t\t\tstack.push(\"dhx_security=\" + this.$gantt.security_key);\n\t\t\t}\n\t\t\treturn stack.join(\"&\");\n\t\t}\n\t}\n\n\tserialize_one(data: any, pref: string) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\t\tconst stack = [];\n\t\tlet serialized = \"\";\n\t\tfor (const key in data)\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tif ((key === \"id\" ||\n\t\t\t\t\tkey == this.action_param) && // tslint:disable-line\n\t\t\t\t\tthis._tMode === \"REST\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (typeof data[key] === \"string\" || typeof data[key] === \"number\") {\n\t\t\t\t\tserialized = String(data[key]);\n\t\t\t\t} else {\n\t\t\t\t\tserialized = JSON.stringify(data[key]);\n\t\t\t\t}\n\t\t\t\tstack.push(this.escape((pref || \"\") + key) + \"=\" + this.escape(serialized));\n\t\t\t}\n\t\treturn stack.join(\"&\");\n\t}\n\n\tsendAllData() {\n\t\tif (!this.updatedRows.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tlet valid: any = true;\n\n\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\tvalid = valid && this.checkBeforeUpdate(rowId);\n\t\t});\n\n\t\tif (!valid && !this.callEvent(\"onValidationError\", [\"\", this.messages])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._tSend) {\n\t\t\tthis._sendData(this._getAllData());\n\t\t} else {\n\t\t\t// this.updatedRows can be spliced from onBeforeUpdate via dp.setUpdated false\n\t\t\t// use an iterator instead of for(var i = 0; i < this.updatedRows; i++) then\n\t\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\t\tif (!this._in_progress[rowId]) {\n\t\t\t\t\tif (this.is_invalid(rowId)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tfindRow(pattern: any) {\n\t\tlet i = 0;\n\t\tfor (i = 0; i < this.updatedRows.length; i++) {\n\t\t\tif (pattern == this.updatedRows[i]) { // tslint:disable-line\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn i;\n\t}\n\n\t/**\n\t * @desc: define custom actions\n\t * @param: name - name of action, same as value of action attribute\n\t * @param: handler - custom function, which receives a XMl response content for action\n\t * @type: private\n\t */\n\tdefineAction(name: string, handler: any) {\n\t\tif (!this._uActions) {\n\t\t\tthis._uActions = {};\n\t\t}\n\t\tthis._uActions[name] = handler;\n\t}\n\n\t/**\n\t * @desc: used in combination with setOnBeforeUpdateHandler to create custom client-server transport system\n\t * @param: sid - id of item before update\n\t * @param: tid - id of item after up0ate\n\t * @param: action - action name\n\t * @type: public\n\t * @topic: 0\n\t */\n\tafterUpdateCallback(sid: number | string, tid: number | string, action: string, btag: any, ganttMode: string) {\n\t\tif(!this.$gantt){\n\t\t\t// destructor has been called before the callback\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setGanttMode(ganttMode);\n\n\t\tconst marker = sid;\n\t\tconst correct = (action !== \"error\" && action !== \"invalid\");\n\t\tif (!correct) {\n\t\t\tthis.set_invalid(sid, action);\n\t\t}\n\t\tif ((this._uActions) && (this._uActions[action]) && (!this._uActions[action](btag))) {\n\t\t\treturn (delete this._in_progress[marker]);\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tthis.setUpdated(sid, false);\n\t\t}\n\n\t\tconst originalSid = sid;\n\n\t\tswitch (action) {\n\t\t\tcase \"inserted\":\n\t\t\tcase \"insert\":\n\t\t\t\tif (tid != sid) { // tslint:disable-line\n\t\t\t\t\tthis.setUpdated(sid, false);\n\t\t\t\t\tthis.$gantt[this._methods[2]](sid, tid);\n\t\t\t\t\tsid = tid;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\tcase \"deleted\":\n\t\t\t\tif(!this.deleteAfterConfirmation || this._ganttMode !== \"task\"){\n\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\n\t\t\t\t\tthis.$gantt[this._methods[3]](sid);\n\t\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t\t\t}else{\n\t\t\t\t\tif (this._ganttMode === \"task\" && this.$gantt.isTaskExists(sid)) {\n\t\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\n\t\t\t\t\t\tconst task = this.$gantt.getTask(sid);\n\t\t\t\t\t\tthis.$gantt.silent(() => {\n\t\t\t\t\t\t\tthis.$gantt.deleteTask(sid);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.$gantt.callEvent(\"onAfterTaskDelete\", [sid, task]);\n\t\t\t\t\t\tthis.$gantt.render();\n\t\t\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\t\t}\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t\t\t}\n\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tif (correct) {\n\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"\", this._ganttMode);\n\t\t\t}\n\t\t\tdelete this._in_progress[marker];\n\t\t} else {\n\t\t\tdelete this._in_progress[marker];\n\t\t\tthis.setUpdated(tid, true, this.$gantt.getUserData(sid, this.action_param, this._ganttMode));\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdate\", [originalSid, action, tid, btag]);\n\t}\n\n\t/**\n\t * @desc: response from server\n\t * @param: xml - XMLLoader object with response XML\n\t * @type: private\n\t */\n\tafterUpdate(that: any, xml: any, id?:any) {\n\t\tlet _xml;\n\t\tif (arguments.length === 3) {\n\t\t\t_xml = arguments[1];\n\t\t} else {\n\t\t\t// old dataprocessor\n\t\t\t_xml = arguments[4];\n\t\t}\n\t\tlet mode = this.getGanttMode();\n\t\tconst reqUrl = _xml.filePath || _xml.url;\n\n\t\tif (this._tMode !== \"REST\" && this._tMode !== \"REST-JSON\") {\n\t\t\tif (reqUrl.indexOf(\"gantt_mode=links\") !== -1) {\n\t\t\t\tmode = \"link\";\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=assignments\") !== -1) {\n\t\t\t\tmode = \"assignment\";\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=baselines\") !== -1) {\n\t\t\t\tmode = \"baseline\";\n\t\t\t} else {\n\t\t\t\tmode = \"task\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (reqUrl.indexOf(\"/link\") >= 0) {\n\t\t\t\tmode = \"link\";\n\t\t\t} else if(reqUrl.indexOf(\"/assignment\") >= 0){\n\t\t\t\tmode = \"assignment\";\n\t\t\t} else if(reqUrl.indexOf(\"/baseline\") >= 0){\n\t\t\t\tmode = \"baseline\";\n\t\t\t} else {\n\t\t\t\tmode = \"task\";\n\t\t\t}\n\t\t}\n\t\tthis.setGanttMode(mode);\n\n\t\tconst ajax = this.$gantt.ajax;\n\t\t// try to use json first\n\t\tlet tag;\n\n\t\ttry {\n\t\t\ttag = JSON.parse(xml.xmlDoc.responseText);\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t} catch (e) {\n\n\t\t\t// empty response also can be processed by json handler\n\t\t\tif (!xml.xmlDoc.responseText.length) {\n\t\t\t\ttag = {};\n\t\t\t}\n\t\t}\n\n\t\tconst processCallback = (itemId: any) => {\n\t\t\tconst action = tag.action || this.getState(itemId) || \"updated\";\n\t\t\tconst sid = tag.sid || itemId[0];\n\t\t\tconst tid = tag.tid || itemId[0];\n\t\t\tthat.afterUpdateCallback(sid, tid, action, tag, mode);\n\t\t};\n\t\tif (tag) {\n\t\t\t// GS-753. When multiple tasks are updated, unhighlight all of them\n\t\t\tif (Array.isArray(id) && id.length > 1) {\n\t\t\t\tid.forEach((taskId) => processCallback(taskId));\n\t\t\t} else {\n\t\t\t\tprocessCallback(id);\n\t\t\t}\n\t\t\tthat.finalizeUpdate();\n\t\t\tthis.setGanttMode(mode);\n\t\t\treturn;\n\t\t}\n\n\t\t// xml response\n\t\tconst top = ajax.xmltop(\"data\", xml.xmlDoc); // fix incorrect content type in IE\n\t\tif (!top) {\n\t\t\treturn this.cleanUpdate(id);\n\t\t}\n\t\tconst atag = ajax.xpath(\"//data/action\", top);\n\t\tif (!atag.length) {\n\t\t\treturn this.cleanUpdate(id);\n\t\t}\n\n\t\tfor (let i = 0; i < atag.length; i++) {\n\t\t\tconst btag = atag[i];\n\t\t\tconst action = btag.getAttribute(\"type\");\n\t\t\tconst sid = btag.getAttribute(\"sid\");\n\t\t\tconst tid = btag.getAttribute(\"tid\");\n\n\t\t\tthat.afterUpdateCallback(sid, tid, action, btag, mode);\n\t\t}\n\t\tthat.finalizeUpdate();\n\t}\n\n\tcleanUpdate(id: any[]) {\n\t\tif (id) {\n\t\t\tfor (let i = 0; i < id.length; i++) {\n\t\t\t\tdelete this._in_progress[id[i]];\n\t\t\t}\n\t\t}\n\t}\n\n\tfinalizeUpdate() {\n\t\tif (this._waitMode) {\n\t\t\tthis._waitMode--;\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdateFinish\", []);\n\t\tif (!this.updatedRows.length) {\n\t\t\tthis.callEvent(\"onFullSync\", []);\n\t\t}\n\t}\n\n\t/**\n\t * @desc: initializes data-processor\n\t * @param: gantt - dhtmlxGantt object to attach this data-processor to\n\t * @type: public\n\t */\n\tinit(gantt: any) {\n\t\tif (this._initialized) {\n\t\t\treturn;\n\t\t}\n\t\tthis.$gantt = gantt;\n\t\tif (this.$gantt._dp_init) {\n\t\t\tthis.$gantt._dp_init(this);\n\t\t}\n\n\t\tthis._setDefaultTransactionMode();\n\n\t\tthis.styles = {\n\t\t\tupdated:\"gantt_updated\",\n\t\t\torder:\"gantt_updated\",\n\t\t\tinserted:\"gantt_inserted\",\n\t\t\tdeleted:\"gantt_deleted\",\n\t\t\tdelete_confirmation:\"gantt_deleted\",\n\t\t\tinvalid:\"gantt_invalid\",\n\t\t\terror:\"gantt_error\",\n\t\t\tclear:\"\"\n\t\t};\n\n\t\tthis._methods=[\"_row_style\",\"setCellTextStyle\",\"_change_id\",\"_delete_task\"];\n\t\textendGantt(this.$gantt, this);\n\t\tconst dataProcessorEvents = new DataProcessorEvents(this.$gantt, this);\n\t\tdataProcessorEvents.attach();\n\t\tthis.attachEvent(\"onDestroy\", function() {\n\t\t\tdelete this.setGanttMode;\n\t\t\tdelete this._getRowData;\n\n\t\t\tdelete this.$gantt._dp;\n\t\t\tdelete this.$gantt._change_id;\n\t\t\tdelete this.$gantt._row_style;\n\t\t\tdelete this.$gantt._delete_task;\n\t\t\tdelete this.$gantt._sendTaskOrder;\n\t\t\tdelete this.$gantt;\n\n\t\t\tdataProcessorEvents.detach();\n\t\t});\n\t\tthis.$gantt.callEvent(\"onDataProcessorReady\", [this]);\n\t\tthis._initialized = true;\n\t}\n\n\tsetOnAfterUpdate(handler) {\n\t\tthis.attachEvent(\"onAfterUpdate\", handler);\n\t}\n\n\tsetOnBeforeUpdateHandler(handler) {\n\t\tthis.attachEvent(\"onBeforeDataSending\", handler);\n\t}\n\n\t/* starts autoupdate mode\n\t\t@param interval time interval for sending update requests\n\t*/\n\tsetAutoUpdate(interval, user) {\n\t\tinterval = interval || 2000;\n\n\t\tthis._user = user || (new Date()).valueOf();\n\t\tthis._needUpdate = false;\n\n\t\tthis._updateBusy = false;\n\n\t\tthis.attachEvent(\"onAfterUpdate\", this.afterAutoUpdate); // arguments sid, action, tid, xml_node;\n\n\t\tthis.attachEvent(\"onFullSync\", this.fullSync);\n\n\t\tsetInterval(() => {\n\t\t\tthis.loadUpdate();\n\t\t}, interval);\n\t}\n\n\t/* process updating request response\n\t\tif status == collision version is deprecated\n\t\tset flag for autoupdating immediately\n\t*/\n\tafterAutoUpdate(sid, action, tid, xml_node) { // tslint:disable-line\n\t\tif (action === \"collision\") {\n\t\t\tthis._needUpdate = true;\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/* callback function for onFillSync event\n\t\tcall update function if it's need\n\t*/\n\tfullSync() {\n\t\tif (this._needUpdate) {\n\t\t\tthis._needUpdate = false;\n\t\t\tthis.loadUpdate();\n\t\t}\n\t\treturn true;\n\t}\n\n\t/* sends query to the server and call callback function\n\t*/\n\tgetUpdates(url, callback) {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tif (this._updateBusy) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\tthis._updateBusy = true;\n\t\t}\n\n\t\tajax.get(url, callback);\n\n\t}\n\n\t/* loads updates and processes them\n\t*/\n\tloadUpdate() {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tconst version = this.$gantt.getUserData(0, \"version\", this._ganttMode);\n\t\tlet url = this.serverProcessor + ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + version].join(\"&\");\n\t\turl = url.replace(\"editing=true&\", \"\");\n\t\tthis.getUpdates(url, (xml) => {\n\t\t\tconst vers = ajax.xpath(\"//userdata\", xml);\n\t\t\tthis.$gantt.setUserData(0, \"version\", this._getXmlNodeValue(vers[0]), this._ganttMode);\n\n\t\t\tconst updates = ajax.xpath(\"//update\", xml);\n\t\t\tif (updates.length) {\n\t\t\t\tthis._silent_mode = true;\n\n\t\t\t\tfor (let i = 0; i < updates.length; i++) {\n\t\t\t\t\tconst status = updates[i].getAttribute(\"status\");\n\t\t\t\t\tconst id = updates[i].getAttribute(\"id\");\n\t\t\t\t\tconst parent = updates[i].getAttribute(\"parent\");\n\t\t\t\t\tswitch (status) {\n\t\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\t\tthis.callEvent(\"insertCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"updated\":\n\t\t\t\t\t\t\tthis.callEvent(\"updateCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\t\tthis.callEvent(\"deleteCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._silent_mode = false;\n\t\t\t}\n\n\t\t\tthis._updateBusy = false;\n\t\t});\n\t}\n\n\tdestructor() {\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t\tthis.updatedRows = [];\n\t\tthis._in_progress = {}; // ?\n\t\tthis._invalid = {};\n\t\tthis._storage.clear();\n\t\tthis._storage = null;\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tdelete this._initialized;\n\t}\n\n\tsetGanttMode(mode) {\n\t\tif (mode === \"tasks\") {\n\t\t\tmode = \"task\";\n\t\t} else if (mode === \"links\") {\n\t\t\tmode = \"link\";\n\t\t}\n\n\t\tconst modes = this.modes || {};\n\t\tconst ganttMode = this.getGanttMode();\n\t\tif (ganttMode) {\n\t\t\tmodes[ganttMode] = {\n\t\t\t\t_in_progress : this._in_progress,\n\t\t\t\t_invalid: this._invalid,\n\t\t\t\t_storage: this._storage,\n\t\t\t\tupdatedRows : this.updatedRows\n\t\t\t};\n\t\t}\n\n\t\tlet newState = modes[mode];\n\t\tif (!newState) {\n\t\t\tnewState = modes[mode] = {\n\t\t\t\t_in_progress : {},\n\t\t\t\t_invalid : {},\n\t\t\t\t_storage : SimpleStorage.create(),\n\t\t\t\tupdatedRows : []\n\t\t\t};\n\t\t}\n\t\tthis._in_progress = newState._in_progress;\n\t\tthis._invalid = newState._invalid;\n\t\tthis._storage = newState._storage;\n\t\tthis.updatedRows = newState.updatedRows;\n\t\tthis.modes = modes;\n\t\tthis._ganttMode = mode;\n\t}\n\tgetGanttMode():string {\n\t\treturn this._ganttMode;\n\t}\n\n\tstoreItem(item) {\n\t\tthis._storage.storeItem(item);\n\t}\n\n\turl(url: string) {\n\t\tthis.serverProcessor = this._serverProcessor = url;\n\t}\n\n\tprotected _beforeSendData(data: any, rowId: any) {\n\t\tif (!this.callEvent(\"onBeforeUpdate\", [rowId, this.getState(rowId), data])) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._sendData(data, rowId);\n\t}\n\n\tprotected _serializeAsJSON(data: any) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\n\t\tconst copy = utils.copy(data);\n\t\tif (this._tMode === \"REST-JSON\") {\n\t\t\tdelete copy.id;\n\t\t\tdelete copy[this.action_param];\n\t\t}\n\n\t\treturn JSON.stringify(copy);\n\t}\n\n\tprotected _applyPayload(url: string) {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tif (this._payload) {\n\t\t\tfor (const key in this._payload) {\n\t\t\t\turl = url + ajax.urlSeparator(url) + this.escape(key) + \"=\" + this.escape(this._payload[key]);\n\t\t\t}\n\t\t}\n\t\treturn url;\n\t}\n\n\t// GET/POST/JSON modes of the dataProcessor didn't send the whole data items in 'delete' requests\n\t// clear extra info from the data in order not to change the request format\n\tprotected _cleanupArgumentsBeforeSend(dataToSend: any) {\n\t\tlet processedData;\n\t\tif(dataToSend[this.action_param] === undefined){// hash of updated items, and not an individual item\n\t\t\tprocessedData = {};\n\t\t\tfor(const i in dataToSend) {\n\t\t\t\tprocessedData[i] = this._cleanupArgumentsBeforeSend(dataToSend[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t}\n\t\treturn processedData;\n\t}\n\tprotected _cleanupItemBeforeSend(updatedItem: any) {\n\t\tlet output = null;\n\t\tif(updatedItem){\n\t\t\tif(updatedItem[this.action_param] === \"deleted\"){\n\t\t\t\toutput = {};\n\t\t\t\toutput.id = updatedItem.id;\n\t\t\t\toutput[this.action_param] = updatedItem[this.action_param];\n\t\t\t}else{\n\t\t\t\toutput = updatedItem;\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tprotected _sendData(dataToSend: any, rowId?: any) {\n\t\tif (!dataToSend) {\n\t\t\treturn; // nothing to send\n\t\t}\n\t\tif (!this.callEvent(\"onBeforeDataSending\", rowId ? [rowId, this.getState(rowId), dataToSend] : [null, null, dataToSend])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (rowId) {\n\t\t\tthis._in_progress[rowId] = (new Date()).valueOf();\n\t\t}\n\n\t\tconst ajax = this.$gantt.ajax;\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tconst taskState = this.getState(rowId);\n\t\t\tconst taskAction = this.getActionByState(taskState);\n\t\t\tconst ganttMode = this.getGanttMode();\n\t\t\tconst _onResolvedCreateUpdate = (tag) => {\n\t\t\t\tlet action = taskState || \"updated\";\n\t\t\t\tlet sid = rowId;\n\t\t\t\tlet tid = rowId;\n\n\t\t\t\tif (tag) {\n\t\t\t\t\taction = tag.action || taskState;\n\t\t\t\t\tsid = tag.sid || sid;\n\t\t\t\t\ttid = tag.id || tag.tid || tid;\n\t\t\t\t}\n\t\t\t\tthis.afterUpdateCallback(sid, tid, action, tag, ganttMode);\n\t\t\t};\n\n\t\t\tlet actionPromise;\n\t\t\tif (this._router instanceof Function) {\n\t\t\t\tif(this._routerParametersFormat === \"object\"){\n\t\t\t\t\tconst obj = {\n\t\t\t\t\t\tentity: ganttMode,\n\t\t\t\t\t\taction: taskAction,\n\t\t\t\t\t\tdata: dataToSend,\n\t\t\t\t\t\tid: rowId\n\t\t\t\t\t};\n\t\t\t\t\tactionPromise = this._router(obj);\n\t\t\t\t} else {\n\t\t\t\t\tactionPromise = this._router(ganttMode, taskAction, dataToSend, rowId);\n\t\t\t\t}\n\t\t\t} else if (this._router[ganttMode] instanceof Function) {\n\t\t\t\tactionPromise = this._router[ganttMode](taskAction, dataToSend, rowId);\n\t\t\t} else {\n\n\t\t\t\tconst errorMsgStart = \"Incorrect configuration of gantt.createDataProcessor\";\n\t\t\t\tconst errorMsgEnd = `\nYou need to either add missing properties to the dataProcessor router object or to use a router function.\nSee https://docs.dhtmlx.com/gantt/desktop__server_side.html#customrouting and https://docs.dhtmlx.com/gantt/api__gantt_createdataprocessor.html for details.`;\n\n\t\t\t\tif(!this._router[ganttMode]){\n\t\t\t\t\tthrow new Error(`${errorMsgStart}: router for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t}\n\t\t\t\tswitch (taskState) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tif(!this._router[ganttMode].create){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **create** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].create(dataToSend);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tif(!this._router[ganttMode].delete){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **delete** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].delete(rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!this._router[ganttMode].update){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **update**\" action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].update(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(actionPromise){\n\t\t\t\t// neither promise nor {tid: newId} response object\n\t\t\t\tif(!actionPromise.then &&\n\t\t\t\t\t(actionPromise.id === undefined && actionPromise.tid === undefined && actionPromise.action === undefined)){\n\t\t\t\t\tthrow new Error(\"Incorrect router return value. A Promise or a response object is expected\");\n\t\t\t\t}\n\n\t\t\t\tif(actionPromise.then){\n\t\t\t\t\tactionPromise.then(_onResolvedCreateUpdate).catch((error) => {\n\t\t\t\t\t\tif(error && error.action){\n\t\t\t\t\t\t\t_onResolvedCreateUpdate(error);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t_onResolvedCreateUpdate({ action: \"error\", value: error});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\t// custom method may return a response object in case of sync action\n\t\t\t\t\t_onResolvedCreateUpdate(actionPromise);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t_onResolvedCreateUpdate(null);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet queryParams: any;\n\t\tqueryParams = {\n\t\t\tcallback: (xml) => {\n\t\t\t\tconst ids = [];\n\n\t\t\t\tif (rowId) {\n\t\t\t\t\tids.push(rowId);\n\t\t\t\t} else if (dataToSend) {\n\t\t\t\t\tfor (const key in dataToSend) {\n\t\t\t\t\t\tids.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn this.afterUpdate(this, xml, ids);\n\t\t\t},\n\t\t\theaders: this._headers\n\t\t};\n\n\t\tconst dhxVersion = \"dhx_version=\" + this.$gantt.getUserData(0, \"version\", this._ganttMode);\n\t\tconst urlParams = this.serverProcessor + (this._user ? (ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, dhxVersion].join(\"&\")) : \"\");\n\t\tlet url: any = this._applyPayload(urlParams);\n\t\tlet data;\n\n\t\tswitch (this._tMode) {\n\t\t\tcase \"GET\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url + ajax.urlSeparator(url) + this.serialize(data, rowId);\n\t\t\t\tqueryParams.method = \"GET\";\n\t\t\t\tbreak;\n\t\t\tcase \"POST\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = this.serialize(data, rowId);\n\t\t\t\tbreak;\n\t\t\tcase \"JSON\":\n\t\t\t\tdata = {};\n\t\t\t\tconst preprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t\t\tfor (const key in preprocessedData) {\n\t\t\t\t\tif (key === this.action_param || key === \"id\" || key === \"gr_id\") {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdata[key] = preprocessedData[key];\n\t\t\t\t}\n\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = JSON.stringify({\n\t\t\t\t\tid: rowId,\n\t\t\t\t\taction: dataToSend[this.action_param],\n\t\t\t\t\tdata\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"REST\":\n\t\t\tcase \"REST-JSON\":\n\t\t\t\turl = urlParams.replace(/(&|\\?)editing=true/, \"\");\n\t\t\t\tdata = \"\";\n\n\t\t\t\tswitch (this.getState(rowId)) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tqueryParams.method = \"DELETE\";\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tqueryParams.method = \"PUT\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tqueryParams.url = this._applyPayload(url);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._waitMode++;\n\t\treturn ajax.query(queryParams);\n\t}\n\n\tprotected _forEachUpdatedRow(code: any) {\n\t\tconst updatedRows = this.updatedRows.slice();\n\t\tfor (let i = 0; i < updatedRows.length; i++) {\n\t\t\tconst rowId = updatedRows[i];\n\t\t\tif (this.$gantt.getUserData(rowId, this.action_param, this._ganttMode)) {\n\t\t\t\tcode.call(this, rowId);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _setDefaultTransactionMode() {\n\t\tif (this.serverProcessor) {\n\t\t\tthis.setTransactionMode(\"POST\", true);\n\t\t\tthis.serverProcessor += (this.serverProcessor.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"editing=true\";\n\t\t\tthis._serverProcessor = this.serverProcessor;\n\t\t}\n\t}\n\n\t/* returns xml node value\n\t\t@param node\n\t\t\txml node\n\t*/\n\tprotected _getXmlNodeValue(node) {\n\t\tif (node.firstChild) {\n\t\t\treturn node.firstChild.nodeValue;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tprotected _getAllData() {\n\t\tconst out = {};\n\t\tlet hasOne = false;\n\n\t\tthis._forEachUpdatedRow(function(id) {\n\t\t\tif (this._in_progress[id] || this.is_invalid(id)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst row = this._getRowData(id);\n\t\t\tif (!this.callEvent(\"onBeforeUpdate\", [id, this.getState(id), row])) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tout[id] = row;\n\t\t\thasOne = true;\n\t\t\tthis._in_progress[id] = (new Date()).valueOf();\n\t\t});\n\n\t\treturn hasOne ? out : null;\n\t}\n\n\tprotected _prepareDate(value: Date) : string {\n\t\treturn this.$gantt.defined(this.$gantt.templates.xml_format) ? this.$gantt.templates.xml_format(value) : this.$gantt.templates.format_date(value);\n\t}\n\n\tprotected _prepareArray(value: any[], traversedObjects: object[]) : any[] {\n\t\ttraversedObjects.push(value);\n\n\t\treturn value.map((item) => {\n\t\t\tif(helpers.isDate(item)){\n\t\t\t\treturn this._prepareDate(item);\n\t\t\t} else if (Array.isArray(item) && !helpers.arrayIncludes(traversedObjects, item)){\n\t\t\t\treturn this._prepareArray(item, traversedObjects);\n\t\t\t} else if (item && typeof item === \"object\" && !helpers.arrayIncludes(traversedObjects, item)) {\n\t\t\t\treturn this._prepareObject(item, traversedObjects);\n\t\t\t} else {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected _prepareObject(rawItem: any, traversedObjects: object[]) : any {\n\t\tconst processedItem = {};\n\t\ttraversedObjects.push(rawItem);\n\n\t\tfor (const key in rawItem) {\n\t\t\tif (key.substr(0, 1) === \"$\") {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst value = rawItem[key];\n\t\t\tif (helpers.isDate(value)) {\n\t\t\t\tprocessedItem[key] = this._prepareDate(value);\n\t\t\t} else if(value === null) {\n\t\t\t\tprocessedItem[key] = \"\";\n\t\t\t} else if (Array.isArray(value) && !helpers.arrayIncludes(traversedObjects, value)){\n\t\t\t\tprocessedItem[key] = this._prepareArray(value, traversedObjects);\n\t\t\t} else if (value && typeof value === \"object\" && !helpers.arrayIncludes(traversedObjects, value)) {\n\t\t\t\tprocessedItem[key] = this._prepareObject(value, traversedObjects);\n\t\t\t} else {\n\t\t\t\tprocessedItem[key] = value;\n\t\t\t}\n\t\t}\n\t\treturn processedItem;\n\t}\n\n\tprotected _prepareDataItem(rawItem: any): any {\n\t\tconst processedItem = this._prepareObject(rawItem, []);\n\n\t\tprocessedItem[this.action_param] = this.$gantt.getUserData(rawItem.id, this.action_param, this._ganttMode);\n\t\treturn processedItem;\n\t}\n\n\tprotected getStoredItem(id){\n\t\treturn this._storage.getStoredItem(id);\n\t}\n\n\tprotected _getRowData(id) {\n\t\tlet dataItem;\n\t\tconst gantt = this.$gantt;\n\t\tif (this.getGanttMode() === \"task\") {\n\t\t\tif(gantt.isTaskExists(id)){\n\t\t\t\tdataItem =this.$gantt.getTask(id);\n\t\t\t}\n\t\t} else if (this.getGanttMode() === \"assignment\") {\n\t\t\tif(this.$gantt.$data.assignmentsStore.exists(id)){\n\t\t\t\tdataItem =this.$gantt.$data.assignmentsStore.getItem(id);\n\t\t\t}\n\t\t} else if (this.getGanttMode() === \"baseline\") {\n\t\t\tif(this.$gantt.$data.baselineStore.exists(id)){\n\t\t\t\tdataItem =this.$gantt.$data.baselineStore.getItem(id);\n\t\t\t}\n\t\t} else {\n\t\t\tif(gantt.isLinkExists(id)){\n\t\t\t\tdataItem =this.$gantt.getLink(id);\n\t\t\t}\n\t\t}\n\n\t\tif (!dataItem) {\n\t\t\tdataItem = this.getStoredItem(id);\n\t\t}\n\n\t\tif (!dataItem) {\n\t\t\tdataItem = { id };\n\t\t}\n\n\t\treturn this._prepareDataItem(dataItem);\n\t}\n}","\nexport default function extendGantt(gantt: any, dp: any) {\n\tgantt.getUserData = function(id, name, store) {\n\t\tif (!this.userdata) {\n\t\t\tthis.userdata = {};\n\t\t}\n\t\tthis.userdata[store] = this.userdata[store] || {};\n\t\tif (this.userdata[store][id] && this.userdata[store][id][name]) {\n\t\t\treturn this.userdata[store][id][name];\n\t\t}\n\t\treturn \"\";\n\t};\n\tgantt.setUserData = function(id, name, value, store) {\n\t\tif (!this.userdata) {\n\t\t\tthis.userdata = {};\n\t\t}\n\t\tthis.userdata[store] = this.userdata[store] || {};\n\t\tthis.userdata[store][id] = this.userdata[store][id] || {};\n\t\tthis.userdata[store][id][name] = value;\n\t};\n\n\tgantt._change_id = function(oldId, newId) {\n\t\tswitch (this._dp._ganttMode) {\n\t\t\tcase \"task\":\n\t\t\t\tthis.changeTaskId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"link\":\n\t\t\t\tthis.changeLinkId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"assignment\":\n\t\t\t\tthis.$data.assignmentsStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"resource\":\n\t\t\t\tthis.$data.resourcesStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"baseline\":\n\t\t\t\tthis.$data.baselineStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`Invalid mode of the dataProcessor after database id is received: ${this._dp._ganttMode}, new id: ${newId}`);\n\t\t}\n\t};\n\n\tgantt._row_style = function(rowId, classname){\n\t\tif (this._dp._ganttMode !== \"task\") {\n\t\t\treturn;\n\t\t}\n\t\tif (!gantt.isTaskExists(rowId)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst task = gantt.getTask(rowId);\n\t\ttask.$dataprocessor_class = classname;\n\t\tgantt.refreshTask(rowId);\n\t};\n\n\t// fake method for dataprocessor\n\tgantt._delete_task = function(rowId, node) {}; // tslint:disable-line\n\n\tgantt._sendTaskOrder = function(id, item){\n\t\tif (item.$drop_target) {\n\t\t\tthis._dp.setGanttMode(\"task\");\n\t\t\tthis.getTask(id).target = item.$drop_target;\n\t\t\tthis._dp.setUpdated(id, true,\"order\");\n\t\t\tdelete this.getTask(id).$drop_target;\n\t\t}\n\t};\n\n\tgantt.setDp = function() {\n\t\tthis._dp = dp;\n\t};\n\n\tgantt.setDp();\n}","import * as DataProcessor from \"./data_processor\";\nexport default {\n\tDEPRECATED_api: function(server) {\n\t\treturn new (DataProcessor.DataProcessor)(server);\n\t},\n\tcreateDataProcessor: DataProcessor.createDataProcessor\n};","import global from \"../../utils/global\";\n\nfunction createMethod(gantt){\n\tvar methods = {};\n\tvar isActive = false;\n\tfunction disableMethod(methodName, dummyMethod){\n\t\tdummyMethod = typeof dummyMethod == \"function\" ? dummyMethod : function(){};\n\n\t\tif(!methods[methodName]){\n\t\t\tmethods[methodName] = this[methodName];\n\t\t\tthis[methodName] = dummyMethod;\n\t\t}\n\t}\n\tfunction restoreMethod(methodName){\n\t\tif(methods[methodName]){\n\t\t\tthis[methodName] = methods[methodName];\n\t\t\tmethods[methodName] = null;\n\t\t}\n\t}\n\tfunction disableMethods(methodsHash){\n\t\tfor(var i in methodsHash){\n\t\t\tdisableMethod.call(this, i, methodsHash[i]);\n\t\t}\n\t}\n\tfunction restoreMethods(){\n\t\tfor(var i in methods){\n\t\t\trestoreMethod.call(this, i);\n\t\t}\n\t}\n\n\tfunction batchUpdatePayload(callback){\n\t\ttry{\n\t\t\tcallback();\n\t\t}catch(e){\n\t\t\tglobal.console.error(e);\n\t\t}\n\t}\n\n\tvar state = gantt.$services.getService(\"state\");\n\tstate.registerProvider(\"batchUpdate\", function(){\n\t\treturn {\n\t\t\tbatch_update: isActive\n\t\t};\n\t}, false);\n\n\treturn function batchUpdate(callback, noRedraw) {\n\t\tif(isActive){\n\t\t\t// batch mode is already active\n\t\t\tbatchUpdatePayload(callback);\n\t\t\treturn;\n\t\t}\n\n\t\tvar call_dp = (this._dp && this._dp.updateMode != \"off\");\n\t\tvar dp_mode;\n\t\tif (call_dp){\n\t\t\tdp_mode = this._dp.updateMode;\n\t\t\tthis._dp.setUpdateMode(\"off\");\n\t\t}\n\n\t\t// temporary disable some methods while updating multiple tasks\n\t\tvar resetProjects = {};\n\t\tvar methods = {\n\t\t\t\"render\":true,\n\t\t\t\"refreshData\":true,\n\t\t\t\"refreshTask\":true,\n\t\t\t\"refreshLink\":true,\n\t\t\t\"resetProjectDates\":function(task){\n\t\t\t\tresetProjects[task.id] = task;\n\t\t\t}\n\t\t};\n\n\t\tdisableMethods.call(this, methods);\n\n\t\tisActive = true;\n\t\tthis.callEvent(\"onBeforeBatchUpdate\", []);\n\n\t\tbatchUpdatePayload(callback);\n\n\t\tthis.callEvent(\"onAfterBatchUpdate\", []);\n\n\t\trestoreMethods.call(this);\n\n\t\t// do required updates after changes applied\n\t\tfor(var i in resetProjects){\n\t\t\tthis.resetProjectDates(resetProjects[i]);\n\t\t}\n\n\t\tisActive = false;\n\n\t\tif(!noRedraw){\n\t\t\tthis.render();\n\t\t}\n\n\t\tif (call_dp) {\n\t\t\tthis._dp.setUpdateMode(dp_mode);\n\t\t\tthis._dp.setGanttMode(\"task\");\n\t\t\tthis._dp.sendData();\n\t\t\tthis._dp.setGanttMode(\"link\");\n\t\t\tthis._dp.sendData();\n\t\t}\n\t};\n\n\n\n}\n\nexport default function(gantt){\n\tgantt.batchUpdate = createMethod(gantt);\n};","var createWbs = (function(gantt){\n\treturn {\n\t_needRecalc: true,\n\treset: function(){\n\t\tthis._needRecalc = true;\n\t},\n\t_isRecalcNeeded: function(){\n\t\treturn (!this._isGroupSort() && this._needRecalc);\n\t},\n\t_isGroupSort: function() {\n\t\treturn !!(gantt.getState().group_mode);\n\t},\n\t_getWBSCode: function(task) {\n\t\tif(!task) return \"\";\n\n\t\tif(this._isRecalcNeeded()){\n\t\t\tthis._calcWBS();\n\t\t}\n\n\t\tif(task.$virtual) return \"\";\n\t\tif(this._isGroupSort()) return task.$wbs || \"\";\n\n\t\tif(!task.$wbs) {\n\t\t\tthis.reset();\n\t\t\tthis._calcWBS();\n\t\t}\n\t\treturn task.$wbs;\n\t},\n\t_setWBSCode: function(task, value) {\n\t\ttask.$wbs = value;\n\t},\n\tgetWBSCode: function(task) {\n\t\treturn this._getWBSCode(task);\n\t},\n\tgetByWBSCode: function(code){\n\t\tvar parts = code.split(\".\");\n\t\tvar currentNode = gantt.config.root_id;\n\t\tfor(var i = 0; i < parts.length; i++){\n\t\t\tvar children = gantt.getChildren(currentNode);\n\t\t\tvar index = parts[i]*1 - 1;\n\t\t\tif(gantt.isTaskExists(children[index])){\n\t\t\t\tcurrentNode = children[index];\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(currentNode)){\n\t\t\treturn gantt.getTask(currentNode);\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t},\n\t_calcWBS: function() {\n\t\tif(!this._isRecalcNeeded()) return;\n\n\t\tvar _isFirst = true;\n\t\tgantt.eachTask(function(ch) {\n\t\t\tif(_isFirst) {\n\t\t\t\t_isFirst = false;\n\t\t\t\tthis._setWBSCode(ch, \"1\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar _prevSibling = gantt.getPrevSibling(ch.id);\n\t\t\tif (_prevSibling !== null) {\n\t\t\t\tvar _wbs = gantt.getTask(_prevSibling).$wbs;\n\t\t\t\tif(_wbs) {\n\t\t\t\t\t_wbs = _wbs.split(\".\");\n\t\t\t\t\t_wbs[_wbs.length-1]++;\n\t\t\t\t\tthis._setWBSCode(ch, _wbs.join(\".\"));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar _parent = gantt.getParent(ch.id);\n\t\t\t\tthis._setWBSCode(ch, gantt.getTask(_parent).$wbs + \".1\");\n\t\t\t}\n\t\t}, gantt.config.root_id, this);\n\n\t\tthis._needRecalc = false;\n\t}\n};\n});\n\nexport default function(gantt){\n\tvar wbs = createWbs(gantt);\n\tgantt.getWBSCode = function getWBSCode(task) {\n\t\treturn wbs.getWBSCode(task);\n\t};\n\n\tgantt.getTaskByWBSCode = function(code) {\n\t\treturn wbs.getByWBSCode(code);\n\t};\n\n\tfunction resetCache(){\n\t\twbs.reset();\n\t\treturn true;\n\t}\n\n\tgantt.attachEvent(\"onAfterTaskMove\", resetCache);\n\tgantt.attachEvent(\"onBeforeParse\", resetCache);\n\tgantt.attachEvent(\"onAfterTaskDelete\", resetCache);\n\tgantt.attachEvent(\"onAfterTaskAdd\", resetCache);\n\tgantt.attachEvent(\"onAfterSort\", resetCache);\n\n};\n","import * as helpers from \"../../utils/helpers\";\n\nfunction createResourceMethods(gantt){\n\n\tvar resourceTaskCache = {};\n\tvar singleResourceCacheBuilt = false;\n\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\n\t\tresourceTaskCache = {};\n\t\tsingleResourceCacheBuilt = false;\n\t});\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tresourceTaskCache = {};\n\t});\n\n\tfunction getTaskBy(propertyName, propertyValue, typeFilter) {\n\t\tif (typeof propertyName == \"function\") {\n\t\t\treturn filterResourceTasks(propertyName);\n\t\t} else {\n\t\t\tif (helpers.isArray(propertyValue)) {\n\t\t\t\treturn getResourceTasks(propertyName, propertyValue, typeFilter);\n\t\t\t} else {\n\t\t\t\treturn getResourceTasks(propertyName, [propertyValue], typeFilter);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction filterResourceTasks(filter) {\n\t\tvar res = [];\n\t\tgantt.eachTask(function (task) {\n\t\t\tif (filter(task)) {\n\t\t\t\tres.push(task);\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t}\n\n\tvar falsyValuePrefix = String(Math.random());\n\tfunction resourceHashFunction(value){\n\t\tif (value === null){\n\t\t\treturn falsyValuePrefix + String(value);\n\t\t}\n\t\treturn String(value);\n\t}\n\n\tfunction getCacheKey(resourceIds, property, typeFilter) {\n\t\tif (Array.isArray(resourceIds)) {\n\t\t\treturn resourceIds.map(function (value) {\n\t\t\t\treturn resourceHashFunction(value);\n\t\t\t}).join(\"_\") + `_${property}_${typeFilter}`;\n\t\t} else {\n\t\t\treturn resourceHashFunction(resourceIds) + `_${property}_${typeFilter}`;\n\t\t}\n\t}\n\n\tfunction getResourceTasks(property, resourceIds, typeFilter) {\n\t\tvar res;\n\t\tvar cacheKey = getCacheKey(resourceIds, property, JSON.stringify(typeFilter));\n\t\tvar matchingResources = {};\n\t\thelpers.forEach(resourceIds, function(resourceId) {\n\t\t\tmatchingResources[resourceHashFunction(resourceId)] = true;\n\t\t});\n\n\t\tif (!resourceTaskCache[cacheKey]) {\n\t\t\tres = resourceTaskCache[cacheKey] = [];\n\t\t\tgantt.eachTask(function (task) {\n\t\t\t\tif (typeFilter) {\n\t\t\t\t\tif (!typeFilter[gantt.getTaskType(task)]) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if (task.type == gantt.config.types.project) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (property in task) {\n\t\t\t\t\tvar resourceValue;\n\t\t\t\t\tif (!helpers.isArray(task[property])) {\n\t\t\t\t\t\tresourceValue = [task[property]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceValue = task[property];\n\t\t\t\t\t}\n\n\t\t\t\t\thelpers.forEach(resourceValue, function(value) {\n\t\t\t\t\t\tvar resourceValue = (value && value.resource_id) ? value.resource_id : value;\n\n\t\t\t\t\t\tif (matchingResources[resourceHashFunction(resourceValue)]) {\n\t\t\t\t\t\t\tres.push(task);\n\t\t\t\t\t\t}else if(!singleResourceCacheBuilt){\n\n\t\t\t\t\t\t\tvar key = getCacheKey(value, property);\n\t\t\t\t\t\t\tif(!resourceTaskCache[key]){\n\t\t\t\t\t\t\t\tresourceTaskCache[key] = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresourceTaskCache[key].push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsingleResourceCacheBuilt = true;\n\t\t} else {\n\t\t\tres = resourceTaskCache[cacheKey];\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tfunction selectAssignments(resourceId, taskId, result){\n\t\tvar property = gantt.config.resource_property;\n\t\tvar owners = [];\n\t\tif (gantt.getDatastore(\"task\").exists(taskId)) {\n\t\t\tvar task = gantt.getTask(taskId);\n\t\t\towners = task[property] || [];\n\t\t}\n\n\t\tif (!Array.isArray(owners)) {\n\t\t\towners = [owners];\n\t\t}\n\t\tfor (var i = 0; i < owners.length; i++) {\n\t\t\tif (owners[i].resource_id == resourceId) {\n\t\t\t\tresult.push({task_id: task.id, resource_id:owners[i].resource_id, value:owners[i].value});\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getResourceAssignments(resourceId, taskId){\n\t\t// resource assignment as an independent module:\n\t\t// {taskId:, resourceId, value}\n\t\t// TODO: probably should add a separate datastore for these\n\t\tvar assignments = [];\n\t\tvar property = gantt.config.resource_property;\n\t\tif(taskId !== undefined){\n\t\t\tselectAssignments(resourceId, taskId, assignments);\n\t\t}else{\n\t\t\tvar tasks = gantt.getTaskBy(property, resourceId);\n\t\t\ttasks.forEach(function(task){\n\t\t\t\tselectAssignments(resourceId, task.id, assignments);\n\t\t\t});\n\t\t}\n\t\treturn assignments;\n\t}\n\n\treturn {\n\t\tgetTaskBy: getTaskBy,\n\t\tgetResourceAssignments: getResourceAssignments\n\t};\n}\n\nfunction createHelper(gantt){\n\tconst resourcePlugin = {\n\t\trenderEditableLabel: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tconst editable = gantt.config.readonly ? \"\" : \"contenteditable\";\n\t\t\tif(start_date < resource.end_date && end_date > resource.start_date){\n\t\t\t\tfor(let i = 0; i < assignments.length; i++){\n\t\t\t\t\tconst a = assignments[i];\n\t\t\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-assignment-id='\"+a.id+\"'\"+\n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\n\t\t\t\t\t\t\" data-end-date='\"+gantt.templates.format_date(end_date)+\"'>\" + a.value + \"</div>\";\n\t\t\t\t}\n\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-empty \"+ \n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\n\t\t\t\t\t\t\" data-resource-id='\"+resource.$resource_id+\"'\"+\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\n\t\t\t\t\t\t\"'  data-end-date='\"+gantt.templates.format_date(end_date)+\"'>-</div>\";\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\trenderSummaryLabel: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tlet sum = assignments.reduce(function(total, assignment){ \n\t\t\t\treturn total + Number(assignment.value);\n\t\t\t}, 0);\n\n\t\t\tif(sum % 1){\n\t\t\t\tsum = Math.round(sum * 10)/10;\n\t\t\t}\n\n\t\t\tif(sum){\n\t\t\t\treturn \"<div>\" + sum + \"</div>\";\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\teditableResourceCellTemplate: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\treturn resourcePlugin.renderEditableLabel(start_date, end_date, resource, tasks, assignments);\n\t\t\t}else{\n\t\t\t\treturn resourcePlugin.renderSummaryLabel(start_date, end_date, resource, tasks, assignments);\n\t\t\t}\n\n\t\t},\n\t\t\n\t\teditableResourceCellClass: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tconst css = [];\n\t\t\tcss.push(\"resource_marker\");\n\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\tcss.push(\"task_cell\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"resource_cell\");\n\t\t\t}\n\n\t\t\tconst sum = assignments.reduce(function(total, assignment){ \n\t\t\t\treturn total + Number(assignment.value);\n\t\t\t}, 0);\n\n\t\t\tlet capacity = Number(resource.capacity);\n\t\t\tif(isNaN(capacity)){\n\t\t\t\tcapacity = 8;\n\t\t\t}\n\t\t\tif (sum <= capacity) {\n\t\t\t\tcss.push(\"workday_ok\");\n\t\t\t} else {\n\t\t\t\tcss.push(\"workday_over\");\n\t\t\t}\n\t\t\treturn css.join(\" \");\n\t\t},\n\t\tgetSummaryResourceAssignments: function getResourceAssignments(resourceId) {\n\t\t\tlet assignments;\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tconst resource = store.getItem(resourceId);\n\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\tassignments = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\n\t\t\t}else{\n\t\t\t\tassignments = gantt.getResourceAssignments(resourceId);\n\t\t\t\tif(store.eachItem){\n\t\t\t\t\tstore.eachItem(function(childResource){\n\t\t\t\t\t\tif(childResource.$role !== \"task\"){\n\t\t\t\t\t\t\tassignments = assignments.concat(gantt.getResourceAssignments(childResource.id));\n\t\t\t\t\t\t}\n\t\t\t\t\t}, resourceId);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn assignments;\n\t\t},\n\t\t\n\t\tinitEditableDiagram: function(){\n\t\t\tgantt.config.resource_render_empty_cells = true;\n\t\t\t\n\t\t\t\n\t\t\t(function(){\n\t\t\t\t/// salesforce locker workaround\n\t\t\t\t// SF removes 'contenteditable' attribute from cells\n\t\t\t\t// restore it on render\n\t\t\t\tlet timeoutId = null;\n\t\t\t\tfunction makeEditable() {\n\t\t\t\t\tif (timeoutId) {\n\t\t\t\t\t\tcancelAnimationFrame(timeoutId);\n\t\t\t\t\t}\n\t\t\t\t\ttimeoutId = requestAnimationFrame(function () {\n\t\t\t\t\t\tif (gantt.$container){\n\t\t\t\t\t\t\tvar cells = Array.prototype.slice.call(gantt.$container.querySelectorAll(\".resourceTimeline_cell [data-assignment-cell]\"));\n\t\t\t\t\t\t\tcells.forEach(function (cell) {\n\t\t\t\t\t\t\t\tcell.contentEditable = true;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_assignment_store).attachEvent(\"onStoreUpdated\", makeEditable);\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).attachEvent(\"onStoreUpdated\", makeEditable);\n\t\t\t\t}, {once: true});\n\t\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\t\t\t\tconst ganttViews = gantt.$layout.getCellsByType(\"viewCell\");\n\t\t\t\t\tganttViews.forEach(function(view){\n\t\t\t\t\t\tif(view.$config && view.$config.view === \"resourceTimeline\" && view.$content){\n\t\t\t\t\t\t\tview.$content.attachEvent(\"onScroll\", makeEditable);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t})();\n\n\n\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\tlet assignmentEditInProcess = false;\n\t\t\t\tgantt.event(gantt.$container, \"keypress\", function(e){\n\t\t\t\t\tvar target = e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n\t\t\t\t\tif(target){\n\t\t\t\t\t\tif (e.keyCode === 13 || e.keyCode === 27) {\n\t\t\t\t\t\t\ttarget.blur();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tgantt.event(gantt.$container, \"focusout\", function(e){\n\t\t\t\t\tif (assignmentEditInProcess){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tassignmentEditInProcess = true;\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tassignmentEditInProcess = false;\n\t\t\t\t\t}, 300);\n\t\t\t\t\tvar target = e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n\t\t\t\t\tif(target){\n\t\t\t\t\t\tvar strValue = (target.innerText || \"\").trim();\n\t\t\t\t\t\tif(strValue == \"-\"){\n\t\t\t\t\t\t\tstrValue = \"0\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar value = Number(strValue);\n\t\t\t\t\t\tvar rowId = target.getAttribute(\"data-row-id\");\n\t\t\t\t\t\tvar assignmentId = target.getAttribute(\"data-assignment-id\");\n\t\t\t\t\t\tvar taskId = target.getAttribute(\"data-task\");\n\t\t\t\t\t\tvar resourceId = target.getAttribute(\"data-resource-id\");\n\t\t\t\t\t\tvar startDate = gantt.templates.parse_date(target.getAttribute(\"data-start-date\"));\n\t\t\t\t\t\tvar endDate = gantt.templates.parse_date(target.getAttribute(\"data-end-date\"));\n\n\t\t\t\t\t\tvar assignmentStore = gantt.getDatastore(gantt.config.resource_assignment_store);\n\t\t\t\t\t\tif(isNaN(value)){\n\t\t\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).refresh(rowId);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tvar task = gantt.getTask(taskId);\n\t\t\t\t\t\t\t// GS-2141. Track the changes by the Undo extension\n\t\t\t\t\t\t\tif (gantt.plugins().undo){\n\t\t\t\t\t\t\t\tgantt.ext.undo.saveState(taskId, \"task\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(assignmentId){\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar assignment = assignmentStore.getItem(assignmentId);\n\t\t\t\t\t\t\t\tif(value === assignment.value){\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(assignment.start_date.valueOf() === startDate.valueOf() && assignment.end_date.valueOf() === endDate.valueOf()){\n\t\t\t\t\t\t\t\t\tassignment.value = value;\n\t\t\t\t\t\t\t\t\tif(!value){\n\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif(assignment.end_date.valueOf() > endDate.valueOf()){\n\t\t\t\t\t\t\t\t\t\tvar nextChunk = gantt.copy(assignment);\n\t\t\t\t\t\t\t\t\t\tnextChunk.id = gantt.uid();\n\t\t\t\t\t\t\t\t\t\tnextChunk.start_date = endDate;\n\t\t\t\t\t\t\t\t\t\tnextChunk.duration = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: nextChunk.start_date,\n\t\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.end_date,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tnextChunk.delay = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.start_date,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tnextChunk.mode = assignment.mode || \"default\";\n\t\t\t\t\t\t\t\t\t\tif(nextChunk.duration !== 0){\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.addItem(nextChunk);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif(assignment.start_date.valueOf() < startDate.valueOf()){\n\t\t\t\t\t\t\t\t\t\tassignment.end_date = startDate;\n\t\t\t\t\t\t\t\t\t\tassignment.duration = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: assignment.start_date,\n\t\t\t\t\t\t\t\t\t\t\tend_date: assignment.end_date,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tassignment.mode = \"fixedDuration\";\n\n\t\t\t\t\t\t\t\t\t\tif(assignment.duration === 0){\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif(value){\n\t\t\t\t\t\t\t\t\t\tassignmentStore.addItem({\n\t\t\t\t\t\t\t\t\t\t\ttask_id: assignment.task_id,\n\t\t\t\t\t\t\t\t\t\t\tresource_id: assignment.resource_id,\n\t\t\t\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\t\t\tend_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\n\t\t\t\t\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\t\t\t\t}else if(value){\n\t\t\t\t\t\t\t\tvar assignment = {\n\t\t\t\t\t\t\t\t\ttask_id: taskId,\n\t\t\t\t\t\t\t\t\tresource_id: resourceId,\n\t\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\tend_date: startDate,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tassignmentStore.addItem(assignment);\n\t\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\n\t\t\t\t\t\t\t\tgantt.updateTask(task.id);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, {once: true});\n\t\t}\n\t};\n\treturn resourcePlugin;\n}\n\nexport default function(gantt){\n\tvar methods = createResourceMethods(gantt);\n\t\n\tgantt.ext.resources = createHelper(gantt);\n\n\tgantt.config.resources = {\n\t\tdataprocessor_assignments: false,\n\t\tdataprocessor_resources: false,\n\t\teditable_resource_diagram: false,\n\t\tresource_store: {\n\t\t\ttype: \"treeDataStore\",\n\t\t\tfetchTasks: false,\n\t\t\tinitItem: function(item) {\n\t\t\t\titem.parent = item.parent || gantt.config.root_id;\n\t\t\t\titem[gantt.config.resource_property] = item.parent;\n\t\t\t\titem.open = true;\n\t\t\t\treturn item;\n\t\t\t}\n\t\t},\n\t\tlightbox_resources: function selectResourceControlOptions(resources){\n\t\t\tconst lightboxOptions = [];\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tresources.forEach(function(res) {\n\t\t\t\tif (!store.hasChild(res.id)) {\n\t\t\t\t\tconst copy = gantt.copy(res);\n\t\t\t\t\tcopy.key = res.id;\n\t\t\t\t\tcopy.label = res.text;\n\t\t\t\t\tlightboxOptions.push(copy);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn lightboxOptions;\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif(gantt.getDatastore(gantt.config.resource_store)){\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourceStoreConfig = gantt.config.resources ? gantt.config.resources.resource_store : undefined;\n\t\tlet fetchTasks = resourceStoreConfig ? resourceStoreConfig.fetchTasks : undefined;\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\t\t\tfetchTasks = true;\n\t\t}\n\n\t\tlet initItems = function(item) {\n\t\t\titem.parent = item.parent || gantt.config.root_id;\n\t\t\titem[gantt.config.resource_property] = item.parent;\n\t\t\titem.open = true;\n\t\t\treturn item;\n\t\t};\n\n\t\tif(resourceStoreConfig && resourceStoreConfig.initItem){\n\t\t\tinitItems = resourceStoreConfig.initItem;\n\t\t}\n\n\t\tconst storeType = resourceStoreConfig && resourceStoreConfig.type ? resourceStoreConfig.type : \"treeDatastore\";\n\n\t\tgantt.$resourcesStore = gantt.createDatastore({\n\t\t\tname: gantt.config.resource_store,\n\t\t\ttype: storeType,\n\t\t\tfetchTasks: fetchTasks !== undefined ? fetchTasks : false,\n\t\t\tinitItem: initItems\n\t\t});\n\n\t\tgantt.$data.resourcesStore = gantt.$resourcesStore;\n\n\t\tgantt.$resourcesStore.attachEvent(\"onParse\", function() {\n\t\t\tfunction selectResourceControlOptions(resources){\n\t\t\t\tconst lightboxOptions = [];\n\t\t\t\tresources.forEach(function(res) {\n\t\t\t\t\tif (!gantt.$resourcesStore.hasChild(res.id)) {\n\t\t\t\t\t\tvar copy = gantt.copy(res);\n\t\t\t\t\t\tcopy.key = res.id;\n\t\t\t\t\t\tcopy.label = res.text;\n\t\t\t\t\t\tlightboxOptions.push(copy);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn lightboxOptions;\n\t\t\t}\n\n\t\t\tlet lightboxOptionsFnc = selectResourceControlOptions;\n\t\t\tif(gantt.config.resources && gantt.config.resources.lightbox_resources){\n\t\t\t\tlightboxOptionsFnc = gantt.config.resources.lightbox_resources;\n\t\t\t}\n\n\t\t\tconst options = lightboxOptionsFnc(gantt.$resourcesStore.getItems());\n\n\t\t\tgantt.updateCollection(\"resourceOptions\", options);\n\t\t});\n\t});\n\n\tgantt.getTaskBy = methods.getTaskBy;\n\tgantt.getResourceAssignments = methods.getResourceAssignments;\n\tgantt.config.resource_property = \"owner_id\";\n\tgantt.config.resource_store = \"resource\";\n\tgantt.config.resource_render_empty_cells = false;\n\n\t/**\n\t * these are placeholder functions that should be redefined by the user\n\t*/\n\tgantt.templates.histogram_cell_class = function(start_date, end_date, resource, tasks, assignments) {};\n\tgantt.templates.histogram_cell_label = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn tasks.length + \"/3\";\n\t};\n\tgantt.templates.histogram_cell_allocated = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn tasks.length / 3;\n\t};\n\tgantt.templates.histogram_cell_capacity = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn 0;\n\t};\n\n\n\tconst defaultResourceCellClass = function(start, end, resource, tasks, assignments) {\n\t\tvar css = \"\";\n\t\tif (tasks.length <= 1) {\n\t\t\tcss = \"gantt_resource_marker_ok\";\n\t\t} else {\n\t\t\tcss = \"gantt_resource_marker_overtime\";\n\t\t}\n\t\treturn css;\n\t};\n\n\tconst defaultResourceCellTemplate = function(start, end, resource, tasks, assignments) {\n\t\treturn tasks.length * 8;\n\t};\n\n\tgantt.templates.resource_cell_value = defaultResourceCellTemplate;\n\tgantt.templates.resource_cell_class = defaultResourceCellClass;\n\n\t//editable_resource_diagram\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\n\t\t\tgantt.config.resource_render_empty_cells = true;\n\t\t\tif(gantt.templates.resource_cell_value === defaultResourceCellTemplate){\n\t\t\t\tgantt.templates.resource_cell_value = gantt.ext.resources.editableResourceCellTemplate;\n\t\t\t}\n\t\t\tif(gantt.templates.resource_cell_class === defaultResourceCellClass){\n\t\t\t\tgantt.templates.resource_cell_class = gantt.ext.resources.editableResourceCellClass;\n\t\t\t}\n\t\t\t\n\t\t\tgantt.ext.resources.initEditableDiagram(gantt);\n\t\t}\n\t});\n};\n\n\n","export default function (gantt) {\n\tvar resourceAssignmentsProperty = \"$resourceAssignments\";\n\tgantt.config.resource_assignment_store = \"resourceAssignments\";\n\tgantt.config.process_resource_assignments = true;\n\n\tvar resourceAssignmentFormats = {\n\t\tauto: \"auto\",\n\t\tsingleValue: \"singleValue\",\n\t\tvalueArray: \"valueArray\",\n\t\tresourceValueArray: \"resourceValueArray\",\n\t\tassignmentsArray: \"assignmentsArray\"\n\t};\n\tvar resourceAssignmentFormat = resourceAssignmentFormats.auto;//\"primitiveSingle\";//\"primitive\";//\"object\"|\"assignment\"\n\n\tvar assignmentModes = {\n\t\tfixedDates: \"fixedDates\",\n\t\tfixedDuration: \"fixedDuration\",\n\t\tdefault: \"default\"\n\t};\n\n\n\tfunction initAssignmentFields(item, task){\n\t\tif (item.start_date) {\n\t\t\titem.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\n\t\t} else {\n\t\t\titem.start_date = null;\n\t\t}\n\n\t\tif (item.end_date) {\n\t\t\titem.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\n\t\t} else {\n\t\t\titem.end_date = null;\n\t\t}\n\n\t\tvar delay = Number(item.delay);\n\t\tvar initDelay = false;\n\t\tif (!isNaN(delay)) {\n\t\t\titem.delay = delay;\n\t\t} else {\n\t\t\titem.delay = 0;\n\t\t\tinitDelay = true;\n\t\t}\n\n\t\tif (!gantt.defined(item.value)) {\n\t\t\titem.value = null;\n\t\t}\n\n\t\tif (!item.task_id || !item.resource_id) {\n\t\t\treturn false;\n\t\t}\n\n\t\titem.mode = item.mode || assignmentModes.default;\n\n\t\tif(item.mode === assignmentModes.fixedDuration){\n\t\t\tif(isNaN(Number(item.duration))){\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\t\titem.duration = gantt.calculateDuration({\n\t\t\t\t\tstart_date: item.start_date,\n\t\t\t\t\tend_date: item.end_date,\n\t\t\t\t\tid: task\n\t\t\t\t});\n\t\t\t}\n\t\t\tif(initDelay){\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\t\titem.delay = gantt.calculateDuration({\n\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\tend_date: item.start_date,\n\t\t\t\t\tid: task\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (item.mode !== assignmentModes.fixedDates && (task || gantt.isTaskExists(item.task_id))) {\n\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\tvar timing = _assignmentTimeFromTask(item, task);\n\t\t\titem.start_date = timing.start_date;\n\t\t\titem.end_date = timing.end_date;\n\t\t\titem.duration = timing.duration;\n\t\t}\n\t}\n\t// gantt init\n\tvar resourceAssignmentsStore = gantt.createDatastore({\n\t\tname: gantt.config.resource_assignment_store,\n\t\tinitItem: function (item) {\n\t\t\tif (!item.id) {\n\t\t\t\titem.id = gantt.uid();\n\t\t\t}\n\n\t\t\tinitAssignmentFields(item);\n\n\t\t\treturn item;\n\t\t}\n\t});\n\t\n\tgantt.$data.assignmentsStore = resourceAssignmentsStore;\n\n\tfunction _assignmentTimeFromTask(assignment, task) {\n\n\t\tif (assignment.mode === assignmentModes.fixedDates) {\n\t\t\treturn {\n\t\t\t\tstart_date: assignment.start_date,\n\t\t\t\tend_date: assignment.end_date,\n\t\t\t\tduration: assignment.duration\n\t\t\t};\n\t\t} else {\n\t\t\tvar start = assignment.delay ? gantt.calculateEndDate({\n\t\t\t\tstart_date: task.start_date,\n\t\t\t\tduration: assignment.delay,\n\t\t\t\ttask: task\n\t\t\t}) : new Date(task.start_date);\n\n\t\t\tvar end;\n\t\t\tvar duration;\n\t\t\tif (assignment.mode === assignmentModes.fixedDuration) {\n\t\t\t\tend = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: start,\n\t\t\t\t\tduration: assignment.duration,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t\tduration = assignment.duration;\n\t\t\t} else {\n\t\t\t\tend = new Date(task.end_date);\n\t\t\t\tduration = task.duration - assignment.delay;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: start,\n\t\t\tend_date: end,\n\t\t\tduration: duration\n\t\t};\n\t}\n\n\t// data loading\n\n\tfunction _makeAssignmentsFromTask(task) {\n\t\tconst property = gantt.config.resource_property;\n\t\tlet assignments = task[property];\n\t\tconst resourceAssignments = [];\n\t\tlet detectFormat = resourceAssignmentFormat === resourceAssignmentFormats.auto;\n\n\t\tif (gantt.defined(assignments) && assignments) {\n\t\t\tif (!Array.isArray(assignments)) {\n\t\t\t\tassignments = [assignments];\n\t\t\t\tif (detectFormat) {\n\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.singleValue;\n\t\t\t\t\tdetectFormat = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst usedIds = {};\n\t\t\tassignments.forEach(function (res) {\n\t\t\t\tif (!res.resource_id) { // when resource is a string/number\n\t\t\t\t\tres = { resource_id: res };\n\t\t\t\t\tif (detectFormat) {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.valueArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t}\n\t\t\t\t\t//\tisSimpleArray = true;\n\t\t\t\t}\n\n\t\t\t\tif (detectFormat) {\n\t\t\t\t\tif (res.id && res.resource_id) {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.assignmentsArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.resourceValueArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet defaultMode = assignmentModes.default;\n\t\t\t\tif(!res.mode){\n\t\t\t\t\tif((res.start_date && res.end_date) || (res.start_date && res.duration)){\n\t\t\t\t\t\tdefaultMode = assignmentModes.fixedDuration;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet id;\n\t\t\t\tif(!res.id && res.$id && !usedIds[res.$id]){\n\t\t\t\t\tid = res.$id;\n\t\t\t\t} else if(res.id && !usedIds[res.id]){\n\t\t\t\t\tid = res.id;\n\t\t\t\t} else{\n\t\t\t\t\tid = gantt.uid();\n\t\t\t\t}\n\t\t\t\tusedIds[id] = true;\n\n\t\t\t\tconst assignment = {\n\t\t\t\t\tid: id,\n\t\t\t\t\tstart_date: res.start_date,\n\t\t\t\t\tduration: res.duration,\n\t\t\t\t\tend_date: res.end_date,\n\t\t\t\t\tdelay: res.delay,\n\t\t\t\t\ttask_id: task.id,\n\t\t\t\t\tresource_id: res.resource_id,\n\t\t\t\t\tvalue: res.value,\n\t\t\t\t\tmode: res.mode || defaultMode\n\t\t\t\t};\n\t\t\t\t// GS-2490: to add custom properties to assignment\n\t\t\t\t// need to exclude $id which incfluences on render \n\t\t\t\tObject.keys(res).forEach(key => {\n\t\t\t\t\tif(key != \"$id\") {\n\t\t\t\t\t\tassignment[key] = res[key];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(!(assignment.start_date && assignment.start_date.getMonth \n\t\t\t\t\t&& assignment.end_date && assignment.end_date.getMonth && typeof assignment.duration === \"number\")){\n\t\t\t\t\tinitAssignmentFields(assignment, task);\n\t\t\t\t}\n\n\t\t\t\tresourceAssignments.push(assignment);\n\t\t\t});\n\t\t}\n\t\treturn resourceAssignments;\n\t}\n\n\tfunction _updateTaskBack(taskId) {\n\t\t// GS-1493. In some cases, the resource assignment store has the tasks that no longer exist\n\t\tif (!gantt.isTaskExists(taskId)){\n\t\t\treturn;\n\t\t}\n\n\t\tvar task = gantt.getTask(taskId);\n\t\tvar assignments = gantt.getTaskAssignments(task.id);\n\t\t_assignAssignments(task, assignments);\n\t}\n\n\tfunction _assignAssignments(task, assignments){\n\t\tassignments.sort(function(a, b){\n\t\t\tif(a.start_date && b.start_date && a.start_date.valueOf() != b.start_date.valueOf()){\n\t\t\t\treturn a.start_date - b.start_date;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray) {\n\t\t\ttask[gantt.config.resource_property] = assignments;\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray) {\n\t\t\ttask[gantt.config.resource_property] = assignments.map(function (a) {\n\t\t\t\treturn {\n\t\t\t\t\t$id: a.id,\n\t\t\t\t\tstart_date: a.start_date,\n\t\t\t\t\tduration: a.duration,\n\t\t\t\t\tend_date: a.end_date,\n\t\t\t\t\tdelay: a.delay,\n\t\t\t\t\tresource_id: a.resource_id,\n\t\t\t\t\tvalue: a.value,\n\t\t\t\t\tmode: a.mode\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\ttask[resourceAssignmentsProperty] = assignments;\n\t}\n\n\tfunction _loadAssignmentsFromTask(task) {\n\t\tvar assignments = _makeAssignmentsFromTask(task);\n\t\tvar taskAssignments = [];\n\t\tassignments.forEach(function (a) {\n\t\t\ta.id = a.id || gantt.uid();\n\t\t\t//var newId = resourceAssignmentsStore.addItem(a);\n\t\t\ttaskAssignments.push(a);\n\t\t});\n\n\t\treturn assignments;\n\t}\n\n\tfunction diffAssignments(taskValues, assignmentsStoreValues) {\n\t\tvar result = {\n\t\t\tinBoth: [],\n\t\t\tinTaskNotInStore: [],\n\t\t\tinStoreNotInTask: []\n\t\t};\n\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.singleValue) {\n\t\t\tvar taskOwner = taskValues[0];\n\t\t\tvar ownerId = taskOwner ? taskOwner.resource_id : null;\n\t\t\tvar foundOwnerAssignment = false;\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tif (a.resource_id != ownerId) {\n\t\t\t\t\tresult.inStoreNotInTask.push(a);\n\t\t\t\t} else if (a.resource_id == ownerId) {\n\t\t\t\t\tresult.inBoth.push({ store: a, task: taskOwner });\n\t\t\t\t\tfoundOwnerAssignment = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!foundOwnerAssignment && taskOwner) {\n\t\t\t\tresult.inTaskNotInStore.push(taskOwner);\n\t\t\t}\n\n\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.valueArray){\n\n\t\t\tvar taskSearch = {};\n\t\t\tvar storeSearch = {};\n\t\t\tvar processedIds = {};\n\t\t\ttaskValues.forEach(function (a) {\n\t\t\t\ttaskSearch[a.resource_id] = a;\n\t\t\t});\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tstoreSearch[a.resource_id] = a;\n\t\t\t});\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\n\t\t\t\tif (processedIds[a.resource_id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tprocessedIds[a.resource_id] = true;\n\t\t\t\tvar inTask = taskSearch[a.resource_id];\n\t\t\t\tvar inStore = storeSearch[a.resource_id];\n\n\t\t\t\tif (inTask && inStore) {\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\n\t\t\t\t} else if (inTask && !inStore) {\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\n\t\t\t\t} else if (!inTask && inStore) {\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if ((resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray)\n\t\t\t|| (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray)) {\n\t\t\tvar taskSearch = {};\n\t\t\tvar storeSearch = {};\n\t\t\tvar processedIds = {};\n\t\t\ttaskValues.forEach(function (a) {\n\t\t\t\ttaskSearch[a.id || a.$id] = a;\n\t\t\t});\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tstoreSearch[a.id] = a;\n\t\t\t});\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\n\t\t\t\tvar id = a.id || a.$id;\n\t\t\t\tif (processedIds[id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tprocessedIds[id] = true;\n\t\t\t\tvar inTask = taskSearch[id];\n\t\t\t\tvar inStore = storeSearch[id];\n\n\t\t\t\tif (inTask && inStore) {\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\n\t\t\t\t} else if (inTask && !inStore) {\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\n\t\t\t\t} else if (!inTask && inStore) {\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction assignmentHasChanged(source, target) {\n\t\tvar ignoreFields = {\n\t\t\tid: true\n\t\t};\n\n\t\tfor (var i in source) {\n\t\t\tif (!ignoreFields[i]) {\n\t\t\t\tif (String(source[i]) !== String(target[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tfunction updateAssignment(source, target) {\n\t\tvar ignoreFields = {\n\t\t\tid: true\n\t\t};\n\n\t\tfor (var i in source) {\n\t\t\tif (!ignoreFields[i]) {\n\t\t\t\ttarget[i] = source[i];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction _syncAssignments(task, storeAssignments){\n\t\tvar tasksAssignments = _makeAssignmentsFromTask(task);\n\n\t\tvar diff = diffAssignments(tasksAssignments, storeAssignments);\n\t\tdiff.inStoreNotInTask.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\n\t\t});\n\t\tdiff.inTaskNotInStore.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.addItem(a);\n\t\t});\n\n\t\tdiff.inBoth.forEach(function (a) {\n\t\t\tif (assignmentHasChanged(a.task, a.store)) {\n\t\t\t\tupdateAssignment(a.task, a.store);\n\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\n\t\t\t} else {\n\t\t\t\tif (a.task.start_date && a.task.end_date && a.task.mode !== assignmentModes.fixedDates) {\n\t\t\t\t\tvar timing = _assignmentTimeFromTask(a.store, task);\n\t\t\t\t\tif (a.store.start_date.valueOf() != timing.start_date.valueOf() || a.store.end_date.valueOf() != timing.end_date.valueOf()) {\n\t\t\t\t\t\ta.store.start_date = timing.start_date;\n\t\t\t\t\t\ta.store.end_date = timing.end_date;\n\t\t\t\t\t\ta.store.duration = timing.duration;\n\t\t\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t_updateTaskBack(task.id);\n\t}\n\n\tfunction _syncOnTaskUpdate(task) {\n\t\tvar storeAssignments = task[resourceAssignmentsProperty] || resourceAssignmentsStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\n\t\t_syncAssignments(task, storeAssignments);\n\t}\n\n\tfunction _syncOnTaskDelete(ids) {\n\t\tvar idsSearch = {};\n\t\tids.forEach(function (id) {\n\t\t\tidsSearch[id] = true;\n\t\t});\n\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\n\t\t\treturn idsSearch[a.task_id];\n\t\t});\n\t\ttaskResources.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\n\t\t});\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\n\t\tif (gantt.config.process_resource_assignments) {\n\t\t\tgantt.attachEvent(\"onParse\", function () {\n\t\t\t\tgantt.silent(function () {\n\t\t\t\t\tresourceAssignmentsStore.clearAll();\n\t\t\t\t\tvar totalAssignments = [];\n\t\t\t\t\tgantt.eachTask(function (task) {\n\t\t\t\t\t\tif (task.type === gantt.config.types.project) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar assignments = _loadAssignmentsFromTask(task);\n\t\t\t\t\t\t_assignAssignments(task, assignments);\n\n\t\t\t\t\t\tassignments.forEach(function (a) {\n\t\t\t\t\t\t\ttotalAssignments.push(a);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tresourceAssignmentsStore.parse(totalAssignments);\n\t\t\t\t});\n\n\t\t\t});\n\n\t\t\tvar batchUpdate = false;\n\t\t\tvar needUpdate = false;\n\t\t\tvar needUpdateFor = {};\n\t\t\tvar undoBatchCancel = false;\n\t\t\tgantt.attachEvent(\"onBeforeBatchUpdate\", function(){\n\t\t\t\tbatchUpdate = true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterBatchUpdate\", function(){\n\t\t\t\t\n\t\t\t\tif(needUpdate){\n\t\t\t\t\tvar assignmentsHash = {};\n\t\t\t\t\tfor(var i in needUpdateFor){\n\t\t\t\t\t\tassignmentsHash[i] = gantt.getTaskAssignments(needUpdateFor[i].id);\n\t\t\t\t\t}\n\t\t\t\t\tfor(var i in needUpdateFor){\n\t\t\t\t\t\t_syncAssignments(needUpdateFor[i], assignmentsHash[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tneedUpdate = false;\n\t\t\t\tbatchUpdate = false;\n\t\t\t\tneedUpdateFor = {};\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (item) {\n\t\t\t\tvar assignments = _loadAssignmentsFromTask(item);\n\t\t\t\tresourceAssignmentsStore.parse(assignments);\n\t\t\t\t_assignAssignments(item, assignments);\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", function (id, item) {\n\t\t\t\tif(batchUpdate){\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t\tneedUpdateFor[id] = item;\n\t\t\t\t}else if (!item.unscheduled){\n\t\t\t\t\t_syncOnTaskUpdate(item);\n\t\t\t\t}\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function (id, item) {\n\t\t\t\tif(batchUpdate){\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t\tneedUpdateFor[id] = item;\n\t\t\t\t}else{\n\t\t\t\t\t_syncOnTaskUpdate(item);\n\t\t\t\t}\n\t\t\t});\n\n\t\t/*\tgantt.attachEvent(\"onRowDragMove\", function (id) {\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\n\t\t\t});*/\n\t\t\tgantt.attachEvent(\"onRowDragEnd\", function (id) {\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\n\t\t\t});\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onAfterDeleteConfirmed\", function (id, item) {\n\t\t\t\tvar deleteIds = [id];\n\t\t\t\tgantt.eachTask(function (task) {\n\t\t\t\t\tdeleteIds.push(task.id);\n\t\t\t\t}, id);\n\t\t\t\t_syncOnTaskDelete(deleteIds);\n\t\t\t});\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n\t\t\t\tresourceAssignmentsCache = null;\n\t\t\t\tresourceTaskAssignmentsCache = null;\n\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\tresourceAssignmentsStore.clearAll();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n\t\t\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\n\t\t\t\t\treturn a.task_id == id;\n\t\t\t\t});\n\t\t\t\ttaskResources.forEach(function (a) {\n\t\t\t\t\ta.task_id = new_id;\n\t\t\t\t\tresourceAssignmentsStore.updateItem(a.id);\n\t\t\t\t});\n\t\t\t\t_updateTaskBack(new_id);\n\t\t\t\t//any custom logic here\n\t\t\t});\n\t\t\t// GS-2144. When we Undo something, the cache should be reset\n\t\t\t// during the `onStoreUpdated` event to properly update the assignments\n\t\t\tgantt.attachEvent(\"onBeforeUndo\", function (action) {\n\t\t\t\tundoBatchCancel = true;\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterUndo\", function (action) {\n\t\t\t\tundoBatchCancel = true;\n\t\t\t});\n\n\n\t\t\tvar resourceAssignmentsCache = null;\n\t\t\tvar resourceTaskAssignmentsCache = null;\n\t\t\tvar taskAssignmentsCache = null;\n\n\t\t\tresourceAssignmentsStore.attachEvent(\"onStoreUpdated\", function resetCache(){\n\t\t\t\tif(batchUpdate && !undoBatchCancel){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tresourceAssignmentsCache = null;\n\t\t\t\tresourceTaskAssignmentsCache = null;\n\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tgantt.getResourceAssignments = function (resourceId, taskId) {\n\t\t\t\tvar searchTaskId = gantt.defined(taskId) && taskId !== null;\n\n\t\t\t\tif(resourceAssignmentsCache === null){\n\t\t\t\t\tresourceAssignmentsCache = {};\n\t\t\t\t\tresourceTaskAssignmentsCache = {};\n\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\n\t\t\t\t\t\tif(!resourceAssignmentsCache[a.resource_id]){\n\t\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id].push(a);\n\n\t\t\t\t\t\tvar resourceTaskCacheKey = a.resource_id + \"-\" + a.task_id;\n\t\t\t\t\t\tif(!resourceTaskAssignmentsCache[resourceTaskCacheKey]){\n\t\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey].push(a);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t\tif(searchTaskId){\n\t\t\t\t\treturn (resourceTaskAssignmentsCache[resourceId + \"-\" + taskId] || []).slice();\n\t\t\t\t}else{\n\t\t\t\t\treturn (resourceAssignmentsCache[resourceId] || []).slice();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t\n\t\t\tgantt.getTaskAssignments = function (taskId) {\n\t\t\t\tif(taskAssignmentsCache === null){\n\t\t\t\t\tvar result = [];\n\t\t\t\t\ttaskAssignmentsCache = {};\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\n\t\t\t\t\t\tif(!taskAssignmentsCache[a.task_id]){\n\t\t\t\t\t\t\ttaskAssignmentsCache[a.task_id] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttaskAssignmentsCache[a.task_id].push(a);\n\t\t\t\t\t\tif (a.task_id == taskId) {\n\t\t\t\t\t\t\tresult.push(a);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn (taskAssignmentsCache[taskId] || []).slice();\n\t\t\t};\n\t\t\t\n\t\t\tgantt.getTaskResources = function (taskId) {\n\t\t\t\tconst store = gantt.getDatastore(\"resource\");\n\t\t\t\tconst assignments = gantt.getTaskAssignments(taskId);\n\t\n\t\t\t\tconst uniqueResources = {};\n\t\t\t\tassignments.forEach(function(a){\n\t\t\t\t\tif(!uniqueResources[a.resource_id]){\n\t\t\t\t\t\tuniqueResources[a.resource_id] = a.resource_id;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tconst resources = [];\n\t\t\t\tfor(const i in uniqueResources){\n\t\t\t\t\tconst res = store.getItem(uniqueResources[i]);\n\t\t\t\t\tif(res){\n\t\t\t\t\t\tresources.push(res);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn resources;\n\t\t\t};\n\n\t\t\tgantt.updateTaskAssignments = _updateTaskBack;\n\t\t}\n\t}, {once: true});\n};","export default function addPlaceholder(gantt){\n\tfunction isEnabled(){\n\t\treturn gantt.config.placeholder_task;\n\t}\n\n\tfunction callIfEnabled(callback){\n\t\treturn function(){\n\t\t\tif(!isEnabled()){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn callback.apply(this, arguments);\n\t\t};\n\t}\n\n\tfunction silenceDataProcessor(dataProcessor){\n\t\tif(dataProcessor && !dataProcessor._silencedPlaceholder){\n\t\t\tdataProcessor._silencedPlaceholder = true;\n\t\t\tdataProcessor.attachEvent(\"onBeforeUpdate\", callIfEnabled(function(id, state, data){\n\t\t\t\tif(data.type == gantt.config.types.placeholder){\n\t\t\t\t\tdataProcessor.setUpdated(id, false);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}));\n\t\t}\n\t}\n\n\tfunction insertPlaceholder(){\n\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\n\t\tif(!placeholders.length || !gantt.isTaskExists(placeholders[0].id)){\n\t\t\tvar placeholder = {\n\t\t\t\tunscheduled: true,\n\t\t\t\ttype: gantt.config.types.placeholder,\n\t\t\t\tduration:0,\n\t\t\t\ttext: gantt.locale.labels.new_task\n\t\t\t};\n\t\t\tif(gantt.callEvent(\"onTaskCreated\", [placeholder]) === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tgantt.addTask(placeholder);\n\t\t\t\n\t\t}\n\t}\n\n\tfunction afterEdit(id){\n\t\tvar item = gantt.getTask(id);\n\t\tif(item.type == gantt.config.types.placeholder) {\n\t\t\tif(item.start_date && item.end_date && item.unscheduled){\n\t\t\t\titem.unscheduled = false;\n\t\t\t}\n\n\t\t\tgantt.batchUpdate(function(){\n\t\t\t\tvar newTask = gantt.copy(item);\n\t\t\t\tgantt.silent(function(){\n\t\t\t\t\tgantt.deleteTask(item.id);\n\t\t\t\t});\n\n\t\t\t\tdelete newTask[\"!nativeeditor_status\"];\n\t\t\t\tnewTask.type = gantt.config.types.task;\n\t\t\t\tnewTask.id = gantt.uid();\n\t\t\t\tgantt.addTask(newTask);\n\n\t\t\t\t//insertPlaceholder();\n\t\t\t});\n\n\t\t}\n\t}\n\n\tgantt.config.types.placeholder = \"placeholder\";\n\tgantt.attachEvent(\"onDataProcessorReady\", callIfEnabled(silenceDataProcessor));\n\n\tvar ready = false;\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(ready){\n\t\t\treturn;\n\t\t}\n\t\tready = true;\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(afterEdit));\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id, task){\n\t\t\tif(task.type != gantt.config.types.placeholder){\n\t\t\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\n\t\t\t\tplaceholders.forEach(function(p){\n\t\t\t\t\tgantt.silent(function(){\n\t\t\t\t\t\tif(gantt.isTaskExists(p.id))\n\t\t\t\t\t\t\tgantt.deleteTask(p.id);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tinsertPlaceholder();\n\t\t\t}\n\t\t}));\n\t\tgantt.attachEvent(\"onParse\", callIfEnabled(insertPlaceholder));\n\t});\n\n\tfunction isPlaceholderTask(taskId){\n\t\tif(gantt.config.types.placeholder && gantt.isTaskExists(taskId)){\n\t\t\tvar task = gantt.getTask(taskId);\n\t\t\tif(task.type == gantt.config.types.placeholder){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tfunction isPlaceholderLink(link){\n\t\tif(isPlaceholderTask(link.source) || isPlaceholderTask(link.target)){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\n\t\tif(isPlaceholderLink(link)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\tgantt.attachEvent(\"onBeforeLinkAdd\", function(id,link){\n\t\tif(isPlaceholderLink(link)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\tgantt.attachEvent(\"onBeforeUndoStack\", function(action){\n\t\tfor(var i = 0; i < action.commands.length; i++){\n\t\t\tvar command = action.commands[i];\n\t\t\tif(command.entity === \"task\" && command.value.type === gantt.config.types.placeholder){\n\t\t\t\taction.commands.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n};","export default function(gantt) {\n\tfunction isEnabled() {\n\t\treturn gantt.config.auto_types && // if enabled\n\t\t\t(gantt.getTaskType(gantt.config.types.project) == gantt.config.types.project);// and supported\n\t}\n\n\tfunction callIfEnabled(callback) {\n\t\treturn function() {\n\t\t\tif (!isEnabled()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn callback.apply(this, arguments);\n\t\t};\n\t}\n\n\tfunction checkTaskType(id, changedTypes) {\n\t\tvar task = gantt.getTask(id);\n\t\tvar targetType = getTaskTypeToUpdate(task);\n\t\tif (targetType !== false && gantt.getTaskType(task) !== targetType) {\n\t\t\tchangedTypes.$needsUpdate = true;\n\t\t\tchangedTypes[task.id] = {task: task, type: targetType};\n\t\t}\n\t}\n\n\tfunction getUpdatedTypes(id, changedTypes) {\n\t\tchangedTypes = changedTypes || {};\n\t\t\n\t\tcheckTaskType(id, changedTypes);\n\t\tgantt.eachParent(function(parent) {\n\t\t\tcheckTaskType(parent.id, changedTypes);\n\t\t}, id);\n\n\t\treturn changedTypes;\n\t}\n\n\tfunction applyChanges(changedTypes) {\n\t\tfor (var i in changedTypes) {\n\t\t\tif(changedTypes[i] && changedTypes[i].task){\n\t\t\t\tvar task = changedTypes[i].task;\n\t\t\t\ttask.type = changedTypes[i].type;\n\t\t\t\tgantt.updateTask(task.id);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction updateParentTypes(startId) {\n\t\tif (gantt.getState().group_mode) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar changedTypes = getUpdatedTypes(startId);\n\t\tif (changedTypes.$needsUpdate) {\n\t\t\tgantt.batchUpdate(function() {\n\t\t\t\tapplyChanges(changedTypes);\n\t\t\t});\n\t\t}\n\t}\n\n\tvar delTaskParent;\n\n\tfunction updateTaskType(task, targetType) {\n\t\tif(!gantt.getState().group_mode){\n\t\t\ttask.type = targetType;\n\t\t\tgantt.updateTask(task.id);\n\t\t}\n\t}\n\n\tfunction getTaskTypeToUpdate(task) {\n\t\tvar allTypes = gantt.config.types;\n\t\tvar hasChildren = gantt.hasChild(task.id);\n\t\tvar taskType = gantt.getTaskType(task.type);\n\n\t\tif (hasChildren && taskType === allTypes.task) {\n\t\t\treturn allTypes.project;\n\t\t}\n\n\t\tif (!hasChildren && taskType === allTypes.project) {\n\t\t\treturn allTypes.task;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvar isParsingDone = true;\n\n\tgantt.attachEvent(\"onParse\", callIfEnabled(function() {\n\t\tisParsingDone = false;\n\t\tif(gantt.getState().group_mode){\n\t\t\treturn;\n\t\t}\n\n\t\tgantt.batchUpdate(function() {\n\t\t\tgantt.eachTask(function(task) {\n\t\t\t\tvar targetType = getTaskTypeToUpdate(task);\n\t\t\t\tif (targetType !== false) {\n\t\t\t\t\tupdateTaskType(task, targetType);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tisParsingDone = true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id) {\n\t\tif (isParsingDone) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(function(id) {\n\t\tif (isParsingDone) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}));\n\n\tfunction updateAfterRemoveChild(id){\n\t\tif (id != gantt.config.root_id && gantt.isTaskExists(id)) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}\n\n\tgantt.attachEvent(\"onBeforeTaskDelete\", callIfEnabled(function(id, task) {\n\t\tdelTaskParent = gantt.getParent(id);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskDelete\", callIfEnabled(function(id, task) {\n\t\tupdateAfterRemoveChild(delTaskParent);\n\t}));\n\n\n\tvar originalRowDndParent;\n\n\tgantt.attachEvent(\"onRowDragStart\", callIfEnabled(function(id, target, e) {\n\t\toriginalRowDndParent = gantt.getParent(id);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onRowDragEnd\", callIfEnabled(function(id, target) {\n\t\tupdateAfterRemoveChild(originalRowDndParent);\n\t\tupdateParentTypes(id);\n\t}));\n\n\tvar originalMoveTaskParent;\n\n\tgantt.attachEvent(\"onBeforeTaskMove\", callIfEnabled(function(sid, parent, tindex) {\n\t\toriginalMoveTaskParent = gantt.getParent(sid);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskMove\", callIfEnabled(function(id, parent, tindex) {\n\t\tif (document.querySelector(\".gantt_drag_marker\")) {\n\t\t\t// vertical dnd in progress\n\t\t\treturn;\n\t\t}\n\t\tupdateAfterRemoveChild(originalMoveTaskParent);\n\t\tupdateParentTypes(id);\n\t}));\n};","export default class DurationFormatterNumeric implements IDurationFormatter {\n\tstatic create = (settings: IDurationFormatterConfig = null): IDurationFormatter => {\n\t\treturn new DurationFormatterNumeric();\n\t};\n\tcanParse = (value: string) : boolean => {\n\t\treturn !isNaN(this.parse(value));\n\t};\n\tformat = (value: number) : string => {\n\t\treturn String(value);\n\t};\n\tparse = (value: string) : number => {\n\t\treturn parseInt(value, 10);\n\t};\n}","export default class LinkFormatterSimple implements ILinkFormatter {\n\tstatic create = (settings: ILinkFormatterConfig = null, gantt: any): LinkFormatterSimple => {\n\t\treturn new LinkFormatterSimple(gantt);\n\t};\n\tprotected _linkReg: RegExp;\n\tprotected _gantt: any;\n\n\tconstructor(gantt: any) {\n\t\tthis._linkReg = /^[0-9\\.]+/;\n\t\tthis._gantt = gantt;\n\t}\n\n\tformat = (link: ILink) : string => {\n\t\tconst wbs = this._getWBSCode(link.source);\n\t\treturn wbs;\n\t};\n\n\tcanParse = (value: string) : boolean => {\n\t\treturn this._linkReg.test(value);\n\t};\n\tparse = (value: string) : ILink => {\n\t\tif(!this.canParse(value)){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst linkPart = this._linkReg.exec(value)[0].trim();\n\n\t\tconst source = this._findSource(linkPart) || null;\n\n\t\treturn {\n\t\t\tid: undefined,\n\t\t\tsource,\n\t\t\ttarget: null,\n\t\t\ttype: this._gantt.config.links.finish_to_start,\n\t\t\tlag: 0\n\t\t};\n\t};\n\n\tprotected _getWBSCode = (source: number | string) => {\n\t\tconst pred = this._gantt.getTask(source);\n\t\treturn this._gantt.getWBSCode(pred);\n\t};\n\n\tprotected _findSource = (value: string) => {\n\t\tconst reqTemplate = new RegExp(\"^[0-9\\.]+\", \"i\");\n\t\tif(reqTemplate.exec(value)){\n\t\t\tconst wbs = reqTemplate.exec(value)[0];\n\t\t\tconst task = this._gantt.getTaskByWBSCode(wbs);\n\t\t\tif(task){\n\t\t\t\treturn task.id;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n}","\nimport DurationFormatter from \"../common/duration_formatter\";\nimport LinkFormatter from \"../common/link_formatter\";\n\nexport default function(gantt){\n\tgantt.ext.formatters = {\n\t\tdurationFormatter: function(settings){\n\t\t\tif(!settings){\n\t\t\t\tsettings = {};\n\t\t\t}\n\t\t\tif(!settings.store){\n\t\t\t\tsettings.store = gantt.config.duration_unit;\n\t\t\t}\n\t\t\tif(!settings.enter){\n\t\t\t\tsettings.enter = gantt.config.duration_unit;\n\t\t\t}\n\t\t\treturn DurationFormatter.create(settings, gantt);\n\t\t},\n\t\tlinkFormatter: function(settings){\n\t\t\treturn LinkFormatter.create(settings, gantt);\n\t\t}\n\t};\n};","export default function(gantt: any){\n\n\tgantt.ext = gantt.ext || {};\n\tgantt.config.show_empty_state = false;\n\n\tgantt.ext.emptyStateElement = gantt.ext.emptyStateElement || {\n\t\tisEnabled() {\n\t\t\treturn gantt.config.show_empty_state === true;\n\t\t},\n\t\tisGanttEmpty(){\n\t\t\treturn !gantt.getTaskByTime().length;\n\t\t},\n\t\trenderContent(container){\n\t\t\tconst placeholderTextElement = `<div class='gantt_empty_state_text'>\n    <div class='gantt_empty_state_text_link' data-empty-state-create-task>${gantt.locale.labels.empty_state_text_link}</div>\n    <div class='gantt_empty_state_text_description'>${gantt.locale.labels.empty_state_text_description}</div>\n    </div>`;\n\t\t\tconst placeholderImageElement = \"<div class='gantt_empty_state_image'></div>\";\n\n\t\t\tconst placeholderContainer = `<div class='gantt_empty_state'>${placeholderImageElement}${placeholderTextElement}</div>`;\n\t\t\tcontainer.innerHTML = placeholderContainer;\n\t\t},\n\n\t\tclickEvents: [],\n\t\tattachAddTaskEvent(){\n\t\t\tconst id = gantt.attachEvent(\"onEmptyClick\", function(e){\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tconst gridPlaceholder = domHelpers.closest(e.target, \"[data-empty-state-create-task]\");\n\t\t\t\tif (gridPlaceholder){\n\t\t\t\t\tgantt.createTask({\n\t\t\t\t\t\tid: gantt.uid(),\n\t\t\t\t\t\ttext: \"New Task\"\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.clickEvents.push(id);\n\t\t},\n\t\tdetachAddTaskEvents(){\n\t\t\tthis.clickEvents.forEach(function(event){\n\t\t\t\tgantt.detachEvent(event);\n\t\t\t});\n\t\t\tthis.clickEvents = [];\n\t\t},\n\n\t\tgetContainer(){\n\t\t\tif (gantt.$container) {\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tif (gantt.$container.contains(gantt.$grid_data)) {\n\t\t\t\t\treturn domHelpers.closest(gantt.$grid_data, \".gantt_layout_content\");\n\t\t\t\t}\n\t\t\t\tif (gantt.$container.contains(gantt.$task_data)){\n\t\t\t\t\treturn domHelpers.closest(gantt.$task_data, \".gantt_layout_content\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tgetNode(){\n\t\t\tconst container = this.getContainer();\n\t\t\tif (!container){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst emptyStateElementNode = container.querySelector(\".gantt_empty_state_wrapper\");\n\t\t\treturn emptyStateElementNode;\n\t\t},\n\n\t\tshow(){\n\t\t\tconst container = this.getContainer();\n\t\t\tif (!container && this.isGanttEmpty()){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst wrapper = document.createElement(\"div\");\n\t\t\twrapper.className = \"gantt_empty_state_wrapper\";\n\t\t\twrapper.style.marginTop = (gantt.config.scale_height - container.offsetHeight) + \"px\";\n\t\t\tconst oldNodes = gantt.$container.querySelectorAll(\".gantt_empty_state_wrapper\");\n\t\t\t// for IE11\n\t\t\tArray.prototype.forEach.call(oldNodes, function(node){\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t});\n\n\t\t\tthis.detachAddTaskEvents();\n\t\t\tthis.attachAddTaskEvent();\n\n\t\t\tcontainer.appendChild(wrapper);\n\t\t\tthis.renderContent(wrapper);\n\t\t},\n\t\thide(){\n\t\t\tconst emptyStateElementNode = this.getNode();\n\t\t\tif (emptyStateElementNode){\n\t\t\t\temptyStateElementNode.parentNode.removeChild(emptyStateElementNode);\n\t\t\t} else{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t},\n\t\tinit(){ }\n\t};\n\n\tgantt.attachEvent(\"onDataRender\", function() {\n\t\tconst emptyStateElement = gantt.ext.emptyStateElement;\n\t\tif (emptyStateElement.isEnabled() && emptyStateElement.isGanttEmpty()) {\n\t\t\temptyStateElement.show();\n\t\t} else {\n\t\t\temptyStateElement.hide();\n\t\t}\n\t});\n\n\n\n\n}\n","export const hasBaselinesBelow = function (gantt, task) {\n  const baselines = task.baselines && task.baselines.length;\n  const baselinesOnDifferentRow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\n  if (baselines && baselinesOnDifferentRow) {\n    return true;\n  }\n};\n\nexport const childrenHaveBaselines = function (gantt, taskId) {\n  let hasBaselines = false;\n  gantt.eachTask(function (child) {\n    if (hasBaselines) {\n      return;\n    }\n    hasBaselines = hasBaselinesBelow(gantt, child);\n  }, taskId);\n  return hasBaselines;\n};\n\nexport const isSplitChild = function (gantt, id) {\n  let splitChild = false;\n  gantt.eachParent(function (parent) {\n    if (isSplitParent(parent)) {\n      splitChild = true;\n    }\n  }, id);\n  return splitChild;\n};\n\nexport const isSplitParent = function (task) {\n  return task.render && task.render == \"split\" && !task.$open;\n};\n\nexport const getMaxParentHeight = function (gantt, view, task, heightLimit) {\n  let maxHeight = heightLimit || view.$task_data.scrollHeight;\n  let shrinkHeight = false;\n  let splitChild = false;\n\n  gantt.eachParent(function (parent) {\n    if (isSplitParent(parent)) {\n      splitChild = true;\n      const parentSizes = view.getItemPosition(parent);\n      const parentHeight = parentSizes.rowHeight;\n      if (parentHeight < maxHeight) {\n        maxHeight = parentHeight;\n        shrinkHeight = true;\n      }\n    }\n  }, task.id);\n\n  return { maxHeight, shrinkHeight, splitChild };\n};\n\nexport const getMilestoneHeight = function (height) {\n  return Math.sqrt(2 * height * height);\n};\n\nexport const getInvertedMilestoneHeight = function (height) {\n  return Math.round(height / Math.sqrt(2));\n};\n\nexport const getAdjustedPosition = function (gantt, timeline, sizes, heightLimit, task, childBaselines) {\n  const baselines = hasBaselinesBelow(gantt, task);\n\n  const splitParams = getMaxParentHeight(gantt, timeline, task);\n  let maxHeight = splitParams.maxHeight;\n\n  let height = sizes.height;\n  let largerHeight = height > heightLimit;\n  let noNeedToShrink = sizes.rowHeight >= heightLimit && !splitParams.splitChild && !baselines;\n  if (largerHeight || noNeedToShrink) {\n    height = heightLimit;\n  }\n\n  if (maxHeight < height) {\n    height = maxHeight;\n  }\n\n  let marginTop = Math.floor((sizes.rowHeight - height) / 2);\n\n  if (splitParams.splitChild) {\n    marginTop = Math.floor((maxHeight - height) / 2);\n  }\n  if (childBaselines || baselines) {\n    let heightDiff = Math.min(sizes.height, maxHeight) - height;\n\n    let additionalMargin = 2;\n    let exceedBarHeight = baselines && task.bar_height >= task.row_height;\n    let exceedParentHeight = splitParams.splitChild && sizes.height >= maxHeight;\n    if (exceedBarHeight || exceedParentHeight){\n      additionalMargin = 0;\n    }\n\n    marginTop = Math.floor(heightDiff / 2) + additionalMargin;\n    const bottom = height + marginTop;\n    if (bottom > sizes.rowHeight || bottom > maxHeight) {\n      // marginTop = 0;\n    }\n  }\n\n  return { height, marginTop };\n};\n\nexport default {\n  hasBaselinesBelow,\n  childrenHaveBaselines,\n  isSplitChild,\n  isSplitParent,\n  getMaxParentHeight,\n  getMilestoneHeight,\n  getInvertedMilestoneHeight,\n  getAdjustedPosition\n};\n","import { hasBaselinesBelow, isSplitParent } from \"../ui/render/baseline_helper\";\n\nexport default function (gantt) {\n  gantt.config.baselines = {\n    datastore: \"baselines\",\n    render_mode: false,\n    dataprocessor_baselines: false,\n    row_height: 16,\n    bar_height: 8\n  };\n\n  function initBaselineFields(item, task) {\n    // don't add baseline if it doesn't belong to any task\n    // or if doesn't have the dates\n    if (!item.task_id || (!item.start_date && !item.end_date)) {\n      return false;\n    }\n\n    if (item.start_date) {\n      item.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\n    } else {\n      item.start_date = null;\n    }\n\n    if (item.end_date) {\n      item.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\n    } else {\n      item.end_date = null;\n    }\n\n    // set min baseline duration\n    item.duration = item.duration || 1;\n\n    // GS-2636. Calculate the 3rd date parameter basing on existing date parameters\n    if (item.start_date && !item.end_date){\n      item.end_date = gantt.calculateEndDate(item.start_date, item.duration);\n    } else if (item.end_date && !item.start_date){\n      item.start_date = gantt.calculateEndDate(item.end_date, -item.duration);\n    } \n  }\n  // gantt init\n  const baselineStore = gantt.createDatastore({\n    name: gantt.config.baselines.datastore,\n    initItem: function (item) {\n      if (!item.id) {\n        item.id = gantt.uid();\n      }\n\n      initBaselineFields(item);\n\n      return item;\n    }\n  });\n\n  gantt.$data.baselineStore = baselineStore;\n\n  function _syncBaselines(task) {\n    let shouldRepaint = false;\n    const iteratedBaselines = {};\n\n    const taskBaselines = task.baselines || [];\n    const exisingBaselines = gantt.getTaskBaselines(task.id);\n\n    if (taskBaselines.length != exisingBaselines.length) {\n      shouldRepaint = true;\n    }\n\n    taskBaselines.forEach(function (baseline) {\n      iteratedBaselines[baseline.id] = true;\n      const exisingBaseline = baselineStore.getItem(baseline.id);\n      if (exisingBaseline) {\n        const start = +exisingBaseline.start_date !== +baseline.start_date;\n        const end = +exisingBaseline.end_date !== +baseline.end_date;\n        if (start || end) {\n          baselineStore.updateItem(baseline.id, baseline);\n        }\n      } else {\n        baselineStore.addItem(baseline);\n      }\n    });\n\n    exisingBaselines.forEach(function (baseline) {\n      if (!iteratedBaselines[baseline.id]) {\n        baselineStore.removeItem(baseline.id);\n      }\n    });\n\n    if (shouldRepaint) {\n      if (isSplitParent(task)){\n        // here we adjust the parent height, then adjust it with the total child height\n        _adjustSplitParentHeight (task);\n      } else {\n        gantt.adjustTaskHeightForBaselines(task);\n      }\n      gantt.render();\n    }\n  }\n\n  function _deleteOrphanBaselines() {\n    baselineStore.eachItem(function (baseline) {\n      if (!gantt.isTaskExists(baseline.task_id)) {\n        baselineStore.removeItem(baseline.id);\n      }\n    });\n  }\n\n  function _adjustSplitParentHeight (task){\n    let maxParentHeight = 0;\n\n    gantt.adjustTaskHeightForBaselines(task);\n\n    gantt.eachTask(function(child){\n      let childHeight = child.row_height || gantt.config.row_height;\n\n      maxParentHeight = maxParentHeight || childHeight;\n      if (childHeight > maxParentHeight){\n        maxParentHeight = childHeight;\n      }\n    }, task.id);\n\n    if (task.row_height < maxParentHeight){\n      task.row_height = maxParentHeight;\n    }\n  }\n\n  gantt.adjustTaskHeightForBaselines = function (task) {\n    let height, baselineSize, betweenBaselines;\n    let margins = 2;\n    let baselineAmount = task.baselines && task.baselines.length || 0;\n    const subrowHeight = gantt.config.baselines.row_height;\n    //const baselineBarHeight = task?.baselines.bar_height\n\n    switch (gantt.config.baselines.render_mode) {\n      case \"taskRow\":\n        task.row_height = task.bar_height + 4;\n        break;\n\n      case \"separateRow\":\n        height = gantt.getLayoutView(\"timeline\").getBarHeight(task.id);\n        if (baselineAmount) {\n          task.bar_height = task.bar_height || height;\n\n          if (task.bar_height > height){\n            height = task.bar_height;\n          }\n\n          task.row_height = height + subrowHeight;\n        } else if (task.bar_height) {\n          task.row_height = task.bar_height + 4;\n        }\n\n        _increaseSplitParentHeight(task);\n        break;\n\n      case \"individualRow\":\n        height = gantt.getLayoutView(\"timeline\").getBarHeight(task.id);\n\n        if (baselineAmount) {\n          task.bar_height = task.bar_height || height;\n\n          if (task.bar_height > height){\n            height = task.bar_height;\n          }\n\n          baselineSize = subrowHeight * baselineAmount;\n       //   betweenBaselines = 3 * (baselineAmount + 1);\n\n          task.row_height = height + baselineSize + margins;\n        } else if (task.bar_height){\n          task.row_height = task.bar_height + 4;\n        }\n\n        _increaseSplitParentHeight(task);\n    }\n  };\n\n  function _increaseSplitParentHeight(task) {\n    gantt.eachParent(function (parent) {\n      if (isSplitParent(parent)) {\n        const parentHeight = parent.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(parent.id);\n        let maxHeight = task.row_height;\n\n        // iterate only direct children\n        const subtasks = gantt.getChildren(parent.id);\n        subtasks.forEach(function (subtaskId) {\n          const subtask = gantt.getTask(subtaskId);\n          if (subtask.id == task.id) {\n            return;\n          }\n          const subtaskHeight = subtask.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(subtask.id);\n          maxHeight = maxHeight || subtaskHeight;\n          if (subtaskHeight > maxHeight) {\n            maxHeight = subtaskHeight;\n          }\n        });\n\n        parent.row_height = maxHeight;\n        parent.bar_height = parent.bar_height || parentHeight;\n      }\n    }, task.id);\n  }\n\n  gantt.attachEvent(\n    \"onGanttReady\",\n    function () {\n\n      if(gantt.config.baselines === false){\n        return;\n      }\n\n      gantt.attachEvent(\"onParse\", function () {\n        baselineStore.eachItem(function (baseline) {\n          const taskId = baseline.task_id;\n          if (gantt.isTaskExists(taskId)) {\n            const task = gantt.getTask(taskId);\n\n            task.baselines = task.baselines || [];\n\n            let newBaseline = true;\n            for (let i = 0; i < task.baselines.length; i++) {\n              let existingBaseline = task.baselines[i];\n              if (existingBaseline.id == baseline.id){\n                newBaseline = false;\n                gantt.mixin(existingBaseline, baseline, true);\n                break;\n              }\n            }\n            if (newBaseline){\n              task.baselines.push(baseline);\n            }\n\n            if (isSplitParent(task)){\n              _adjustSplitParentHeight (task);\n            } else {\n              gantt.adjustTaskHeightForBaselines(task);\n            }\n          }\n        });\n      });\n\n      gantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\n        _syncBaselines(task);\n        return true;\n      });\n\n      gantt.attachEvent(\"onAfterUndo\", function(action){\n        const baselinesRenderedBelow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\n        if (baselinesRenderedBelow && action){\n          let repaint = false;\n          action.commands.forEach(function(command){\n            if (command.entity == \"task\"){\n              const taskId = command.value.id;\n              if (gantt.isTaskExists(taskId)){\n                const task = gantt.getTask(taskId);\n                if (task.parent && gantt.isTaskExists(task.parent)){\n                  const parent = gantt.getTask(task.parent);\n                  if (isSplitParent(parent)){\n                    _adjustSplitParentHeight (parent);\n                    repaint = true;\n                  }\n                }\n              }    \n            }\n          });\n          if (repaint){\n            gantt.render();\n          }\n        }\n      });\n\n      gantt.attachEvent(\"onAfterTaskDelete\", function (id, task) {\n        if (hasBaselinesBelow){\n          if (task.parent && gantt.isTaskExists(task.parent)){\n            const parent = gantt.getTask(task.parent);\n            if (isSplitParent(parent)){\n              _adjustSplitParentHeight (parent);\n            }\n          }\n        }\n        _deleteOrphanBaselines();\n      });\n\n      gantt.getTaskBaselines = function (taskId) {\n        const baselines = [];\n        baselineStore.eachItem(function (baseline) {\n          if (baseline.task_id == taskId) {\n            baselines.push(baseline);\n          }\n        });\n        return baselines;\n      };\n      gantt.$data.baselineStore.attachEvent(\"onClearAll\", function () {\n        gantt.eachTask(function(task){\n          if (task.baselines){\n            delete task.baselines;\n          }\n        });\n        // The data should not be repainted as otherwise it causes issues when we have resource \n        // assignments and group tasks. It should be fixed when we add a repaint stack\n        // gantt.refreshData();\n        return true;\n      });\n\n      gantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n        baselineStore.clearAll();\n        return true;\n      });\n      gantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n        const baselines = baselineStore.find(function (a) {\n          return a.task_id == id;\n        });\n        baselines.forEach(function (a) {\n          a.task_id = new_id;\n          baselineStore.updateItem(a.id);\n        });\n      });\n    },\n    { once: true }\n  );\n};\n","import * as helpers from \"../../utils/helpers\";\n\nexport default function(gantt) {\n\tgantt.load = function(){\n\t\tthrow new Error(\"gantt.load() method is not available in the node.js, use gantt.parse() instead\");\n\t};\n\tgantt.parse = function (data, type) {\n\t\tthis.on_load({xmlDoc: {responseText: data}}, type);\n\t};\n\n\tgantt.serialize = function (type) {\n\t\ttype = type || \"json\";\n\t\treturn this[type].serialize();\n\t};\n\n\t/*\n\ttasks and relations\n\t{\n\tdata:[\n\t\t{\n\t\t\t\"id\":\"string\",\n\t\t\t\"text\":\"...\",\n\t\t\t\"start_date\":\"Date or string\",\n\t\t\t\"end_date\":\"Date or string\",\n\t\t\t\"duration\":\"number\",\n\t\t\t\"progress\":\"0..1\",\n\t\t\t\"parent_id\":\"string\",\n\t\t\t\"order\":\"number\"\n\t\t},...],\n\tlinks:[\n\t\t{\n\t\t\tid:\"string\",\n\t\t\tsource:\"string\",\n\t\t\ttarget:\"string\",\n\t\t\ttype:\"string\"\n\t\t},...],\n\tcollections:{\n\t\t\tcollectionName:[\n\t\t\t\t{key:, label:, optional:...},...\n\t\t\t],...\n\t\t}\n\t}\n\n\t* */\n\n\tgantt.on_load = function (resp, type) {\n\t\tif(resp.xmlDoc && resp.xmlDoc.status === 404){ // work if we don't have a file at current url\n\t\t\tthis.assert(false, \"Failed to load the data from <a href='\" + resp.xmlDoc.responseURL + \"' target='_blank'>\" \n\t\t\t\t+ resp.xmlDoc.responseURL + \"</a>, server returns 404\");\n\t\t\treturn;\n\t\t}\n\t\tif(gantt.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\tthis.callEvent(\"onBeforeParse\", []);\n\t\tif (!type)\n\t\t\ttype = \"json\";\n\t\tthis.assert(this[type], \"Invalid data type:'\" + type + \"'\");\n\n\t\tvar raw = resp.xmlDoc.responseText;\n\n\t\tvar data = this[type].parse(raw, resp);\n\t\tthis._process_loading(data);\n\t};\n\n\tfunction attachAssignmentsToTasks(tasks, assignments) {\n\t\tconst assignmentsByTasks = {};\n\t\tassignments.forEach((a)=>{\n\t\t\tif(!assignmentsByTasks[a.task_id]) {\n\t\t\t\tassignmentsByTasks[a.task_id] = [];\n\t\t\t}\n\t\t\tassignmentsByTasks[a.task_id].push(a);\n\t\t});\n\t\ttasks.forEach((t) => {\n\t\t\tt[gantt.config.resource_property] = assignmentsByTasks[t.id] || [];\n\t\t});\t\n\t}\n\t\n\tgantt._process_loading = function (data) {\n\t\tif(data.collections)\n\t\t\tthis._load_collections(data.collections);\n\n\t\tif(data.resources && this.$data.resourcesStore){\n\t\t\tthis.$data.resourcesStore.parse(data.resources);\n\t\t}\n\t\tif(gantt.config.baselines !== false && data.baselines && this.$data.baselineStore){\n\t\t\tthis.$data.baselineStore.parse(data.baselines);\n\t\t}\n\t\t\n\t\tconst tasks = data.data || data.tasks;\n\t\tif(data.assignments){\n\t\t\tattachAssignmentsToTasks(tasks, data.assignments);\n\t\t}\n\n\t\tthis.$data.tasksStore.parse(tasks);\n\t\tvar links = data.links || (data.collections ? data.collections.links : []);\n\t\tthis.$data.linksStore.parse(links);\n\n\t\t//this._sync_links();\n\t\tthis.callEvent(\"onParse\", []);\n\t\tthis.render();\n\t};\n\n\tgantt._load_collections = function (collections) {\n\t\tvar collections_loaded = false;\n\t\tfor (var key in collections) {\n\t\t\tif (collections.hasOwnProperty(key)) {\n\t\t\t\tcollections_loaded = true;\n\t\t\t\tvar collection = collections[key];\n\t\t\t\t// GS-1728. Create an empty serverList if it doesn't exist\n\t\t\t\tthis.serverList[key] = this.serverList[key] || [];\n\t\t\t\tvar arr = this.serverList[key];\n\t\t\t\tif (!arr) continue;\n\t\t\t\tarr.splice(0, arr.length); //clear old options\n\t\t\t\tfor (var j = 0; j < collection.length; j++) {\n\t\t\t\t\tvar option = collection[j];\n\t\t\t\t\tvar obj = this.copy(option);\n\t\t\t\t\tobj.key = obj.value;// resulting option object\n\n\t\t\t\t\tfor (var option_key in option) {\n\t\t\t\t\t\tif (option.hasOwnProperty(option_key)) {\n\t\t\t\t\t\t\tif (option_key == \"value\" || option_key == \"label\")\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\tobj[option_key] = option[option_key]; // obj['value'] = option['value']\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (collections_loaded)\n\t\t\tthis.callEvent(\"onOptionsLoad\", []);\n\t};\n\n\tgantt.attachEvent(\"onBeforeTaskDisplay\", function (id, task) {\n\t\treturn !task.$ignore;\n\t});\n\n\tfunction jsonParseError(data){\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An object or a JSON string of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#json is expected. Actual argument value: \"\n\t\t\t+ JSON.stringify(data));\n\t}\n\n\tgantt.json = {\n\t\tparse: function (data) {\n\t\t\tif(!data){\n\t\t\t\tjsonParseError(data);\n\t\t\t}\n\n\t\t\tif (typeof data == \"string\") {\n\t\t\t\tif (typeof JSON != undefined){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\tjsonParseError(data);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tgantt.assert(false, \"JSON is not supported\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!data.data && !data.tasks){\n\t\t\t\tjsonParseError(data);\n\t\t\t}\n\n\t\t\tif (data.dhx_security)\n\t\t\t\tgantt.security_key = data.dhx_security;\n\t\t\treturn data;\n\t\t},\n\t\tserializeTask: function (task) {\n\t\t\treturn this._copyObject(task);\n\t\t},\n\t\tserializeLink: function (link) {\n\t\t\treturn this._copyLink(link);\n\t\t},\n\t\t_copyLink: function (obj) {\n\t\t\tvar copy = {};\n\t\t\tfor (var key in obj)\n\t\t\t\tcopy[key] = obj[key];\n\t\t\treturn copy;\n\t\t},\n\t\t_copyObject: function (obj) {\n\t\t\tvar copy = {};\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (key.charAt(0) == \"$\")\n\t\t\t\t\tcontinue;\n\t\t\t\tcopy[key] = obj[key];\n\n\t\t\t\tif (helpers.isDate(copy[key])) {\n\t\t\t\t\tcopy[key] = gantt.defined(gantt.templates.xml_format) ? gantt.templates.xml_format(copy[key]) : gantt.templates.format_date(copy[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn copy;\n\t\t},\n\t\tserialize: function () {\n\t\t\tvar tasks = [];\n\t\t\tvar links = [];\n\t\t\tlet baselines = [];\n\n\t\t\tgantt.eachTask(function (obj) {\n\t\t\t\tgantt.resetProjectDates(obj);\n\t\t\t\ttasks.push(this.serializeTask(obj));\n\t\t\t}, gantt.config.root_id, this);\n\n\t\t\tvar rawLinks = gantt.getLinks();\n\t\t\tfor (var i = 0; i < rawLinks.length; i++) {\n\t\t\t\tlinks.push(this.serializeLink(rawLinks[i]));\n\t\t\t}\n\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\n\t\t\tbaselineStore.eachItem(function(baseline){\n\t\t\t\tconst baselineCopy = gantt.json.serializeTask(baseline);\n\t\t\t\tbaselines.push(baselineCopy);\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\tdata: tasks,\n\t\t\t\tlinks,\n\t\t\t\tbaselines\n\t\t\t};\n\t\t}\n\t};\n\n\t/*\n\t<data>\n\t\t<task id:\"some\" parent_id=\"0\" progress=\"0.5\">\n\t\t\t<text>My task 1</text>\n\t\t\t<start_date>16.08.2013</start_date>\n\t\t\t<end_date>22.08.2013</end_date>\n\t\t</task>\n\t\t<coll_options>\n\t\t\t<links>\n\t\t\t\t<link source='a1' target='b2' type='c3' />\n\t\t\t</links>\n\t\t</coll_options>\n\t</data>\n\t*/\n\n\tfunction xmlParseError(data){\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An XML of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#xmldhtmlxgantt20 is expected. Actual argument value: \"\n\t\t\t+ JSON.stringify(data));\n\t}\n\n\tgantt.xml = {\n\t\t_xmlNodeToJSON: function (node, attrs_only) {\n\t\t\tvar t = {};\n\t\t\tfor (var i = 0; i < node.attributes.length; i++)\n\t\t\t\tt[node.attributes[i].name] = node.attributes[i].value;\n\n\t\t\tif (!attrs_only) {\n\t\t\t\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\t\t\t\tvar child = node.childNodes[i];\n\t\t\t\t\tif (child.nodeType == 1)\n\t\t\t\t\t\tt[child.tagName] = child.firstChild ? child.firstChild.nodeValue : \"\";\n\t\t\t\t}\n\n\t\t\t\tif (!t.text) t.text = node.firstChild ? node.firstChild.nodeValue : \"\";\n\t\t\t}\n\n\t\t\treturn t;\n\t\t},\n\t\t_getCollections: function (loader) {\n\t\t\tvar collection = {};\n\t\t\tvar opts = gantt.ajax.xpath(\"//coll_options\", loader);\n\t\t\tfor (var i = 0; i < opts.length; i++) {\n\t\t\t\tvar bind = opts[i].getAttribute(\"for\");\n\t\t\t\tvar arr = collection[bind] = [];\n\t\t\t\tvar itms = gantt.ajax.xpath(\".//item\", opts[i]);\n\t\t\t\tfor (var j = 0; j < itms.length; j++) {\n\t\t\t\t\tvar itm = itms[j];\n\t\t\t\t\tvar attrs = itm.attributes;\n\t\t\t\t\tvar obj = {key: itms[j].getAttribute(\"value\"), label: itms[j].getAttribute(\"label\")};\n\t\t\t\t\tfor (var k = 0; k < attrs.length; k++) {\n\t\t\t\t\t\tvar attr = attrs[k];\n\t\t\t\t\t\tif (attr.nodeName == \"value\" || attr.nodeName == \"label\")\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tobj[attr.nodeName] = attr.nodeValue;\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn collection;\n\t\t},\n\t\t_getXML: function (text, loader, toptag) {\n\t\t\ttoptag = toptag || \"data\";\n\t\t\tif (!loader.getXMLTopNode) {\n\t\t\t\tloader = gantt.ajax.parse(loader);\n\t\t\t}\n\n\t\t\tvar xml = gantt.ajax.xmltop(toptag, loader.xmlDoc);\n\t\t\tif (!xml || xml.tagName != toptag) {\n\t\t\t\txmlParseError(text);\n\t\t\t}\n\n\t\t\tvar skey = xml.getAttribute(\"dhx_security\");\n\t\t\tif (skey)\n\t\t\t\tgantt.security_key = skey;\n\n\t\t\treturn xml;\n\t\t},\n\t\tparse: function (text, loader) {\n\t\t\tloader = this._getXML(text, loader);\n\t\t\tvar data = {};\n\n\t\t\tvar evs = data.data = [];\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\n\n\t\t\tfor (var i = 0; i < xml.length; i++)\n\t\t\t\tevs[i] = this._xmlNodeToJSON(xml[i]);\n\n\t\t\tdata.collections = this._getCollections(loader);\n\t\t\treturn data;\n\t\t},\n\t\t_copyLink: function (obj) {\n\t\t\treturn \"<item id='\" + obj.id + \"' source='\" + obj.source + \"' target='\" + obj.target + \"' type='\" + obj.type + \"' />\";\n\t\t},\n\t\t_copyObject: function (obj) {\n\t\t\treturn \"<task id='\" + obj.id + \"' parent='\" + (obj.parent || \"\") + \"' start_date='\" + obj.start_date + \"' duration='\" + obj.duration + \"' open='\" + (!!obj.open) + \"' progress='\" + obj.progress + \"' end_date='\" + obj.end_date + \"'><![CDATA[\" + obj.text + \"]]></task>\";\n\t\t},\n\t\tserialize: function () {\n\t\t\tvar tasks = [];\n\t\t\tvar links = [];\n\n\t\t\tvar json = gantt.json.serialize();\n\t\t\tfor (var i = 0, len = json.data.length; i < len; i++) {\n\t\t\t\ttasks.push(this._copyObject(json.data[i]));\n\t\t\t}\n\t\t\tfor (var i = 0, len = json.links.length; i < len; i++) {\n\t\t\t\tlinks.push(this._copyLink(json.links[i]));\n\t\t\t}\n\t\t\treturn \"<data>\" + tasks.join(\"\") + \"<coll_options for='links'>\" + links.join(\"\") + \"</coll_options></data>\";\n\t\t}\n\t};\n\n\n\tgantt.oldxml = {\n\t\tparse: function (text, loader) {\n\t\t\tloader = gantt.xml._getXML(text, loader, \"projects\");\n\t\t\tvar data = {collections: {links: []}};\n\n\t\t\tvar evs = data.data = [];\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\n\n\t\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\t\tevs[i] = gantt.xml._xmlNodeToJSON(xml[i]);\n\t\t\t\tvar parent = xml[i].parentNode;\n\n\t\t\t\tif (parent.tagName == \"project\")\n\t\t\t\t\tevs[i].parent = \"project-\" + parent.getAttribute(\"id\");\n\t\t\t\telse\n\t\t\t\t\tevs[i].parent = parent.parentNode.getAttribute(\"id\");\n\t\t\t}\n\n\t\t\txml = gantt.ajax.xpath(\"//project\", loader);\n\t\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\t\tvar ev = gantt.xml._xmlNodeToJSON(xml[i], true);\n\t\t\t\tev.id = \"project-\" + ev.id;\n\t\t\t\tevs.push(ev);\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\tvar ev = evs[i];\n\t\t\t\tev.start_date = ev.startdate || ev.est;\n\t\t\t\tev.end_date = ev.enddate;\n\t\t\t\tev.text = ev.name;\n\t\t\t\tev.duration = ev.duration / 8;\n\t\t\t\tev.open = 1;\n\t\t\t\tif (!ev.duration && !ev.end_date) ev.duration = 1;\n\t\t\t\tif (ev.predecessortasks)\n\t\t\t\t\tdata.collections.links.push({\n\t\t\t\t\t\ttarget: ev.id,\n\t\t\t\t\t\tsource: ev.predecessortasks,\n\t\t\t\t\t\ttype: gantt.config.links.finish_to_start\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\t\tserialize: function () {\n\t\t\tgantt.message(\"Serialization to 'old XML' is not implemented\");\n\t\t}\n\t};\n\n\tgantt.serverList = function (name, array) {\n\t\tif (array) {\n\t\t\tthis.serverList[name] = array.slice(0);\n\t\t} else if (!this.serverList[name]) {\n\t\t\tthis.serverList[name] = [];\n\t\t}\n\t\treturn this.serverList[name];\n\t};\n\n};","import * as utils from \"../../utils/utils\";\nimport * as helpers from \"../../utils/helpers\";\n\n\nfunction IsWorkTimeArgument(date, unit, task, id, calendar){\n\tthis.date = date;\n\tthis.unit = unit;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction ClosestWorkTimeArgument(date, dir, unit, task, id, calendar){\n\tthis.date = date;\n\tthis.dir = dir;\n\tthis.unit = unit;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar){\n\tthis.start_date = start_date;\n\tthis.duration = duration;\n\tthis.unit = unit;\n\tthis.step = step;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction GetDurationArgument(start, end, task, calendar) {\n\tthis.start_date = start;\n\tthis.end_date = end;\n\tthis.task = task;\n\tthis.calendar = calendar;\n\tthis.unit = null;\n\tthis.step = null;\n\treturn this;\n}\n\nvar calendarArgumentsHelper = function(gantt){\n\treturn {\n\t\tgetWorkHoursArguments: function () {\n\t\t\tvar config = arguments[0];\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tconfig = {\n\t\t\t\t\tdate: config\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconfig = utils.mixin({}, config);\n\t\t\t}\n\n\t\t\tif(!helpers.isValidDate(config.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getWorkHours method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for getWorkHours method\");\n\t\t\t}\n\n\t\t\treturn config;\n\t\t},\n\t\tsetWorkTimeArguments: function () {\n\t\t\treturn arguments[0];\n\t\t},\n\t\tunsetWorkTimeArguments: function () {\n\t\t\treturn arguments[0];\n\t\t},\n\t\tisWorkTimeArguments: function () {\n\t\t\tvar config = arguments[0];\n\t\t\tif(config instanceof IsWorkTimeArgument){\n\t\t\t\treturn config;\n\t\t\t}\n\n\t\t\tvar processedConfig;\n\t\t\tif (!config.date) {\n\t\t\t\t//IsWorkTimeArgument(date, unit, task, id, calendar)\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(arguments[0], arguments[1], arguments[2], null, arguments[3]);\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(config.date, config.unit, config.task, null, config.calendar);\n\t\t\t}\n\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for isWorkTime method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for isWorkTime method\");\n\t\t\t}\n\n\t\t\treturn processedConfig;\n\t\t},\n\t\tgetClosestWorkTimeArguments: function (arg) {\n\t\t\tvar config = arguments[0];\n\t\t\tif (config instanceof ClosestWorkTimeArgument)\n\t\t\t\treturn config;\n\n\t\t\tvar processedConfig;\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(config);\n\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(\n\t\t\t\t\tconfig.date,\n\t\t\t\t\tconfig.dir,\n\t\t\t\t\tconfig.unit,\n\t\t\t\t\tconfig.task,\n\t\t\t\t\tnull,//config.id,\n\t\t\t\t\tconfig.calendar\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(config.id){\n\t\t\t\tprocessedConfig.task = config;\n\t\t\t}\n\t\t\tprocessedConfig.dir = config.dir || 'any';\n\t\t\tprocessedConfig.unit = config.unit || gantt.config.duration_unit;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getClosestWorkTime method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for getClosestWorkTime method\");\n\t\t\t}\n\t\t\treturn processedConfig;\n\t\t},\n\n\t\t_getStartEndConfig: function (param) {\n\t\t\tvar argumentType = GetDurationArgument;\n\t\t\tvar config;\n\t\t\tif (param instanceof argumentType)\n\t\t\t\treturn param;\n\n\t\t\tif (helpers.isDate(param)) {\n\t\t\t\tconfig = new argumentType(arguments[0], arguments[1], arguments[2], arguments[3]);\n\t\t\t} else {\n\t\t\t\tconfig = new argumentType(param.start_date, param.end_date, param.task);\n\t\t\t\tif (param.id !== null && param.id !== undefined) {\n\t\t\t\t\tconfig.task = param;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.unit = config.unit || gantt.config.duration_unit;\n\t\t\tconfig.step = config.step || gantt.config.duration_step;\n\t\t\tconfig.start_date = config.start_date || config.start || config.date;\n\n\t\t\tif(!helpers.isValidDate(config.start_date)){\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for getDuration method\");\n\t\t\t\tthrow new Error(\"Invalid start_date argument for getDuration method\");\n\t\t\t}\n\n\t\t\tif(!helpers.isValidDate(config.end_date)){\n\t\t\t\tgantt.assert(false, \"Invalid end_date argument for getDuration method\");\n\t\t\t\tthrow new Error(\"Invalid end_date argument for getDuration method\");\n\t\t\t}\n\n\t\t\treturn config;\n\t\t},\n\n\t\tgetDurationArguments: function (start, end, unit, step) {\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\n\t\t},\n\n\t\thasDurationArguments: function (start, end, unit, step) {\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\n\t\t},\n\n\t\tcalculateEndDateArguments: function (start, duration, unit, step) {\n\t\t\tvar config = arguments[0];\n\t\t\tif (config instanceof CalculateEndDateArgument)\n\t\t\t\treturn config;\n\n\t\t\tvar processedConfig;\n\t\t\t//CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar)\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\n\t\t\t\t\targuments[0],\n\t\t\t\t\targuments[1],\n\t\t\t\t\targuments[2],\n\t\t\t\t\tundefined,\n\t\t\t\t\targuments[3],\n\t\t\t\t\tundefined,\n\t\t\t\t\targuments[4]\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\n\t\t\t\t\tconfig.start_date,\n\t\t\t\t\tconfig.duration,\n\t\t\t\t\tconfig.unit,\n\t\t\t\t\tconfig.step,\n\t\t\t\t\tconfig.task,\n\t\t\t\t\tnull,//config.id,\n\t\t\t\t\tconfig.calendar\n\t\t\t\t);\n\t\t\t}\n\t\t\tif(config.id !== null && config.id !== undefined){\n\t\t\t\tprocessedConfig.task = config;\n\n\t\t\t\t// received a task object as an argument\n\t\t\t\t// ignore 'unit' and 'step' properties in this case, since it's likely a part of data model of a task\n\t\t\t\tprocessedConfig.unit = null;\n\t\t\t\tprocessedConfig.step = null;\n\t\t\t}\n\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\n\t\t\tprocessedConfig.step = processedConfig.step || gantt.config.duration_step;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.start_date)){\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for calculateEndDate method\");\n\t\t\t\tthrow new Error(\"Invalid start_date argument for calculateEndDate method\");\n\t\t\t}\n\n\t\t\treturn processedConfig;\n\t\t}\n\t};\n};\n\n\nexport default calendarArgumentsHelper;","import * as utils from \"../../../utils/utils\";\nfunction WorkTimeCalendarMerger(){\n}\n\nWorkTimeCalendarMerger.prototype = {\n\n\n\t/**\n\t * convert hours array items into objects, e.g. [8, 12, 17, 18] -> [{start: 8, end: 12}, {start:17, end:18}]\n\t * @param {Array} hoursArray\n\t */\n\t_getIntervals: function(hoursArray){\n\t\tvar result = [];\n\t\tfor(var i = 0; i < hoursArray.length; i += 2){\n\n\t\t\tresult.push({\n\t\t\t\tstart: hoursArray[i],\n\t\t\t\tend: hoursArray[i+1]\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Convert ranges config into hours array\n\t * [{start: 8, end: 12}, {start:17, end:18}] --> [8, 12, 17, 18]\n\t * @param {*} intervalsArray\n\t */\n\t_toHoursArray: function(intervalsArray){\n\t\tvar result = [];\n\n\t\tfunction toFixed(value){\n\t\t\tvar str = String(value);\n\t\t\tif(str.length < 2){\n\t\t\t\tstr = \"0\" + str;\n\t\t\t}\n\t\t\treturn str;\n\t\t}\n\t\tfunction formatHHMM(secondsValue){\n\t\t\tvar hours = Math.floor(secondsValue / (60*60));\n\t\t\tvar minutePart = secondsValue - hours * 60 * 60;\n\n\t\t\tvar minutes = Math.floor(minutePart / (60));\n\t\t\treturn hours + \":\" + toFixed(minutes);\n\t\t}\n\t\tfor(var i = 0; i < intervalsArray.length; i++){\n\t\t\tresult.push(\n\t\t\t\tformatHHMM(intervalsArray[i].start) +\n\t\t\t\t\"-\" +\n\t\t\t\tformatHHMM(intervalsArray[i].end)\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Build intersection of hour intervals. e.g.\n\t * first: [{start: 8, end: 12}, {start:13, end:18}]\n\t * second: [{start: 10, end: 15}]\n\t * result: [{start: 10, end: 12}, {start: 13, end: 15}]\n\t * @param {Array} first\n\t * @param {Array} second\n\t */\n\t_intersectHourRanges: function(first, second){\n\t\tvar result = [];\n\n\t\tvar baseArray = first.length > second.length ? first : second;\n\t\tvar overridesArray = first === baseArray ? second: first;\n\t\tbaseArray = baseArray.slice();\n\t\toverridesArray = overridesArray.slice();\n\n\t\tvar result = [];\n\t\tfor(var i = 0; i < baseArray.length; i++){\n\t\t\tvar base = baseArray[i];\n\n\t\t\tfor(var j = 0; j < overridesArray.length; j++){\n\t\t\t\tvar current = overridesArray[j];\n\t\t\t\tif(current.start < base.end && current.end > base.start){\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\tstart: Math.max(base.start, current.start),\n\t\t\t\t\t\tend: Math.min(base.end, current.end)\n\t\t\t\t\t});\n\t\t\t\t\tif(base.end > current.end){\n\t\t\t\t\t\toverridesArray.splice(j, 1);\n\t\t\t\t\t\tj--;\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Reduce the number of ranges in config when possible,\n\t * joins ranges that can be merged\n\t * parts: [{start: 8, end: 12}, {start:12, end:13}, {start: 15, end: 17}]\n\t * result: [{start: 8, end: 13}, {start: 15, end: 17}]\n\t * @param {Array} parts\n\t */\n\t_mergeAdjacentIntervals: function(parts){\n\t\tvar result = parts.slice();\n\t\tresult.sort(function(a, b){\n\t\t\treturn a.start - b.start;\n\t\t});\n\t\tvar base = result[0];\n\t\tfor(var i = 1; i < result.length; i++){\n\t\t\tvar current = result[i];\n\t\t\tif(current.start <= base.end){\n\t\t\t\tif(current.end > base.end){\n\t\t\t\t\tbase.end = current.end;\n\t\t\t\t}\n\t\t\t\tresult.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\tbase = current;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t_mergeHoursConfig: function(firstHours, secondHours){\n\t\t//var firstIntervals = this._getIntervals(firstHours);\n\t\t//var secondIntervals = this._getIntervals(secondHours);\n\n\t\treturn this._mergeAdjacentIntervals(\n\t\t\tthis._intersectHourRanges(firstHours, secondHours)\n\t\t);\n\t},\n\n\tmerge: function(first, second){\n\t\tvar firstConfig = utils.copy(first.getConfig().parsed);\n\n\t\tvar secondConfig = utils.copy(second.getConfig().parsed);\n\n\t\tvar mergedSettings = {\n\t\t\thours: this._toHoursArray(this._mergeHoursConfig(firstConfig.hours, secondConfig.hours)),\n\t\t\tdates: {},\n\t\t\tcustomWeeks: {}\n\t\t};\n\n\t\tconst processCalendar = (config1, config2) => {\n\t\t\tfor (let i in config1.dates) {\n\t\t\t\tconst date1 = config1.dates[i];\n\t\n\t\t\t\t// dates contain day-of-week rules [0-7] and rules for specific dates (js date timestamps) - set false date rules initially\n\t\t\t\tif (+i > 1000) {\n\t\t\t\t\tmergedSettings.dates[i] = false;\n\t\t\t\t}\n\t\t\t\t// Check if the key exists in the fisrt calendar object\n\t\t\t\tfor (const key in config2.dates) {\n\t\t\t\t\tconst date2 = config2.dates[key];\n\t\n\t\t\t\t\t// Logical AND for week days\n\t\t\t\t\tif (key == i) {\n\t\t\t\t\t\tmergedSettings.dates[i] = !!(date1 && date2);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Handle case where dates are arrays\n\t\t\t\t\tif (Array.isArray(date1)) {\n\t\t\t\t\t\tconst hours2 = Array.isArray(date2) ? date2 : config2.hours;\n\t\t\t\t\t\tmergedSettings.dates[i] = this._toHoursArray(this._mergeHoursConfig(date1, hours2));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t// Check both calendars\n\t\tprocessCalendar(firstConfig, secondConfig);\n\t\tprocessCalendar(secondConfig, firstConfig);\n\n\t\t// transfer and overwrite custom week calendars\n\t\tif(firstConfig.customWeeks){\n\t\t\tfor(var i in firstConfig.customWeeks){\n\t\t\t\tmergedSettings.customWeeks[i] = firstConfig.customWeeks[i];\n\t\t\t}\n\t\t}\n\t\tif(secondConfig.customWeeks){\n\t\t\tfor(var i in secondConfig.customWeeks){\n\t\t\t\tmergedSettings.customWeeks[i] = secondConfig.customWeeks[i];\n\t\t\t}\n\t\t}\n\n\t\treturn mergedSettings;\n\n\t}\n\n};\n\nexport default WorkTimeCalendarMerger;","\n\nimport { IWorkUnitCache } from \"./workunit_cache_interface\";\n\nexport class WorkUnitsMapCache implements IWorkUnitCache {\n\tprivate _cache: Map<string, Array<Map<string, boolean>>>;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\n\t\tif (this._cache.has(unit)) {\n\t\t\tconst unitCache = this._cache.get(unit);\n\n\t\t\tconst subCache = unitCache[value.getFullYear()];\n\t\t\tif (subCache && subCache.has(timestamp)) {\n\t\t\t\treturn subCache.get(timestamp);\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\n\t\tif (!unit || !timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cache = this._cache;\n\t\tconst year = rawValue.getFullYear();\n\n\t\tlet unitCache;\n\t\tif (!cache.has(unit)) {\n\t\t\tunitCache = [];\n\t\t\tcache.set(unit, unitCache);\n\t\t} else {\n\t\t\tunitCache = cache.get(unit);\n\t\t}\n\n\t\tlet yearCache = unitCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = unitCache[year] = new Map<string, boolean>();\n\t\t}\n\n\n\t\tyearCache.set(timestamp, value);\n\t}\n\tclear(): void{\n\t\tthis._cache = new Map<string, Array<Map<string, boolean>>>();\n\t}\n}","import { IWorkUnitCache } from \"./workunit_cache_interface\";\n\nexport class WorkUnitsObjectCache implements IWorkUnitCache {\n\tprivate _cache: any;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\n\t\tconst cache = this._cache;\n\t\tif (cache && cache[unit]) {\n\t\t\tconst units = cache[unit];\n\t\t\tif(units === undefined){\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tconst subCache = units[value.getFullYear()];\n\t\t\tif (subCache && subCache[timestamp] !== undefined) {\n\t\t\t\treturn subCache[timestamp];\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\n\t\tif (!unit || !timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cache = this._cache;\n\n\t\tif (!cache) {\n\t\t\treturn;\n\t\t}\n\t\tif (!cache[unit]) {\n\t\t\tcache[unit] = [];\n\t\t}\n\t\tconst unitCache = cache[unit];\n\n\t\tconst year = rawValue.getFullYear();\n\t\tlet yearCache = unitCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = unitCache[year] = {};\n\t\t}\n\t\tyearCache[timestamp] = value;\n\t}\n\tclear(): void{\n\t\tthis._cache = {};\n\t}\n}","\n\nexport class LargerUnitsCache {\n\tprivate _weekCache: Map<number, number>;\n\tprivate _monthCache: Map<number, number>;\n\tprivate _calendar: any;\n\tconstructor(calendar) {\n\t\tthis.clear();\n\t\tthis._calendar = calendar;\n\t}\n\n\tgetMinutesPerWeek = (weekStart: Date) => {\n\t\tconst key = weekStart.valueOf();\n\n\t\tif(this._weekCache.has(key)){\n\t\t\treturn this._weekCache.get(key);\n\t\t}\n\n\t\tconst calendar = this._calendar;\n\t\tconst gantt = this._calendar.$gantt;\n\n\t\tlet minutesPerWeek = 0;\n\t\tlet start = gantt.date.week_start(new Date(weekStart));\n\t\tfor(let i = 0; i < 7; i++){\n\t\t\tminutesPerWeek += calendar.getHoursPerDay(start) * 60;\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\n\t\t}\n\n\t\tthis._weekCache.set(key, minutesPerWeek);\n\t\treturn minutesPerWeek;\n\t};\n\n\tgetMinutesPerMonth = (monthStart: Date) => {\n\t\tconst key = monthStart.valueOf();\n\n\t\tif(this._monthCache.has(key)){\n\t\t\treturn this._monthCache.get(key);\n\t\t}\n\n\t\tconst calendar = this._calendar;\n\t\tconst gantt = this._calendar.$gantt;\n\n\t\tlet minutesPerMonth = 0;\n\t\tlet start = gantt.date.week_start(new Date(monthStart));\n\t\tconst nextMonth = gantt.date.add(start, 1, \"month\").valueOf();\n\t\twhile(start.valueOf() < nextMonth){\n\t\t\tminutesPerMonth += calendar.getHoursPerDay(start) * 60;\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\n\t\t}\n\n\t\tthis._monthCache.set(key, minutesPerMonth);\n\t\treturn minutesPerMonth;\n\t};\n\n\tclear = (): void => {\n\t\tthis._weekCache = new Map<number, number>();\n\t\tthis._monthCache = new Map<number, number>();\n\t};\n}","export class DateDurationCache  {\n\tprivate _cache: any;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\t_getCacheObject(startDate: Date, unit: string, step:number){\n\t\tconst cache = this._cache;\n\t\tif (!cache[unit]) {\n\t\t\tcache[unit] = [];\n\t\t}\n\t\tlet unitCache = cache[unit];\n\t\tif(!unitCache) {\n\t\t\tunitCache = cache[unit] = {};\n\t\t}\n\n\t\tlet stepCache = unitCache[step];\n\t\tif(!stepCache) {\n\t\t\tstepCache = unitCache[step] = {};\n\t\t}\n\n\t\tconst year = startDate.getFullYear();\n\t\tlet yearCache = stepCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = stepCache[year] = {durations: {}, endDates: {}};\n\t\t}\n\n\t\treturn yearCache;\n\t}\n\t_endDateCacheKey(startDate: number, duration: number){\n\t\treturn String(startDate) + \"-\" + String(duration);\n\t}\n\t_durationCacheKey(startDate: number, endDate: number){\n\t\treturn String(startDate) + \"-\" + String(endDate);\n\t}\n\tgetEndDate(startDate: Date, duration: number, unit: string, step: number, compute: () => Date): number|null{\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\n\n\t\tconst startDateTimestamp = startDate.valueOf();\n\t\tconst key = this._endDateCacheKey(startDateTimestamp, duration);\n\t\tlet endDate;\n\t\tif(cache.endDates[key] === undefined){\n\t\t\tconst result = compute();\n\t\t\tconst resultTimestamp = result.valueOf();\n\t\t\tcache.endDates[key] = resultTimestamp;\n\t\t\tcache.durations[this._durationCacheKey(startDateTimestamp, resultTimestamp)] = duration;\n\t\t\tendDate = result;\n\t\t}else{\n\t\t\tendDate = new Date(cache.endDates[key]);\n\t\t}\n\n\t\treturn endDate;\n\t}\n\n\tgetDuration(startDate: Date, endDate: Date, unit: string, step: number, compute: () => number): number|null{\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\n\n\t\tconst startDateTimestamp = startDate.valueOf();\n\t\tconst endDateTimestamp = endDate.valueOf();\n\t\tconst key = this._durationCacheKey(startDateTimestamp, endDateTimestamp);\n\t\tlet duration;\n\t\tif(cache.durations[key] === undefined){\n\t\t\tconst result = compute();\n\t\t\tcache.durations[key] = result.valueOf();\n\n\t\t\t// can't populate end date due to logic of end date calculation, current unit tests capture it\n\t\t\t// cache.endDates[this._endDateCacheKey(startDateTimestamp, result)] = endDateTimestamp;\n\t\t\tduration = result;\n\t\t}else{\n\t\t\tduration = cache.durations[key];\n\t\t}\n\n\t\treturn duration;\n\t}\n\n\tclear(): void{\n\t\tthis._cache = {};\n\t}\n}","import {createCacheObject} from \"./work_unit_cache\";\nimport {LargerUnitsCache} from \"./work_unit_cache\";\nimport * as utils from \"../../../utils/utils\";\nimport {DateDurationCache} from \"./work_unit_cache/date_duration_cache\";\n\nfunction CalendarWorkTimeStrategy(gantt, argumentsHelper) {\n\tthis.argumentsHelper = argumentsHelper;\n\tthis.$gantt = gantt;\n\tthis._workingUnitsCache = createCacheObject();\n\tthis._largeUnitsCache = new LargerUnitsCache(this);\n\tthis._dateDurationCache = new DateDurationCache();\n\tthis._worktime = null;\n\tthis._cached_timestamps = {};\n\tthis._cached_timestamps_count = 0;\n}\n\nCalendarWorkTimeStrategy.prototype = {\n\tunits: [\n\t\t\"year\",\n\t\t\"month\",\n\t\t\"week\",\n\t\t\"day\",\n\t\t\"hour\",\n\t\t\"minute\"\n\t],\n\t_clearCaches: function(){\n\t\tthis._workingUnitsCache.clear();\n\t\tthis._largeUnitsCache.clear();\n\t\tthis._dateDurationCache.clear();\n\t},\n\t// cache previously calculated worktime\n\t_getUnitOrder: function (unit) {\n\t\tfor (var i = 0, len = this.units.length; i < len; i++) {\n\t\t\tif (this.units[i] == unit)\n\t\t\t\treturn i;\n\t\t}\n\t},\n\t_resetTimestampCache: function(){\n\t\tthis._cached_timestamps = {};\n\t\tthis._cached_timestamps_count = 0;\n\t},\n\t_timestamp: function (settings) {\n\t\t// minor optimization, store calculated timestamps to reduce computations\n\t\t// reset cache when number of keys exceeds large number where key lookup may became more expensive than the recalculation\n\t\tif(this._cached_timestamps_count > 1000000){\n\t\t\tthis._resetTimestampCache();\n\t\t}\n\n\t\tvar timestamp = null;\n\t\tif ((settings.day || settings.day === 0)) {\n\t\t\ttimestamp = settings.day;\n\t\t} else if (settings.date) {\n\t\t\tvar value = String(settings.date.valueOf());\n\t\t\tif(this._cached_timestamps[value]){\n\t\t\t\ttimestamp = this._cached_timestamps[value];\n\t\t\t}else{\n\t\t\t\t// store worktime datestamp in utc so it could be recognized in different timezones (e.g. opened locally and sent to the export service in different timezone)\n\t\t\t\ttimestamp = Date.UTC(settings.date.getFullYear(), settings.date.getMonth(), settings.date.getDate());\n\t\t\t\tthis._cached_timestamps[value] = timestamp;\n\t\t\t\tthis._cached_timestamps_count++;\n\t\t\t}\n\n\t\t}\n\t\treturn timestamp;\n\t},\n\t_checkIfWorkingUnit: function (date, unit) {\n\t\t// GS-596: If unit is larger than day or has a custom logic\n\t\tif (!this[\"_is_work_\" + unit]) {\n\t\t\tconst from = this.$gantt.date[`${unit}_start`](new Date(date));\n\t\t\tconst to = this.$gantt.date.add(from, 1, unit);\n\t\t\treturn this.hasDuration(from, to);\n\t\t}\n\t\treturn this[\"_is_work_\" + unit](date);\n\t},\n\t//checkings for particular time units\n\t//methods for month-year-week can be defined, otherwise always return 'true'\n\t_is_work_day: function (date) {\n\t\tvar val = this._getWorkHours(date);\n\n\t\tif (Array.isArray(val)) {\n\t\t\treturn val.length > 0;\n\t\t}\n\t\treturn false;\n\t},\n\t_is_work_hour: function (date) {\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\n\t\tvar value = date.getHours();\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif(value >= hours[i].startHour && value < hours[i].endHour){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_getTimeOfDayStamp: function(date, dayEnd) {\n\t\tvar hours = date.getHours();\n\t\tif(!date.getHours() && !date.getMinutes() && dayEnd){\n\t\t\thours = 24;\n\t\t}\n\t\treturn hours * 60 * 60 + date.getMinutes() * 60;\n\t},\n\n\t_is_work_minute: function(date){\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\n\t\tvar checkTime = this._getTimeOfDayStamp(date);\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif(checkTime >= hours[i].start && checkTime < hours[i].end){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_nextDate: function (start, unit, step) {\n\t\treturn this.$gantt.date.add(start, step, unit);\n\t},\n\t_getWorkUnitsBetweenGeneric: function (from, to, unit, step) {\n\t\tvar dateHelper = this.$gantt.date;\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\t\tvar units = 0;\n\n\n\t\tvar next = null;\n\t\tvar stepStart,\n\t\t\tstepEnd;\n\n\t\t// calculating decimal durations, i.e. 2016-09-20 00:05:00 - 2016-09-20 01:00:00 ~ 0.95 instead of 1\n\t\t// and also  2016-09-20 00:00:00 - 2016-09-20 00:05:00 ~ 0.05 instead of 1\n\t\t// durations must be rounded later\n\t\tvar checkFirst = false;\n\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\n\t\tif (stepStart.valueOf() != start.valueOf()) {\n\t\t\tcheckFirst = true;\n\t\t}\n\t\tvar checkLast = false;\n\t\tstepEnd = dateHelper[unit + \"_start\"](new Date(to));\n\t\tif (stepEnd.valueOf() != to.valueOf()) {\n\t\t\tcheckLast = true;\n\t\t}\n\n\t\tvar isLastStep = false;\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tnext = this._nextDate(start, unit, step);\n\t\t\tisLastStep = (next.valueOf() > end.valueOf());\n\n\t\t\tif (this._isWorkTime(start, unit)) {\n\t\t\t\tif (checkFirst || (checkLast && isLastStep)) {\n\t\t\t\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\n\t\t\t\t\tstepEnd = dateHelper.add(stepStart, step, unit);\n\t\t\t\t}\n\n\t\t\t\tif (checkFirst) {\n\t\t\t\t\tcheckFirst = false;\n\t\t\t\t\tnext = this._nextDate(stepStart, unit, step);\n\t\t\t\t\tunits += ((stepEnd.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\n\t\t\t\t} else if (checkLast && isLastStep) {\n\t\t\t\t\tcheckLast = false;\n\t\t\t\t\tunits += ((end.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\n\n\t\t\t\t} else {\n\t\t\t\t\tunits++;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar unitOrder = this._getUnitOrder(unit);\n\t\t\t\tvar biggerTimeUnit = this.units[unitOrder - 1];\n\t\t\t\tif(biggerTimeUnit && !this._isWorkTime(start, biggerTimeUnit)){\n\t\t\t\t\tnext = this._getClosestWorkTimeFuture(start, biggerTimeUnit);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstart = next;\n\t\t}\n\t\treturn units;\n\t},\n\n\t_getMinutesPerHour: function (date) {\n\t\tvar hourStart = this._getTimeOfDayStamp(date);\n\t\tvar hourEnd = this._getTimeOfDayStamp(this._nextDate(date, \"hour\", 1));\n\t\tif (hourEnd === 0){\n\t\t\thourEnd = 24 * 60 * 60;\n\t\t}\n\t\tvar worktimes = this._getWorkHours(date);\n\n\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(hourStart >= interval.start && hourEnd <= interval.end){\n\t\t\t\treturn 60;// hour inside a working interval, all hour is a work hour\n\t\t\t}else if(hourStart < interval.end && hourEnd > interval.start){\n\t\t\t\t// hour is partially work time\n\t\t\t\tvar duration = Math.min(hourEnd, interval.end) - Math.max(hourStart, interval.start);\n\t\t\t\treturn duration / 60;\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t},\n\n\t_getMinutesPerDay: function (date) {\n\t\tvar hours = this._getWorkHours(date);\n\t\tvar res = 0;\n\t\thours.forEach(function(interval){\n\t\t\tres+= interval.durationMinutes;\n\t\t});\n\t\treturn res;\n\t},\n\tgetHoursPerDay: function (date) {\n\t\tvar hours = this._getWorkHours(date);\n\t\tvar res = 0;\n\t\thours.forEach(function(interval){\n\t\t\tres+= interval.durationHours;\n\t\t});\n\t\treturn res;\n\t},\n\t_getWorkUnitsForRange: function (from, to, unit, step) {\n\t\tvar total = 0;\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\n\t\tvar getUnitsPerDay;\n\t\tif (unit == \"minute\") {\n\t\t\tgetUnitsPerDay = utils.bind(this._getMinutesPerDay, this);\n\t\t} else {\n\t\t\tgetUnitsPerDay = utils.bind(this.getHoursPerDay, this);\n\t\t}\n\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tif(end - start > 1000*60*60*24*32 && start.getDate() === 0) {\n\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerMonth(start);\n\t\t\t\tif(unit == \"hour\"){\n\t\t\t\t\tunits = units / 60;\n\t\t\t\t}\n\t\t\t\ttotal += units;\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"month\");\n\t\t\t\tcontinue;\n\t\t\t}else if(end - start > 1000*60*60*24*16) {\n\t\t\t\tvar weekStart = this.$gantt.date.week_start(new Date(start));\n\t\t\t\tif(start.valueOf() === weekStart.valueOf()){\n\t\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerWeek(start);\n\t\t\t\t\tif(unit == \"hour\"){\n\t\t\t\t\t\tunits = units / 60;\n\t\t\t\t\t}\n\t\t\t\t\ttotal += units;\n\t\t\t\t\tstart = this.$gantt.date.add(start, 7, \"day\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t//\tif (this._isWorkTime(start, \"day\")) {\n\t\t\ttotal += getUnitsPerDay(start);\n\t\t//\t}\n\t\t\tstart = this._nextDate(start, \"day\", 1);\n\t\t}\n\n\t\treturn total / step;\n\t},\n\n\n\t_getMinutesBetweenSingleDay: function(from, to){\n\t\tvar range = this._getIntervalTimestamp(from, to);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tvar result = 0;\n\n\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\n\t\t\t\tresult += (minuteTo - minuteFrom) / 60;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\treturn Math.floor(result);\n\t},\n\n\t_getMinutesBetween: function(from, to, unit, step){\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\tvar firstDayStart = new Date(start);\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\n\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\n\t\t\treturn this._getMinutesBetweenSingleDay(from, to);\n\t\t} else {\n\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\n\t\t\tvar lastDayEnd = end;\n\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd);\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd);\n\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\n\t\t\tvar total = startPart + rangePart + endPart;\n\n\t\t\treturn total;\n\t\t}\n\t},\n\t// optimized method for calculating work units duration of large time spans\n\t// implemented for hours and minutes units, bigger time units don't benefit from the optimization so much\n\t_getHoursBetween: function (from, to, unit, step) {\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\tvar firstDayStart = new Date(start);\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\n\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\n\t\t\treturn Math.round(this._getMinutesBetweenSingleDay(from, to) / 60);\n\t\t} else {\n\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\n\t\t\tvar lastDayEnd = end;\n\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd, unit, step) / 60;\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd, unit, step) / 60;\n\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\n\t\t\tvar total = startPart + rangePart + endPart;\n\n\t\t\treturn Math.round(total);\n\t\t}\n\t},\n\n\tgetConfig: function () {\n\t\treturn this._worktime;\n\t},\n\t_setConfig: function (settings) {\n\t\tthis._worktime = settings;\n\t\tthis._parseSettings();\n\t\tthis._clearCaches();\n\t},\n\t_parseSettings: function() {\n\t\tvar settings = this.getConfig();\n\t\tsettings.parsed = {\n\t\t\tdates: {},\n\t\t\thours: null,\n\t\t\thaveCustomWeeks: false,\n\t\t\tcustomWeeks: {},\n\t\t\tcustomWeeksRangeStart: null,\n\t\t\tcustomWeeksRangeEnd: null,\n\t\t\tcustomWeeksBoundaries: []\n\t\t};\n\n\t\tsettings.parsed.hours = this._parseHours(settings.hours);\n\t\tfor(var i in settings.dates){\n\t\t\tsettings.parsed.dates[i] = this._parseHours(settings.dates[i]);\n\t\t}\n\n\t\tif(settings.customWeeks) {\n\t\t\tvar minCustomRangeStart = null;\n\t\t\tvar maxCustomRangeEnd = null;\n\t\t\tfor(var i in settings.customWeeks){\n\t\t\t\tvar customTime = settings.customWeeks[i];\n\n\t\t\t\tif(customTime.from && customTime.to){\n\t\t\t\t\tvar rangeStart = customTime.from;\n\t\t\t\t\tvar rangeEnd = customTime.to;\n\t\t\t\t\tif(!minCustomRangeStart || minCustomRangeStart > rangeStart.valueOf()){\n\t\t\t\t\t\tminCustomRangeStart = rangeStart.valueOf();\n\t\t\t\t\t}\n\t\t\t\t\tif(!maxCustomRangeEnd || maxCustomRangeEnd < rangeEnd.valueOf()){\n\t\t\t\t\t\tmaxCustomRangeEnd = rangeEnd.valueOf();\n\t\t\t\t\t}\n\n\t\t\t\t\tsettings.parsed.customWeeksBoundaries.push({\n\t\t\t\t\t\tfrom: rangeStart.valueOf(),\n\t\t\t\t\t\tfromReadable: new Date(rangeStart),\n\t\t\t\t\t\tto: rangeEnd.valueOf(),\n\t\t\t\t\t\ttoReadable: new Date(rangeEnd),\n\t\t\t\t\t\tname: i\n\t\t\t\t\t});\n\n\t\t\t\t\tsettings.parsed.haveCustomWeeks = true;\n\t\t\t\t\tvar currentWeek = settings.parsed.customWeeks[i] = {\n\t\t\t\t\t\tfrom: customTime.from,\n\t\t\t\t\t\tto: customTime.to,\n\t\t\t\t\t\thours: this._parseHours(customTime.hours),\n\t\t\t\t\t\tdates: {}\n\t\t\t\t\t};\n\n\t\t\t\t\tfor(var d in customTime.dates){\n\t\t\t\t\t\tcurrentWeek.dates[d] = this._parseHours(customTime.dates[d]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsettings.parsed.customWeeksRangeStart = minCustomRangeStart;\n\t\t\tsettings.parsed.customWeeksRangeEnd = maxCustomRangeEnd;\n\n\t\t}\n\t},\n\n\t_tryChangeCalendarSettings: function (payload) {\n\t\tvar backup = JSON.stringify(this.getConfig());\n\t\tpayload();\n\t\tif (!this.hasWorkTime()) {\n\t\t//\tthis.$gantt.assert(false, \"Invalid calendar settings, no worktime available\");\n\t\t\tthis._setConfig(JSON.parse(backup));\n\t\t\tthis._clearCaches();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\n\t},\n\n\t_arraysEqual: function(a, b){\n\t\tif (a === b) return true;\n\t\tif (!a || !b) return false;\n\t\tif (a.length != b.length) return false;\n\n\t\tfor (var i = 0; i < a.length; ++i) {\n\t\t\tif (a[i] !== b[i]) return false;\n\t\t}\n\t\treturn true;\n\t},\n\n\n\t_compareSettings: function (mySettings, thatSettings) {\n\t\tif (!this._arraysEqual(mySettings.hours, thatSettings.hours)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar myDays = Object.keys(mySettings.dates);\n\t\tvar otherDates = Object.keys(thatSettings.dates);\n\t\tmyDays.sort();\n\t\totherDates.sort();\n\n\t\tif (!this._arraysEqual(myDays, otherDates)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor(var i = 0; i < myDays.length; i++){\n\t\t\tvar timestamp = myDays[i];\n\t\t\tvar myHours = mySettings.dates[timestamp];\n\t\t\tvar otherHours = mySettings.dates[timestamp];\n\n\t\t\t// day settings not equal\n\t\t\tif(myHours !== otherHours &&\n\t\t\t\t// but still can be two arrays with the equivalent hour settings\n\t\t\t\t!(Array.isArray(myHours) && Array.isArray(otherHours) && this._arraysEqual(myHours, otherHours))\n\t\t\t\t){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tequals: function (calendar) {\n\t\tif(!(calendar instanceof CalendarWorkTimeStrategy)){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar mySettings = this.getConfig();\n\t\tvar thatSettings = calendar.getConfig();\n\n\t\tif(!this._compareSettings(mySettings, thatSettings)){\n\t\t\treturn false;\n\t\t}\n\n\t\tif(mySettings.parsed.haveCustomWeeks && thatSettings.parsed.haveCustomWeeks){\n\t\t\tif(mySettings.parsed.customWeeksBoundaries.length != thatSettings.parsed.customWeeksBoundaries.length){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor(var i in mySettings.parsed.customWeeks){\n\t\t\t\tvar myWeek = mySettings.parsed.customWeeks[i];\n\t\t\t\tvar thatWeek = thatSettings.parsed.customWeeks[i];\n\t\t\t\tif(!thatWeek){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif(!this._compareSettings(myWeek, thatWeek)){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}else if(mySettings.parse.haveCustomWeeks !== thatSettings.parsed.haveCustomWeeks){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tgetWorkHours: function () {\n\t\tvar config = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n\t\treturn this._getWorkHours(config.date, false);\n\t},\n\t_getWorkHours: function (date, parsed) {\n\t\tvar calendar = this.getConfig();\n\t\tif(parsed !== false){\n\t\t\tcalendar = calendar.parsed;\n\t\t}\n\n\t\tif(!date){\n\t\t\treturn calendar.hours;\n\t\t}\n\n\t\tvar dateValue = this._timestamp({date: date});\n\n\t\tif(calendar.haveCustomWeeks){\n\t\t\tif(calendar.customWeeksRangeStart <= dateValue && calendar.customWeeksRangeEnd > dateValue){\n\t\t\t\tfor(var i = 0; i < calendar.customWeeksBoundaries.length; i++){\n\t\t\t\t\tif(calendar.customWeeksBoundaries[i].from <= dateValue && calendar.customWeeksBoundaries[i].to > dateValue){\n\t\t\t\t\t\tcalendar = calendar.customWeeks[calendar.customWeeksBoundaries[i].name];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar hours = true;\n\n\t\tif (calendar.dates[dateValue] !== undefined) {\n\t\t\thours = calendar.dates[dateValue];//custom day\n\t\t} else if (calendar.dates[date.getDay()] !== undefined) {\n\t\t\thours = calendar.dates[date.getDay()];//week day\n\t\t}\n\t\tif (hours === true) {\n\t\t\treturn calendar.hours;\n\t\t} else if (hours) {\n\t\t\treturn hours;\n\t\t}\n\t\treturn [];\n\t},\n\n\t_getIntervalTimestamp: function(from, to){\n\t\tvar res = {\n\t\t\tstart: 0,\n\t\t\tend: 0\n\t\t};\n\n\t\tres.start = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\n\t\tvar endHours = to.getHours();\n\t\tif(!endHours && !to.getMinutes() && !to.getSeconds() && from.valueOf() < to.valueOf()){\n\t\t\tendHours = 24;\n\t\t}\n\t\tres.end = endHours * 60 * 60 + to.getMinutes() * 60 + to.getSeconds();\n\t\treturn res;\n\t},\n\n\t_parseHours: function(hours) {\n\t\tif(Array.isArray(hours)){\n\n\t\t\tvar timestampRanges = [];// worktime as seconds range\n\t\t\thours.forEach(function(hour){\n\t\t\t\tif(typeof hour === \"number\"){\n\t\t\t\t\ttimestampRanges.push(hour*60*60);\n\t\t\t\t}else if(typeof hour === \"string\") {\n\t\t\t\t\t// \"12-13\", or \"12:00-13:00\", or \"12:00:00-13:00:00\"\n\t\t\t\t\thour.split(\"-\").map(function(time){\n\t\t\t\t\t\treturn time.trim();\n\t\t\t\t\t}).forEach(function(part){\n\t\t\t\t\t\tvar parsed = part.split(\":\").map(function(time){\n\t\t\t\t\t\t\treturn time.trim();\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tvar value = parseInt(parsed[0]*60*60);\n\t\t\t\t\t\tif(parsed[1]){\n\t\t\t\t\t\t\tvalue += parseInt(parsed[1]*60);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(parsed[2]){\n\t\t\t\t\t\t\tvalue += parseInt(parsed[2]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttimestampRanges.push(value);\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar timerangeConfig = [];\n\t\t\tfor (var i = 0; i < timestampRanges.length; i += 2) {\n\t\t\t\tvar start = timestampRanges[i];\n\t\t\t\tvar end = timestampRanges[i + 1];\n\t\t\t\tvar duration = end - start;\n\n\t\t\t\ttimerangeConfig.push({\n\t\t\t\t\tstart: start,\n\t\t\t\t\tend: end,\n\t\t\t\t\tstartHour: Math.floor(start / (60*60)),\n\t\t\t\t\tstartMinute: Math.floor(start / (60)),\n\t\t\t\t\tendHour: Math.ceil(end / (60*60)),\n\t\t\t\t\tendMinute: Math.ceil(end / (60)),\n\t\t\t\t\tdurationSeconds: duration,\n\t\t\t\t\tdurationMinutes: duration/60,\n\t\t\t\t\tdurationHours: duration/(60 * 60)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn timerangeConfig;\n\t\t} else {\n\t\t\treturn hours;\n\t\t}\n\t},\n\n\tsetWorkTime: function (settings) {\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\n\t\t\tvar hours = settings.hours !== undefined ? settings.hours : true;\n\t\t\tvar timestamp = this._timestamp(settings);\n\t\t\tvar calendarConfig = this.getConfig();\n\t\t\tif (timestamp !== null) {\n\t\t\t\tcalendarConfig.dates[timestamp] = hours;\n\t\t\t} else if(!settings.customWeeks) {\n\t\t\t\tcalendarConfig.hours = hours;\n\t\t\t}\n\n\t\t\tif(settings.customWeeks){\n\t\t\t\tif(!calendarConfig.customWeeks){\n\t\t\t\t\tcalendarConfig.customWeeks = {};\n\t\t\t\t}\n\t\t\t\t// GS-1867. allow setWorkTime to exclude dates in the customWeeks range\n\t\t\t\tif (typeof settings.customWeeks == \"string\"){\n\t\t\t\t\tif (timestamp !== null) {\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].dates[timestamp] = hours;\n\t\t\t\t\t} else if(!settings.customWeeks) {\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].hours = hours;\n\t\t\t\t\t}\t\t\n\t\t\t\t} else if (typeof settings.customWeeks === \"object\"\n\t\t\t\t&& Function.prototype.toString.call(settings.customWeeks.constructor) === \"function Object() { [native code] }\"){\n\t\t\t\t\tfor(var i in settings.customWeeks){\n\t\t\t\t\t\tcalendarConfig.customWeeks[i] = settings.customWeeks[i];\n\t\t\t\t\t}\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._parseSettings();\n\t\t\tthis._clearCaches();\n\t\t}, this));\n\t},\n\n\tunsetWorkTime: function (settings) {\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\n\t\t\tif (!settings) {\n\t\t\t\tthis.reset_calendar();\n\t\t\t} else {\n\n\t\t\t\tvar timestamp = this._timestamp(settings);\n\n\t\t\t\tif (timestamp !== null) {\n\t\t\t\t\tdelete this.getConfig().dates[timestamp];\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Load updated settings and clear work units cache\n\t\t\tthis._parseSettings();\n\t\t\tthis._clearCaches();\n\t\t}, this));\n\t},\n\n\t_isWorkTime: function (date, unit) {\n\t\t// Check if this item has in the cache\n\n\t\tvar useCache = true;//unit === \"day\"; // use cache only for days. In case of hours/minutes cache size grows too large and the overhead exceeds the gains\n\t\tvar isWorkUnit = -1;\n\t\tvar dateKey = null;\n\n\t\tif(useCache){\n\t\t\t// use string keys\n\t\t\tdateKey = String(date.valueOf());\n\t\t\tisWorkUnit = this._workingUnitsCache.getItem(unit, dateKey, date);\n\t\t}\n\n\t\tif (isWorkUnit == -1) {\n\t\t\t// calculate if not cached\n\t\t\tisWorkUnit = this._checkIfWorkingUnit(date, unit);\n\t\t\tif(useCache){\n\t\t\t\tthis._workingUnitsCache.setItem(unit, dateKey, isWorkUnit, date);\n\t\t\t}\n\t\t}\n\n\t\treturn isWorkUnit;\n\t},\n\n\tisWorkTime: function () {\n\t\tvar config =  this.argumentsHelper.isWorkTimeArguments.apply( this.argumentsHelper, arguments);\n\t\treturn this._isWorkTime(config.date, config.unit);\n\t},\n\n\tcalculateDuration: function () {\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\n\n\t\tif (!config.unit) {\n\t\t\treturn false;\n\t\t}\n\t\t//return this._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\n\n\t\tvar self = this;\n\t\treturn this._dateDurationCache.getDuration(config.start_date, config.end_date, config.unit, config.step, function(){ \n\t\t\treturn self._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\n\t\t});\n\t},\n\n\t_calculateDuration: function (from, to, unit, step) {\n\t\tvar res = 0;\n\n\t\tvar sign = 1;\n\t\tif(from.valueOf() > to.valueOf()){\n\t\t\tvar tmp = to;\n\t\t\tto = from;\n\t\t\tfrom = tmp;\n\t\t\tsign = -1;\n\t\t}\n\n\t\tif (unit == \"hour\" && step == 1) {\n\t\t\tres = this._getHoursBetween(from, to, unit, step);\n\t\t} else if(unit == \"minute\" && step == 1){\n\t\t\t// quick calculation for minutes with 1 minute step\n\t\t\tres = this._getMinutesBetween(from, to, unit, step);\n\t\t} else {\n\t\t\tres = this._getWorkUnitsBetweenGeneric(from, to, unit, step);\n\t\t}\n\n\t\t// getWorkUnits.. returns decimal durations\n\t\treturn sign * Math.round(res);\n\t},\n\thasDuration: function () {\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\n\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\tif (!unit) {\n\t\t\treturn false;\n\t\t}\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tif (this._isWorkTime(start, unit))\n\t\t\t\treturn true;\n\t\t\tstart = this._nextDate(start, unit, step);\n\t\t}\n\t\treturn false;\n\t},\n\n\tcalculateEndDate: function () {\n\t\tvar config =  this.argumentsHelper.calculateEndDateArguments.apply( this.argumentsHelper, arguments);\n\n\t\tvar from = config.start_date,\n\t\t\tduration = config.duration,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\tif (!unit)\n\t\t\treturn false;\n\n\t\tvar mult = (config.duration >= 0) ? 1 : -1;\n\t\tduration = Math.abs(duration * 1);\n\t//\tvar endDate = this._calculateEndDate(from, duration, unit, step * mult);\n\t//\treturn endDate;\n\t\tvar self = this;\n\t\treturn this._dateDurationCache.getEndDate(from, duration, unit, step * mult, function(){ \n\t\t\treturn self._calculateEndDate(from, duration, unit, step * mult);\n\t\t} );\n\t},\n\n\t_calculateEndDate: function (from, duration, unit, step) {\n\t\tif (!unit)\n\t\t\treturn false;\n\n\t\tif (step == 1 && unit == \"minute\") {\n\t\t\treturn this._calculateMinuteEndDate(from, duration, step);\n\t\t} else if(step == -1 && unit == \"minute\") {\n\t\t\treturn this._subtractMinuteDate(from, duration, step);\n\t\t} else if (step == 1 && unit == \"hour\") {\n\t\t\treturn this._calculateHourEndDate(from, duration, step);\n\t\t} else {\n\t\t\tvar interval = this._addInterval(from, duration, unit, step, null);\n\t\t\treturn interval.end;\n\t\t}\n\t},\n\n\t_addInterval: function (start, duration, unit, step, stopAction) {\n\t\tvar added = 0;\n\t\tvar current = start;\n\t\tvar dstShift = false;\n\n\t\twhile (added < duration && !(stopAction && stopAction(current))) {\n\t\t\tvar next = this._nextDate(current, unit, step);\n\n\t\t\t// GS-1501. Correct hours after DST change\n\t\t\tif (unit == \"day\"){\n\t\t\t\tdstShift = dstShift || !current.getHours() && next.getHours();\n\n\t\t\t\tif (dstShift){\n\t\t\t\t\tnext.setHours(0);\n\t\t\t\t\tif (next.getHours()){\n\t\t\t\t\t// the day when the timezone is changed, try to correct hours next time\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdstShift = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar dateValue = new Date(next.valueOf() + 1);\n\t\t\tif (step > 0) {\n\t\t\t\tdateValue = new Date(next.valueOf() - 1);\n\t\t\t}\n\t\t\tvar workTimeCheck = this._isWorkTime(dateValue, unit);\n\n\t\t\tif (workTimeCheck && !dstShift) {\n\t\t\t\tadded++;\n\t\t\t}\n\t\t\tcurrent = next;\n\t\t}\n\t\treturn {\n\t\t\tend: current,\n\t\t\tstart: start,\n\t\t\tadded: added\n\t\t};\n\t},\n\n\t_addHoursUntilDayEnd: function(from, duration) {\n\t\tvar dayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(from)), 1, \"day\");\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar range = this._getIntervalTimestamp(from, dayEnd);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\t\t\t\tvar rangeHours = (minuteTo - minuteFrom) / (60 * 60);\n\t\t\t\tif(rangeHours > left){\n\t\t\t\t\trangeHours = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60 * 60);\n\t\t\t\t}\n\n\t\t\t\tvar addHours = Math.round((minuteTo - minuteFrom) / (60 * 60));\n\t\t\t\tadded += addHours;\n\t\t\t\tleft -= addHours;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = dayEnd;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_calculateHourEndDate: function (from, duration,  step) {\n\t\tvar start = new Date(from),\n\t\tadded = 0;\n\t\tstep = step || 1;\n\t\tduration = Math.abs(duration * 1);\n\n\t\tvar interval = this._addHoursUntilDayEnd(start, duration);\n\t\tadded = interval.added;\n\t\tstart = interval.end;\n\n\t\tvar durationLeft = duration - added;\n\n\t\tif (durationLeft) {\n\t\t\tvar current = start;\n\t\t\twhile (added < duration) {\n\t\t\t\tvar next = this._nextDate(current, \"day\", step);\n\t\t\t\t// reset to day start in case DST switch happens in the process\n\t\t\t\tnext.setHours(0);\n\t\t\t\tnext.setMinutes(0);\n\t\t\t\tnext.setSeconds(0);\n\n\t\t\t\tvar hoursPerDay = 0;\n\t\t\t\tif(step > 0){\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() - 1));\n\t\t\t\t}else{\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() + 1));\n\t\t\t\t}\n\n\t\t\t\tif (added + hoursPerDay >= duration) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tadded += hoursPerDay;\n\t\t\t\t}\n\n\t\t\t\tcurrent = next;\n\t\t\t}\n\t\t\tstart = current;\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\tinterval = this._addHoursUntilDayEnd(start, durationLeft);\n\t\t\tstart = interval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\n\t_addMinutesUntilHourEnd: function(from, duration){\n\t\tif(from.getMinutes() === 0) {\n\t\t\t// already at hour end\n\t\t\treturn {\n\t\t\t\tadded: 0,\n\t\t\t\tend: new Date(from)\n\t\t\t};\n\t\t}\n\t\tvar hourEnd = this.$gantt.date.add(this.$gantt.date.hour_start(new Date(from)), 1, \"hour\");\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar range = this._getIntervalTimestamp(from, hourEnd);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\t\t\t\tvar rangeMinutes = (minuteTo - minuteFrom) / 60;\n\t\t\t\tif(rangeMinutes > left){\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\n\t\t\t\t}\n\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\n\t\t\t\t/*if (rangeMinutes === 0) {\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\n\t\t\t\t}*/\n\n\t\t\t\tvar addMinutes = Math.round((minuteTo - minuteFrom) / 60);\n\t\t\t\tleft -= addMinutes;\n\t\t\t\tadded += addMinutes;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = hourEnd;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_subtractMinutesUntilHourStart: function(from, duration){\n\t\tvar hourStart = this.$gantt.date.hour_start(new Date(from));\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar hourStartTimestamp = hourStart.getHours() * 60 * 60 + hourStart.getMinutes() * 60 + hourStart.getSeconds();\n\t\tvar initialDateTimestamp = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\n\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = worktimes.length - 1; i >= 0 && added < duration; i--){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(initialDateTimestamp > interval.start && hourStartTimestamp <= interval.end){\n\t\t\t\tvar minuteFrom = Math.min(initialDateTimestamp, interval.end);\n\t\t\t\tvar minuteTo = Math.max(hourStartTimestamp, interval.start);\n\n\t\t\t//\tvar minuteFrom = Math.max(interval.start, currentHour.start);\n\t\t\t//\tvar minuteTo = Math.min(interval.end, currentHour.end);\n\t\t\t\tvar rangeMinutes = (minuteFrom - minuteTo) / 60;\n\t\t\t\tif(rangeMinutes > left){\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\n\t\t\t\t}\n\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\n\t\t\t\t/*if (rangeMinutes === 0) {\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\n\t\t\t\t}*/\n\n\t\t\t\tvar addMinutes = Math.abs(Math.round((minuteFrom - minuteTo) / 60));\n\t\t\t\tleft -= addMinutes;\n\t\t\t\tadded += addMinutes;\n\t\t\t\tinitialDateTimestamp = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = hourStart;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, initialDateTimestamp);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_subtractMinuteDate: function (from, duration, step) {\n\t\tvar start = new Date(from),\n\t\t\tadded = 0;\n\t\tstep = step || -1;\n\t\tduration = Math.abs(duration * 1);\n\t\tduration = Math.round(duration);\n\n\t\tconst minutePrecision = this._isMinutePrecision(start);\n\n\t\tlet addedInterval = this._subtractMinutesUntilHourStart(start, duration);\n\t\tadded += addedInterval.added;\n\n\t\tstart = addedInterval.end;\n\n\t\tvar calculatedDay = 0;\n\t\tvar daySchedule = [];\n\t\tvar minutesInDay = 0;\n\n\t\twhile (added < duration) {\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start));\n\n\t\t\tvar iterateFromDayEnd = false;\n\t\t\tif(start.valueOf() === dayStart.valueOf()){\n\t\t\t\tdayStart = this.$gantt.date.add(dayStart, -1, \"day\");\n\t\t\t\titerateFromDayEnd = true;\n\t\t\t}\n\t\t\t//var dayStartTimestamp = this.$gantt.date.day_start(new Date(start)).valueOf();\n\t\t\tvar dayEnd = new Date(dayStart.getFullYear(), dayStart.getMonth(), dayStart.getDate(), 23, 59,59,999).valueOf();\n\n\t\t\tif(dayEnd !== calculatedDay){\n\t\t\t\tdaySchedule = this._getWorkHours(dayStart);\n\t\t\t\tminutesInDay = this._getMinutesPerDay(dayStart);\n\t\t\t\tcalculatedDay = dayEnd;\n\t\t\t}\n\n\t\t\tvar left = duration - added;\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start, iterateFromDayEnd);\n\n\t\t\tif(!daySchedule.length || !minutesInDay){\n\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(daySchedule[daySchedule.length - 1].end <= timestamp){\n\t\t\t\tif(left > minutesInDay){\n\t\t\t\t\tadded += minutesInDay;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar isWorkHour = false;\n\t\t\tvar workInterval = null;\n\t\t\tvar prevInterval = null;\n\t\t\tfor(var i = daySchedule.length - 1; i >= 0; i--){\n\t\t\t\tif(daySchedule[i].start < timestamp - 1 && daySchedule[i].end >= timestamp - 1){\n\t\t\t\t\tisWorkHour = true;\n\t\t\t\t\tworkInterval = daySchedule[i];\n\t\t\t\t\tprevInterval = daySchedule[i-1];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(isWorkHour){\n\n\t\t\t\t// we're at the end of worktime interval and subtracting more than the duration of the interval\n\t\t\t\t// -> subtract the duration of the interval and move to the start of the interval (we're moving from end)\n\t\t\t\tif(timestamp === workInterval.end && left >= workInterval.durationMinutes){\n\t\t\t\t\tadded += workInterval.durationMinutes;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -workInterval.durationMinutes, \"minute\");\n\t\t\t\t} // worktime is set in whole hours (no intervals like 9:15-10:00)\n\t\t\t\t// the amount we need to subtract lies inside the interval\n\t\t\t\telse if(!minutePrecision && left <= (timestamp/60 - workInterval.startMinute)){\n\t\t\t\t\tadded += left;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\n\t\t\t\t}else if (minutePrecision){\n\t\t\t\t\t// GS-2129. If the working time is set in minutes, we accumulate the working time in minutes from right to left\n\t\t\t\t\t\n\t\t\t\t\t// duration we need to subtract lies completely inside the work interval\n\t\t\t\t\tif(left <= (timestamp/60 - workInterval.startMinute)){\n\t\t\t\t\t\tadded += left;\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\n\t\t\t\t\t}else {\n\t\t\t\t\t\t// we need to go trough multiple work intervals to subtract needed time\n\t\t\t\t\t\tadded += (timestamp/60 - workInterval.startMinute);\n\t\t\t\t\t\tif(prevInterval){\n\t\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, prevInterval.end);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\n\t\t\t\t}else{\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\n\t\t\t\t\tif(minutesInHour <= left){\n\t\t\t\t\t\tadded += minutesInHour;\n\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\n\t\t\t\t\t}else{\n\t\t\t\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, left);\n\t\t\t\t\t\tadded += addedInterval.added;\n\t\t\t\t\t\tstart = addedInterval.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(start.getHours() === 0 && start.getMinutes() === 0 && start.getSeconds() === 0){\n\t\t\t\t\tvar prev = this._getClosestWorkTimePast(start, \"hour\");\n\t\t\t\t\tif(prev.valueOf() === start.valueOf()){\n\t\t\t\t\t\tvar prev = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\t\t\tvar times = this._getWorkHours(prev);\n\t\t\t\t\t\tif(times.length){\n\t\t\t\t\t\t\tvar lastInterval = times[times.length - 1];\n\t\t\t\t\t\t\tprev.setSeconds(lastInterval.durationSeconds);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstart = prev;\n\n\t\t\t\t} else{\n\t\t\t\t\tstart = this._getClosestWorkTimePast(new Date(start - 1), \"hour\");\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, durationLeft);\n\t\t\tadded += addedInterval.added;\n\t\t\tstart = addedInterval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\t_calculateMinuteEndDate: function (from, duration, step) {\n\t\tvar start = new Date(from),\n\t\t\tadded = 0;\n\t\tstep = step || 1;\n\t\tduration = Math.abs(duration * 1);\n\t\tduration = Math.round(duration);\n\n\t\tvar addedInterval = this._addMinutesUntilHourEnd(start, duration);\n\t\tadded += addedInterval.added;\n\n\t\tstart = addedInterval.end;\n\n\t\tvar calculatedDay = 0;\n\t\tvar daySchedule = [];\n\t\tvar minutesInDay = 0;\n\n\t\tvar minutePrecision = this._isMinutePrecision(start);\n\n\t\twhile (added < duration) {\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start)).valueOf();\n\t\t\tif(dayStart !== calculatedDay){\n\t\t\t\tdaySchedule = this._getWorkHours(start);\n\t\t\t\tminutesInDay = this._getMinutesPerDay(start);\n\t\t\t\tcalculatedDay = dayStart;\n\n\t\t\t}\n\n\t\t\tvar left = duration - added;\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start);\n\n\t\t\tif(!daySchedule.length || !minutesInDay){\n\t\t\t\tstart = this.$gantt.date.add(this.$gantt.date.day_start(start), 1, \"day\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(daySchedule[0].start >= timestamp){\n\t\t\t\tif(left >= minutesInDay){\n\t\t\t\t\tadded += minutesInDay;\n\t\t\t\t\tif (left == minutesInDay) {\n\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, daySchedule[daySchedule.length - 1].end);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\n\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar isWorkHour = false;\n\t\t\tvar workInterval = null;\n\t\t\tfor(var i = 0; i < daySchedule.length; i++){\n\t\t\t\tif(daySchedule[i].start <= timestamp && daySchedule[i].end > timestamp){\n\t\t\t\t\tisWorkHour = true;\n\t\t\t\t\tworkInterval = daySchedule[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(isWorkHour){\n\n\t\t\t\tif(timestamp === workInterval.start && left >= workInterval.durationMinutes){\n\t\t\t\t\tadded += workInterval.durationMinutes;\n\t\t\t\t\tstart = this.$gantt.date.add(start, workInterval.durationMinutes, \"minute\");\n\t\t\t\t}else if(left <= (workInterval.endMinute - timestamp/60)){\n\t\t\t\t\tadded += left;\n\t\t\t\t\tstart = this.$gantt.date.add(start, left, \"minute\");\n\t\t\t\t}else{\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\n\t\t\t\t\tif(minutesInHour <= left){\n\t\t\t\t\t\tadded += minutesInHour;\n\t\t\t\t\t\t// when the working time settings are set in minutes move to the next minutes\n\t\t\t\t\t\tif (minutePrecision) {\n\t\t\t\t\t\t\tstart = this.$gantt.date.add(start, minutesInHour, \"minute\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, left);\n\t\t\t\t\t\tadded += addedInterval.added;\n\t\t\t\t\t\tstart = addedInterval.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tstart = this._getClosestWorkTimeFuture(start, \"hour\");\n\t\t\t}\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, durationLeft);\n\t\t\tadded += addedInterval.added;\n\t\t\tstart = addedInterval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\n\tgetClosestWorkTime: function () {\n\t\tvar settings =  this.argumentsHelper.getClosestWorkTimeArguments.apply( this.argumentsHelper, arguments);\n\t\treturn this._getClosestWorkTime(settings.date, settings.unit, settings.dir);\n\t},\n\n\t_getClosestWorkTime: function (inputDate, unit, direction) {\n\t\tvar result = new Date(inputDate);\n\n\t\tif (this._isWorkTime(result, unit)) {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = this.$gantt.date[unit + '_start'](result);\n\n\t\tif (direction == 'any' || !direction) {\n\t\t\tvar closestFuture = this._getClosestWorkTimeFuture(result, unit);\n\t\t\tvar closestPast = this._getClosestWorkTimePast(result, unit);\n\t\t\tif (Math.abs(closestFuture - inputDate) <= Math.abs(inputDate - closestPast)) {\n\t\t\t\tresult = closestFuture;\n\t\t\t} else {\n\t\t\t\tresult = closestPast;\n\t\t\t}\n\t\t} else if (direction == \"past\") {\n\t\t\tresult = this._getClosestWorkTimePast(result, unit);\n\t\t} else {\n\t\t\tresult = this._getClosestWorkTimeFuture(result, unit);\n\t\t}\n\t\treturn result;\n\t},\n\n\t_getClosestWorkTimeFuture: function (date, unit) {\n\t\treturn this._getClosestWorkTimeGeneric(date, unit, 1);\n\t},\n\n\t_getClosestWorkTimePast: function (date, unit) {\n\t\tvar result = this._getClosestWorkTimeGeneric(date, unit, -1);\n\t\t// should return the end of the closest work interval\n\t\treturn this.$gantt.date.add(result, 1, unit);\n\t},\n\n\t_findClosestTimeInDay: function(date, direction, worktimes) {\n\t\tvar start = new Date(date);\n\t\tvar resultDate = null;\n\t\tvar fromDayEnd = false;\n\t\tif(!this._getWorkHours(start).length){\n\t\t\tstart = this._getClosestWorkTime(start, \"day\", direction < 0 ? \"past\" : \"future\");\n\t\t\tif(direction < 0){\n\t\t\t\tstart = new Date(start.valueOf() - 1);\n\t\t\t\tfromDayEnd = true;\n\t\t\t}\n\t\t\tworktimes = this._getWorkHours(start);\n\t\t}\n\n\t\tvar value = this._getTimeOfDayStamp(start);\n\t\tif(fromDayEnd){\n\t\t\tvalue = this._getTimeOfDayStamp(new Date(start.valueOf() + 1), fromDayEnd);\n\t\t}\n\t\tif(direction > 0){\n\t\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\t\tif(worktimes[i].start >= value){\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].start);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tfor(var i = worktimes.length - 1; i >= 0; i--){\n\t\t\t\tif(worktimes[i].end <= value){\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].end);\n\t\t\t\t\tbreak;\n\t\t\t\t}else if(worktimes[i].end > value && worktimes[i].start <= value) {\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, value);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn resultDate;\n\t},\n\t_getClosestWorkMinute: function(date, unit, direction) {\n\t\tvar start = new Date(date);\n\t\tvar worktimes = this._getWorkHours(start);\n\t\tvar resultDate = this._findClosestTimeInDay(start, direction, worktimes);\n\t\tif(!resultDate){\n\t\t\tstart = this.calculateEndDate(start, direction, \"day\");\n\t\t\tif(direction > 0){\n\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t}else{\n\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\n\t\t\t\tstart = new Date(start.valueOf() - 1);\n\t\t\t}\n\t\t\tworktimes = this._getWorkHours(start);\n\t\t\tresultDate = this._findClosestTimeInDay(start, direction, worktimes);\n\t\t}\n\t\tif(direction < 0){\n\t\t\t// getClosestWorkTimePast adds one time unit to the result date after this\n\t\t\tresultDate = this.$gantt.date.add(resultDate, -1, unit);\n\t\t}\n\t\treturn resultDate;\n\t},\n\n\t_getClosestWorkTimeGeneric: function (date, unit, increment) {\n\t\tif(unit === \"hour\" || unit === \"minute\"){\n\t\t\treturn this._getClosestWorkMinute(date, unit, increment);\n\t\t}\n\n\t\tvar unitOrder = this._getUnitOrder(unit),\n\t\t\tbiggerTimeUnit = this.units[unitOrder - 1];\n\n\t\tvar result = date;\n\n\t\t// be extra sure we won't fall into infinite loop, 3k seems big enough\n\t\tvar maximumLoop = 3000,\n\t\t\tcount = 0;\n\n\t\twhile (!this._isWorkTime(result, unit)) {\n\t\t\tif (biggerTimeUnit && !this._isWorkTime(result, biggerTimeUnit)) {\n\t\t\t\t// if we look for closest work hour and detect a week-end - first find the closest work day,\n\t\t\t\t// and continue iterations after that\n\t\t\t\tif (increment > 0) {\n\t\t\t\t\tresult = this._getClosestWorkTimeFuture(result, biggerTimeUnit);\n\t\t\t\t} else {\n\t\t\t\t\tresult = this._getClosestWorkTimePast(result, biggerTimeUnit);\n\t\t\t\t}\n\n\t\t\t\tif (this._isWorkTime(result, unit)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcount++;\n\t\t\tif (count > maximumLoop) {\n\t\t\t\tthis.$gantt.assert(false, \"Invalid working time check\");\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar tzOffset = result.getTimezoneOffset();\n\t\t\tresult = this.$gantt.date.add(result, increment, unit);\n\n\t\t\tresult = this.$gantt._correct_dst_change(result, tzOffset, increment, unit);\n\t\t\tif (this.$gantt.date[unit + '_start']) {\n\t\t\t\tresult = this.$gantt.date[unit + '_start'](result);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Check whether this calendar has working time. Calendar has working time only if there are regular working days of week\n\t *\n\t */\n\thasWorkTime: function () {\n\t\tvar worktime = this.getConfig();\n\t\tvar dates = worktime.dates;\n\n\t\tvar daysOfWeek = [0, 1, 2, 3, 4, 5, 6];\n\t\tvar exceptions = [];\n\t\tfor(var i in worktime.dates){\n\t\t\tif(Number(i) > 6){\n\t\t\t\texceptions.push(Number(i));\n\t\t\t}\n\t\t}\n\n\t\tvar hasRegularHours = this._checkWorkHours(worktime.hours);\n\n\t\tvar result = false;\n\t\tdaysOfWeek.forEach((function(day){\n\t\t\tif(result){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar dayConfig = dates[day];\n\t\t\tif(dayConfig === true){\n\t\t\t\t// workday uses global hours\n\t\t\t\tresult = hasRegularHours;\n\t\t\t}else if(Array.isArray(dayConfig)){\n\t\t\t\t// workday uses custom hours\n\t\t\t\tresult = this._checkWorkHours(dayConfig);\n\t\t\t}\n\t\t}).bind(this));\n\n\t\treturn result;\n\n\t},\n\n\t_checkWorkHours: function(hoursArray) {\n\t\tif (hoursArray.length === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tvar result = false;\n\t\tfor (var i = 0; i < hoursArray.length; i += 2) {\n\t\t\tif (hoursArray[i] !== hoursArray[i + 1]) {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t_isMinutePrecision: function (date) {\n\t\tlet minutePrecision = false;\n\t\tthis._getWorkHours(date).forEach(function(interval){\n\t\t\tif (interval.startMinute % 60 || interval.endMinute % 60){\n\t\t\t\tminutePrecision = true;\n\t\t\t}\n\t\t});\n\t\treturn minutePrecision;\n\t}\n};\n\nexport default CalendarWorkTimeStrategy;","import { IWorkUnitCache } from \"./workunit_cache_interface\";\nimport { WorkUnitsMapCache } from \"./workunit_map_cache\";\nimport { WorkUnitsObjectCache } from \"./workunit_object_cache\";\nexport { LargerUnitsCache } from \"./larger_units_helper\";\n\nexport function createCacheObject(): IWorkUnitCache {\n\n\t// worktime hash is on the hot path,\n\t// Map seems to work faster than plain array, use it whenever possible\n\tif (typeof Map !== \"undefined\") {\n\t\treturn new WorkUnitsMapCache();\n\t} else {\n\t\treturn new WorkUnitsObjectCache();\n\t}\n}\n","export default {\n\tisLegacyResourceCalendarFormat: function(resourceCalendarsProperty){\n\t\t// modern format:\n\t\t//gantt.config.resource_calendars = {\n\t\t//\tresourceId: calendarId,\n\t\t//\tresourceId: calendarId,\n\t\t//\tresourceId: calendarId\n\t\t//\t};\n\t\t\n\t\t// legacy format:\n\t\t// gantt.config.resource_calendars = {\n\t\t//\t\"resourceProperty\": {\n\t\t//\t\tresourceId: calendarId,\n\t\t//\t\tresourceId: calendarId,\n\t\t//\t\tresourceId: calendarId\n\t\t//\t\t}\n\t\t//\t};\n\n\t\tif(!resourceCalendarsProperty){\n\t\t\treturn false;\n\t\t}\n\t\tfor(var i in resourceCalendarsProperty){\n\t\t\tif(resourceCalendarsProperty[i] && typeof resourceCalendarsProperty[i] === \"object\"){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\tgetResourceProperty: function(config){\n\t\tvar resourceCalendarsConfig = config.resource_calendars;\n\t\tvar propertyName = config.resource_property;\n\t\tif(this.isLegacyResourceCalendarFormat(resourceCalendarsConfig)){\n\t\t\tfor(var i in config){\n\t\t\t\tpropertyName = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn propertyName;\n\t},\n\tgetCalendarIdFromLegacyConfig: function(task, config){\n\t\tif (config) {\n\t\t\tfor (var field in config) {\n\t\t\t\tvar resource = config[field];\n\t\t\t\tif (task[field]) {\n\t\t\t\t\tvar calendarId = resource[task[field]];\n\t\t\t\t\tif (calendarId) {\n\t\t\t\t\t\treturn calendarId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};","import * as utils from \"../../utils/utils\";\nimport createArgumentsHelper from \"./calendar_arguments_helper\";\nimport CalendarMergeHelper from \"./strategy/work_calendar_merger\";\nimport CalendarWorkTimeStrategy from \"./strategy/calendar_strategy\";\nimport legacyResourceCalendarConfig from \"./legacy_resource_config\";\nimport dynamicResourceCalendarsFactory from \"./dynamic_resource_calendars\";\n\nconst dynamicResourceCalendars = dynamicResourceCalendarsFactory();\n\nfunction CalendarManager (gantt){\n\tthis.$gantt = gantt;\n\tthis._calendars = {};\n\tthis._legacyConfig = undefined;\n\tthis.$gantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(this.$gantt.config.resource_calendars){\n\t\t\tthis._isLegacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(this.$gantt.config.resource_calendars);\n\t\t}\n\t}.bind(this));\n\n\tthis.$gantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tthis.createDefaultCalendars();\n\t}.bind(this));\n\tthis.$gantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tthis.createDefaultCalendars();\n\t}.bind(this));\n}\n\nCalendarManager.prototype = {\n\t_calendars: {},\n\t_convertWorkTimeSettings: function (settings) {\n\t\tvar days = settings.days;\n\t\tif (days && !settings.dates) {\n\t\t\tsettings.dates = settings.dates || {};\n\t\t\tfor (var i = 0; i < days.length; i++) {\n\t\t\t\tsettings.dates[i] = days[i];\n\t\t\t\tif (!(days[i] instanceof Array)) {\n\t\t\t\t\tsettings.dates[i] = !!days[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdelete settings.days;\n\t\treturn settings;\n\t},\n\tmergeCalendars: function(){\n\t\tvar calendars = [];\n\t\tvar args = arguments;\n\t\tif(Array.isArray(args[0])){\n\t\t\tcalendars = args[0].slice();\n\t\t}else{\n\t\t\tfor(var i = 0; i < arguments.length; i++){\n\t\t\t\tcalendars.push(arguments[i]);\n\t\t\t}\n\t\t}\n\n\t\tvar mergeHelper = new CalendarMergeHelper();\n\n\t\tvar result;\n\t\tcalendars.forEach(function(calendar){\n\t\t\tif(!result){\n\t\t\t\tresult = calendar;\n\t\t\t} else{\n\t\t\t\tresult = this._createCalendarFromConfig(mergeHelper.merge(result, calendar));\n\t\t\t}\n\n\t\t}.bind(this));\n\t\treturn this.createCalendar(result);\n\t},\n\n\t_createCalendarFromConfig: function(config){\n\t\tvar apiCore = new CalendarWorkTimeStrategy(this.$gantt, createArgumentsHelper(this.$gantt));\n\t\tapiCore.id = String(utils.uid());\n\n\t\tvar preparedConfig = this._convertWorkTimeSettings(config);\n\t\tif(preparedConfig.customWeeks){\n\t\t\tfor(var i in preparedConfig.customWeeks){\n\t\t\t\tpreparedConfig.customWeeks[i] = this._convertWorkTimeSettings(preparedConfig.customWeeks[i]);\n\t\t\t}\n\t\t}\n\t\tapiCore._setConfig(preparedConfig);\n\n\t\treturn apiCore;\n\t},\n\n\tcreateCalendar: function (parentCalendar) {\n\t\tvar settings;\n\n\t\tif (!parentCalendar) {\n\t\t\tparentCalendar = {};\n\t\t}\n\n\t\tif (parentCalendar.getConfig){\n\t\t\tsettings = utils.copy(parentCalendar.getConfig());\n\t\t} else if (parentCalendar.worktime) {\n\t\t\tsettings = utils.copy(parentCalendar.worktime);\n\t\t} else {\n\t\t\tsettings = utils.copy(parentCalendar);\n\t\t}\n\n\t\tvar defaults = utils.copy(this.defaults.fulltime.worktime);\n\t\tutils.mixin(settings, defaults);\n\n\t\treturn this._createCalendarFromConfig(settings);\n\t},\n\n\tgetCalendar: function (id) {\n\t\tid = id || \"global\";\n\t\tvar calendar = this._calendars[id];\n\t\tif(!calendar){\n\t\t\tthis.createDefaultCalendars();\n\t\t\tcalendar = this._calendars[id];\n\t\t}\n\n\t\treturn calendar;\n\t},\n\n\tgetCalendars: function () {\n\t\tvar res = [];\n\t\tfor (var i in this._calendars) {\n\t\t\tres.push(this.getCalendar(i));\n\t\t}\n\t\treturn res;\n\t},\n\n\t_getOwnCalendar: function(task){\n\t\tvar config = this.$gantt.config;\n\t\tif (task[config.calendar_property]) {\n\t\t\treturn this.getCalendar(task[config.calendar_property]);\n\t\t}\n\n\t\tif (config.resource_calendars) {\n\t\t\tvar calendar;\n\t\t\tvar calendarId;\n\t\t\tvar resourceProperty;\n\t\t\tif(this._legacyConfig === false){\n\t\t\t\tresourceProperty = config.resource_property;\n\t\t\t}else{\n\t\t\t\tresourceProperty = legacyResourceCalendarConfig.getResourceProperty(config);\n\t\t\t}\n\t\t\tif(Array.isArray(task[resourceProperty])){\n\t\t\t\t// if multiple resources are attached to the task - merge their calendars\n\t\t\t\tif(config.dynamic_resource_calendars){\n\t\t\t\t\tcalendarId = dynamicResourceCalendars.getCalendarIdFromMultipleResources(task[resourceProperty], this);\n\t\t\t\t} else {\n\t\t\t\t\tcalendar = this.getResourceCalendar(task[resourceProperty]);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(this._legacyConfig === undefined){\n\t\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\n\t\t\t\t}\n\n\t\t\t\tif(this._legacyConfig){\n\t\t\t\t\tvar calendarId = legacyResourceCalendarConfig.getCalendarIdFromLegacyConfig(task, config.resource_calendars);\n\t\t\t\t}else if(resourceProperty && task[resourceProperty] && config.resource_calendars[task[resourceProperty]]){\n\t\t\t\t\tvar calendar = this.getResourceCalendar(task[resourceProperty]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(calendarId){\n\t\t\t\tcalendar = this.getCalendar(calendarId);\n\t\t\t}\n\n\t\t\tif(calendar){\n\t\t\t\treturn calendar;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\n\t * Returns calendar assigned to the specified resource.\n\t * Returns the global calendar if no custom calendar is associated with the resource.\n\t * @param {(string|number|Object)} resource - resource object or resource id\n\t * @returns {object} Calendar object\n\t */\n\tgetResourceCalendar: function(resource) {\n\t\tif (resource === null || resource === undefined) {\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\tvar resourceId = null;\n\t\t// if task id is provided\n\t\tif((typeof resource === \"number\" || typeof resource === \"string\")){\n\t\t\tresourceId = resource;\n\t\t}else{\n\t\t\tresourceId = resource.id || resource.key;\n\t\t}\n\n\t\tvar config = this.$gantt.config;\n\t\tvar calendarsConfig = config.resource_calendars;\n\t\tvar calendarId = null;\n\n\t\t// GS-1714: if resource is specified through array\n\t\tif (Array.isArray(resource)){\n\t\t\tif (resource.length === 1){\n\t\t\t\tif (typeof resource[0] === 'object'){\n\t\t\t\t\tresourceId = resource[0].resource_id; // if resource: [\"resource_id: \"6\", value: \"4\", ...\"]\n\t\t\t\t} else {\n\t\t\t\t\tresourceId = resource[0]; // if resource: [1]\n\t\t\t\t}\n\t\t\t} \n\t\t}\n\t\t\n\t\tif (calendarsConfig) {\n\t\t\tif(this._legacyConfig === undefined){\n\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\n\t\t\t}\n\n\t\t\tif(this._legacyConfig){\n\t\t\t\tfor(var field in calendarsConfig){\n\t\t\t\t\tif(calendarsConfig[field][resourceId]){\n\t\t\t\t\t\tcalendarId = calendarsConfig[field][resourceId];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar calendarId = calendarsConfig[resourceId];\n\t\t\t}\n\n\t\t\tif(calendarId){\n\t\t\t\treturn this.getCalendar(calendarId);\n\t\t\t}\n\n\t\t}\n\t\treturn this.getCalendar();\n\t},\n\n\t/**\n\t * Returns the calendar assigned to a task.\n\t * - Returns a calendar assigned via task[gantt.config.calendar_property] if specified.\n\t * - Returns a calendar assigned to the task resource if specified.\n\t * - Returns the global calendar otherwise.\n\t * @param {(string|number|Object)} task - task object or task id\n\t * @returns {object} Calendar object\n\t */\n\tgetTaskCalendar: function (task) {\n\t\tvar gantt = this.$gantt;\n\t\tvar taskObject;\n\t\tif (task === null || task === undefined) {\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\t// if task id is provided\n\t\tif((typeof task === \"number\" || typeof task === \"string\") && gantt.isTaskExists(task)){\n\t\t\ttaskObject = gantt.getTask(task);\n\t\t}else{\n\t\t\ttaskObject = task;\n\t\t}\n\n\t\tif(!taskObject){\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\tvar calendar = this._getOwnCalendar(taskObject);\n\t\tvar groupMode = !!gantt.getState().group_mode;\n\n\t\tif (!calendar && gantt.config.inherit_calendar && gantt.isTaskExists(taskObject.parent)){\n\t\t\t// GS-1579  group mode overrides tree hierarchy, iterate using `.parent` property, instead of using eachParent iterator\n\t\t\tvar currentTask = taskObject;\n\t\t\twhile(gantt.isTaskExists(currentTask.parent)){\n\t\t\t\tcurrentTask = gantt.getTask(currentTask.parent);\n\t\t\t\tif(gantt.isSummaryTask(currentTask)){\n\t\t\t\t\tcalendar = this._getOwnCalendar(currentTask);\n\t\t\t\t\tif(calendar){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(groupMode && !calendar){\n\t\t\t\t// if group mode and inherit_calendars is enabled - preserve previously applied parent calendar\n\t\t\t\t// we may need it when groupBy parses grouped data, old parent may be not loaded yet\n\t\t\t\tif(task.$effective_calendar){\n\t\t\t\t\tcalendar = this.getCalendar(task.$effective_calendar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn calendar || this.getCalendar();\n\t},\n\n\taddCalendar: function(calendar) { // puts new calendar to Global Storage - gantt.calendarManager._calendars {}\n\t\tif (!(this.isCalendar(calendar))) {\n\t\t\tvar id = calendar.id;\n\t\t\tcalendar = this.createCalendar(calendar);\n\t\t\tcalendar.id = id;\n\t\t}\n\n\t\t// validate/check if empty calendar\n\t\tif (!calendar._tryChangeCalendarSettings(function () {\n\t\t\t})) {\n\n\t\t\tthis.$gantt.callEvent(\"onCalendarError\", [{message: \"Invalid calendar settings, no worktime available\"}, calendar]);\n\t\t\treturn null;\n\t\t} else {\n\t\t\tvar config = this.$gantt.config;\n\n\t\t\tcalendar.id = calendar.id || utils.uid();\n\t\t\tthis._calendars[calendar.id] = calendar;\n\t\t\tif (!config.worktimes)\n\t\t\t\tconfig.worktimes = {};\n\t\t\tconfig.worktimes[calendar.id] = calendar.getConfig();\n\t\t\treturn calendar.id;\n\t\t}\n\t},\n\n\tdeleteCalendar: function (calendar) {\n\t\tvar config = this.$gantt.config;\n\t\tif (!calendar) return false;\n\t\tif (this._calendars[calendar]) {\n\t\t\tdelete this._calendars[calendar];\n\t\t\tif (config.worktimes && config.worktimes[calendar])\n\t\t\t\tdelete config.worktimes[calendar];\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\trestoreConfigCalendars: function (configs) {\n\t\tfor (var i in configs) {\n\t\t\tif (this._calendars[i])\n\t\t\t\tcontinue;\n\n\t\t\tvar settings = configs[i];\n\t\t\tvar calendar = this.createCalendar(settings);\n\t\t\tcalendar.id = i;\n\t\t\tthis.addCalendar(calendar);\n\t\t}\n\t},\n\n\tdefaults: {\n\t\tglobal: {\n\t\t\tid: \"global\",\n\t\t\tworktime: {\n\t\t\t\thours: [8, 12, 13, 17],\n\t\t\t\tdays: [0, 1, 1, 1, 1, 1, 0]\n\t\t\t}\n\t\t},\n\t\tfulltime: {\n\t\t\tid: \"fulltime\",\n\t\t\tworktime: {\n\t\t\t\thours: [0, 24],\n\t\t\t\tdays: [1, 1, 1, 1, 1, 1, 1]\n\t\t\t}\n\t\t}\n\t},\n\n\tcreateDefaultCalendars: function () {\n\t\tvar config = this.$gantt.config;\n\t\tthis.restoreConfigCalendars(this.defaults);\n\t\tthis.restoreConfigCalendars(config.worktimes);\n\t},\n\n\tisCalendar: function(possibleCalendar) {\n\t\t// because we don't have any way to check without dependency to CalendarWorkTimeStrategy\n\t\tvar props = [\n\t\t\tpossibleCalendar.isWorkTime,\n\t\t\tpossibleCalendar.setWorkTime,\n\t\t\tpossibleCalendar.getWorkHours,\n\t\t\tpossibleCalendar.unsetWorkTime,\n\t\t\tpossibleCalendar.getClosestWorkTime,\n\t\t\tpossibleCalendar.calculateDuration,\n\t\t\tpossibleCalendar.hasDuration,\n\t\t\tpossibleCalendar.calculateEndDate\n\t\t];\n\t\treturn props.every(function(entry) {\n\t\t\treturn entry instanceof Function;\n\t\t});\n\t}\n};\n\nexport default CalendarManager;","export default function() {\n\tfunction getResourcesCalendarKey(resourceAssignments){\n\t\treturn resourceAssignments.map(function(res){\n\t\t\tif(res && res.resource_id){\n\t\t\t\treturn res.resource_id;\n\t\t\t} else {\n\t\t\t\treturn res;\n\t\t\t}\n\t\t}).sort().join(\"-\");\n\t}\n\n\tvar dynamicCalendars = {};\n\n\tfunction mergeResourceCalendars(resourceAssignments, manager){\n\t\treturn manager.mergeCalendars(resourceAssignments.map(function(assignment){\n\t\t\tvar resourceId = (assignment && assignment.resource_id) ? assignment.resource_id : assignment;\n\t\t\treturn manager.getResourceCalendar(resourceId);\n\t\t}));\n\t}\n\tfunction getCalendarIdFromMultipleResources(resourceAssignments, manager){\n\t\tvar key = getResourcesCalendarKey(resourceAssignments);\n\t\tif(!resourceAssignments.length){\n\t\t\treturn null;\n\t\t}else if(resourceAssignments.length === 1){\n\t\t\treturn manager.getResourceCalendar(key).id;\n\t\t}else if (dynamicCalendars[key]){\n\t\t\treturn dynamicCalendars[key].id;\n\t\t} else {\n\t\t\tvar tempCalendar = mergeResourceCalendars(resourceAssignments, manager);\n\n\t\t\tdynamicCalendars[key] = tempCalendar;\n\t\t\treturn manager.addCalendar(tempCalendar);\n\t\t}\n\t}\n\n\treturn {\n\t\tgetCalendarIdFromMultipleResources: getCalendarIdFromMultipleResources\n\t};\n};","function CalendarDisabledTimeStrategy(gantt, argumentsHelper){\n\tthis.argumentsHelper = argumentsHelper;\n\tthis.$gantt = gantt;\n}\n\nCalendarDisabledTimeStrategy.prototype = {\n\tgetWorkHours: function () {\n\t\treturn [0, 24];\n\t},\n\tsetWorkTime: function () {\n\t\treturn true;\n\t},\n\tunsetWorkTime: function () {\n\t\treturn true;\n\t},\n\tisWorkTime: function () {\n\t\treturn true;\n\t},\n\tgetClosestWorkTime: function (config) {\n\t\tvar config = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\t\treturn config.date;\n\t},\n\n\tcalculateDuration: function () {\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\treturn this._calculateDuration(from, to, unit, step);\n\t},\n\t_calculateDuration: function (start, end, unit, step) {\n\t\tvar dateHelper = this.$gantt.date;\n\t\tvar fixedUnits = {\n\t\t\t\"week\": 1000 * 60 * 60 * 24 * 7,\n\t\t\t\"day\": 1000 * 60 * 60 * 24,\n\t\t\t\"hour\": 1000 * 60 * 60,\n\t\t\t\"minute\": 1000 * 60\n\t\t};\n\n\t\tvar res = 0;\n\t\tif (fixedUnits[unit]) {\n\t\t\tres = Math.round((end - start) / (step * fixedUnits[unit]));\n\t\t} else {\n\t\t\tvar from = new Date(start),\n\t\t\t\tto = new Date(end);\n\t\t\twhile (from.valueOf() < to.valueOf()) {\n\t\t\t\tres += 1;\n\t\t\t\tfrom = dateHelper.add(from, step, unit);\n\t\t\t}\n\n\t\t\tif (from.valueOf() != end.valueOf()) {\n\t\t\t\tres += (to - from) / (dateHelper.add(from, step, unit) - from);\n\t\t\t}\n\t\t}\n\n\t\treturn Math.round(res);\n\t},\n\n\thasDuration: function () {\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit;\n\n\t\tif (!unit) {\n\t\t\treturn false;\n\t\t}\n\t\tfrom = new Date(from);\n\t\tto = new Date(to);\n\n\t\treturn (from.valueOf() < to.valueOf());\n\t},\n\n\thasWorkTime: function() {\n\t\treturn true;\n\t},\n\n\tequals: function(calendar) {\n\t\tif(!(calendar instanceof CalendarDisabledTimeStrategy)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\tcalculateEndDate: function () {\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar start = config.start_date,\n\t\t\tduration = config.duration,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\treturn this.$gantt.date.add(start, step * duration, unit);\n\t}\n};\n\nexport default CalendarDisabledTimeStrategy;","import createArgumentsHelper from \"./calendar_arguments_helper\";\nimport NoWorkTimeCalendar from \"./strategy/no_work_time\";\n\nfunction TimeCalculator(calendarManager){\n\n\tthis.$gantt = calendarManager.$gantt;\n\tthis.argumentsHelper = createArgumentsHelper(this.$gantt);\n\tthis.calendarManager = calendarManager;\n\tthis.$disabledCalendar = new NoWorkTimeCalendar(this.$gantt, this.argumentsHelper);\n}\n\nTimeCalculator.prototype = {\n\t_getCalendar: function (config) {\n\t\tvar calendar;\n\t\tif (!this.$gantt.config.work_time) {\n\t\t\tcalendar = this.$disabledCalendar;\n\t\t} else {\n\t\t\tvar manager = this.calendarManager;\n\t\t\tif (config.task) {\n\t\t\t\tcalendar = manager.getTaskCalendar(config.task);\n\t\t\t} else if (config.id) {\n\t\t\t\tcalendar = manager.getTaskCalendar(config);\n\t\t\t} else if (config.calendar) {\n\t\t\t\tcalendar = config.calendar;\n\t\t\t}\n\t\t\tif (!calendar) {\n\t\t\t\tcalendar = manager.getTaskCalendar();\n\t\t\t}\n\t\t}\n\t\treturn calendar;\n\t},\n\n\tgetWorkHours: function (config) {\n\t\tconfig = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.getWorkHours(config.date);\n\t},\n\n\tsetWorkTime: function (config, calendar) {\n\t\tconfig = this.argumentsHelper.setWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tif (!calendar)\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\n\t\treturn calendar.setWorkTime(config);\n\t},\n\n\tunsetWorkTime: function (config, calendar) {\n\t\tconfig = this.argumentsHelper.unsetWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tif (!calendar)\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\n\t\treturn calendar.unsetWorkTime(config);\n\t},\n\tisWorkTime: function (date, unit, task, calendar) {\n\t\tvar config = this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tcalendar = this._getCalendar(config);\n\t\treturn calendar.isWorkTime(config);\n\t},\n\tgetClosestWorkTime: function (config) {\n\t\tconfig = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.getClosestWorkTime(config);\n\t},\n\n\tcalculateDuration: function () { // start_date_date, end_date, task\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\n\n\t\tvar calendar = this._getCalendar(config);\n\t\treturn calendar.calculateDuration(config);\n\t},\n\thasDuration: function () {\n\t\tvar config = this.argumentsHelper.hasDurationArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.hasDuration(config);\n\t},\n\tcalculateEndDate: function (config) { // start_date, duration, unit, task\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\t\treturn calendar.calculateEndDate(config);\n\t}\n};\n\nexport default TimeCalculator;\n\n","// TODO: rework public api for date methods\nimport * as utils from \"../../utils/utils\";\n\nvar createWorkTimeFacade = function(calendarManager, timeCalculator){\n\treturn {\n\t\tgetWorkHours: function (date) {\n\t\t\treturn timeCalculator.getWorkHours(date);\n\t\t},\n\n\t\tsetWorkTime: function (config) {\n\t\t\treturn timeCalculator.setWorkTime(config);\n\t\t},\n\n\t\tunsetWorkTime: function (config) {\n\t\t\ttimeCalculator.unsetWorkTime(config);\n\t\t},\n\n\t\tisWorkTime: function (date, unit, task) {\n\t\t\treturn timeCalculator.isWorkTime(date, unit, task);\n\t\t},\n\n\t\tgetClosestWorkTime: function (config) {\n\t\t\treturn timeCalculator.getClosestWorkTime(config);\n\t\t},\n\n\t\tcalculateDuration: function (start_date, end_date, task) {\n\t\t\treturn timeCalculator.calculateDuration(start_date, end_date, task);\n\t\t},\n\t\t_hasDuration: function (start_date, end_date, task) {\n\t\t\treturn timeCalculator.hasDuration(start_date, end_date, task);\n\t\t},\n\n\t\tcalculateEndDate: function (start, duration, unit, task) {\n\t\t\treturn timeCalculator.calculateEndDate(start, duration, unit, task);\n\t\t},\n\n\t\tmergeCalendars: utils.bind(calendarManager.mergeCalendars, calendarManager),\n\t\tcreateCalendar: utils.bind(calendarManager.createCalendar, calendarManager),\n\t\taddCalendar: utils.bind(calendarManager.addCalendar, calendarManager),\n\t\tgetCalendar: utils.bind(calendarManager.getCalendar, calendarManager),\n\t\tgetCalendars: utils.bind(calendarManager.getCalendars, calendarManager),\n\t\tgetResourceCalendar: utils.bind(calendarManager.getResourceCalendar, calendarManager),\n\t\tgetTaskCalendar: utils.bind(calendarManager.getTaskCalendar, calendarManager),\n\t\tdeleteCalendar: utils.bind(calendarManager.deleteCalendar, calendarManager)\n\t};\n};\n\n\nexport default { create: createWorkTimeFacade };","import * as helpers from \"../utils/helpers\";\n\nexport default function(gantt) {\n\n\tgantt.isUnscheduledTask = function (task) {\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isUnscheduledTask. Task object was expected\");\n\t\treturn (!!task.unscheduled || !task.start_date);\n\t};\n\n\tgantt._isAllowedUnscheduledTask = function (task) {\n\t\treturn !!(task.unscheduled && gantt.config.show_unscheduled);\n\t};\n\n\tgantt._isTaskInTimelineLimits = function(task) {\n\t\tvar taskStart = task.start_date ? task.start_date.valueOf() : null;\n\t\tvar taskEnd = task.end_date ? task.end_date.valueOf() : null;\n\t\treturn !!(taskStart && taskEnd && taskStart <= this._max_date.valueOf() && taskEnd >= this._min_date.valueOf());\n\t};\n\tgantt.isTaskVisible = function (id) {\n\t\tif (!this.isTaskExists(id)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar task = this.getTask(id);\n\t\tif (!(this._isAllowedUnscheduledTask(task) || this._isTaskInTimelineLimits(task))) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !!(this.getGlobalTaskIndex(id) >= 0);\n\t};\n\n\tgantt._getProjectEnd = function() {\n\t\tif(gantt.config.project_end){\n\t\t\treturn gantt.config.project_end;\n\t\t}else{\n\t\t\tvar tasks = gantt.getTaskByTime();\n\t\t\ttasks = tasks.sort(function (a, b) {\n\t\t\t\treturn +a.end_date > +b.end_date ? 1 : -1;\n\t\t\t});\n\t\t\treturn tasks.length ? tasks[tasks.length - 1].end_date : null;\n\t\t}\n\t};\n\tgantt._getProjectStart = function() {\n\t\tif (gantt.config.project_start) {\n\t\t\treturn gantt.config.project_start;\n\t\t}\n\n\t\t// use timeline start if project start is not specified\n\t\tif (gantt.config.start_date) {\n\t\t\treturn gantt.config.start_date;\n\t\t}\n\t\tif (gantt.getState().min_date) {\n\t\t\treturn gantt.getState().min_date;\n\t\t}\n\n\t\t// earliest task start if neither project start nor timeline are specified\n\t\tvar tasks = gantt.getTaskByTime();\n\t\ttasks = tasks.sort(function (a, b) {\n\t\t\treturn +a.start_date > +b.start_date ? 1 : -1;\n\t\t});\n\t\treturn tasks.length ? tasks[0].start_date : null;\n\t};\n\n\tvar getDefaultTaskDate = function (item, parent_id) {\n\t\tvar parentExists = parent_id && parent_id != gantt.config.root_id && gantt.isTaskExists(parent_id);\n\t\tvar parent = parentExists ? gantt.getTask(parent_id) : false,\n\t\t\tstartDate = null;\n\t\tif (parent) {\n\t\t\tif(gantt.config.schedule_from_end){\n\t\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: parent.end_date,\n\t\t\t\t\tduration: - gantt.config.duration_step,\n\t\t\t\t\ttask:item\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tif(!parent.start_date){\n\t\t\t\t\treturn getDefaultTaskDate(parent, gantt.getParent(parent));\n\t\t\t\t}\n\t\t\t\tstartDate = parent.start_date;\n\t\t\t}\n\n\t\t} else if(gantt.config.schedule_from_end) {\n\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\tstart_date: gantt._getProjectEnd(),\n\t\t\t\tduration: - gantt.config.duration_step,\n\t\t\t\ttask:item\n\t\t\t});\n\t\t} else {\n\t\t\tconst first = gantt.getTaskByIndex(0);\n\t\t\tconst minDate = gantt.config.start_date || gantt.getState().min_date;\n\n\t\t\tif (first){\n\t\t\t\tif (first.start_date){\n\t\t\t\t\tstartDate = first.start_date;\n\t\t\t\t}\n\t\t\t\telse if (first.end_date){\n\t\t\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: first.end_date,\n\t\t\t\t\t\tduration: -gantt.config.duration_step,\n\t\t\t\t\t\ttask:item\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstartDate = minDate;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstartDate = minDate;\n\t\t\t}\n\t\t}\n\t\tgantt.assert(startDate, \"Invalid dates\");\n\t\treturn new Date(startDate);\n\t};\n\n\tgantt._set_default_task_timing = function (task) {\n\t\ttask.start_date = task.start_date || getDefaultTaskDate(task, gantt.getParent(task));\n\t\ttask.duration = task.duration || gantt.config.duration_step;\n\t\ttask.end_date = task.end_date || gantt.calculateEndDate(task);\n\t};\n\n\tgantt.createTask = function (item, parent, index) {\n\t\titem = item || {};\n\n\t\tif (!gantt.defined(item.id))\n\t\t\titem.id = gantt.uid();\n\n\t\tif (!item.start_date) {\n\t\t\titem.start_date = getDefaultTaskDate(item, parent);\n\t\t}\n\t\tif (item.text === undefined) {\n\t\t\titem.text = gantt.locale.labels.new_task;\n\t\t}\n\t\tif (item.duration === undefined) {\n\t\t\titem.duration = 1;\n\t\t}\n\n\t\tif (this.isTaskExists(parent)) {\n\t\t\tthis.setParent(item, parent, true);\n\t\t\tvar parentObj = this.getTask(parent);\n\t\t\tparentObj.$open = true;\n\t\t\t// GS-1583. Save the $open state to the Undo Stack\n\t\t\tif (!this.config.details_on_create){\n\t\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\n\t\t\t}\n\t\t}\n\n\t\tif (!this.callEvent(\"onTaskCreated\", [item])) {\n\t\t\treturn null;\n\t\t}\n\t\tif (this.config.details_on_create) {\n\t\t\t//GS-761: assert unique ID\n\t\t\tif (gantt.isTaskExists(item.id)){\n\t\t\t\tvar task = gantt.getTask(item.id);\n\t\t\t\tif (task.$index != item.$index) {\n\t\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\n\t\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\n\t\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\n\t\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\n\t\t\t\t\t}\n\t\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\n\t\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.$data.tasksStore.updateItem(item.id, item);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\titem.$new = true;\n\t\t\t\tthis.silent(function(){\n\t\t\t\t\tgantt.$data.tasksStore.addItem(item, index);\n\t\t\t\t});\t\n\t\t\t}\n\t\t\tthis.selectTask(item.id);\n\t\t\tthis.refreshData();\n\t\t\tthis.showLightbox(item.id);\n\t\t} else {\n\t\t\tif (this.addTask(item, parent, index)) {\n\t\t\t\tthis.showTask(item.id);\n\t\t\t\tthis.selectTask(item.id);\n\t\t\t}\n\t\t}\n\t\treturn item.id;\n\t};\n\n\tgantt._update_flags = function (oldid, newid) {\n\t\t//  TODO: need a proper way to update all possible flags\n\t\tvar store = gantt.$data.tasksStore;\n\t\tif (oldid === undefined) {\n\t\t\tthis._lightbox_id = null;\n\n\t\t\tstore.silent(function(){\n\t\t\t\tstore.unselect();\n\t\t\t});\n\t\t\t// GS-1522. If we have multiselect, unselect all previously selected tasks\n\t\t\tif (this.getSelectedTasks) {\n\t\t\t\tthis._multiselect.reset();\n\t\t\t}\n\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag) {\n\t\t\t\tthis._tasks_dnd.drag.id = null;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._lightbox_id == oldid)\n\t\t\t\tthis._lightbox_id = newid;\n\n\t\t\t// TODO: probably can be removed\n\t\t\tif (store.getSelectedId() == oldid) {\n\t\t\t\tstore.silent(function(){\n\t\t\t\t\tstore.unselect(oldid);\n\t\t\t\t\tstore.select(newid);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag && this._tasks_dnd.drag.id == oldid) {\n\t\t\t\tthis._tasks_dnd.drag.id = newid;\n\t\t\t}\n\t\t}\n\t};\n\n\tvar getTaskTimingMode = function (task, force) {\n\t\tvar task_type = gantt.getTaskType(task.type);\n\n\t\tvar state = {\n\t\t\ttype: task_type,\n\t\t\t$no_start: false,\n\t\t\t$no_end: false,\n\t\t\tscheduled_summary: false\n\t\t};\n\n\t\tif(task_type === gantt.config.types.project && task.auto_scheduling === false){\n\t\t\tstate.scheduled_summary = true;\n\t\t}\n\n\t\tif (!force && task_type == task.$rendered_type) {\n\t\t\tstate.$no_start = task.$no_start;\n\t\t\tstate.$no_end = task.$no_end;\n\t\t\treturn state;\n\t\t}\n\n\t\tif (task_type == gantt.config.types.project) {\n\t\t\t//project duration is always defined by children duration\n\t\t\tstate.$no_end = state.$no_start = true;\n\t\t} else if (task_type != gantt.config.types.milestone) {\n\t\t\t//tasks can have fixed duration, children duration(as projects), or one date fixed, and other defined by nested items\n\t\t\tstate.$no_end = !(task.end_date || task.duration);\n\t\t\tstate.$no_start = !task.start_date;\n\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) {\n\t\t\t\tstate.$no_end = state.$no_start = false;\n\t\t\t}\n\t\t}\n\n\t\treturn state;\n\t};\n\n\tgantt._init_task_timing = function (task) {\n\t\tvar task_mode = getTaskTimingMode(task, true);\n\n\t\tvar dirty = task.$rendered_type != task_mode.type;\n\n\t\tvar task_type = task_mode.type;\n\n\t\tif (dirty) {\n\t\t\ttask.$no_start = task_mode.$no_start;\n\t\t\ttask.$no_end = task_mode.$no_end;\n\t\t\ttask.$rendered_type = task_mode.type;\n\t\t}\n\n\t\tif (dirty && task_type != this.config.types.milestone) {\n\t\t\tif (task_type == this.config.types.project) {\n\t\t\t\t//project duration is always defined by children duration\n\t\t\t\tthis._set_default_task_timing(task);\n\t\t\t\ttask.$calculate_duration = false;// do not recalculate duration below\n\t\t\t}\n\t\t}\n\n\t\tif (task_type == this.config.types.milestone) {\n\t\t\ttask.end_date = task.start_date;\n\t\t}\n\t\tif (task.start_date && task.end_date && task.$calculate_duration !== false) {\n\t\t\ttask.duration = this.calculateDuration(task);\n\t\t}\n\n\t\tif(!task.$calculate_duration){\n\t\t\ttask.$calculate_duration = true;\n\t\t}\n\n\t\tif (!task.end_date) {\n\t\t\ttask.end_date = task.start_date;\n\t\t}\n\n\t\ttask.duration = task.duration || 0;\n\t\t// GS-1145. We should let tasks to have 0 duration if user wants it\n\t\tif (this.config.min_duration === 0 && task.duration === 0){\n\t\t\ttask.$no_end = false;\n\t\t}\n\n\t\t// work calendar of task has changed\n\t\tvar effectiveCalendar = this.getTaskCalendar(task);\n\t\tif(task.$effective_calendar && task.$effective_calendar !== effectiveCalendar.id){\n\t\t\tupdateTaskTiming(task);\n\t\t\tif(this.config.inherit_calendar && this.isSummaryTask(task)){\n\t\t\t\tthis.eachTask(function(child){\n\t\t\t\t\tupdateTaskTiming(child);\n\t\t\t\t}, task.id);\n\t\t\t}\n\t\t}\n\n\t\ttask.$effective_calendar = effectiveCalendar.id;\n\t};\n\n\tfunction updateTaskTiming(task) {\n\t\ttask.$effective_calendar = gantt.getTaskCalendar(task).id;\n\t\ttask.start_date = gantt.getClosestWorkTime({\n\t\t\tdir: \"future\",\n\t\t\tdate: task.start_date,\n\t\t\tunit: gantt.config.duration_unit,\n\t\t\ttask: task\n\t\t});\n\t\ttask.end_date = gantt.calculateEndDate(task);\n\t}\n\n\tgantt.isSummaryTask = function (task) {\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSummaryTask. Task object was expected\");\n\n\t\tvar mode = getTaskTimingMode(task);\n\n\t\treturn !!(mode.$no_end || mode.$no_start);\n\t};\n\n// downward calculation of project duration\n\tgantt.resetProjectDates = function (task) {\n\t\tvar taskMode = getTaskTimingMode(task);\n\t\tif (taskMode.$no_end || taskMode.$no_start) {\n\t\t\tvar info = getSubtaskInfo(task.id);\n\t\t\tassignProjectDates.call(this, task, taskMode, info.start_date, info.end_date);\n\t\t\ttask.$rollup = info.rollup;\n\t\t}\n\t};\n\n\tfunction assignProjectDates(task, taskTiming, from, to) {\n\n\t\tconst summaryDateFields = {\n\t\t\tstart: \"start_date\",\n\t\t\tend: \"end_date\"\n\t\t};\n\t\tconst manuallyScheduledSummaryDateFields = {\n\t\t\tstart: \"$auto_start_date\",\n\t\t\tend: \"$auto_end_date\"\n\t\t};\n\n\t\tlet dateFields;\n\t\tif(task.type === gantt.config.types.project && task.auto_scheduling === false){\n\t\t\tdateFields = manuallyScheduledSummaryDateFields;\n\t\t}else{\n\t\t\tdateFields = summaryDateFields;\n\t\t}\n\n\t\tif (taskTiming.$no_start) {\n\t\t\tif (from) {\n\t\t\t\ttask[dateFields.start] = new Date(from);\n\t\t\t} else {\n\t\t\t\ttask[dateFields.start] = getDefaultTaskDate(task, this.getParent(task));\n\t\t\t}\n\t\t}\n\n\t\tif (taskTiming.$no_end) {\n\t\t\tif (to) {\n\t\t\t\ttask[dateFields.end] = new Date(to);\n\t\t\t} else {\n\t\t\t\ttask[dateFields.end] = this.calculateEndDate({\n\t\t\t\t\tstart_date: task[dateFields.start],\n\t\t\t\t\tduration: this.config.duration_step,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (taskTiming.$no_start || taskTiming.$no_end) {\n\t\t\tthis._init_task_timing(task);\n\t\t}\n\t}\n\n\tgantt.getSubtaskDuration = function (taskId) {\n\t\tvar res = 0,\n\t\t\troot = taskId !== undefined ? taskId : gantt.config.root_id;\n\n\t\tthis.eachTask(function (child) {\n\t\t\tif (this.getTaskType(child.type) == gantt.config.types.project || this.isUnscheduledTask(child))\n\t\t\t\treturn;\n\n\t\t\tres += child.duration;\n\t\t}, root);\n\n\t\treturn res;\n\t};\n\n\tfunction getSubtaskInfo (taskId){\n\t\tvar min = null,\n\t\t\tmax = null,\n\t\t\troot = taskId !== undefined ? taskId : gantt.config.root_id,\n\t\t\trollup = [];\n\n\t\tgantt.eachTask(function (child) {\n\t\t\tconst isScheduledSummary = (gantt.getTaskType(child.type) == gantt.config.types.project && (child.auto_scheduling === false));\n\t\t\tif ((gantt.getTaskType(child.type) == gantt.config.types.project && !isScheduledSummary) || gantt.isUnscheduledTask(child))\n\t\t\t\treturn;\n\t\t\t\n\t\t\tif(child.rollup){\n\t\t\t\trollup.push(child.id);\n\t\t\t}\n\n\t\t\tif ((child.start_date && (!child.$no_start || isScheduledSummary)) && (!min || min > child.start_date.valueOf()))\n\t\t\t\tmin = child.start_date.valueOf();\n\t\t\tif ((child.end_date && (!child.$no_end || isScheduledSummary)) && (!max || max < child.end_date.valueOf()))\n\t\t\t\tmax = child.end_date.valueOf();\n\t\t}, root);\n\n\t\treturn {\n\t\t\tstart_date: min ? new Date(min) : null,\n\t\t\tend_date: max ? new Date(max) : null,\n\t\t\trollup: rollup\n\t\t};\n\t}\n\n\tgantt.getSubtaskDates = function (task_id) {\n\t\tvar info = getSubtaskInfo(task_id);\n\t\treturn {\n\t\t\tstart_date: info.start_date,\n\t\t\tend_date: info.end_date\n\t\t};\n\t};\n\n\n// upward calculation of project duration\n\tgantt._update_parents = function (taskId, silent, updateAll) {\n\t\tif (!taskId) return;\n\n\t\tvar task = this.getTask(taskId);\n\t\tif(task.rollup){\n\t\t\tupdateAll = true;\n\t\t}\n\t\tvar pid = this.getParent(task);\n\n\t\tvar taskTiming = getTaskTimingMode(task);\n\n\t\tvar has_changed = true;\n\t\t// GS-761 the dates check is necessary for adding empty tasks: gantt.addTask({id:\"2\"})\n\t\tif (updateAll || (task.start_date && task.end_date && (taskTiming.$no_start || taskTiming.$no_end))) {\n\n\t\t\tconst startDateField = task.$auto_start_date ? \"$auto_start_date\" : \"start_date\";\n\t\t\tconst endDateField = task.$auto_end_date ? \"$auto_end_date\" : \"end_date\";\n\n\t\t\tvar oldStart = task[startDateField].valueOf(),\n\t\t\t\toldEnd = task[endDateField].valueOf();\n\n\t\t\tgantt.resetProjectDates(task);\n\n\t\t\t// not refresh parent projects if dates hasn't changed\n\t\t\tif (!updateAll && oldStart == task[startDateField].valueOf() && oldEnd == task[endDateField].valueOf()) {\n\t\t\t\thas_changed = false;\n\t\t\t}\n\n\t\t\tif (has_changed && !silent) {\n\t\t\t\tthis.refreshTask(task.id, true);\n\t\t\t}\n\n\t\t\tif(taskTiming.scheduled_summary){\n\t\t\t\thas_changed = true;//recalculate upwards from scheduled summaries\n\t\t\t}\n\t\t}\n\n\n\t\tif (has_changed && pid && this.isTaskExists(pid)) {\n\t\t\tthis._update_parents(pid, silent, updateAll);\n\t\t}\n\t};\n\n\tgantt.roundDate = function (config) {\n\t\tvar scale = gantt.getScale();\n\n\t\tif (helpers.isDate(config)) {\n\t\t\tconfig = {\n\t\t\t\tdate: config,\n\t\t\t\tunit: scale ? scale.unit : gantt.config.duration_unit,\n\t\t\t\tstep: scale ?  scale.step : gantt.config.duration_step\n\t\t\t};\n\t\t}\n\t\tvar date = config.date,\n\t\t\tsteps = config.step,\n\t\t\tunit = config.unit;\n\n\t\tif(!scale){\n\t\t\treturn date;\n\t\t}\n\n\t\tvar upper, lower, colIndex;\n\t\tif (unit == scale.unit && steps == scale.step &&\n\t\t\t+date >= +scale.min_date && +date <= +scale.max_date) {\n\t\t\t//find date in time scale config\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\tif (!scale.trace_x[colIndex]) {\n\t\t\t\tcolIndex -= 1;// end of time scale\n\t\t\t\tif(scale.rtl){\n\t\t\t\t\tcolIndex = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlower = new Date(scale.trace_x[colIndex]);\n\t\t\tupper = gantt.date.add(lower, steps, unit);\n\t\t} else {\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\tupper = gantt.date[unit + \"_start\"](new Date(scale.min_date));\n\t\t\tif (scale.trace_x[colIndex]) {\n\t\t\t\tupper = gantt.date[unit + \"_start\"](scale.trace_x[colIndex]);// end of time scale\n\t\t\t}\n\n\t\t\twhile (+upper < +date) {\n\t\t\t\tupper = gantt.date[unit + \"_start\"](gantt.date.add(upper, steps, unit));\n\n\t\t\t\tvar tzOffset = upper.getTimezoneOffset();\n\n\t\t\t\tupper = gantt._correct_dst_change(upper, tzOffset, upper, unit);\n\t\t\t\tif (gantt.date[unit + '_start'])\n\t\t\t\t\tupper = gantt.date[unit + '_start'](upper);\n\t\t\t}\n\n\t\t\tlower = gantt.date.add(upper, -1 * steps, unit);\n\n\t\t}\n\t\tif (config.dir && config.dir == 'future')\n\t\t\treturn upper;\n\t\tif (config.dir && config.dir == 'past')\n\t\t\treturn lower;\n\n\t\tif (Math.abs(date - lower) < Math.abs(upper - date)) {\n\t\t\treturn lower;\n\t\t} else {\n\t\t\treturn upper;\n\t\t}\n\n\t};\n\n\tgantt.correctTaskWorkTime = function (task) {\n\t\tif (gantt.config.work_time && gantt.config.correct_work_time) {\n\t\t\tif (!this.isWorkTime(task.start_date, undefined, task)) {\n\t\t\t\ttask.start_date = this.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t} else if (!this.isWorkTime(new Date(+task.end_date - 1), undefined, task)) {\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t}\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\n\t\tgantt._init_task_timing(task);\n\t\treturn true;\n\t});\n\tgantt.attachEvent(\"onBeforeTaskAdd\", function (id, task) {\n\t\tgantt._init_task_timing(task);\n\t\treturn true;\n\t});\n\n\tgantt.attachEvent(\"onAfterTaskMove\", function (id, parent, tindex) {\n\t\tgantt._init_task_timing(gantt.getTask(id));\n\t\treturn true;\n\t});\n\n};","function addResizeListener(gantt){\n\tvar containerStyles = window.getComputedStyle(gantt.$root);\n\tif(containerStyles.getPropertyValue(\"position\") == \"static\"){\n\t\tgantt.$root.style.position = \"relative\";\n\t}\n\n\tvar resizeWatcher = document.createElement('iframe');\n\tresizeWatcher.className = \"gantt_container_resize_watcher\";\n\tresizeWatcher.tabIndex = -1;\n\tif(gantt.config.wai_aria_attributes){\n\t\tresizeWatcher.setAttribute(\"role\", \"none\");\n\t\tresizeWatcher.setAttribute(\"aria-hidden\", true);\n\t}\n\n\tvar salesforce_environment = !!window[\"Sfdc\"] || !!window[\"$A\"] || window[\"Aura\"];\n\tif (salesforce_environment){\n\t\tgantt.config.container_resize_method = \"timeout\";\n\t}\n\n\t// in some environments (namely, in SalesForce) iframe.contentWindow is not available\n\tgantt.$root.appendChild(resizeWatcher);\n\tif (resizeWatcher.contentWindow) {\n\t\tlistenWindowResize(gantt, resizeWatcher.contentWindow);\n\t} else {\n\t\t// if so - ditch the iframe and fallback to listening the main window resize\n\t\tgantt.$root.removeChild(resizeWatcher);\n\t\tlistenWindowResize(gantt, window);\n\t}\n}\n\nfunction listenWindowResize(gantt, window){\n\tvar resizeTimeout = gantt.config.container_resize_timeout || 20;\n\tvar resizeDelay;\n\tlet previousSize = getContainerSize(gantt);\n\n\tif (gantt.config.container_resize_method == \"timeout\"){\n\t\tlowlevelResizeWatcher();\n\t}\n\telse {\n\t\ttry {\n\t\t\tgantt.event(window, \"resize\", function () {\n\t\t\t\tif (gantt.$scrollbarRepaint) {\n\t\t\t\t\tgantt.$scrollbarRepaint = null;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// GS-2140. Don't repaint Gantt if it has the same sizes\n\t\t\t\t\tlet currentSize = getContainerSize(gantt);\n\t\t\t\t\tif (previousSize.x == currentSize.x && previousSize.y == currentSize.y){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tpreviousSize = currentSize;\n\t\t\t\t\trepaintGantt();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tcatch (e) {\n\t\t\tlowlevelResizeWatcher();\n\t\t}\n\t}\n\n\tfunction repaintGantt(){\n\t\tclearTimeout(resizeDelay);\n\t\tresizeDelay = setTimeout(function(){\n\t\t\tif(!gantt.$destroyed){\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}, resizeTimeout);\n\t}\n\n\tvar previousHeight = gantt.$root.offsetHeight;\n\tvar previousWidth = gantt.$root.offsetWidth;\t\n\n\tfunction lowlevelResizeWatcher(){\n\t\tif (gantt.$root.offsetHeight != previousHeight ||\n\t\t\t\tgantt.$root.offsetWidth != previousWidth){\n\t\t\t\trepaintGantt();\n\t\t}\n\n\t\tpreviousHeight = gantt.$root.offsetHeight;\n\t\tpreviousWidth = gantt.$root.offsetWidth;\n\n\t\tsetTimeout(lowlevelResizeWatcher, resizeTimeout);\n\t}\n}\n\nfunction getContainerSize(gantt){\n\treturn {\n\t\tx: gantt.$root.offsetWidth,\n\t\ty: gantt.$root.offsetHeight\n\t};\n}\n\nexport default addResizeListener;","import * as domHelpers from \"./ui/utils/dom_helpers\";\nimport * as helpers from \"../utils/helpers\";\nimport isHeadless from \"../utils/is_headless\";\nimport addResizeListener from \"./ui/resize_listener\";\nimport calculateScaleRange from \"./gantt_data_range\";\nimport assert from \"./common/assert\";\n\nexport default function(gantt){\n\t\n\n\tgantt.assert = assert(gantt);\n\n\tfunction isHTMLElement(node){\n\t\ttry {\n\t\t\tnode.cloneNode(false);\n\t\t}\n\t\tcatch (e){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tvar invalidContainerMessage = \"Invalid value of the first argument of `gantt.init`. Supported values: HTMLElement, String (element id).\" +\n\t\"This error means that either invalid object is passed into `gantt.init` or that the element with the specified ID doesn't exist on the page when `gantt.init` is called.\";\n\n\tfunction validateNode(node){\n\t\tif (!node || (typeof node == 'string' && document.getElementById(node))) return true;\n\t\tif (isHTMLElement(node)) return true;\n\n\t\tgantt.assert(false, invalidContainerMessage);\n\t\tthrow new Error(invalidContainerMessage);\n\t}\n\n//initial initialization\n\tgantt.init = function(node, from, to){\n\t\tif (gantt.env.isNode) { \n\t\t\tnode = null; // for the nodejs version\n\t\t} else {\n\t\t\tvalidateNode(node); // for the web version\n\t\t}\n\n\t\tif(from && to){\n\t\t\tthis.config.start_date = this._min_date = new Date(from);\n\t\t\tthis.config.end_date = this._max_date = new Date(to);\n\t\t}\n\t\tthis.date.init();\n\n\t\t//can be called only once\n\t\tthis.init = function(node){\n\t\t\tif (gantt.env.isNode) { \n\t\t\t\tnode = null; // for the nodejs version\n\t\t\t} else {\n\t\t\t\tvalidateNode(node); // for the web version\n\t\t\t}\n\n\t\t\tif (this.$container && this.$container.parentNode){\n\t\t\t\tthis.$container.parentNode.removeChild(this.$container);\n\t\t\t\tthis.$container = null;\n\t\t\t}\n\n\t\t\tif(this.$layout){\n\t\t\t\tthis.$layout.clear();\n\t\t\t}\n\t\t\tthis._reinit(node);\n\t\t};\n\t\tthis._reinit(node);\n\t};\n\n\tgantt._quickRefresh = function(code){\n\t\tvar stores = this._getDatastores.call(this);\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i]._quick_refresh = true;\n\t\t}\n\n\t\tcode();\n\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i]._quick_refresh = false;\n\t\t}\n\t};\n\n\tvar dropLayout = (function dropLayout(){\n\t\tif(this._clearTaskLayers){\n\t\t\tthis._clearTaskLayers();\n\t\t}\n\n\t\tif(this._clearLinkLayers){\n\t\t\tthis._clearLinkLayers();\n\t\t}\n\n\t\tif(this.$layout){\n\t\t\tthis.$layout.destructor();\n\t\t\tthis.$layout = null;\n\t\t\tthis.$ui.reset();\n\t\t}\n\t}).bind(gantt);\n\n\tvar rebuildLayout = (function rebuildLayout(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$root.innerHTML = \"\";\n\n\t\tthis.$root.gantt = this;\n\t\tcalculateScaleRange(this);\n\t\tthis.config.layout.id = \"main\";\n\t\tthis.$layout = this.$ui.createView(\"layout\", this.$root, this.config.layout);\n\n\t\tthis.$layout.attachEvent(\"onBeforeResize\", function(){\n\t\t\tvar storeNames = gantt.$services.getService(\"datastores\");\n\t\t\tfor(var i = 0; i < storeNames.length; i++){\n\t\t\t\tgantt.getDatastore(storeNames[i]).filter();\n\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation){\n\t\t\t\t\t// do not repaint items, they will be repainted later in the onStoreUpdate event\n\t\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation != \"lightbox\"){\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\tgantt.getDatastore(storeNames[i]).callEvent(\"onBeforeRefreshAll\", []);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.$layout.attachEvent(\"onResize\", function(){\n\t\t\tgantt._quickRefresh(function(){\n\t\t\t\tgantt.refreshData();\n\t\t\t});\n\t\t});\n\n\t\tthis.callEvent(\"onGanttLayoutReady\", []);\n\t\tthis.$layout.render();\n\n\t\tthis.$container = this.$layout.$container.firstChild;\n\n\t\taddResizeListener(this);\n\t}).bind(gantt);\n\n\tgantt.resetLayout = function(){\n\t\tdropLayout();\n\t\trebuildLayout();\n\t\tthis.render();\n\t};\n\n\tgantt._reinit = function(node){\n\t\tthis.callEvent(\"onBeforeGanttReady\", []);\n\t\tthis._update_flags();\n\n\t\tvar config = this.$services.getService(\"templateLoader\");\n\t\tconfig.initTemplates(this);\n\n\t\tdropLayout();\n\n\t\tthis.$root = null;\n\t\tif(node){\n\t\t\tthis.$root = domHelpers.toNode(node);\n\t\t\trebuildLayout();\n\t\t\tthis.$mouseEvents.reset(this.$root);\n\t\t\taddMinimalSizes(gantt);\n\t\t}\n\n\t\tthis.callEvent(\"onTemplatesReady\",[]);\n\n\t\tthis.callEvent(\"onGanttReady\", []);\n\n\t\tthis.render();\n\t};\n\n\tfunction addMinimalSizes(gantt) {\n\t\tif (gantt.$container && !gantt.config.autosize) {\n\t\t\tif (gantt.$root.offsetHeight < 50) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.warn(`The Gantt container has a small height, so you cannot see its content. If it is not intended, you need to set the 'height' style rule to the container:\nhttps://docs.dhtmlx.com/gantt/faq.html#theganttchartisntrenderedcorrectly`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgantt.$click={\n\t\tbuttons:{\n\t\t\t\"edit\": function(id) {\n\t\t\t\tif (gantt.isReadonly(gantt.getTask(id))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgantt.showLightbox(id);\n\t\t\t},\n\t\t\t\"delete\": function(id) {\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (gantt.isReadonly(task)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar question = gantt.locale.labels.confirm_deleting;\n\t\t\t\tvar title = gantt.locale.labels.confirm_deleting_title;\n\n\t\t\t\tgantt._simple_confirm(question, title, function(){\n\t\t\t\t\tif(!gantt.isTaskExists(id)){\n\t\t\t\t\t\tgantt.hideLightbox();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(task.$new){\n\t\t\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\n\t\t\t\t\t\t// as they will be recalculated in the `refreshData`\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\n\t\t\t\t\t\tgantt.silent(function(){\n\t\t\t\t\t\t\tgantt.deleteTask(id, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\t\t\t\t\tgantt.refreshData();\n\t\t\t\t\t}else{\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = true;\n\t\t\t\t\t\tgantt.deleteTask(id);\n\t\t\t\t\t}\n\n\t\t\t\t\tgantt.hideLightbox();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n//renders self\n\tgantt.render = function(){\n\t\tthis.callEvent(\"onBeforeGanttRender\", []);\n\n\t\tvar visibleDate;\n\t\tif(!isHeadless(gantt)){\n\t\t\tif (!this.config.sort && this._sort) {\n\t\t\t\tthis._sort = undefined;\n\t\t\t}\n\n\t\t\tif(this.$root){\n\t\t\t\tif(this.config.rtl){\n\t\t\t\t\tthis.$root.classList.add(\"gantt_rtl\");\n\t\t\t\t\tthis.$root.firstChild.classList.add(\"gantt_rtl\"); // GS-1499\n\t\t\t\t}else{\n\t\t\t\t\tthis.$root.classList.remove(\"gantt_rtl\");\n\t\t\t\t\tthis.$root.firstChild.classList.remove(\"gantt_rtl\"); // GS-1499\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pos = this.getScrollState();\n\t\t\tvar posX = pos ? pos.x : 0;\n\t\t\tif(this._getHorizontalScrollbar()){\n\t\t\t\tvar scrollbar = this._getHorizontalScrollbar();\n\t\t\t\tposX = scrollbar.$config.codeScrollLeft || posX || 0;\n\t\t\t}\n\n\n\t\t\tvisibleDate = null;\n\t\t\tif(posX){\n\t\t\t\tvisibleDate = gantt.dateFromPos(posX + this.config.task_scroll_offset);\n\t\t\t}\n\t\t}\n\n\t\tcalculateScaleRange(this);\n\n\t\tif(!isHeadless(gantt)){\n\t\t\tthis.$layout.$config.autosize = this.config.autosize;\n\t\t\tvar preserveScroll = this.config.preserve_scroll;\n\t\t\tthis.config.preserve_scroll = false; // prevent scrolling from layout resize, scroll will be called here later on\n\t\t\tthis.$layout.resize();\n\t\t\tthis.config.preserve_scroll = preserveScroll;\n\n\t\t\tif(this.config.preserve_scroll && pos){\n\n\t\t\t\t// GS-1640: We need pos.y, otherwise part of the timeline won't be rendered if the scrollbar disappeared\n\t\t\t\tif (posX || pos.y) {\n\t\t\t\t\tvar new_pos = gantt.getScrollState();\n\t\t\t\t\tvar new_date = gantt.dateFromPos(new_pos.x);\n\t\t\t\t\tif(!(+visibleDate == +new_date && new_pos.y == pos.y)){\n\t\t\t\t\t\tvar posX = null;\n\t\t\t\t\t\tvar posY = null;\n\t\t\t\t\t\tif(visibleDate){\n\t\t\t\t\t\t\tvar posX = Math.max(gantt.posFromDate(visibleDate) - gantt.config.task_scroll_offset, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(pos.y){\n\t\t\t\t\t\t\tposY = pos.y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt.scrollTo(posX, posY);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// GS-1640: We need to reset the scroll position for the grid if the scrollbar disappeared and\n\t\t\t\t// the grid and timeline have different scrollbars\n\t\t\t\tvar gridCell = gantt.$ui.getView(\"grid\");\n\t\t\t\tif (gridCell) {\n\t\t\t\t\tvar attachedScrollbar = gridCell.$config.scrollY;\n\t\t\t\t\tvar verticalScrollbar = gantt.$ui.getView(attachedScrollbar);\n\t\t\t\t\tif (verticalScrollbar) {\n\t\t\t\t\t\tvar scrollbarNodeVisible = gantt.utils.dom.isChildOf(verticalScrollbar.$view, gantt.$container);\n\t\t\t\t\t\tif (!scrollbarNodeVisible) {\n\t\t\t\t\t\t\tgridCell.scrollTo(undefined, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}else{\n\t\t\tgantt.refreshData();\n\t\t}\n\t\tthis.callEvent(\"onGanttRender\", []);\n\t};\n\n\t//TODO: add layout.resize method that wouldn't trigger data repaint\n\tgantt.setSizes = gantt.render;\n\n\n\tgantt.getTaskRowNode = function(id) {\n\t\tvar els = this.$grid_data.childNodes;\n\t\tvar attribute = this.config.task_attribute;\n\t\tfor (var i = 0; i < els.length; i++) {\n\t\t\tif (els[i].getAttribute) {\n\t\t\t\tvar value = els[i].getAttribute(attribute);\n\t\t\t\tif (value == id) return els[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tgantt.changeLightboxType = function(type){\n\t\tif(this.getLightboxType() == type)\n\t\t\treturn true;\n\t\tgantt._silent_redraw_lightbox(type);\n\t};\n\n\tgantt._get_link_type = function (from_start, to_start) {\n\t\tvar type = null;\n\t\tif (from_start && to_start) {\n\t\t\ttype = gantt.config.links.start_to_start;\n\t\t} else if (!from_start && to_start) {\n\t\t\ttype = gantt.config.links.finish_to_start;\n\t\t} else if (!from_start && !to_start) {\n\t\t\ttype = gantt.config.links.finish_to_finish;\n\t\t} else if (from_start && !to_start) {\n\t\t\ttype = gantt.config.links.start_to_finish;\n\t\t}\n\t\treturn type;\n\t};\n\n\tgantt.isLinkAllowed = function (from, to, from_start, to_start) {\n\t\tvar link = null;\n\t\tif (typeof(from) == \"object\") {\n\t\t\tlink = from;\n\t\t} else {\n\t\t\tlink = {source: from, target: to, type: this._get_link_type(from_start, to_start)};\n\t\t}\n\n\t\tif (!link) return false;\n\t\tif (!(link.source && link.target && link.type)) return false;\n\t\tif (link.source == link.target) return false;\n\n\t\tvar res = true;\n\t\t//any custom rules\n\t\tif (this.checkEvent(\"onLinkValidation\"))\n\t\t\tres = this.callEvent(\"onLinkValidation\", [link]);\n\n\t\treturn res;\n\t};\n\n\n\tgantt._correct_dst_change = function(date, prevOffset, step, unit){\n\t\tvar time_unit = helpers.getSecondsInUnit(unit) * step;\n\t\tif(time_unit > 60*60 && time_unit < 60*60*24){\n\t\t\t//correct dst change only if current unit is more than one hour and less than day (days have own checking), e.g. 12h\n\t\t\tvar offsetChanged = date.getTimezoneOffset() - prevOffset;\n\t\t\tif(offsetChanged){\n\t\t\t\tdate = gantt.date.add(date, offsetChanged, \"minute\");\n\t\t\t}\n\t\t}\n\t\treturn date;\n\t};\n\n\tgantt.isSplitTask = function(task){\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSplitTask. Task object was expected\");\n\t\treturn this.$data.tasksStore._isSplitItem(task);\n\t};\n\n\tgantt._is_icon_open_click = function(e) {\n\t\tif (!e)\n\t\t\treturn false;\n\t\tvar target = e.target || e.srcElement;\n\t\tif (!(target && target.className))\n\t\t\treturn false;\n\t\tvar className = domHelpers.getClassName(target);\n\t\tif (className.indexOf(\"gantt_tree_icon\") !== -1 && (className.indexOf(\"gantt_close\") !== -1 || className.indexOf(\"gantt_open\") !== -1))\n\t\t\treturn true;\n\t\treturn false;\n\t};\n\n};","/*\n \tasserts will be removed in final code, so you can place them anythere\n\twithout caring about performance impacts\n*/\n\nexport default function(gantt){\n\treturn function assert(check, message){\n\t\tif (!check){\n\t\t\tif(gantt.config.show_errors && gantt.callEvent(\"onError\",[message]) !== false) {\n\t\t\t\tif (gantt.message) {\n\t\t\t\t\tgantt.message({type: \"error\", text: message, expire: -1});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\tconsole.log(message);\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line no-debugger\n\t\t\t\tdebugger;\n\t\t\t}\n\t\t}\n\t};\n};","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"كانون الثاني\", \"شباط\", \"آذار\", \"نيسان\", \"أيار\", \"حزيران\", \"تموز\", \"آب\", \"أيلول\", \"تشرين الأول\", \"تشرين الثاني\", \"كانون الأول\"],\n\t\tmonth_short: [\"يناير\", \"فبراير\", \"مارس\", \"أبريل\", \"مايو\", \"يونيو\", \"يوليو\", \"أغسطس\", \"سبتمبر\", \"أكتوبر\", \"نوفمبر\", \"ديسمبر\"],\n\t\tday_full: [\"الأحد\", \"الأثنين\", \"ألثلاثاء\", \"الأربعاء\", \"ألحميس\", \"ألجمعة\", \"السبت\"],\n\t\tday_short: [\"احد\", \"اثنين\", \"ثلاثاء\", \"اربعاء\", \"خميس\", \"جمعة\", \"سبت\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"مهمة جديد\",\n\t\ticon_save: \"اخزن\",\n\t\ticon_cancel: \"الغاء\",\n\t\ticon_details: \"تفاصيل\",\n\t\ticon_edit: \"تحرير\",\n\t\ticon_delete: \"حذف\",\n\t\tconfirm_closing: \"التغييرات سوف تضيع, هل انت متأكد؟\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"الحدث سيتم حذفها نهائيا ، هل أنت متأكد؟\",\n\t\tsection_description: \"الوصف\",\n\t\tsection_time: \"الفترة الزمنية\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"الغاء\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Студзень\", \"Люты\", \"Сакавік\", \"Красавік\", \"Maй\", \"Чэрвень\", \"Ліпень\", \"Жнівень\", \"Верасень\", \"Кастрычнік\", \"Лістапад\", \"Снежань\"],\n\t\tmonth_short: [\"Студз\", \"Лют\", \"Сак\", \"Крас\", \"Maй\", \"Чэр\", \"Ліп\", \"Жнів\", \"Вер\", \"Каст\", \"Ліст\", \"Снеж\"],\n\t\tday_full: [\"Нядзеля\", \"Панядзелак\", \"Аўторак\", \"Серада\", \"Чацвер\", \"Пятніца\", \"Субота\"],\n\t\tday_short: [\"Нд\", \"Пн\", \"Аўт\", \"Ср\", \"Чцв\", \"Пт\", \"Сб\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Новае заданне\",\n\t\ticon_save: \"Захаваць\",\n\t\ticon_cancel: \"Адмяніць\",\n\t\ticon_details: \"Дэталі\",\n\t\ticon_edit: \"Змяніць\",\n\t\ticon_delete: \"Выдаліць\",\n\t\tconfirm_closing: \"\", // Унесеныя змены будуць страчаны, працягнуць?\n\t\tconfirm_deleting: \"Падзея будзе выдалена незваротна, працягнуць?\",\n\t\tsection_description: \"Апісанне\",\n\t\tsection_time: \"Перыяд часу\",\n\t\tsection_type: \"Тып\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"ІСР\",\n\t\tcolumn_text: \"Задача\",\n\t\tcolumn_start_date: \"Пачатак\",\n\t\tcolumn_duration: \"Працяг\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Сувязь\",\n\t\tconfirm_link_deleting: \"будзе выдалена\",\n\t\tlink_start: \"(пачатак)\",\n\t\tlink_end: \"(канец)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Хвiлiна\",\n\t\thours: \"Гадзiна\",\n\t\tdays: \"Дзень\",\n\t\tweeks: \"Тыдзень\",\n\t\tmonths: \"Месяц\",\n\t\tyears: \"Год\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Адмяніць\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n @Traducido por Vicente Adria Bohigues - vicenteadria@hotmail.com\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Gener\", \"Febrer\", \"Març\", \"Abril\", \"Maig\", \"Juny\", \"Juliol\", \"Agost\", \"Setembre\", \"Octubre\", \"Novembre\", \"Desembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Oct\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Diumenge\", \"Dilluns\", \"Dimarts\", \"Dimecres\", \"Dijous\", \"Divendres\", \"Dissabte\"],\n\t\tday_short: [\"Dg\", \"Dl\", \"Dm\", \"Dc\", \"Dj\", \"Dv\", \"Ds\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova tasca\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancel·lar\",\n\t\ticon_details: \"Detalls\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Esborrar\",\n\t\tconfirm_closing: \"\", // \"Els seus canvis es perdràn, continuar ?\"\n\t\tconfirm_deleting: \"L'esdeveniment s'esborrarà definitivament, continuar ?\",\n\t\tsection_description: \"Descripció\",\n\t\tsection_time: \"Periode de temps\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancel·lar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\nTranslation by FreezeSoul\n\nUpdate 26/10/2015:\nTranslation of new labels by zwh8800\n https://github.com/DHTMLX/gantt/pull/7\n\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"一月\", \"二月\", \"三月\", \"四月\", \"五月\", \"六月\", \"七月\", \"八月\", \"九月\", \"十月\", \"十一月\", \"十二月\"],\n\t\tmonth_short: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\n\t\tday_full: [\"星期日\", \"星期一\", \"星期二\", \"星期三\", \"星期四\", \"星期五\", \"星期六\"],\n\t\tday_short: [\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"新任務\",\n\t\ticon_save: \"保存\",\n\t\ticon_cancel: \"关闭\",\n\t\ticon_details: \"详细\",\n\t\ticon_edit: \"编辑\",\n\t\ticon_delete: \"删除\",\n\t\tconfirm_closing: \"请确认是否撤销修改!\", // Your changes will be lost, are your sure?\n\t\tconfirm_deleting: \"是否删除日程?\",\n\t\tsection_description: \"描述\",\n\t\tsection_time: \"时间范围\",\n\t\tsection_type: \"类型\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"工作分解结构\",\n\t\tcolumn_text: \"任务名\",\n\t\tcolumn_start_date: \"开始时间\",\n\t\tcolumn_duration: \"持续时间\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\n\t\tlink: \"关联\",\n\t\tconfirm_link_deleting: \"将被删除\",\n\t\tlink_start: \" (开始)\",\n\t\tlink_end: \" (结束)\",\n\n\t\ttype_task: \"任务\",\n\t\ttype_project: \"项目\",\n\t\ttype_milestone: \"里程碑\",\n\n\t\tminutes: \"分钟\",\n\t\thours: \"小时\",\n\t\tdays: \"天\",\n\t\tweeks: \"周\",\n\t\tmonths: \"月\",\n\t\tyears: \"年\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"关闭\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Leden\", \"Únor\", \"Březen\", \"Duben\", \"Květen\", \"Červen\", \"Červenec\", \"Srpen\", \"Září\", \"Říjen\", \"Listopad\", \"Prosinec\"],\n\t\tmonth_short: [\"Led\", \"Ún\", \"Bře\", \"Dub\", \"Kvě\", \"Čer\", \"Čec\", \"Srp\", \"Září\", \"Říj\", \"List\", \"Pro\"],\n\t\tday_full: [\"Neděle\", \"Pondělí\", \"Úterý\", \"Středa\", \"Čtvrtek\", \"Pátek\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"Út\", \"St\", \"Čt\", \"Pá\", \"So\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nová práce\",\n\t\ticon_save: \"Uložit\",\n\t\ticon_cancel: \"Zpět\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Smazat\",\n\t\tconfirm_closing: \"\", // Vaše změny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Událost bude trvale smazána, opravdu?\",\n\t\tsection_description: \"Poznámky\",\n\t\tsection_time: \"Doba platnosti\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Zpět\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marts\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Søndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lørdag\"],\n\t\tday_short: [\"Søn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lør\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny opgave\",\n\t\ticon_save: \"Gem\",\n\t\ticon_cancel: \"Fortryd\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Tilret\",\n\t\ticon_delete: \"Slet\",\n\t\tconfirm_closing: \"Dine rettelser vil gå tabt.. Er dy sikker?\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Bigivenheden vil blive slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Fortryd\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\" Januar\", \" Februar\", \" März \", \" April\", \" Mai\", \" Juni\", \" Juli\", \" August\", \" September \", \" Oktober\", \" November \", \" Dezember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mär\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Sonntag\", \"Montag\", \"Dienstag\", \" Mittwoch\", \" Donnerstag\", \"Freitag\", \"Samstag\"],\n\t\tday_short: [\"So\", \"Mo\", \"Di\", \"Mi\", \"Do\", \"Fr\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Neue Aufgabe\",\n\t\ticon_save: \"Speichern\",\n\t\ticon_cancel: \"Abbrechen\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Ändern\",\n\t\ticon_delete: \"Löschen\",\n\t\tconfirm_closing: \"\", // \"Ihre Veränderungen werden verloren sein, wollen Sie ergänzen? \"\n\t\tconfirm_deleting: \"Der Eintrag wird gelöscht\",\n\t\tsection_description: \"Beschreibung\",\n\t\tsection_time: \"Zeitspanne\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"PSP\",\n\t\tcolumn_text: \"Task-Namen\",\n\t\tcolumn_start_date: \"Startzeit\",\n\t\tcolumn_duration: \"Dauer\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"werden gelöscht\",\n\t\tlink_start: \"(starten)\",\n\t\tlink_end: \"(ende)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuten\",\n\t\thours: \"Stunden\",\n\t\tdays: \"Tage\",\n\t\tweeks: \"Wochen\",\n\t\tmonths: \"Monate\",\n\t\tyears: \"Jahre\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Abbrechen\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Regel\",\n\t\tconstraint_type: \"Regel\",\n\t\tconstraint_date: \"Regel - Datum\",\n\t\tasap: \"So bald wie möglich\",\n\t\talap: \"So spät wie möglich\",\n\t\tsnet: \"Beginn nicht vor\",\n\t\tsnlt: \"Beginn nicht später als\",\n\t\tfnet: \"Fertigstellung nicht vor\",\n\t\tfnlt: \"Fertigstellung nicht später als\",\n\t\tmso: \"Muss beginnen am\",\n\t\tmfo: \"Muss fertig sein am\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ιανουάριος\", \"Φεβρουάριος\", \"Μάρτιος\", \"Απρίλιος\", \"Μάϊος\", \"Ιούνιος\", \"Ιούλιος\", \"Αύγουστος\", \"Σεπτέμβριος\", \"Οκτώβριος\", \"Νοέμβριος\", \"Δεκέμβριος\"],\n\t\tmonth_short: [\"ΙΑΝ\", \"ΦΕΒ\", \"ΜΑΡ\", \"ΑΠΡ\", \"ΜΑΙ\", \"ΙΟΥΝ\", \"ΙΟΥΛ\", \"ΑΥΓ\", \"ΣΕΠ\", \"ΟΚΤ\", \"ΝΟΕ\", \"ΔΕΚ\"],\n\t\tday_full: [\"Κυριακή\", \"Δευτέρα\", \"Τρίτη\", \"Τετάρτη\", \"Πέμπτη\", \"Παρασκευή\", \"Κυριακή\"],\n\t\tday_short: [\"ΚΥ\", \"ΔΕ\", \"ΤΡ\", \"ΤΕ\", \"ΠΕ\", \"ΠΑ\", \"ΣΑ\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Νέα εργασία\",\n\t\ticon_save: \"Αποθήκευση\",\n\t\ticon_cancel: \"Άκυρο\",\n\t\ticon_details: \"Λεπτομέρειες\",\n\t\ticon_edit: \"Επεξεργασία\",\n\t\ticon_delete: \"Διαγραφή\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Το έργο θα διαγραφεί οριστικά. Θέλετε να συνεχίσετε;\",\n\t\tsection_description: \"Περιγραφή\",\n\t\tsection_time: \"Χρονική περίοδος\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Άκυρο\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n\t\tday_short: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"New task\",\n\t\ticon_save: \"Save\",\n\t\ticon_cancel: \"Cancel\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Delete\",\n\t\tconfirm_closing: \"\",// Your changes will be lost, are you sure?\n\t\tconfirm_deleting: \"Task will be deleted permanently, are you sure?\",\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Time period\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancel\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;","/*\n @Autor Manuel Fernandez Panzuela - www.mfernandez.es\n\n Update 30/10/2015:\n Translation of new labels by Jorge Macias\n https://disqus.com/by/disqus_bTuZk1voC7/\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\n\t\tmonth_short: [\"Ene\", \"Feb\", \"Mar\", \"Abr\", \"May\", \"Jun\", \"Jul\", \"Ago\", \"Sep\", \"Oct\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domingo\", \"Lunes\", \"Martes\", \"Miércoles\", \"Jueves\", \"Viernes\", \"Sábado\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mié\", \"Jue\", \"Vie\", \"Sáb\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nueva tarea\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalles\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Eliminar\",\n\t\tconfirm_closing: \"\", // \"Sus cambios se perderán, continuar ?\"\n\t\tconfirm_deleting: \"El evento se borrará definitivamente, ¿continuar?\",\n\t\tsection_description: \"Descripción\",\n\t\tsection_time: \"Período\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"EDT\",\n\t\tcolumn_text: \"Tarea\",\n\t\tcolumn_start_date: \"Inicio\",\n\t\tcolumn_duration: \"Duración\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Enlace\",\n\t\tconfirm_link_deleting: \"será borrada\",\n\t\tlink_start: \" (inicio)\",\n\t\tlink_end: \" (fin)\",\n\n\t\ttype_task: \"Tarea\",\n\t\ttype_project: \"Proyecto\",\n\t\ttype_milestone: \"Hito\",\n\n\n\t\tminutes: \"Minutos\",\n\t\thours: \"Horas\",\n\t\tdays: \"Días\",\n\t\tweeks: \"Semanas\",\n\t\tmonths: \"Meses\",\n\t\tyears: \"Años\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancelar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n dhtmlxGantt Persian (Farsi, fa_IR) locale by Mohammad Shokri http://slashsbin.com/\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\n\t\t\t\"ژانویه\",\n\t\t\t\"فوریه\",\n\t\t\t\"مارس\",\n\t\t\t\"آوریل\",\n\t\t\t\"مه\",\n\t\t\t\"ژوئن\",\n\t\t\t\"ژوئیه\",\n\t\t\t\"اوت\",\n\t\t\t\"سپتامبر\",\n\t\t\t\"اکتبر\",\n\t\t\t\"نوامبر\",\n\t\t\t\"دسامبر\"\n\t\t],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\n\t\t\t\"يکشنبه\",\n\t\t\t\"دوشنبه\",\n\t\t\t\"سه‌شنبه\",\n\t\t\t\"چهارشنبه\",\n\t\t\t\"پنجشنبه\",\n\t\t\t\"جمعه\",\n\t\t\t\"شنبه\"\n\t\t],\n\t\tday_short: [\n\t\t\t\"ی\",\n\t\t\t\"د\",\n\t\t\t\"س\",\n\t\t\t\"چ\",\n\t\t\t\"پ\",\n\t\t\t\"ج\",\n\t\t\t\"ش\"\n\t\t]\n\t},\n\tlabels: {\n\t\tnew_task: \"وظیفه جدید\",\n\t\ticon_save: \"ذخیره\",\n\t\ticon_cancel: \"لغو\",\n\t\ticon_details: \"جزییات\",\n\t\ticon_edit: \"ویرایش\",\n\t\ticon_delete: \"حذف\",\n\t\tconfirm_closing: \"تغییرات شما ازدست خواهد رفت، آیا مطمئن هستید؟\",\n\t\tconfirm_deleting: \"این مورد برای همیشه حذف خواهد شد، آیا مطمئن هستید؟\",\n\t\tsection_description: \"توضیحات\",\n\t\tsection_time: \"مدت زمان\",\n\t\tsection_type: \"نوع\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"عنوان\",\n\t\tcolumn_start_date: \"زمان شروع\",\n\t\tcolumn_duration: \"مدت\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"ارتباط\",\n\t\tconfirm_link_deleting: \"حذف خواهد شد\",\n\t\tlink_start: \" (آغاز)\",\n\t\tlink_end: \" (پایان)\",\n\n\t\ttype_task: \"وظیفه\",\n\t\ttype_project: \"پروژه\",\n\t\ttype_milestone: \"نگارش\",\n\n\t\tminutes: \"دقایق\",\n\t\thours: \"ساعات\",\n\t\tdays: \"روزها\",\n\t\tweeks: \"هفته\",\n\t\tmonths: \"ماه‌ها\",\n\t\tyears: \"سال‌ها\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"تایید\",\n\t\tmessage_cancel: \"لغو\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Tammikuu\", \"Helmikuu\", \"Maaliskuu\", \"Huhtikuu\", \"Toukokuu\", \"Kes&auml;kuu\", \"Hein&auml;kuu\", \"Elokuu\", \"Syyskuu\", \"Lokakuu\", \"Marraskuu\", \"Joulukuu\"],\n\t\tmonth_short: [\"Tam\", \"Hel\", \"Maa\", \"Huh\", \"Tou\", \"Kes\", \"Hei\", \"Elo\", \"Syy\", \"Lok\", \"Mar\", \"Jou\"],\n\t\tday_full: [\"Sunnuntai\", \"Maanantai\", \"Tiistai\", \"Keskiviikko\", \"Torstai\", \"Perjantai\", \"Lauantai\"],\n\t\tday_short: [\"Su\", \"Ma\", \"Ti\", \"Ke\", \"To\", \"Pe\", \"La\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Uusi tehtävä\",\n\t\ticon_save: \"Tallenna\",\n\t\ticon_cancel: \"Peru\",\n\t\ticon_details: \"Tiedot\",\n\t\ticon_edit: \"Muokkaa\",\n\t\ticon_delete: \"Poista\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Haluatko varmasti poistaa tapahtuman?\",\n\t\tsection_description: \"Kuvaus\",\n\t\tsection_time: \"Aikajakso\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Peru\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janvier\", \"Février\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Août\", \"Septembre\", \"Octobre\", \"Novembre\", \"Décembre\"],\n\t\tmonth_short: [\"Jan\", \"Fév\", \"Mar\", \"Avr\", \"Mai\", \"Juin\", \"Juil\", \"Aoû\", \"Sep\", \"Oct\", \"Nov\", \"Déc\"],\n\t\tday_full: [\"Dimanche\", \"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\"],\n\t\tday_short: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nouvelle tâche\",\n\t\ticon_save: \"Enregistrer\",\n\t\ticon_cancel: \"Annuler\",\n\t\ticon_details: \"Détails\",\n\t\ticon_edit: \"Modifier\",\n\t\ticon_delete: \"Effacer\",\n\t\tconfirm_closing: \"\",// Vos modifications seront perdus, êtes-vous sûr ?\n\t\tconfirm_deleting: \"L'événement sera effacé sans appel, êtes-vous sûr ?\",\n\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Période\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"OTP\",\n\t\tcolumn_text: \"Nom de la tâche\",\n\t\tcolumn_start_date: \"Date initiale\",\n\t\tcolumn_duration: \"Durée\",\n\t\tcolumn_add: \"\",\n\n\n\t\t/* link confirmation */\n\t\tlink: \"Le lien\",\n\t\tconfirm_link_deleting: \"sera supprimé\",\n\t\tlink_start: \"(début)\",\n\t\tlink_end: \"(fin)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Heures\",\n\t\tdays: \"Jours\",\n\t\tweeks: \"Semaines\",\n\t\tmonths: \"Mois\",\n\t\tyears: \"Années\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Annuler\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"ינואר\", \"פברואר\", \"מרץ\", \"אפריל\", \"מאי\", \"יוני\", \"יולי\", \"אוגוסט\", \"ספטמבר\", \"אוקטובר\", \"נובמבר\", \"דצמבר\"],\n\t\tmonth_short: [\"ינו\", \"פבר\", \"מרץ\", \"אפר\", \"מאי\", \"יונ\", \"יול\", \"אוג\", \"ספט\", \"אוק\", \"נוב\", \"דצמ\"],\n\t\tday_full: [\"ראשון\", \"שני\", \"שלישי\", \"רביעי\", \"חמישי\", \"שישי\", \"שבת\"],\n\t\tday_short: [\"א\", \"ב\", \"ג\", \"ד\", \"ה\", \"ו\", \"ש\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"משימה חדש\",\n\t\ticon_save: \"שמור\",\n\t\ticon_cancel: \"בטל\",\n\t\ticon_details: \"פרטים\",\n\t\ticon_edit: \"ערוך\",\n\t\ticon_delete: \"מחק\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"ארוע ימחק סופית.להמשיך?\",\n\t\tsection_description: \"הסבר\",\n\t\tsection_time: \"תקופה\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"בטל\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n  Translation by Davor\n http://docs.dhtmlx.com/gantt/desktop__localization.html#comment-2569116291\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Siječanj\", \"Veljača\", \"Ožujak\", \"Travanj\", \"Svibanj\", \"Lipanj\", \"Srpanj\", \"Kolovoz\", \"Rujan\", \"Listopad\", \"Studeni\", \"Prosinac\"],\n\t\tmonth_short: [\"Sij\", \"Velj\", \"Ožu\", \"Tra\", \"Svi\", \"Lip\", \"Srp\", \"Kol\", \"Ruj\", \"Lis\", \"Stu\", \"Pro\"],\n\t\tday_full: [\"Nedjelja\", \"Ponedjeljak\", \"Utorak\", \"Srijeda\", \"Četvrtak\", \"Petak\", \"Subota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Uto\", \"Sri\", \"Čet\", \"Pet\", \"Sub\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Novi Zadatak\",\n\t\ticon_save: \"Spremi\",\n\t\ticon_cancel: \"Odustani\",\n\t\ticon_details: \"Detalji\",\n\t\ticon_edit: \"Izmjeni\",\n\t\ticon_delete: \"Obriši\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"Zadatak će biti trajno izbrisan, jeste li sigurni?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Vremenski Period\",\n\t\tsection_type: \"Tip\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Naziv Zadatka\",\n\t\tcolumn_start_date: \"Početno Vrijeme\",\n\t\tcolumn_duration: \"Trajanje\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Poveznica\",\n\t\tconfirm_link_deleting: \"će biti izbrisan\",\n\t\tlink_start: \" (početak)\",\n\t\tlink_end: \" (kraj)\",\n\n\t\ttype_task: \"Zadatak\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minute\",\n\t\thours: \"Sati\",\n\t\tdays: \"Dani\",\n\t\tweeks: \"Tjedni\",\n\t\tmonths: \"Mjeseci\",\n\t\tyears: \"Godine\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Odustani\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Január\", \"Február\", \"Március\", \"Április\", \"Május\", \"Június\", \"Július\", \"Augusztus\", \"Szeptember\", \"Október\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Már\", \"Ápr\", \"Máj\", \"Jún\", \"Júl\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Vasárnap\", \"Hétfõ\", \"Kedd\", \"Szerda\", \"Csütörtök\", \"Péntek\", \"szombat\"],\n\t\tday_short: [\"Va\", \"Hé\", \"Ke\", \"Sze\", \"Csü\", \"Pé\", \"Szo\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Új feladat\",\n\t\ticon_save: \"Mentés\",\n\t\ticon_cancel: \"Mégse\",\n\t\ticon_details: \"Részletek\",\n\t\ticon_edit: \"Szerkesztés\",\n\t\ticon_delete: \"Törlés\",\n\t\tconfirm_closing: \"\", // A változások elvesznek, biztosan folytatja? \"\n\t\tconfirm_deleting: \"Az esemény törölve lesz, biztosan folytatja?\",\n\t\tsection_description: \"Leírás\",\n\t\tsection_time: \"Idõszak\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Mégse\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Ags\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Minggu\", \"Senin\", \"Selasa\", \"Rabu\", \"Kamis\", \"Jumat\", \"Sabtu\"],\n\t\tday_short: [\"Ming\", \"Sen\", \"Sel\", \"Rab\", \"Kam\", \"Jum\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Tugas baru\",\n\t\ticon_save: \"Simpan\",\n\t\ticon_cancel: \"Batal\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Hapus\",\n\t\tconfirm_closing: \"\", /* Perubahan tidak akan disimpan ? */\n\t\tconfirm_deleting: \"Acara akan dihapus\",\n\t\tsection_description: \"Keterangan\",\n\t\tsection_time: \"Periode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Batal\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n Update 29/12/2015:\n New labels translation by ARCANGELI CLAUDIO\n\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Giugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Apr\", \"Mag\", \"Giu\", \"Lug\", \"Ago\", \"Set\", \"Ott\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domenica\", \"Lunedì\", \"Martedì\", \"Mercoledì\", \"Giovedì\", \"Venerdì\", \"Sabato\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nuovo compito\",\n\t\ticon_save: \"Salva\",\n\t\ticon_cancel: \"Chiudi\",\n\t\ticon_details: \"Dettagli\",\n\t\ticon_edit: \"Modifica\",\n\t\ticon_delete: \"Elimina\",\n\t\tconfirm_closing: \"\",// \"Sei sicuro di confermare la chiusura?\",\n\t\tconfirm_deleting: \"Sei sicuro di confermare l'eliminazione?\",\n\t\tsection_description: \"Descrizione\",\n\t\tsection_time: \"Periodo di tempo\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Nome Attività\",\n\t\tcolumn_start_date: \"Inizio\",\n\t\tcolumn_duration: \"Durata\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"sarà eliminato\",\n\t\tlink_start: \" (inizio)\",\n\t\tlink_end: \" (fine)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuti\",\n\t\thours: \"Ore\",\n\t\tdays: \"Giorni\",\n\t\tweeks: \"Settimane\",\n\t\tmonths: \"Mesi\",\n\t\tyears: \"Anni\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Chiudi\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n Translation by Genexus Japan Inc.\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\n\t\tmonth_short: [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"],\n\t\tday_full: [\"日曜日\", \"月曜日\", \"火曜日\", \"水曜日\", \"木曜日\", \"金曜日\", \"土曜日\"],\n\t\tday_short: [\"日\", \"月\", \"火\", \"水\", \"木\", \"金\", \"土\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"新しい仕事\",\n\t\ticon_save: \"保存\",\n\t\ticon_cancel: \"キャンセル\",\n\t\ticon_details: \"詳細\",\n\t\ticon_edit: \"編集\",\n\t\ticon_delete: \"削除\",\n\t\tconfirm_closing: \"\", // 変更が取り消されます、宜しいですか？\n\t\tconfirm_deleting: \"イベント完全に削除されます、宜しいですか？\",\n\t\tsection_description: \"デスクリプション\",\n\t\tsection_time: \"期間\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"キャンセル\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTranslated by cjkim@dbvalley.com\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"1월\", \"2월\", \"3월\", \"4월\", \"5월\", \"6월\", \"7월\", \"8월\", \"9월\", \"10월\", \"11월\", \"12월\"],\n\t\tmonth_short: [\"1월\", \"2월\", \"3월\", \"4월\", \"5월\", \"6월\", \"7월\", \"8월\", \"9월\", \"10월\", \"11월\", \"12월\"],\n\t\tday_full: [\"일요일\", \"월요일\", \"화요일\", \"수요일\", \"목요일\", \"금요일\", \"토요일\"],\n\t\tday_short: [\"일\", \"월\", \"화\", \"수\", \"목\", \"금\", \"토\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"이름없는 작업\",\n\t\ticon_save: \"저장\",\n\t\ticon_cancel: \"취소\",\n\t\ticon_details: \"세부 사항\",\n\t\ticon_edit: \"수정\",\n\t\ticon_delete: \"삭제\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"작업을 삭제하시겠습니까?\",\n\t\tsection_description: \"설명\",\n\t\tsection_time: \"기간\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"작업명\",\n\t\tcolumn_start_date: \"시작일\",\n\t\tcolumn_duration: \"기간\",\n\t\tcolumn_add: \"\",\n\t\tlink: \"전제\",\n\t\tconfirm_link_deleting: \"삭제 하시겠습니까?\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\t\ttype_task: \"작업\",\n\t\ttype_project: \"프로젝트\",\n\t\ttype_milestone: \"마일스톤\",\n\t\tminutes: \"분\",\n\t\thours: \"시간\",\n\t\tdays: \"일\",\n\t\tweeks: \"주\",\n\t\tmonths: \"달\",\n\t\tyears: \"년\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"취소\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","export default class LocaleManager{\n\tprivate _locales:{[key:string]: IGanttLocale };\n\n\tconstructor(config: {[key:string]: IGanttLocale }){\n\t\tthis._locales = {};\n\t\tfor(const i in config){\n\t\t\tthis._locales[i] = config[i];\n\t\t}\n\t}\n\n\taddLocale = (name: string, locale: IGanttLocale) => {\n\t\tthis._locales[name] = locale;\n\t};\n\n\tgetLocale = (name: string): IGanttLocale => {\n\t\treturn this._locales[name];\n\t};\n}","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Søndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lørdag\"],\n\t\tday_short: [\"Søn\", \"Mon\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lør\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny oppgave\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Rediger\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Hendelsen vil bli slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maart\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Augustus\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"mrt\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Zondag\", \"Maandag\", \"Dinsdag\", \"Woensdag\", \"Donderdag\", \"Vrijdag\", \"Zaterdag\"],\n\t\tday_short: [\"Zo\", \"Ma\", \"Di\", \"Wo\", \"Do\", \"Vr\", \"Za\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nieuwe taak\",\n\t\ticon_save: \"Opslaan\",\n\t\ticon_cancel: \"Annuleren\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Bewerken\",\n\t\ticon_delete: \"Verwijderen\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Item zal permanent worden verwijderd, doorgaan?\",\n\t\tsection_description: \"Beschrijving\",\n\t\tsection_time: \"Tijd periode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Taak omschrijving\",\n\t\tcolumn_start_date: \"Startdatum\",\n\t\tcolumn_duration: \"Duur\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Koppeling\",\n\t\tconfirm_link_deleting: \"zal worden verwijderd\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (eind)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"minuten\",\n\t\thours: \"uren\",\n\t\tdays: \"dagen\",\n\t\tweeks: \"weken\",\n\t\tmonths: \"maanden\",\n\t\tyears: \"jaren\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Annuleren\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Søndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lørdag\"],\n\t\tday_short: [\"Søn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lør\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny oppgave\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Endre\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"Endringer blir ikke lagret, er du sikker?\", // Endringer blir ikke lagret, er du sikker?\n\t\tconfirm_deleting: \"Oppføringen vil bli slettet, er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Styczeń\", \"Luty\", \"Marzec\", \"Kwiecień\", \"Maj\", \"Czerwiec\", \"Lipiec\", \"Sierpień\", \"Wrzesień\", \"Październik\", \"Listopad\", \"Grudzień\"],\n\t\tmonth_short: [\"Sty\", \"Lut\", \"Mar\", \"Kwi\", \"Maj\", \"Cze\", \"Lip\", \"Sie\", \"Wrz\", \"Paź\", \"Lis\", \"Gru\"],\n\t\tday_full: [\"Niedziela\", \"Poniedziałek\", \"Wtorek\", \"Środa\", \"Czwartek\", \"Piątek\", \"Sobota\"],\n\t\tday_short: [\"Nie\", \"Pon\", \"Wto\", \"Śro\", \"Czw\", \"Pią\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nowe zadanie\",\n\t\ticon_save: \"Zapisz\",\n\t\ticon_cancel: \"Anuluj\",\n\t\ticon_details: \"Szczegóły\",\n\t\ticon_edit: \"Edytuj\",\n\t\ticon_delete: \"Usuń\",\n\t\tconfirm_closing: \"\", // Zmiany zostaną usunięte, jesteś pewien?\n\t\tconfirm_deleting: \"Zdarzenie zostanie usunięte na zawsze, kontynuować?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Okres czasu\",\n\t\tsection_type: \"Typ\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Nazwa zadania\",\n\t\tcolumn_start_date: \"Początek\",\n\t\tcolumn_duration: \"Czas trwania\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"zostanie usunięty\",\n\t\tlink_start: \" (początek)\",\n\t\tlink_end: \" (koniec)\",\n\n\t\ttype_task: \"Zadanie\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuty\",\n\t\thours: \"Godziny\",\n\t\tdays: \"Dni\",\n\t\tweeks: \"Tydzień\",\n\t\tmonths: \"Miesiące\",\n\t\tyears: \"Lata\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Anuluj\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\n TRANSLATION BY MATTHEUS PIROVANI RORIZ GONЗALVES\n\n mattheusroriz@hotmail.com / mattheus.pirovani@gmail.com /\n\n www.atrixian.com.br\n\n\n Updated by Jorge Albernaz Martins\n\n jorgefox@hotmail.com\n\n www.redfox.inf.br\n\n JorgeFox\n\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janeiro\", \"Fevereiro\", \"Março\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"],\n\t\tmonth_short: [\"Jan\", \"Fev\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Out\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Domingo\", \"Segunda\", \"Terça\", \"Quarta\", \"Quinta\", \"Sexta\", \"Sábado\"],\n\t\tday_short: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova tarefa\",\n\t\ticon_save: \"Salvar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalhes\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Excluir\",\n\t\tconfirm_closing: \"\",// Suas alterações serão perdidas, confirme?\n\t\tconfirm_deleting: \"As tarefas serão excluidas permanentemente, confirme?\",\n\t\tsection_description: \"Descrição\",\n\t\tsection_time: \"Período\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"EAP\",\n\t\tcolumn_text: \"Nome tarefa\",\n\t\tcolumn_start_date: \"Data início\",\n\t\tcolumn_duration: \"Duração\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"Será excluído!\",\n\t\tlink_start: \" (início)\",\n\t\tlink_end: \" (fim)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Projeto\",\n\t\ttype_milestone: \"Marco\",\n\n\n\t\tminutes: \"Minutos\",\n\t\thours: \"Horas\",\n\t\tdays: \"Dias\",\n\t\tweeks: \"Semanas\",\n\t\tmonths: \"Meses\",\n\t\tyears: \"Anos\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancelar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Restrição\",\n\t\tconstraint_type: \"Tipo Restrição\",\n\t\tconstraint_date: \"Data restrição\",\n\t\tasap: \"Mais breve possível\",\n\t\talap: \"Mais tarde possível\",\n\t\tsnet: \"Não começar antes de\",\n\t\tsnlt: \"Não começar depois de\",\n\t\tfnet: \"Não terminar antes de\",\n\t\tfnlt: \"Não terminar depois de\",\n\t\tmso: \"Precisa começar em\",\n\t\tmfo: \"Precisa terminar em\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"Tipo de filtros\",\n\t\tresources_filter_label: \"Ocultar vazios\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTraducere de Ovidiu Lixandru: http://www.madball.ro\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ianuarie\", \"Februarie\", \"Martie\", \"Aprilie\", \"Mai\", \"Iunie\", \"Iulie\", \"August\", \"Septembrie\", \"Octombrie\", \"November\", \"December\"],\n\t\tmonth_short: [\"Ian\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Iun\", \"Iul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Duminica\", \"Luni\", \"Marti\", \"Miercuri\", \"Joi\", \"Vineri\", \"Sambata\"],\n\t\tday_short: [\"Du\", \"Lu\", \"Ma\", \"Mi\", \"Jo\", \"Vi\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Sarcina noua\",\n\t\ticon_save: \"Salveaza\",\n\t\ticon_cancel: \"Anuleaza\",\n\t\ticon_details: \"Detalii\",\n\t\ticon_edit: \"Editeaza\",\n\t\ticon_delete: \"Sterge\",\n\t\tconfirm_closing: \"Schimbarile nu vor fi salvate, esti sigur?\",// Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Evenimentul va fi sters permanent, esti sigur?\",\n\t\tsection_description: \"Descriere\",\n\t\tsection_time: \"Interval\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Anuleaza\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Январь\", \"Февраль\", \"Март\", \"Апрель\", \"Maй\", \"Июнь\", \"Июль\", \"Август\", \"Сентябрь\", \"Oктябрь\", \"Ноябрь\", \"Декабрь\"],\n\t\tmonth_short: [\"Янв\", \"Фев\", \"Maр\", \"Aпр\", \"Maй\", \"Июн\", \"Июл\", \"Aвг\", \"Сен\", \"Окт\", \"Ноя\", \"Дек\"],\n\t\tday_full: [\"Воскресенье\", \"Понедельник\", \"Вторник\", \"Среда\", \"Четверг\", \"Пятница\", \"Суббота\"],\n\t\tday_short: [\"Вс\", \"Пн\", \"Вт\", \"Ср\", \"Чт\", \"Пт\", \"Сб\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Новое задание\",\n\t\ticon_save: \"Сохранить\",\n\t\ticon_cancel: \"Отменить\",\n\t\ticon_details: \"Детали\",\n\t\ticon_edit: \"Изменить\",\n\t\ticon_delete: \"Удалить\",\n\t\tconfirm_closing: \"\", // Ваши изменения будут потеряны, продолжить?\n\t\tconfirm_deleting: \"Событие будет удалено безвозвратно, продолжить?\",\n\t\tsection_description: \"Описание\",\n\t\tsection_time: \"Период времени\",\n\t\tsection_type: \"Тип\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"ИСР\",\n\t\tcolumn_text: \"Задача\",\n\t\tcolumn_start_date: \"Начало\",\n\t\tcolumn_duration: \"Длительность\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Связь\",\n\t\tconfirm_link_deleting: \"будет удалена\",\n\t\tlink_start: \" (начало)\",\n\t\tlink_end: \" (конец)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Минута\",\n\t\thours: \"Час\",\n\t\tdays: \"День\",\n\t\tweeks: \"Неделя\",\n\t\tmonths: \"Месяц\",\n\t\tyears: \"Год\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Отменить\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"начните вводить слово для фильтрации\",\n\t\tresources_filter_label: \"спрятать не установленные\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marec\", \"April\", \"Maj\", \"Junij\", \"Julij\", \"Avgust\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedelja\", \"Ponedeljek\", \"Torek\", \"Sreda\", \"Četrtek\", \"Petek\", \"Sobota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Tor\", \"Sre\", \"Čet\", \"Pet\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova naloga\",\n\t\ticon_save: \"Shrani\",\n\t\ticon_cancel: \"Prekliči\",\n\t\ticon_details: \"Podrobnosti\",\n\t\ticon_edit: \"Uredi\",\n\t\ticon_delete: \"Izbriši\",\n\t\tconfirm_closing: \"\", // Spremembe ne bodo shranjene. Želite nadaljevati ?\n\t\tconfirm_deleting: \"Dogodek bo izbrisan. Želite nadaljevati?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Časovni okvir\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Prekliči\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Január\", \"Február\", \"Marec\", \"Apríl\", \"Máj\", \"Jún\", \"Júl\", \"August\", \"September\", \"Október\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Máj\", \"Jún\", \"Júl\", \"Aug\", \"Sept\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedeľa\", \"Pondelok\", \"Utorok\", \"Streda\", \"Štvrtok\", \"Piatok\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"Ut\", \"St\", \"Št\", \"Pi\", \"So\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nová úloha\",\n\t\ticon_save: \"Uložiť\",\n\t\ticon_cancel: \"Späť\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Zmazať\",\n\t\tconfirm_closing: \"Vaše zmeny nebudú uložené. Skutočne?\", // Vaše změny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Udalosť bude natrvalo vymazaná. Skutočne?\",\n\t\tsection_description: \"Poznámky\",\n\t\tsection_time: \"Doba platnosti\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Späť\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTranslation by Peter Eriksson\n */\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Söndag\", \"Måndag\", \"Tisdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lördag\"],\n\t\tday_short: [\"Sön\", \"Mån\", \"Tis\", \"Ons\", \"Tor\", \"Fre\", \"Lör\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny uppgift\",\n\t\ticon_save: \"Spara\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detajer\",\n\t\ticon_edit: \"Ändra\",\n\t\ticon_delete: \"Ta bort\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"Är du säker på att du vill ta bort händelsen permanent?\",\n\t\tsection_description: \"Beskrivning\",\n\t\tsection_time: \"Tid\",\n\t\tsection_type: \"Typ\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Uppgiftsnamn\",\n\t\tcolumn_start_date: \"Starttid\",\n\t\tcolumn_duration: \"Varaktighet\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\n\t\tlink: \"Länk\",\n\t\tconfirm_link_deleting: \"kommer tas bort\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (slut)\",\n\t\ttype_task: \"Uppgift\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milstolpe\",\n\n\t\tminutes: \"Minuter\",\n\t\thours: \"Timmar\",\n\t\tdays: \"Dagar\",\n\t\tweeks: \"Veckor\",\n\t\tmonths: \"Månader\",\n\t\tyears: \"År\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n * updated by @levkar at https://github.com/DHTMLX/gantt/pull/10\n */\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ocak\", \"Şubat\", \"Mart\", \"Nisan\", \"Mayıs\", \"Haziran\", \"Temmuz\", \"Ağustos\", \"Eylül\", \"Ekim\", \"Kasım\", \"Aralık\"],\n\t\tmonth_short: [\"Oca\", \"Şub\", \"Mar\", \"Nis\", \"May\", \"Haz\", \"Tem\", \"Ağu\", \"Eyl\", \"Eki\", \"Kas\", \"Ara\"],\n\t\tday_full: [\"Pazar\", \"Pazartesi\", \"Salı\", \"Çarşamba\", \"Perşembe\", \"Cuma\", \"Cumartesi\"],\n\t\tday_short: [\"Paz\", \"Pzt\", \"Sal\", \"Çar\", \"Per\", \"Cum\", \"Cmt\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Yeni görev\",\n\t\ticon_save: \"Kaydet\",\n\t\ticon_cancel: \"İptal\",\n\t\ticon_details: \"Detaylar\",\n\t\ticon_edit: \"Düzenle\",\n\t\ticon_delete: \"Sil\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Görev silinecek, emin misiniz?\",\n\t\tsection_description: \"Açıklama\",\n\t\tsection_time: \"Zaman Aralığı\",\n\t\tsection_type: \"Tip\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Görev Adı\",\n\t\tcolumn_start_date: \"Başlangıç\",\n\t\tcolumn_duration: \"Süre\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Bağlantı\",\n\t\tconfirm_link_deleting: \"silinecek\",\n\t\tlink_start: \" (başlangıç)\",\n\t\tlink_end: \" (bitiş)\",\n\n\t\ttype_task: \"Görev\",\n\t\ttype_project: \"Proje\",\n\t\ttype_milestone: \"Kilometretaşı\",\n\n\n\t\tminutes: \"Dakika\",\n\t\thours: \"Saat\",\n\t\tdays: \"Gün\",\n\t\tweeks: \"Hafta\",\n\t\tmonths: \"Ay\",\n\t\tyears: \"Yıl\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Ýptal\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Січень\", \"Лютий\", \"Березень\", \"Квітень\", \"Травень\", \"Червень\", \"Липень\", \"Серпень\", \"Вересень\", \"Жовтень\", \"Листопад\", \"Грудень\"],\n\t\tmonth_short: [\"Січ\", \"Лют\", \"Бер\", \"Кві\", \"Тра\", \"Чер\", \"Лип\", \"Сер\", \"Вер\", \"Жов\", \"Лис\", \"Гру\"],\n\t\tday_full: [\"Неділя\", \"Понеділок\", \"Вівторок\", \"Середа\", \"Четвер\", \"П'ятниця\", \"Субота\"],\n\t\tday_short: [\"Нед\", \"Пон\", \"Вів\", \"Сер\", \"Чет\", \"Птн\", \"Суб\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Нове завдання\",\n\t\ticon_save: \"Зберегти\",\n\t\ticon_cancel: \"Відміна\",\n\t\ticon_details: \"Деталі\",\n\t\ticon_edit: \"Редагувати\",\n\t\ticon_delete: \"Вилучити\",\n\t\tconfirm_closing: \"\", // Ваші зміни втратяться. Ви впевнені ?\n\t\tconfirm_deleting: \"Подія вилучиться назавжди. Ви впевнені?\",\n\t\tsection_description: \"Опис\",\n\t\tsection_time: \"Часовий проміжок\",\n\t\tsection_type: \"Тип\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Відміна\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_filter_placeholder: \"type to filter\",\n\t\tresources_filter_label: \"hide empty\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","import * as utils from \"../utils/utils\";\nimport constants from \"../constants\";\nimport ExtensionManager from \"../ext/extension_manager\";\n\nimport services from \"../core/common/services\";\nimport config from \"../core/common/config\";\nimport ajax from \"../core/common/ajax\";\nimport date from \"../core/common/date\";\nimport {remoteEvents} from \"../core/remote/remote_events\";\n\nimport DnD from \"../core/common/dnd\";\nimport templates from \"../core/common/templates\";\nimport eventable from \"../utils/eventable\";\n\nimport StateService from \"../core/common/state\";\n\nimport Promise from \"../utils/promise\";\nimport env from \"../utils/env\";\nimport datastoreHooks from \"../core/datastore/datastore_hooks\";\nimport DataProcessor from \"../core/dataprocessor\";\n\nimport plugins from \"../core/plugins\";\n\nimport grid_column_api from \"../core/grid_column_api\";\nimport tasks from \"../core/tasks\";\nimport parsing from \"../core/loading/parsing\";\nimport work_time from \"../core/worktime/work_time\";\nimport data from \"../core/data\";\n\nimport void_script_second from \"../publish_helpers/void_script_second\";\n\nimport data_task_types from \"../core/data_task_types\";\nimport cached_functions from \"../core/cached_functions\";\n\nimport gantt_core from \"../core/gantt_core\";\nimport destructor from \"../core/destructor\";\nimport void_script_third from \"../publish_helpers/void_script_third\";\n\nimport i18nFactory from \"../locale\";\n\nfunction DHXGantt(){\n\tthis.constants = constants;\n\tthis.version = VERSION;\n\tthis.license = LICENSE;\n\tthis.templates = {};\n\tthis.ext = {};\n\tthis.keys = {\n\t\tedit_save: this.constants.KEY_CODES.ENTER,\n\t\tedit_cancel: this.constants.KEY_CODES.ESC\n\t};\n}\n\nexport default function(supportedExtensions) {\n\t// use a named constructor to make gantt instance discoverable in heap snapshots\n\tvar gantt = new DHXGantt();\n\n\tvar extensionManager = new ExtensionManager(supportedExtensions);\n\tvar activePlugins = {};\n\tgantt.plugins = function(config){\n\t\tfor(var i in config){\n\t\t\tif(config[i] && !activePlugins[i]){\n\t\t\t\tvar plugin = extensionManager.getExtension(i);\n\t\t\t\tif(plugin){\n\t\t\t\t\tplugin(gantt);\n\t\t\t\t\tactivePlugins[i] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn activePlugins;\n\t};\n\n\tgantt.$services = services();\n\tgantt.config = config();\n\tgantt.ajax =  ajax(gantt);\n\tgantt.date = date(gantt);\n\tgantt.RemoteEvents = remoteEvents;\n\n\tvar dnd = DnD(gantt);\n\tgantt.$services.setService(\"dnd\", function(){return dnd;});\n\n\tvar templatesLoader = templates(gantt);\n\tgantt.$services.setService(\"templateLoader\", function () {\n\t\treturn templatesLoader;\n\t});\n\n\teventable(gantt);\n\n\t\n\tvar stateService = new StateService();\n\n\tstateService.registerProvider(\"global\", function () {\n\t\tvar res = {\n\t\t\tmin_date: gantt._min_date,\n\t\t\tmax_date: gantt._max_date,\n\t\t\tselected_task: null\n\t\t};\n\n\t\t// do not throw error if getState called from non-initialized gantt\n\t\tif(gantt.$data && gantt.$data.tasksStore){\n\t\t\tres.selected_task = gantt.$data.tasksStore.getSelectedId();\n\t\t}\n\t\treturn res;\n\t});\n\tgantt.getState = stateService.getState;\n\tgantt.$services.setService(\"state\", function () {\n\t\treturn stateService;\n\t});\n\n\tutils.mixin(gantt, utils);\n\n\tgantt.Promise = Promise;\n\tgantt.env = env;\n\n\tdatastoreHooks(gantt);\n\n\tgantt.dataProcessor = DataProcessor.DEPRECATED_api;\n\tgantt.createDataProcessor = DataProcessor.createDataProcessor;\n\n\tplugins(gantt);\n\n\tgrid_column_api(gantt);\n\ttasks(gantt);\n\tparsing(gantt);\n\twork_time(gantt);\n\tdata(gantt);\n\n\tvoid_script_second(gantt);\n\n\tdata_task_types(gantt);\n\tcached_functions(gantt);\n\n\tgantt_core(gantt);\n\tdestructor(gantt);\n\tvoid_script_third(gantt);\n\n\tvar i18n = i18nFactory();\n\tgantt.i18n = {\n\t\taddLocale: i18n.addLocale,\n\t\tsetLocale: function(locale){\n\t\t\tif(typeof locale === \"string\"){\n\t\t\t\tvar localeObject = i18n.getLocale(locale);\n\t\t\t\tif(!localeObject){\n\t\t\t\t\tlocaleObject = i18n.getLocale(\"en\");\n\t\t\t\t}\n\n\t\t\t\tgantt.locale = localeObject;\n\t\t\t}else if(locale){\n\t\t\t\tif(!gantt.locale){\n\t\t\t\t\tgantt.locale = locale;\n\t\t\t\t}else{\n\t\t\t\t\tfor(var i in locale){\n\t\t\t\t\t\tif(locale[i] && typeof locale[i] === \"object\"){\n\t\t\t\t\t\t\tif(!gantt.locale[i]){\n\t\t\t\t\t\t\t\tgantt.locale[i] = {};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tgantt.mixin(gantt.locale[i], locale[i], true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tgantt.locale[i] = locale[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetLocale: i18n.getLocale\n\t};\n\tgantt.i18n.setLocale(\"en\");\n\treturn gantt;\n};","export default function(){\n\tvar services = {};\n\tfunction register (name, getter){\n\t\tservices[name] = getter;\n\t}\n\n\tfunction getService(name){\n\t\tif(!services[name]){\n\t\t\treturn null;\n\t\t}\n\t\treturn services[name]();\n\t}\n\n\tfunction dropService(name) {\n\t\tif (services[name]) {\n\t\t\tdelete services[name];\n\t\t}\n\t}\n\n\tvar servicesEnum = {};\n\n\treturn {\n\t\tservices: servicesEnum,\n\t\tsetService: register,\n\t\tgetService: getService,\n\t\tdropService: dropService,\n\t\tdestructor: function(){\n\t\t\tfor(var i in services){\n\t\t\t\tif(services[i]){\n\t\t\t\t\tvar service = services[i];\n\t\t\t\t\tif(service && service.destructor){\n\t\t\t\t\t\tservice.destructor();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tservices = null;\n\t\t}\n\t};\n};\n","import eventable from \"../../utils/eventable\";\nimport * as utils from \"../../utils/utils\";\nimport timeout from \"../../utils/timeout\";\nimport global from \"../../utils/global\";\nimport * as domHelpers from \"../ui/utils/dom_helpers\";\n\nexport default function(gantt){\n\n\tfunction copyDomEvent(e){\n\t\treturn {\n\t\t\ttarget: e.target || e.srcElement,\n\t\t\tpageX: e.pageX,\n\t\t\tpageY: e.pageY,\n\t\t\tclientX: e.clientX,\n\t\t\tclientY: e.clientY,\n\t\t\tmetaKey: e.metaKey,\n\t\t\tshiftKey: e.shiftKey,\n\t\t\tctrlKey: e.ctrlKey,\n\t\t\taltKey: e.altKey\n\t\t};\n\t}\n\n\tfunction DnD(obj, config) {\n\t\tthis._obj = obj;\n\t\tthis._settings = config || {};\n\t\teventable(this);\n\n\t\tvar inputMethods = this.getInputMethods();\n\n\t\tthis._drag_start_timer = null;\n\t\tgantt.attachEvent(\"onGanttScroll\", utils.bind(function (left, top) {\n\t\t\tthis.clearDragTimer();\n\t\t}, this));\n\n\t\tvar lastDown = 0;\n\t\tvar eventParams = {passive: false};\n\t\tfor(var i = 0; i < inputMethods.length; i++){\n\t\t\t(utils.bind(function(input){\n\n\t\t\t\tgantt.event(obj, input.down, utils.bind(function (e) {\n\t\t\t\t\tif(!input.accessor(e)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof e.button !== 'undefined' && e.button !== 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(config.preventDefault && config.selector && domHelpers.closest(e.target, config.selector)){\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (gantt.config.touch && e.timeStamp && e.timeStamp - lastDown < 300) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._settings.original_target = copyDomEvent(e);\n\n\t\t\t\t\tthis._settings.original_element_sizes = {\n\t\t\t\t\t\t...domHelpers.getRelativeEventPosition(e, domHelpers.getClosestSizedElement(obj)), \n\t\t\t\t\t\twidth: e.target.offsetWidth,\n\t\t\t\t\t\theight: e.target.offsetHeight\n\t\t\t\t\t};\n\n\t\t\t\t\tif (gantt.config.touch) {\n\t\t\t\t\t\tthis.clearDragTimer();\n\t\t\t\t\t\tthis._drag_start_timer = setTimeout(utils.bind(function () {\n\t\t\t\t\t\t\tif(gantt.getState().lightbox){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.dragStart(obj, e, input);\n\t\t\t\t\t\t}, this), gantt.config.touch_drag);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.dragStart(obj, e, input);\n\t\t\t\t\t}\n\t\t\t\t}, this), eventParams);\n\t\t\t\tvar eventElement = document.body;\n\t\t\t\tgantt.event(eventElement, input.up, utils.bind(function (e) {\n\t\t\t\t\tif(!input.accessor(e)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.clearDragTimer();\n\t\t\t\t}, this), eventParams);\n\n\t\t\t}, this))(inputMethods[i]);\n\t\t}\n\t}\n\n\tDnD.prototype = {\n\t\ttraceDragEvents: function (domElement, inputMethod) {\n\t\t\tvar mousemove = utils.bind(function (e) {\n\t\t\t\treturn this.dragMove(domElement, e, inputMethod.accessor);\n\t\t\t}, this);\n\t\t\tutils.bind(function (e) {\n\t\t\t\treturn this.dragScroll(domElement, e);\n\t\t\t}, this);\n\n\t\t\tvar limited_mousemove = utils.bind(function (e) {\n\t\t\t\tif (this.config.started && utils.defined(this.config.updates_per_second)) {\n\t\t\t\t\tif (!timeout(this, this.config.updates_per_second))\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar dndActive = mousemove(e);\n\n\t\t\t\tif (dndActive) {\n\t\t\t\t\ttry{\n\t\t\t\t\t\tif (e && e.preventDefault && e.cancelable){//e.cancelable condition - because navigator.vibrate is blocked by Chrome\n\t\t\t\t\t\t\te.preventDefault();//Cancel default action on DND\n\t\t\t\t\t\t} //Cancel default action on DND\n\t\t\t\t\t}catch (e){\n\t\t\t\t\t\t// just suppress the exception, nothing needed to be done here\n\t\t\t\t\t}\n\n\t\t\t\t\t//e.cancelBubble = true;\n\t\t\t\t}\n\n\t\t\t\treturn dndActive;\n\t\t\t}, this);\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root);\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || domHelpers.getRootNode(gantt.$root);\n\n\t\t\tvar eventParams = {passive: false};\n\t\t\tvar mouseup = utils.bind(function (e) {\n\t\t\t\tgantt.eventRemove(mousemoveContainer, inputMethod.move, limited_mousemove);\n\t\t\t\tgantt.eventRemove(eventElement, inputMethod.up, mouseup, eventParams);\n\t\t\t\treturn this.dragEnd(domElement);\n\t\t\t}, this);\n\n\t\t\tgantt.event(mousemoveContainer, inputMethod.move, limited_mousemove, eventParams);\n\t\t\tgantt.event(eventElement, inputMethod.up, mouseup, eventParams);\n\t\t},\n\t\tcheckPositionChange: function (pos) {\n\t\t\tvar diff_x = pos.x - this.config.pos.x;\n\t\t\tvar diff_y = pos.y - this.config.pos.y;\n\t\t\tvar distance = Math.sqrt(Math.pow(Math.abs(diff_x), 2) + Math.pow(Math.abs(diff_y), 2));\n\n\t\t\tif (distance > this.config.sensitivity) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tinitDnDMarker: function () {\n\t\t\t// create dnd placeholder and put it in dom\n\t\t\tvar marker = this.config.marker = document.createElement(\"div\");\n\t\t\tmarker.className = \"gantt_drag_marker\";\n\t\t\t// GS-1333: don't show any message when we resize grid columns\n\t\t\tmarker.innerHTML = \"\";\n\t\t\tdocument.body.appendChild(marker);\n\t\t},\n\t\tbackupEventTarget: function (domEvent, getEvent) {\n\t\t\tif (!gantt.config.touch) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// keep original event target in DOM in order to keep dnd on touchmove event\n\t\t\tvar e = getEvent(domEvent);\n\n\t\t\tvar el = e.target || e.srcElement;\n\t\t\tvar copy = el.cloneNode(true);\n\t\t\t//this.config.target.target = copy;\n\t\t\tthis.config.original_target = copyDomEvent(e);\n\t\t\tthis.config.original_target.target = copy;\n\t\t\tthis.config.backup_element = el;\n\t\t\tel.parentNode.appendChild(copy);\n\n\t\t\tel.style.display = \"none\";\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || document.body;\n\t\t\tmousemoveContainer.appendChild(el);\n\t\t},\n\t\tgetInputMethods: function () {\n\t\t\t// bind actions to browser events\n\t\t\tvar inputMethods = [];\n\n\t\t\tinputMethods.push({\n\t\t\t\t\"move\": \"mousemove\",\n\t\t\t\t\"down\": \"mousedown\",\n\t\t\t\t\"up\": \"mouseup\",\n\t\t\t\t\"accessor\": function (e) {\n\t\t\t\t\treturn e;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (gantt.config.touch) {\n\n\t\t\t\tvar touchEventsSupported = true;\n\t\t\t\ttry{\n\t\t\t\t\tdocument.createEvent(\"TouchEvent\");\n\t\t\t\t}catch (e){\n\t\t\t\t\ttouchEventsSupported = false;\n\t\t\t\t}\n\n\t\t\t\tif(touchEventsSupported){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"touchmove\",\n\t\t\t\t\t\t\"down\": \"touchstart\",\n\t\t\t\t\t\t\"up\": \"touchend\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\t\t\t\tif (ev.touches[0])\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\ttarget: document.elementFromPoint(ev.touches[0].clientX, ev.touches[0].clientY),\n\t\t\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else if(global.navigator.pointerEnabled){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"pointermove\",\n\t\t\t\t\t\t\"down\": \"pointerdown\",\n\t\t\t\t\t\t\"up\": \"pointerup\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}else if (global.navigator.msPointerEnabled){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"MSPointerMove\",\n\t\t\t\t\t\t\"down\": \"MSPointerDown\",\n\t\t\t\t\t\t\"up\": \"MSPointerUp\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.pointerType == ev.MSPOINTER_TYPE_MOUSE) return null;\n\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn inputMethods;\n\t\t},\n\t\tclearDragTimer: function () {\n\t\t\tif (this._drag_start_timer) {\n\t\t\t\tclearTimeout(this._drag_start_timer);\n\t\t\t\tthis._drag_start_timer = null;\n\t\t\t}\n\t\t},\n\t\tdragStart: function (obj, e, inputMethod) {\n\t\t\tif (this.config && this.config.started) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.config = {\n\t\t\t\tobj: obj,\n\t\t\t\tmarker: null,\n\t\t\t\tstarted: false,\n\t\t\t\tpos: this.getPosition(e),\n\t\t\t\tsensitivity: 4\n\t\t\t};\n\t\t\tif (this._settings)\n\t\t\t\tutils.mixin(this.config, this._settings, true);\n\n\n\t\t\tthis.traceDragEvents(obj, inputMethod);\n\n\t\t\tgantt._prevent_touch_scroll = true;\n\t\t\tdocument.body.classList.add(\"gantt_noselect\");\n\n\t\t\tif (gantt.config.touch) {\n\t\t\t\tthis.dragMove(obj, e, inputMethod.accessor);\n\t\t\t}\n\n\t\t},\n\t\tdragMove: function (obj, e, getEvent) {\n\t\t\tvar source = getEvent(e);\n\t\t\tif (!source) return false;\n\n\t\t\tif (!this.config.marker && !this.config.started) {\n\t\t\t\tvar pos = this.getPosition(source);\n\n\t\t\t\tif (gantt.config.touch || this.checkPositionChange(pos)) {\n\t\t\t\t\t// real drag starts here,\n\t\t\t\t\t// when user moves mouse at first time after onmousedown\n\t\t\t\t\tthis.config.started = true;\n\t\t\t\t\tthis.config.ignore = false;\n\t\t\t\t\tgantt._touch_drag = true;\n\t\t\t\t\tif (this.callEvent(\"onBeforeDragStart\", [obj, this.config.original_target]) === false) {\n\t\t\t\t\t\tthis.config.ignore = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tthis.backupEventTarget(e, getEvent);\n\t\t\t\t\tthis.initDnDMarker();\n\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t\tthis.callEvent(\"onAfterDragStart\", [obj, this.config.original_target]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.config.ignore = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!this.config.ignore) {\n\t\t\t\t// GS-1279 Gantt crashes on Mobile Firefox after starting to create a link and moving finger outisde the page.\n\t\t\t\tif (e.targetTouches && !source.target) return;\n\t\t\t\t\n\t\t\t\tsource.pos = this.getPosition(source);\n\t\t\t\tthis.config.marker.style.left = source.pos.x + \"px\";\n\t\t\t\tthis.config.marker.style.top = source.pos.y + \"px\";\n\t\t\t\tthis.callEvent(\"onDragMove\", [obj, source]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tdragEnd: function (obj) {\n\t\t\tvar target = this.config.backup_element;\n\t\t\tif (target && target.parentNode) {\n\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t}\n\t\t\tgantt._prevent_touch_scroll = false;\n\t\t\tif (this.config.marker) {\n\t\t\t\tthis.config.marker.parentNode.removeChild(this.config.marker);\n\t\t\t\tthis.config.marker = null;\n\n\t\t\t\tthis.callEvent(\"onDragEnd\", []);\n\t\t\t}\n\t\t\tthis.config.started = false;\n\t\t\tgantt._touch_drag = false;\n\t\t\tdocument.body.classList.remove(\"gantt_noselect\");\n\t\t},\n\n\t\tgetPosition: function (e) {\n\t\t\tvar x = 0, y = 0;\n\t\t\tif (e.pageX || e.pageY) {\n\t\t\t\tx = e.pageX;\n\t\t\t\ty = e.pageY;\n\t\t\t} else if (e.clientX || e.clientY) {\n\t\t\t\tx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n\t\t\t\ty = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n\t\t\t}\n\t\t\treturn {x: x, y: y};\n\t\t}\n\t};\n\n\treturn DnD;\n};\n","export default function(gantt) {\n\n\tvar regTemplates = {};\n\n\tfunction initTemplate(name, initial, template_name) {\n\t\ttemplate_name = template_name || name;\n\t\tvar config = gantt.config,\n\t\t\ttemplates = gantt.templates;\n\n\t\tif (gantt.config[name] && regTemplates[template_name] != config[name]) {\n\t\t\tif (!(initial && templates[template_name])) {\n\t\t\t\ttemplates[template_name] = gantt.date.date_to_str(config[name]);\n\t\t\t\tregTemplates[template_name] = config[name];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction initTemplates() {\n\t\tvar labels = gantt.locale.labels;\n\t\tlabels.gantt_save_btn = labels.icon_save;\n\t\tlabels.gantt_cancel_btn = labels.icon_cancel;\n\t\tlabels.gantt_delete_btn = labels.icon_delete;\n\n\n\t\tvar date = gantt.date;\n\n\t\t//build configuration based templates\n\t\tvar d = date.date_to_str;\n\t\tvar c = gantt.config;\n\t\tvar format_date = d(c.xml_date || c.date_format, c.server_utc);\n\t\tvar parse_date = date.str_to_date(c.xml_date || c.date_format, c.server_utc);\n\n\t\tinitTemplate(\"date_scale\", true, undefined, gantt.config, gantt.templates);\n\t\tinitTemplate(\"date_grid\", true, \"grid_date_format\", gantt.config, gantt.templates);\n\t\tinitTemplate(\"task_date\", true, undefined, gantt.config, gantt.templates);\n\n\t\tgantt.mixin(gantt.templates, {\n\t\t\txml_format: undefined, // deprecated\n\t\t\tformat_date: format_date,\n\n\t\t\txml_date: undefined, // deprecated\n\t\t\tparse_date: parse_date,\n\n\t\t\tprogress_text: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tgrid_header_class: function (column, config) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\ttask_text: function (start, end, task) {\n\t\t\t\treturn task.text;\n\t\t\t},\n\t\t\ttask_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttask_end_date: function (date) {\n\t\t\t\treturn gantt.templates.task_date(date);\n\t\t\t},\n\t\t\tgrid_row_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttask_row_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttimeline_cell_class: function (item, date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttimeline_cell_content: function (item, date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tscale_cell_class: function (date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tscale_row_class: function (date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\tgrid_indent: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_indent'></div>\";\n\t\t\t},\n\t\t\tgrid_folder: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_folder_\" + (item.$open ? \"open\" : \"closed\") + \"'></div>\";\n\t\t\t},\n\t\t\tgrid_file: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_file'></div>\";\n\t\t\t},\n\t\t\tgrid_open: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_\" + (item.$open ? \"close\" : \"open\") + \"'></div>\";\n\t\t\t},\n\t\t\tgrid_blank: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_blank'></div>\";\n\t\t\t},\n\t\t\tdate_grid: function (date, item, column) {\n\t\t\t\tif (item && gantt.isUnscheduledTask(item) && gantt.config.show_unscheduled) {\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(item);\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.templates.grid_date_format(date, column);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttask_time: function (start, end, ev) {\n\t\t\t\tif (gantt.isUnscheduledTask(ev) && gantt.config.show_unscheduled) {\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(ev);\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.templates.task_date(start) + \" - \" + gantt.templates.task_end_date(end);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttask_unscheduled_time: function (task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\ttime_picker: d(c.time_picker),\n\t\t\tlink_class: function (link) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tlink_description: function (link) {\n\t\t\t\tvar from = gantt.getTask(link.source),\n\t\t\t\t\tto = gantt.getTask(link.target);\n\n\t\t\t\treturn \"<b>\" + from.text + \"</b> &ndash;  <b>\" + to.text + \"</b>\";\n\t\t\t},\n\n\t\t\tdrag_link: function (from, from_start, to, to_start) {\n\t\t\t\tfrom = gantt.getTask(from);\n\t\t\t\tvar labels = gantt.locale.labels;\n\n\t\t\t\tvar text = \"<b>\" + from.text + \"</b> \" + (from_start ? labels.link_start : labels.link_end) + \"<br/>\";\n\t\t\t\tif (to) {\n\t\t\t\t\tto = gantt.getTask(to);\n\t\t\t\t\ttext += \"<b> \" + to.text + \"</b> \" + (to_start ? labels.link_start : labels.link_end) + \"<br/>\";\n\t\t\t\t}\n\t\t\t\treturn text;\n\t\t\t},\n\t\t\tdrag_link_class: function (from, from_start, to, to_start) {\n\t\t\t\tvar add = \"\";\n\n\t\t\t\tif (from && to) {\n\t\t\t\t\tvar allowed = gantt.isLinkAllowed(from, to, from_start, to_start);\n\t\t\t\t\tadd = \" \" + (allowed ? \"gantt_link_allow\" : \"gantt_link_deny\");\n\t\t\t\t}\n\n\t\t\t\treturn \"gantt_link_tooltip\" + add;\n\t\t\t},\n\n\t\t\t/* used for aria-labels of bar elements and for tooltip.js */\n\t\t\ttooltip_date_format: date.date_to_str(\"%Y-%m-%d\"),\n\t\t\ttooltip_text: function (start, end, event) {\n\t\t\t\treturn `<div>Task: ${event.text}</div>\n\t\t\t\t<div>Start date: ${gantt.templates.tooltip_date_format(start)}</div>\n\t\t\t\t<div>End date: ${gantt.templates.tooltip_date_format(end)}</div>`;\n\t\t\t},\n\t\t\tbaseline_text: function (task, baseline, index) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tinitTemplates: initTemplates,\n\t\tinitTemplate: initTemplate\n\t};\n\n};","import * as utils from \"../../utils/utils\";\nimport facadeFactory from \"./../facades/datastore\";\nimport calculateScaleRange from \"../gantt_data_range\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\n\nimport treeHelper from \"../../utils/task_tree_helpers\";\n\nfunction initDataStores(gantt){\n\n\tvar facade = facadeFactory.create();\n\tutils.mixin(gantt, facade);\n\tvar tasksStore = gantt.createDatastore({\n\t\tname: \"task\",\n\t\ttype: \"treeDatastore\",\n\t\trootId: function() { return gantt.config.root_id; },\n\t\tinitItem: utils.bind(_init_task, gantt),\n\t\tgetConfig: function() { return gantt.config; }\n\t});\n\n\tvar linksStore = gantt.createDatastore({\n\t\tname: \"link\",\n\t\tinitItem: utils.bind(_init_link, gantt)\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\ttasksStore.destructor();\n\t\tlinksStore.destructor();\n\t});\n\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\n\t\tif(gantt.isLinkExists(link.id) || link.id === \"predecessor_generated\"){\n\t\t\t// link was already added into gantt\n\t\t\treturn true;\n\t\t}\n\t\tvar source = gantt.getTask(link.source);\n\t\tvar taskLinks = source.$source;\n\t\tfor (var i = 0; i < taskLinks.length; i++) {\n\t\t\tvar existingLink = gantt.getLink(taskLinks[i]);\n\n\t\t\tvar sourceMatch = link.source == existingLink.source;\n\t\t\tvar targetMatch = link.target == existingLink.target;\n\t\t\tvar typeMatch = link.type == existingLink.type;\n\n\t\t\t// prevent creating duplicated links from the UI\n\t\t\tif (sourceMatch && targetMatch && typeMatch) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onBeforeRefreshAll\", function(){\n\n\t\t// GS-2170 do not recalculate indexes and dates as the event will be called later in the onStoreUpdate event\n\t\tif (tasksStore._skipTaskRecalculation){\n\t\t\treturn;\n\t\t}\n\n\t\tvar order = tasksStore.getVisibleItems();\n\n\t\tfor(var i=0; i < order.length; i++){\n\t\t\tvar item = order[i];\n\t\t\titem.$index = i;\n\t\t\titem.$local_index = gantt.getTaskIndex(item.id);\n\t\t\tgantt.resetProjectDates(item);\n\t\t}\n\n\t});\n\n\ttasksStore.attachEvent(\"onFilterItem\", function(id, task) {\n\t\tif (gantt.config.show_tasks_outside_timescale) {\n\t\t\treturn true;\n\t\t}\n\t\tvar min = null, max = null;\n\t\tif (gantt.config.start_date && gantt.config.end_date) {\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) return true;\n\t\t\tmin = gantt.config.start_date.valueOf();\n\t\t\tmax = gantt.config.end_date.valueOf();\n\n\t\t\tif (+task.start_date > max || +task.end_date < +min)\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\tgantt._update_flags(oldId, newId);\n\n\t\tvar changedTask = gantt.getTask(newId);\n\t\tif(!tasksStore.isSilent()){\n\t\t\tif(changedTask.$split_subtask || changedTask.rollup){\n\t\t\t\tgantt.eachParent(function(parent){\n\t\t\t\t\tgantt.refreshTask(parent.id);\n\t\t\t\t}, newId);\n\t\t\t}\n\t\t}\n\t});\n\n\ttasksStore.attachEvent(\"onAfterUpdate\", function(id){\n\t\tgantt._update_parents(id);\n\t\tif(gantt.getState(\"batchUpdate\").batch_update){\n\t\t\treturn true;\n\t\t}\n\n\t\tvar task = tasksStore.getItem(id);\n\t\tif (!task.$source) task.$source = [];\n\t\tfor (var i = 0; i < task.$source.length; i++) {\n\t\t\tlinksStore.refresh(task.$source[i]);\n\t\t}\n\t\tif (!task.$target) task.$target = [];\n\t\tfor (var i = 0; i < task.$target.length; i++) {\n\t\t\tlinksStore.refresh(task.$target[i]);\n\t\t}\n\t});\n\n\ttasksStore.attachEvent(\"onBeforeItemMove\", function(sid, parent, tindex){\n\t\t// GS-125. Don't allow users to move the placeholder task\n\t\tif (isPlaceholderTask(sid, gantt, tasksStore)){\n\t\t\t//eslint-disable-next-line\n\t\t\tconsole.log(\"The placeholder task cannot be moved to another position.\");\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onAfterItemMove\", function(sid, parent, tindex){\n\t\tvar source = gantt.getTask(sid);\n\n\t\tif(this.getNextSibling(sid) !== null){\n\t\t\tsource.$drop_target = this.getNextSibling(sid);\n\t\t} else if(this.getPrevSibling(sid) !== null){\n\t\t\tsource.$drop_target = \"next:\" + this.getPrevSibling(sid);\n\t\t}else{\n\t\t\tsource.$drop_target = \"next:null\";\n\t\t}\n\n\t});\n\n\ttasksStore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(action == \"delete\"){\n\t\t\tgantt._update_flags(id, null);\n\t\t}\n\n\t\tvar state = gantt.$services.getService(\"state\");\n\t\tif(state.getState(\"batchUpdate\").batch_update){\n\t\t\treturn;\n\t\t}\n\n\t\tif(gantt.config.fit_tasks && action !== \"paint\"){\n\t\t\tvar oldState = gantt.getState();\n\t\t\tcalculateScaleRange(gantt);\n\t\t\tvar newState = gantt.getState();\n\n\t\t\t//this._init_tasks_range();\n\t\t\tif (+oldState.min_date != +newState.min_date || +oldState.max_date != +newState.max_date) {\n\t\t\t\tgantt.render();\n\n\t\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t}\n\n\t\tif(action == \"add\" || action == \"move\" || action == \"delete\"){\n\t\t\tif(gantt.$layout){\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks in the\n\t\t\t\t// onBeforeResize layout event, but do it later. If lightbox is opened, it will\n\t\t\t\t// trigger the refreshData, so the indexes and dates will be recalculated there\n\t\t\t\tif (this.$config.name == \"task\" && (action == \"add\" || action == \"delete\")){\n\t\t\t\t\tif (this._skipTaskRecalculation != \"lightbox\"){\n\t\t\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgantt.$layout.resize();\n\t\t\t}\n\n\t\t}else if(!id){\n\t\t\tlinksStore.refresh();\n\t\t}\n\n\t});\n\n\tlinksStore.attachEvent(\"onAfterAdd\", function(id, link){\n\t\tsync_link(link);\n\t});\n\tlinksStore.attachEvent(\"onAfterUpdate\", function(id, link){\n\t\tsync_links();\n\t});\n\tlinksStore.attachEvent(\"onAfterDelete\", function(id, link){\n\t\tsync_link_delete(link);\n\t});\n\tlinksStore.attachEvent(\"onAfterSilentDelete\", function(id, link){\n\t\tsync_link_delete(link);\n\t});\n\tlinksStore.attachEvent(\"onBeforeIdChange\", function(oldId, newId){\n\t\tsync_link_delete(gantt.mixin({id:oldId}, gantt.$data.linksStore.getItem(newId)));\n\t\tsync_link(gantt.$data.linksStore.getItem(newId));\n\t});\n\n\tfunction checkLinkedTaskVisibility(taskId){\n\t\tvar isVisible = gantt.isTaskVisible(taskId);\n\t\tif(!isVisible && gantt.isTaskExists(taskId)){\n\t\t\tvar parent = gantt.getParent(taskId);\n\t\t\tif(gantt.isTaskExists(parent) && gantt.isTaskVisible(parent)){\n\t\t\t\tparent = gantt.getTask(parent);\n\t\t\t\tif(gantt.isSplitTask(parent)){\n\t\t\t\t\tisVisible = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tlinksStore.attachEvent(\"onFilterItem\", function(id, link){\n\t\tif (!gantt.config.show_links) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar sourceVisible = checkLinkedTaskVisibility(link.source);\n\t\tvar targetVisible = checkLinkedTaskVisibility(link.target);\n\n\t\tif (!(sourceVisible && targetVisible) ||\n\t\t\tgantt._isAllowedUnscheduledTask(gantt.getTask(link.source)) || gantt._isAllowedUnscheduledTask(gantt.getTask(link.target)))\n\t\t\treturn false;\n\n\t\treturn gantt.callEvent(\"onBeforeLinkDisplay\", [id, link]);\n\t});\n\n\n\t(function(){\n\t\t// delete all connected links after task is deleted\n\t\tvar deletedLinks = {};\n\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", function(id, item){\n\t\t\tdeletedLinks[id] = treeHelper.getSubtreeLinks(gantt, id);\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", function(id, item) {\n\t\t\tif(deletedLinks[id]){\n\t\t\t\tgantt.$data.linksStore.silent(function(){\n\t\t\t\t\tfor(var i in deletedLinks[id]){\n\t\t\t\t\t\tif (gantt.isLinkExists(i)){\n\t\t\t\t\t\t\tgantt.$data.linksStore.removeItem(i);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsync_link_delete(deletedLinks[id][i]);\n\t\t\t\t\t}\n\n\t\t\t\t\tdeletedLinks[id] = null;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t})();\n\n\tgantt.attachEvent(\"onAfterLinkDelete\", function(id, link) {\n\t\tgantt.refreshTask(link.source);\n\t\tgantt.refreshTask(link.target);\n\t});\n\n\tgantt.attachEvent(\"onParse\", sync_links);\n\n\tmapEvents({\n\t\tsource: linksStore,\n\t\ttarget: gantt,\n\t\tevents:{\n\t\t\t\"onItemLoading\":\"onLinkLoading\",\n\t\t\t\"onBeforeAdd\":\"onBeforeLinkAdd\",\n\t\t\t\"onAfterAdd\":\"onAfterLinkAdd\",\n\t\t\t\"onBeforeUpdate\":\"onBeforeLinkUpdate\",\n\t\t\t\"onAfterUpdate\":\"onAfterLinkUpdate\",\n\t\t\t\"onBeforeDelete\":\"onBeforeLinkDelete\",\n\t\t\t\"onAfterDelete\":\"onAfterLinkDelete\",\n\t\t\t\"onIdChange\":\"onLinkIdChange\"\n\t\t}\n\t});\n\n\tmapEvents({\n\t\tsource: tasksStore,\n\t\ttarget: gantt,\n\t\tevents:{\n\t\t\t\"onItemLoading\":\"onTaskLoading\",\n\t\t\t\"onBeforeAdd\":\"onBeforeTaskAdd\",\n\t\t\t\"onAfterAdd\":\"onAfterTaskAdd\",\n\t\t\t\"onBeforeUpdate\":\"onBeforeTaskUpdate\",\n\t\t\t\"onAfterUpdate\":\"onAfterTaskUpdate\",\n\t\t\t\"onBeforeDelete\":\"onBeforeTaskDelete\",\n\t\t\t\"onAfterDelete\":\"onAfterTaskDelete\",\n\t\t\t\"onIdChange\":\"onTaskIdChange\",\n\t\t\t\"onBeforeItemMove\":\"onBeforeTaskMove\",\n\t\t\t\"onAfterItemMove\":\"onAfterTaskMove\",\n\t\t\t\"onFilterItem\":\"onBeforeTaskDisplay\",\n\t\t\t\"onItemOpen\":\"onTaskOpened\",\n\t\t\t\"onItemClose\":\"onTaskClosed\",\n\t\t\t\"onBeforeSelect\":\"onBeforeTaskSelected\",\n\t\t\t\"onAfterSelect\":\"onTaskSelected\",\n\t\t\t\"onAfterUnselect\":\"onTaskUnselected\"\n\t\t}\n\t});\n\n\tgantt.$data = {\n\t\ttasksStore: tasksStore,\n\t\tlinksStore: linksStore\n\t};\n\n\tfunction sync_link(link){\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tvar sourceTask = gantt.getTask(link.source);\n\t\t\tsourceTask.$source = sourceTask.$source || [];\n\t\t\tsourceTask.$source.push(link.id);\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tvar targetTask = gantt.getTask(link.target);\n\t\t\ttargetTask.$target = targetTask.$target || [];\n\t\t\ttargetTask.$target.push(link.id);\n\t\t}\n\t}\n\n\tfunction sync_link_delete(link){\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tvar sourceTask = gantt.getTask(link.source);\n\t\t\tfor(var i = 0; i < sourceTask.$source.length; i++){\n\t\t\t\tif(sourceTask.$source[i] == link.id){\n\t\t\t\t\tsourceTask.$source.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tvar targetTask = gantt.getTask(link.target);\n\t\t\tfor(var i = 0; i < targetTask.$target.length; i++){\n\t\t\t\tif(targetTask.$target[i] == link.id){\n\t\t\t\t\ttargetTask.$target.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction sync_links() {\n\t\tvar task = null;\n\t\tvar tasks = gantt.$data.tasksStore.getItems();\n\n\t\tfor(var i = 0, len = tasks.length; i < len; i++){\n\t\t\ttask = tasks[i];\n\t\t\ttask.$source = [];\n\t\t\ttask.$target = [];\n\t\t}\n\n\t\tvar links = gantt.$data.linksStore.getItems();\n\t\tfor (var i = 0, len = links.length; i < len; i++) {\n\n\t\t\tvar link = links[i];\n\t\t\tsync_link(link);\n\t\t}\n\t}\n\n\tfunction mapEvents(conf){\n\t\tvar mapFrom = conf.source;\n\t\tvar mapTo = conf.target;\n\t\tfor(var i in conf.events){\n\t\t\t(function(sourceEvent, targetEvent){\n\t\t\t\tmapFrom.attachEvent(sourceEvent, function(){\n\t\t\t\t\treturn mapTo.callEvent(targetEvent, Array.prototype.slice.call(arguments));\n\t\t\t\t}, targetEvent);\n\t\t\t})(i, conf.events[i]);\n\t\t}\n\t}\n\n\tfunction _init_task(task) {\n\t\tif (!this.defined(task.id))\n\t\t\ttask.id = this.uid();\n\n\t\tif (task.start_date)\n\t\t\ttask.start_date = gantt.date.parseDate(task.start_date, \"parse_date\");\n\t\tif (task.end_date)\n\t\t\ttask.end_date = gantt.date.parseDate(task.end_date, \"parse_date\");\n\n\n\t\tvar duration = null;\n\t\tif (task.duration || task.duration === 0) {\n\t\t\ttask.duration = duration = task.duration * 1;\n\t\t}\n\n\t\tif (duration) {\n\t\t\tif (task.start_date && !task.end_date) {\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t} else if (!task.start_date && task.end_date) {\n\t\t\t\ttask.start_date = this.calculateEndDate({\n\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t}\n\t\t\t//task.$calculate_duration = false;\n\t\t}\n\n\t\tif (gantt.config.deadlines !== false && task.deadline){\n\t\t\ttask.deadline = gantt.date.parseDate(task.deadline, \"parse_date\");\n\t\t}\n\n\t\ttask.progress = Number(task.progress) || 0;\n\n\t\tif (this._isAllowedUnscheduledTask(task)) {\n\t\t\tthis._set_default_task_timing(task);\n\t\t}\n\t\tthis._init_task_timing(task);\n\t\tif (task.start_date && task.end_date)\n\t\t\tthis.correctTaskWorkTime(task);\n\n\t\ttask.$source = [];\n\t\ttask.$target = [];\n\n\t\tvar originalTask = this.$data.tasksStore.getItem(task.id);\n\t\tif (originalTask && !utils.defined(task.open)) {\n\t\t\t// if a task with the same id is already in the gantt and the new object doesn't specify the `open` state -\n\t\t\t// restore the `open` state we already have in the chart\n\t\t\ttask.$open = originalTask.$open;\n\t\t}\n\n\t\tif (task.parent === undefined) {\n\t\t\ttask.parent = this.config.root_id;\n\t\t}\n\t\tif(task.open){\n\t\t\ttask.$open = true;\n\t\t}\n\t\treturn task;\n\t}\n\n\tfunction _init_link(link) {\n\t\tif (!this.defined(link.id))\n\t\t\tlink.id = this.uid();\n\t\treturn link;\n\t}\n}\n\n\nexport default initDataStores;\n","import batch_update from \"./batch_update\";\nimport wbs from \"./wbs\";\nimport resources from \"./resources\";\nimport resource_assignments from \"./resource_assignments\";\nimport new_task_placeholder from \"./new_task_placeholder\";\nimport auto_task_types from \"./auto_task_types\";\nimport formatters from \"./formatters\";\nimport empty_state_screen from \"./empty_state_screen\";\nimport baselines from \"./baselines\";\n\nexport default function(gantt){\n\tif(!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tvar modules = [\n\t\tbatch_update,\n\t\twbs,\n\t\tresources,\n\t\tresource_assignments,\n\t\tnew_task_placeholder,\n\t\tauto_task_types,\n\t\tformatters,\n\t\tempty_state_screen,\n\t\tbaselines\n\t];\n\n\tfor(var i = 0; i < modules.length; i++){\n\t\tif(modules[i])\n\t\t\tmodules[i](gantt);\n\t}\n};","export default function(gantt) {\n\tgantt.getGridColumn = function(name) {\n\t\tvar columns = gantt.config.columns;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tif (columns[i].name == name)\n\t\t\t\treturn columns[i];\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tgantt.getGridColumns = function() {\n\t\treturn gantt.config.columns.slice();\n\t};\n};","export default function(gantt) {\n\tgantt.isReadonly = function (item) {\n\n\t\tif((typeof item == \"number\" || typeof item == \"string\") && gantt.isTaskExists(item)){\n\t\t\titem = gantt.getTask(item);\n\t\t}\n\t\tif (item && item[this.config.editable_property]) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn (item && item[this.config.readonly_property]) || this.config.readonly;\n\t\t}\n\t};\n};","import CalendarManager from \"./calendar_manager\";\nimport TimeCalculator from \"./time_calculator\";\nimport worktimeFacadeFactory from \"../facades/worktime_calendars\";\nimport * as utils from \"../../utils/utils\";\n\nexport default function (gantt) {\n\tvar manager = new CalendarManager(gantt),\n\ttimeCalculator = new TimeCalculator(manager);\n\tvar facade = worktimeFacadeFactory.create(manager, timeCalculator);\n\tutils.mixin(gantt, facade);\n};\n","export default function(gantt) {\n\n\tgantt.getTaskType = function (type) {\n\t\treturn \"task\";\n\t};\n};","/*\n reuse results of functions that can be recalculated during rendering\n greatly increases the rendering speed when critical path enabled\n Sample - 94_dev/critical_path.html\n\n */\nexport default function(gantt){\n\ngantt._cached_functions = {\n\tcache: {},\n\tmode: false,\n\tcritical_path_mode: false,\n\twrap_methods : function(methods, object){\n\t\tif(object._prefetch_originals){\n\t\t\tfor(var i in object._prefetch_originals){\n\t\t\t\tobject[i] = object._prefetch_originals[i];\n\t\t\t}\n\t\t}\n\t\tobject._prefetch_originals = {};\n\t\tfor(var i = 0; i < methods.length; i++)\n\t\t\tthis.prefetch(methods[i], object);\n\n\t},\n\tprefetch : function(methodname, host){\n\t\tvar original = host[methodname];\n\t\tif(original){\n\t\t\tvar optimizer = this;\n\n\t\t\thost._prefetch_originals[methodname] = original;\n\t\t\thost[methodname] = function get_prefetched_value(){\n\n\t\t\t\tvar argumentsArray = new Array(arguments.length);\n\t\t\t\tfor (var i = 0, l = arguments.length; i < l; i++) {\n\t\t\t\t\targumentsArray[i] = arguments[i];\n\t\t\t\t}\n\n\t\t\t\tif(optimizer.active){\n\t\t\t\t\tvar args = optimizer.get_arguments_hash(Array.prototype.slice.call(argumentsArray));\n\t\t\t\t\tif(!optimizer.cache[methodname]){\n\t\t\t\t\t\toptimizer.cache[methodname] = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tvar cached_values = optimizer.cache[methodname];\n\n\t\t\t\t\tif(optimizer.has_cached_value(cached_values, args)){\n\t\t\t\t\t\treturn optimizer.get_cached_value(cached_values, args);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar value = original.apply(this, argumentsArray);\n\t\t\t\t\t\toptimizer.cache_value(cached_values, args, value);\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn original.apply(this, argumentsArray);\n\t\t\t};\n\t\t}\n\t\treturn original;\n\t},\n\tcache_value: function(cache, arguments_hash, value){\n\t\tif(this.is_date(value))\n\t\t\tvalue = new Date(value);\n\t\tcache[arguments_hash] = value;\n\t},\n\thas_cached_value: function(cache, arguments_hash){\n\t\treturn cache.hasOwnProperty(arguments_hash);\n\t},\n\tget_cached_value: function(cache, arguments_hash){\n\t\tvar data = cache[arguments_hash];\n\n\t\t//for cached dates - return copy\n\t\tif(this.is_date(data)){\n\t\t\tdata = new Date(data);\n\t\t}\n\t\treturn data;\n\t},\n\tis_date: function(value){\n\t\treturn (value && value.getUTCDate);\n\t},\n\tget_arguments_hash:function(args){\n\t\tvar values = [];\n\t\tfor(var i = 0; i < args.length; i++){\n\t\t\tvalues.push(this.stringify_argument(args[i]));\n\t\t}\n\t\treturn \"(\" + values.join(\";\") + \")\";\n\t},\n\tstringify_argument: function(value){\n\t\t//expecting task or link, or any other data entries, dates and primitive values\n\t\tvar ret = \"\";\n\t\tif(value.id){\n\t\t\tret = value.id;\n\t\t}else if(this.is_date(value)){\n\t\t\tret = value.valueOf();\n\t\t}else{\n\t\t\tret = value;\n\t\t}\n\t\treturn ret + \"\";\n\t},\n\tactivate: function(){\n\t\tthis.clear();\n\t\tthis.active = true;\n\t},\n\tdeactivate: function(){\n\t\tthis.clear();\n\t\tthis.active = false;\n\t},\n\tclear: function(){\n\t\tthis.cache = {};\n\t},\n\n\tsetup: function(gantt){\n\t\tvar override_gantt = [];\n\n\t\tvar gantt_methods  = [\n\t\t\t'_isProjectEnd',\n\t\t\t'_getProjectEnd',\n\t\t\t'_getSlack'\n\t\t];\n\n\n\n\t\tif(this.mode == 'auto'){\n\t\t\tif(gantt.config.highlight_critical_path){\n\t\t\t\toverride_gantt = gantt_methods;\n\t\t\t}\n\t\t}else if(this.mode === true){\n\t\t\toverride_gantt = gantt_methods;\n\t\t}\n\n\t\tthis.wrap_methods(override_gantt, gantt);\n\n\t},\n\tupdate_if_changed: function(gantt){\n\t\tvar changed = (this.critical_path_mode != gantt.config.highlight_critical_path ||\n\t\t\t\t\t\tthis.mode !== gantt.config.optimize_render);\n\t\tif(changed){\n\t\t\tthis.critical_path_mode = gantt.config.highlight_critical_path;\n\t\t\tthis.mode = gantt.config.optimize_render;\n\t\t\tthis.setup(gantt);\n\t\t}\n\t}\n};\n\nfunction activate(){\n\tgantt._cached_functions.update_if_changed(gantt);\n\tif(!gantt._cached_functions.active){\n\t\tgantt._cached_functions.activate();\n\t}\n\treturn true;\n}\ngantt.attachEvent(\"onBeforeGanttRender\", activate);\ngantt.attachEvent(\"onBeforeDataRender\", activate);\ngantt.attachEvent(\"onBeforeSmartRender\",  function(){\n\tactivate();\n});\ngantt.attachEvent(\"onBeforeParse\", activate);\ngantt.attachEvent(\"onDataRender\", function(){\n\tgantt._cached_functions.deactivate();\n});\nvar deactivTimeout = null;\ngantt.attachEvent(\"onSmartRender\", function(){\n\tif(deactivTimeout)\n\t\tclearTimeout(deactivTimeout);\n\tdeactivTimeout = setTimeout(function(){\n\t\tgantt._cached_functions.deactivate();\n\t}, 1000);\n});\n\ngantt.attachEvent(\"onBeforeGanttReady\", function(){\n\tgantt._cached_functions.update_if_changed(gantt);\n\treturn true;\n});\n\n};","function extend(gantt){\n\n\tgantt.destructor = function(){\n\t\tthis.clearAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\n\t\tif(this.$root){\n\t\t\tdelete this.$root.gantt;\n\t\t}\n\n\t\tif(this._eventRemoveAll){\n\t\t\tthis._eventRemoveAll();\n\t\t}\n\n\t\tif(this.$layout){\n\t\t\tthis.$layout.destructor();\n\t\t}\n\n\t\tif(this.resetLightbox){\n\t\t\tthis.resetLightbox();\n\t\t}\n\n\t\t// GS-99. Call this here to detach the events\n\t\tif (this.ext.inlineEditors) {\n\t\t\tthis.ext.inlineEditors.destructor();\n\t\t}\n\n\t\tif(this._dp && this._dp.destructor){\n\t\t\tthis._dp.destructor();\n\t\t}\n\t\tthis.$services.destructor();\n\n\t\t// detachAllEvents should be called last, because in components may be attached events\n\t\tthis.detachAllEvents();\n\n\t\tfor(var i in this){\n\t\t\tif(i.indexOf(\"$\") === 0){\n\t\t\t\tdelete this[i];\n\t\t\t}\n\t\t}\n\t\tthis.$destroyed = true;\n\t};\n}\n\nexport default extend;\n","import ar from \"./locale_ar\";\nimport be from \"./locale_be\";\nimport ca from \"./locale_ca\";\nimport cn from \"./locale_cn\";\nimport cs from \"./locale_cs\";\nimport da from \"./locale_da\";\nimport de from \"./locale_de\";\nimport el from \"./locale_el\";\nimport en from \"./locale_en\";\nimport es from \"./locale_es\";\nimport fa from \"./locale_fa\";\nimport fi from \"./locale_fi\";\nimport fr from \"./locale_fr\";\nimport he from \"./locale_he\";\nimport hr from \"./locale_hr\";\nimport hu from \"./locale_hu\";\nimport id from \"./locale_id\";\nimport it from \"./locale_it\";\nimport jp from \"./locale_jp\";\nimport kr from \"./locale_kr\";\n\nimport LocaleManager from \"./locale_manager\";\n\nimport nb from \"./locale_nb\";\nimport nl from \"./locale_nl\";\nimport no from \"./locale_no\";\nimport pl from \"./locale_pl\";\nimport pt from \"./locale_pt\";\nimport ro from \"./locale_ro\";\nimport ru from \"./locale_ru\";\nimport si from \"./locale_si\";\nimport sk from \"./locale_sk\";\nimport sv from \"./locale_sv\";\nimport tr from \"./locale_tr\";\nimport ua from \"./locale_ua\";\n\nexport default function(){\n\treturn new LocaleManager({\n\t\ten,\n\t\tar,\n\t\tbe,\n\t\tca,\n\t\tcn,\n\t\tcs,\n\t\tda,\n\t\tde,\n\t\tel,\n\t\tes,\n\t\tfa,\n\t\tfi,\n\t\tfr,\n\t\the,\n\t\thr,\n\t\thu,\n\t\tid,\n\t\tit,\n\t\tjp,\n\t\tkr,\n\t\tnb,\n\t\tnl,\n\t\tno,\n\t\tpl,\n\t\tpt,\n\t\tro,\n\t\tru,\n\t\tsi,\n\t\tsk,\n\t\tsv,\n\t\ttr,\n\t\tua\n\t});\n}","import * as utils from \"../../utils/utils\";\nimport * as domHelpers from \"./utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\tvar boxAttribute = \"data-dhxbox\";\n\n\tvar _dhx_msg_cfg = null;\n\n\tfunction callback(config, result) {\n\t\tvar usercall = config.callback;\n\t\tmodalBox.hide(config.box);\n\n\t\t_dhx_msg_cfg = config.box = null;\n\t\tif (usercall)\n\t\t\tusercall(result);\n\t}\n\n\tfunction modal_key(event) {\n\t\tif (_dhx_msg_cfg) {\n\n\t\t\tvar code = event.which || event.keyCode;\n\t\t\tvar preventDefault = false;\n\n\t\t\tif (messageBox.keyboard) {\n\t\t\t\tif (code == 13 || code == 32) {\n\t\t\t\t\t// default behavior is to confirm/submit popup on space/enter\n\t\t\t\t\t// if browser focus is set on button element - do button click instead of default behavior\n\t\t\t\t\tvar target = event.target || event.srcElement;\n\t\t\t\t\tif (domHelpers.getClassName(target).indexOf(\"gantt_popup_button\") > -1 && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback(_dhx_msg_cfg, true);\n\t\t\t\t\t\tpreventDefault = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (code == 27) {\n\t\t\t\t\tcallback(_dhx_msg_cfg, false);\n\t\t\t\t\tpreventDefault = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (preventDefault) {\n\t\t\t\tif (event.preventDefault){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\treturn !(event.cancelBubble = true);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document;\n\tgantt.event(eventElement, \"keydown\", modal_key, true);\n\n\tfunction modality(mode) {\n\t\tif (!modality.cover) {\n\t\t\tmodality.cover = document.createElement(\"div\");\n\t\t\t//necessary for IE only\n\t\t\tmodality.cover.onkeydown = modal_key;\n\t\t\tmodality.cover.className = \"dhx_modal_cover\";\n\t\t\tdocument.body.appendChild(modality.cover);\n\t\t}\n\n\t\tmodality.cover.style.display = mode ? \"inline-block\" : \"none\";\n\t}\n\n\tfunction button(text, className, result) {\n\t\tvar buttonAriaAttrs = gantt._waiAria.messageButtonAttrString(text);\n\t\tvar name = className.toLowerCase().replace(/ /g, \"_\");\n\t\tvar button_css = \"gantt_\" + name + \"_button\";\n\t\treturn \"<div \" + buttonAriaAttrs + \" class='gantt_popup_button \" + button_css + \"' data-result='\" + result + \"' result='\" + result + \"' ><div>\" + text + \"</div></div>\";\n\t}\n\n\tfunction info(text) {\n\t\tif (!messageBox.area) {\n\t\t\tmessageBox.area = document.createElement(\"div\");\n\t\t\tmessageBox.area.className = \"gantt_message_area\";\n\t\t\tmessageBox.area.style[messageBox.position] = \"5px\";\n\t\t\tdocument.body.appendChild(messageBox.area);\n\t\t}\n\n\t\tmessageBox.hide(text.id);\n\t\tvar message = document.createElement(\"div\");\n\t\tmessage.innerHTML = \"<div>\" + text.text + \"</div>\";\n\t\tmessage.className = \"gantt-info gantt-\" + text.type;\n\t\tmessage.onclick = function () {\n\t\t\tmessageBox.hide(text.id);\n\t\t\ttext = null;\n\t\t};\n\n\t\tgantt._waiAria.messageInfoAttr(message);\n\n\t\tif (messageBox.position == \"bottom\" && messageBox.area.firstChild)\n\t\t\tmessageBox.area.insertBefore(message, messageBox.area.firstChild);\n\t\telse\n\t\t\tmessageBox.area.appendChild(message);\n\n\t\tif (text.expire > 0)\n\t\t\tmessageBox.timers[text.id] = window.setTimeout(function () {\n\t\t\t\t// GS-1213: We need that when Gantt is destroyed\n\t\t\t\tif (messageBox) messageBox.hide(text.id);\n\t\t\t}, text.expire);\n\n\t\tmessageBox.pull[text.id] = message;\n\t\tmessage = null;\n\n\t\treturn text.id;\n\t}\n\n\tfunction getFirstDefined() {\n\t\tvar values = [].slice.apply(arguments, [0]);\n\n\t\tfor (var i = 0; i < values.length; i++) {\n\t\t\tif (values[i]) {\n\t\t\t\treturn values[i];\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction _boxStructure(config, ok, cancel) {\n\t\tvar box = document.createElement(\"div\");\n\n\t\tvar contentId = utils.uid();\n\t\tgantt._waiAria.messageModalAttr(box, contentId);\n\n\n\t\tbox.className = \" gantt_modal_box gantt-\" + config.type;\n\t\tbox.setAttribute(boxAttribute, 1);\n\n\t\tvar inner = '';\n\n\t\tif (config.width)\n\t\t\tbox.style.width = config.width;\n\t\tif (config.height)\n\t\t\tbox.style.height = config.height;\n\t\tif (config.title)\n\t\t\tinner += '<div class=\"gantt_popup_title\">' + config.title + '</div>';\n\t\tinner += '<div class=\"gantt_popup_text\" id=\"' + contentId + '\"><span>' + (config.content ? '' : config.text) + '</span></div><div  class=\"gantt_popup_controls\">';\n\t\tif (ok)\n\t\t\tinner += button(getFirstDefined(config.ok, gantt.locale.labels.message_ok, \"OK\"), \"ok\", true);\n\t\tif (cancel)\n\t\t\tinner += button(getFirstDefined(config.cancel, gantt.locale.labels.message_cancel, \"Cancel\"), \"cancel\", false);\n\n\t\tif (config.buttons) {\n\t\t\tfor (var i = 0; i < config.buttons.length; i++) {\n\t\t\t\tvar btn = config.buttons[i];\n\t\t\t\tif (typeof btn == \"object\") {\n\t\t\t\t\t// Support { label:\"Save\", css:\"main_button\", value:\"save\" }\n\t\t\t\t\tvar label = btn.label;\n\t\t\t\t\tvar css = btn.css || (\"gantt_\" + btn.label.toLowerCase() + \"_button\");\n\t\t\t\t\tvar value = btn.value || i;\n\t\t\t\t\tinner += button(label, css, value);\n\t\t\t\t} else {\n\t\t\t\t\tinner += button(btn, btn, i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinner += '</div>';\n\t\tbox.innerHTML = inner;\n\n\t\tif (config.content) {\n\t\t\tvar node = config.content;\n\t\t\tif (typeof node == \"string\")\n\t\t\t\tnode = document.getElementById(node);\n\t\t\tif (node.style.display == 'none')\n\t\t\t\tnode.style.display = \"\";\n\t\t\tbox.childNodes[config.title ? 1 : 0].appendChild(node);\n\t\t}\n\n\t\tbox.onclick = function (event) {\n\t\t\tvar source = event.target || event.srcElement;\n\t\t\tif (!source.className) source = source.parentNode;\n\t\t\tif (domHelpers.closest(source, \".gantt_popup_button\")) {\n\t\t\t\tvar result = source.getAttribute(\"data-result\");\n\t\t\t\tresult = (result == \"true\") || (result == \"false\" ? false : result);\n\t\t\t\tcallback(config, result);\n\t\t\t}\n\t\t};\n\t\tconfig.box = box;\n\t\tif (ok || cancel)\n\t\t\t_dhx_msg_cfg = config;\n\n\t\treturn box;\n\t}\n\n\tfunction _createBox(config, ok, cancel) {\n\t\tvar box = config.tagName ? config : _boxStructure(config, ok, cancel);\n\n\t\tif (!config.hidden)\n\t\t\tmodality(true);\n\t\tdocument.body.appendChild(box);\n\t\tvar x = Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - box.offsetWidth) / 2));\n\t\tvar y = Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - box.offsetHeight) / 2));\n\t\tif (config.position == \"top\")\n\t\t\tbox.style.top = \"-3px\";\n\t\telse\n\t\t\tbox.style.top = y + 'px';\n\t\tbox.style.left = x + 'px';\n\t\t//necessary for IE only\n\t\tbox.onkeydown = modal_key;\n\n\t\tmodalBox.focus(box);\n\n\t\tif (config.hidden)\n\t\t\tmodalBox.hide(box);\n\n\t\tgantt.callEvent(\"onMessagePopup\", [box]);\n\t\treturn box;\n\t}\n\n\tfunction alertPopup(config) {\n\t\treturn _createBox(config, true, false);\n\t}\n\n\tfunction confirmPopup(config) {\n\t\treturn _createBox(config, true, true);\n\t}\n\n\tfunction boxPopup(config) {\n\t\treturn _createBox(config);\n\t}\n\n\tfunction box_params(text, type, callback) {\n\t\tif (typeof text != \"object\") {\n\t\t\tif (typeof type == \"function\") {\n\t\t\t\tcallback = type;\n\t\t\t\ttype = \"\";\n\t\t\t}\n\t\t\ttext = {text: text, type: type, callback: callback};\n\t\t}\n\t\treturn text;\n\t}\n\n\tfunction params(text, type, expire, id) {\n\t\tif (typeof text != \"object\")\n\t\t\ttext = {text: text, type: type, expire: expire, id: id};\n\t\ttext.id = text.id || utils.uid();\n\t\ttext.expire = text.expire || messageBox.expire;\n\t\treturn text;\n\t}\n\n\tvar alertBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"confirm\";\n\t\treturn alertPopup(text);\n\t};\n\tvar confirmBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn confirmPopup(text);\n\t};\n\tvar modalBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn boxPopup(text);\n\t};\n\tmodalBox.hide = function (node) {\n\t\twhile (node && node.getAttribute && !node.getAttribute(boxAttribute))\n\t\t\tnode = node.parentNode;\n\t\tif (node) {\n\t\t\tnode.parentNode.removeChild(node);\n\t\t\tmodality(false);\n\n\t\t\tgantt.callEvent(\"onAfterMessagePopup\", [node]);\n\t\t}\n\t};\n\n\tmodalBox.focus = function (node) {\n\t\tsetTimeout(function () {\n\t\t\tvar focusable = domHelpers.getFocusableNodes(node);\n\t\t\tif (focusable.length) {\n\t\t\t\tif (focusable[0].focus) focusable[0].focus();\n\t\t\t}\n\t\t}, 1);\n\t};\n\n\tvar messageBox = function (text, type, expire, id) {\n\t\ttext = params.apply(this, arguments);\n\t\ttext.type = text.type || \"info\";\n\n\t\tvar subtype = text.type.split(\"-\")[0];\n\t\tswitch (subtype) {\n\t\t\tcase \"alert\":\n\t\t\t\treturn alertPopup(text);\n\t\t\tcase \"confirm\":\n\t\t\t\treturn confirmPopup(text);\n\t\t\tcase \"modalbox\":\n\t\t\t\treturn boxPopup(text);\n\t\t\tdefault:\n\t\t\t\treturn info(text);\n\t\t}\n\t};\n\n\tmessageBox.seed = (new Date()).valueOf();\n\tmessageBox.uid = utils.uid;\n\tmessageBox.expire = 4000;\n\tmessageBox.keyboard = true;\n\tmessageBox.position = \"top\";\n\tmessageBox.pull = {};\n\tmessageBox.timers = {};\n\n\tmessageBox.hideAll = function () {\n\t\tfor (var key in messageBox.pull)\n\t\t\tmessageBox.hide(key);\n\t};\n\tmessageBox.hide = function (id) {\n\t\tvar obj = messageBox.pull[id];\n\t\tif (obj && obj.parentNode) {\n\t\t\twindow.setTimeout(function () {\n\t\t\t\tobj.parentNode.removeChild(obj);\n\t\t\t\tobj = null;\n\t\t\t}, 2000);\n\t\t\tobj.className += \" hidden\";\n\n\t\t\tif (messageBox.timers[id])\n\t\t\t\twindow.clearTimeout(messageBox.timers[id]);\n\t\t\tdelete messageBox.pull[id];\n\t\t}\n\t};\n\n\tvar popups = [];\n\tgantt.attachEvent(\"onMessagePopup\", function(box){\n\t\tpopups.push(box);\n\t});\n\tgantt.attachEvent(\"onAfterMessagePopup\", function(box){\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i] === box){\n\t\t\t\tpopups.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tif(modality.cover && modality.cover.parentNode){\n\t\t\tmodality.cover.parentNode.removeChild(modality.cover);\n\t\t}\n\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i].parentNode){\n\t\t\t\tpopups[i].parentNode.removeChild(popups[i]);\n\t\t\t}\n\t\t}\n\t\tpopups = null;\n\n\t\tif(messageBox.area && messageBox.area.parentNode){\n\t\t\tmessageBox.area.parentNode.removeChild(messageBox.area);\n\t\t}\n\t\tmessageBox = null;\n\t});\n\n\treturn {\n\t\talert: alertBox,\n\t\tconfirm: confirmBox,\n\t\tmessage: messageBox,\n\t\tmodalbox: modalBox\n\t};\n};","import * as utils from \"../../utils/utils\";\n\nfunction extendSettings (store, parentSettings){\n\tvar own = this.$config[store];\n\n\tif(own){\n\t\tif(!own.$extendedConfig){\n\t\t\town.$extendedConfig = true;\n\t\t\tObject.setPrototypeOf(own, parentSettings);\n\t\t}\n\t\treturn own;\n\t}else{\n\t\treturn parentSettings;\n\t}\n}\n\nvar configurable = function(parentView){\n\tvar parentConfig,\n\t\tparentTemplates;\n\n\treturn {\n\t\t$getConfig: function(){\n\t\t\tif(!parentConfig){\n\t\t\t\tparentConfig = parentView ? parentView.$getConfig() : this.$gantt.config;\n\t\t\t}\n\t\t\tif(!this.$config.config){\n\t\t\t\treturn parentConfig;\n\t\t\t}else{\n\t\t\t\treturn extendSettings.call(this, \"config\", parentConfig);\n\t\t\t}\n\t\t},\n\t\t$getTemplates: function(){\n\t\t\tif(!parentTemplates){\n\t\t\t\tparentTemplates = parentView ? parentView.$getTemplates() : this.$gantt.templates;\n\t\t\t}\n\t\t\tif(!this.$config.templates){\n\t\t\t\treturn parentTemplates;\n\t\t\t}else{\n\t\t\t\treturn extendSettings.call(this, \"templates\", parentTemplates);\n\t\t\t}\n\t\t}\n\t};\n};\n\nexport default function(obj, parent){\n\tutils.mixin(obj, configurable(parent));\n};","import * as utils from \"../../utils/utils\";\nimport configurable from \"./configurable\";\n\nvar uiFactory = function createFactory(gantt){\n\tvar views = {};\n\n\tfunction ui(cell, parentView) {\n\t\tvar content;\n\t\tvar view = \"cell\";\n\t\tif (cell.view){\n\t\t\tview = \"viewcell\";\n\t\t}else if (cell.resizer) {\n\t\t\tview = \"resizer\";\n\t\t}\n\t\telse if (cell.rows || cell.cols) {\n\t\t\tview = \"layout\";\n\t\t}\n\t\telse if (cell.views) {\n\t\t\tview = \"multiview\";\n\t\t}\n\n\t\tcontent = createView.call(this, view, null, cell, parentView);\n\t\treturn content;\n\t}\n\t\n\tvar createdViews = {};\n\n\tfunction createView(name, parent, config, parentView) {\n\t\tvar creator = views[name];\n\n\t\tif(!creator || !creator.create)\n\t\t\treturn false;\n\n\t\tif(name == \"resizer\" && !config.mode){\n\t\t\tif(parentView.$config.cols){\n\t\t\t\tconfig.mode = \"x\";\n\t\t\t}else{\n\t\t\t\tconfig.mode = \"y\";\n\t\t\t}\n\t\t}\n\n\t\tif(name == \"viewcell\" && config.view == \"scrollbar\" && !config.scroll){\n\t\t\tif(parentView.$config.cols){\n\t\t\t\tconfig.scroll = \"y\";\n\t\t\t}else{\n\t\t\t\tconfig.scroll = \"x\";\n\t\t\t}\n\t\t}\n\n\t\tvar config = utils.copy(config);\n\n\t\tif(!config.id && !createdViews[config.view]){\n\t\t\tconfig.id = config.view;\n\t\t}\n\n\t\tif(config.id && !config.css){\n\t\t\tconfig.css = config.id+\"_cell\";\n\t\t}\n\n\t\tvar view = new creator.create(parent, config, this, gantt);\n\n\t\tif(creator.configure){\n\t\t\tcreator.configure(view);\n\t\t}\n\n\t\tconfigurable(view, parentView);\n\t\tif(!view.$id){\n\t\t\tview.$id = config.id || gantt.uid();\n\t\t}\n\n\t\tif(!view.$parent && typeof parent == \"object\"){\n\t\t\tview.$parent = parent;\n\t\t}\n\t\tif(!view.$config){\n\t\t\tview.$config = config;\n\t\t}\n\n\t\tif(createdViews[view.$id]){\n\t\t\tview.$id = gantt.uid();\n\t\t}\n\n\t\tcreatedViews[view.$id] = view;\n\n\t\treturn view;\n\t}\n\n\tfunction reset(){\n\t\tcreatedViews = {};\n\t}\n\n\tfunction register(name, viewConstructor, configure){\n\t\tviews[name] = {create: viewConstructor, configure: configure};\n\t}\n\n\tfunction getView(id){\n\t\treturn createdViews[id];\n\t}\n\n\tvar factory = {\n\t\tinitUI:ui,\n\t\treset: reset,\n\t\tregisterView: register,\n\t\tcreateView: createView,\n\t\tgetView: getView\n\t};\n\n\treturn factory;\n};\n\nexport default {\n\tcreateFactory: uiFactory\n};\n\n","import * as domHelpers from \"./utils/dom_helpers\";\n\nvar createMouseHandler = (function(domHelpers) {\n\treturn function (gantt) {\n\t\tvar eventHandlers = {\n\t\t\t\"click\": {},\n\t\t\t\"doubleclick\": {},\n\t\t\t\"contextMenu\": {}\n\t\t};\n\n\t\tfunction addEventTarget(event, className, handler, root) {\n\t\t\tif(!eventHandlers[event][className]){\n\t\t\t\teventHandlers[event][className] = [];\n\t\t\t}\n\n\t\t\teventHandlers[event][className].push({\n\t\t\t\thandler: handler,\n\t\t\t\troot: root\n\t\t\t});\n\t\t}\n\n\t\tfunction callHandler(eventName, className, root, args) {\n\t\t\tvar handlers = eventHandlers[eventName][className];\n\t\t\tif(handlers){\n\t\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\t\tif(!(root || handlers[i].root) || handlers[i].root === root){\n\t\t\t\t\t\thandlers[i].handler.apply(this, args);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onClick(e) {\n\t\t\te = e || window.event;\n\t\t\tvar id = gantt.locate(e);\n\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.click);\n\t\t\tvar res = true;\n\t\t\tif (id !== null) {\n\t\t\t\tres = !gantt.checkEvent(\"onTaskClick\") || gantt.callEvent(\"onTaskClick\", [id, e]);\n\t\t\t} else {\n\t\t\t\tgantt.callEvent(\"onEmptyClick\", [e]);\n\t\t\t}\n\n\t\t\tif (res) {\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\n\t\t\t\tif (!default_action)\n\t\t\t\t\treturn;\n\n\t\t\t\t// GS-1025: if we don't do that, the dropdown or date select will be closed for unselected tasks\n\t\t\t\t// GS-1078: or for the built-in select inline editor\n\t\t\t\tswitch(e.target.nodeName) {\n\t\t\t\t\tcase \"SELECT\":\n\t\t\t\t\tcase 'INPUT':\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//allow task selection when the multiselect plugin is not enabled\n\t\t\t\tif (id && gantt.getTask(id) && !gantt._multiselect && gantt.config.select_task) {\n\t\t\t\t\tgantt.selectTask(id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onContextMenu(e) {\n\t\t\te = e || window.event;\n\t\t\tvar src = e.target || e.srcElement,\n\t\t\t\ttaskId = gantt.locate(src),\n\t\t\t\tlinkId = gantt.locate(src, gantt.config.link_attribute);\n\n\t\t\tvar res = !gantt.checkEvent(\"onContextMenu\") || gantt.callEvent(\"onContextMenu\", [taskId, linkId, e]);\n\t\t\tif (!res) {\n\t\t\t\tif (e.preventDefault)\n\t\t\t\t\te.preventDefault();\n\t\t\t\telse\n\t\t\t\t\te.returnValue = false;\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\n\t\tfunction findEventHandlers(e, hash){\n\t\t\tvar trg = e.target || e.srcElement;\n\t\t\tvar handlers = [];\n\t\t\twhile (trg) {\n\t\t\t\tvar css = domHelpers.getClassName(trg);\n\t\t\t\tif (css) {\n\t\t\t\t\tcss = css.split(\" \");\n\t\t\t\t\tfor (var i = 0; i < css.length; i++) {\n\t\t\t\t\t\tif (!css[i]) continue;\n\t\t\t\t\t\tif (hash[css[i]]) {\n\t\t\t\t\t\t\tvar delegateHandlers = hash[css[i]];\n\n\t\t\t\t\t\t\tfor(var h = 0; h < delegateHandlers.length; h++){\n\t\t\t\t\t\t\t\tif(delegateHandlers[h].root){\n\t\t\t\t\t\t\t\t\tif(!domHelpers.isChildOf(trg, delegateHandlers[h].root)){\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thandlers.push(delegateHandlers[h].handler);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttrg = trg.parentNode;\n\t\t\t}\n\t\t\treturn handlers;\n\t\t}\n\n\t\tfunction callEventHandlers(handlers, e, id){\n\t\t\tvar res = true;\n\n\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\tvar handlerResult =  handlers[i].call(gantt, e, id, e.target || e.srcElement);\n\t\t\t\tres = res && !(typeof handlerResult != \"undefined\" && handlerResult !== true);\n\t\t\t}\n\n\t\t\treturn res;\n\t\t}\n\n\n\t\tfunction onDoubleClick(e) {\n\t\t\te = e || window.event;\n\t\t\tvar id = gantt.locate(e);\n\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.doubleclick);\n\t\t\t// when doubleclick fired not on task, id === null\n\t\t\tvar res = !gantt.checkEvent(\"onTaskDblClick\") || id === null || gantt.callEvent(\"onTaskDblClick\", [id, e]);\n\t\t\tif (res) {\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\n\t\t\t\tif (!default_action)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (id !== null && gantt.getTask(id)) {\n\t\t\t\t\tif (res && gantt.config.details_on_dblclick && !gantt.isReadonly(id)) {\n\t\t\t\t\t\tgantt.showLightbox(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseMove(e) {\n\t\t\tif (gantt.checkEvent(\"onMouseMove\")) {\n\t\t\t\tvar id = gantt.locate(e);\n\t\t\t\tgantt._last_move_event = e;\n\t\t\t\tgantt.callEvent(\"onMouseMove\", [id, e]);\n\t\t\t}\n\t\t}\n\n\t\tfunction detach(eventName, className, handler, root) {\n\t\t\tif (eventHandlers[eventName] && eventHandlers[eventName][className]) {\n\t\t\t\tvar handlers = eventHandlers[eventName];\n\t\t\t\tvar elementHandlers = handlers[className];\n\t\t\t\tfor(var i = 0; i < elementHandlers.length; i++){\n\t\t\t\t\tif(elementHandlers[i].root == root){\n\t\t\t\t\t\telementHandlers.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!elementHandlers.length){\n\t\t\t\t\tdelete handlers[className];\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tvar domEvents = gantt._createDomEventScope();\n\n\t\tfunction reset(node){\n\n\t\t\tdomEvents.detachAll();\n\n\t\t\tif(node){\n\t\t\t\tdomEvents.attach(node, \"click\", onClick);\n\t\t\t\tdomEvents.attach(node, \"dblclick\", onDoubleClick);\n\t\t\t\tdomEvents.attach(node, \"mousemove\", onMouseMove);\n\t\t\t\tdomEvents.attach(node, \"contextmenu\", onContextMenu);\n\t\t\t}\n\t\t}\n\n\n\n\t\treturn {\n\t\t\treset: reset,\n\t\t\tglobal: function(event, classname, handler){\n\t\t\t\taddEventTarget(event, classname, handler, null);\n\t\t\t},\n\t\t\tdelegate: addEventTarget,\n\t\t\tdetach: detach,\n\t\t\tcallHandler: callHandler,\n\t\t\tonDoubleClick: onDoubleClick,\n\t\t\tonMouseMove: onMouseMove,\n\t\t\tonContextMenu: onContextMenu,\n\t\t\tonClick: onClick,\n\t\t\tdestructor: function(){\n\t\t\t\treset();\n\t\t\t\teventHandlers = null;\n\t\t\t\tdomEvents = null;\n\t\t\t}\n\n\t\t};\n\t};\n\n})(domHelpers);\n\n\nexport default {\n\tinit:createMouseHandler\n};","export default function(viewport, box, gantt){\n\tif(!box){\n\t\treturn false;\n\t}\n\n\tif(box.left > viewport.x_end || box.left + box.width < viewport.x){\n\t\treturn false;\n\t}\n\n\tif(box.top > viewport.y_end || box.top + box.height < viewport.y){\n\t\treturn false;\n\t}\n\t\n\treturn true;\n};","export default function(gantt){\n\treturn gantt.config.smart_rendering && gantt._smart_render;\n};","export default function(item, view, config){\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: 0,\n\t\tright: Infinity\n\t};\n};","export default function getVisibleTasksRange(gantt, view, config, datastore, viewport){\n\tvar buffer = 1;\n\tvar start = view.getItemIndexByTopPosition(viewport.y) || 0;\n\tvar end = view.getItemIndexByTopPosition(viewport.y_end) || datastore.count();\n\tvar indexStart = Math.max(0, start - buffer);\n\tvar indexEnd =  Math.min(datastore.count(), end + buffer);\n\t// GS-2481 and GS-1715, need to take into account selected task when using keyboard shortcuts and when the inline editor is opened \n\tconst extraTasksIds= [];\n\tif (gantt.config.keyboard_navigation && gantt.getSelectedId()) {\n\t\textraTasksIds.push(gantt.getSelectedId());\n\t}\n\tif (gantt.$ui.getView(\"grid\") && gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id) {\n\t\tlet inlineEditorId = gantt.ext.inlineEditors.getState().id;\n\t\tif (datastore.exists(inlineEditorId)){\n\t\t\textraTasksIds.push(inlineEditorId);\n\t\t}\n\t}\n\treturn {\n\t\tstart: indexStart,\n\t\tend: indexEnd,\n\t\tids: extraTasksIds \n\t};\n};","import genericViewPortChecker from \"./viewport/is_in_viewport\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\nimport basicGetRectangle from \"./viewport/get_grid_row_rectangle\";\nimport basicGetRange from \"./viewport/get_visible_bars_range\";\nvar rendererFactory = function(gantt){\n\n\t//hash of dom elements is needed to redraw single bar/link\n\tvar task_area_pulls = {},\n\t\ttask_area_renderers = {};\n\n\tfunction getView(layer){\n\t\tvar view = null;\n\t\tif (typeof layer.view === \"string\") {\n\t\t\tview = gantt.$ui.getView(layer.view);\n\t\t} else if (layer.view) {\n\t\t\tview = layer.view;\n\t\t}\n\t\treturn view;\n\t}\n\n\tfunction getRenderer(id, layer, node) {\n\t\t\n\t\tif (task_area_renderers[id])\n\t\t\treturn task_area_renderers[id];\n\n\t\tif (!layer.renderer)\n\t\t\tgantt.assert(false, \"Invalid renderer call\");\n\n\t\tvar renderMethod = null;\n\t\tvar updateMethod = null;\n\t\tvar getRectangle = null;\n\t\tvar renderCallbackMethod = null;\n\t\tvar specializedViewPortChecker = null;\n\n\t\tif(typeof layer.renderer === \"function\"){\n\t\t\trenderMethod = layer.renderer;\n\t\t\tgetRectangle = basicGetRectangle;\n\t\t}else{\n\t\t\trenderMethod = layer.renderer.render;\n\t\t\tupdateMethod = layer.renderer.update;\n\t\t\trenderCallbackMethod = layer.renderer.onrender;\n\t\t\t\n\t\t\tif(layer.renderer.isInViewPort){\n\t\t\t\tspecializedViewPortChecker = layer.renderer.isInViewPort;\n\t\t\t}else{\n\t\t\t\tgetRectangle = layer.renderer.getRectangle;\n\t\t\t}\n\n\t\t\tif (!getRectangle && getRectangle !== null) {\n\t\t\t\tgetRectangle = basicGetRectangle;\n\t\t\t}\n\t\t}\n\n\t\tvar filter = layer.filter;\n\n\t\tif (node)\n\t\t\tnode.setAttribute(gantt.config.layer_attribute, true);\n\n\t\ttask_area_renderers[id] = {\n\t\t\trender_item: function (item, container, viewPort, layerView, viewConfig) {\n\t\t\t\tcontainer = container || node;\n\t\t\t\tif (filter) {\n\t\t\t\t\tif (!filter(item)) {\n\t\t\t\t\t\tthis.remove_item(item.id);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar view = layerView || getView(layer);\n\t\t\t\tvar config = viewConfig || (view ? view.$getConfig() : null);\n\t\t\t\tvar rendererViewPort = viewPort;\n\t\t\t\tif(!rendererViewPort && config && config.smart_rendering){\n\t\t\t\t\trendererViewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar dom = null;\n\t\t\t\tif(!isLegacyRender(gantt) && (getRectangle || specializedViewPortChecker) && rendererViewPort){\n\t\t\t\t\tvar isVisible = false;\n\t\t\t\t\tif(specializedViewPortChecker){\n\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, rendererViewPort, view, config, gantt);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tisVisible = genericViewPortChecker(rendererViewPort, getRectangle(item, view, config, gantt), gantt);\n\t\t\t\t\t}\n\t\t\t\t\tif(isVisible){\n\t\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\n\t\t\t\t}\n\t\t\t\tthis.append(item, dom, container);\n\n\t\t\t\tvar useBuffer = container.nodeType == 11;//DocumentFragment\n\t\t\t\tif(renderCallbackMethod && !useBuffer && dom) {\n\t\t\t\t\trenderCallbackMethod.call(gantt, item, dom, view);\n\t\t\t\t} \n\t\t\t},\n\n\t\t\tclear: function (container) {\n\n\t\t\t\tthis.rendered = task_area_pulls[id] = {};\n\t\t\t\tif(!layer.append)\n\t\t\t\t\tthis.clear_container(container);\n\t\t\t},\n\t\t\tclear_container: function (container) {\n\t\t\t\tcontainer = container || node;\n\t\t\t\tif (container){\n\t\t\t\t\tcontainer.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_visible_range: function(datastore){\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewport;\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\n\t\t\t\t\tviewport = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar range;\n\t\t\t\tif(view && viewport){\n\t\t\t\t\tif(typeof layer.renderer === \"function\"){\n\t\t\t\t\t\trange = basicGetRange(gantt, view, viewConfig, datastore, viewport);\n\t\t\t\t\t}else if(layer.renderer && layer.renderer.getVisibleRange){\n\t\t\t\t\t\trange = layer.renderer.getVisibleRange(gantt, view, viewConfig, datastore, viewport);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!range){\n\t\t\t\t\trange = {\n\t\t\t\t\t\tstart: 0,\n\t\t\t\t\t\tend: datastore.count()\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn range;\n\t\t\t},\n\t\t\tprepare_data: function(items){\n\t\t\t\tif(layer.renderer && layer.renderer.prepareData){\n\t\t\t\t\treturn layer.renderer.prepareData(items, gantt, layer);\n\t\t\t\t}\n\t\t\t},\n\t\t\trender_items: function (items, container) {\n\t\t\t\tcontainer = container || node;\n\n\t\t\t\tvar buffer = document.createDocumentFragment();\n\t\t\t\tthis.clear(container);\n\n\t\t\t\tvar viewPort = null;\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\n\t\t\t\t\tviewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\n\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\n\t\t\t\t}\n\n\t\t\t\tcontainer.appendChild(buffer, container);\n\n\t\t\t\tvar itemsSearch = {};\n\t\t\t\titems.forEach(function(item){\n\t\t\t\t\titemsSearch[item.id] = item;\n\t\t\t\t});\n\t\t\t\tvar renderedItems = {};\n\t\t\t\tif (renderCallbackMethod) {\n\t\t\t\t\tvar newElements = {};\n\t\t\t\t\tfor(var i in this.rendered) {\n\t\t\t\t\t\tif(!renderedItems[i]){\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate_items: function (items, container) {\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(!view || !view.$getConfig().smart_rendering || isLegacyRender(gantt)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!this.rendered){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!(getRectangle || specializedViewPortChecker)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcontainer = container || node;\n\n\t\t\t\tvar buffer = document.createDocumentFragment();\n\n\t\t\t\tvar viewPort = null;\n\t\t\t\tif(view){\n\t\t\t\t\tviewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar itemsSearch = {};\n\t\t\t\titems.forEach(function(item){\n\t\t\t\t\titemsSearch[item.id] = item;\n\t\t\t\t});\n\t\t\t\tvar renderedItems = {};\n\n\t\t\t\tvar nodesToRemove = {};\n\t\t\t\tfor(var i in this.rendered){\n\t\t\t\t\tnodesToRemove[i] = true;\n\t\t\t\t\trenderedItems[i] = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar renderCalledFor = {};\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\n\t\t\t\t\tvar item = items[i];\n\t\t\t\t\tvar itemNode = this.rendered[item.id];\n\t\t\t\t\tnodesToRemove[item.id] = false;\n\t\t\t\t\tif (itemNode && itemNode.parentNode) {\n\t\t\t\t\t\tvar isVisible = false;\n\t\t\t\t\t\tif(specializedViewPortChecker){\n\t\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, viewPort, view, viewConfig, gantt);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tisVisible = genericViewPortChecker(viewPort, getRectangle(item, view, viewConfig, gantt), gantt);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isVisible) {\n\t\t\t\t\t\t\tnodesToRemove[item.id] = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(updateMethod){\n\t\t\t\t\t\t\t\tupdateMethod.call(gantt, item, itemNode, view, viewConfig, viewPort);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.restore(item, buffer);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trenderCalledFor[items[i].id] = true;\n\t\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(var i in nodesToRemove){\n\t\t\t\t\tif(nodesToRemove[i]){\n\t\t\t\t\t\tthis.hide(i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(buffer.childNodes.length){\n\t\t\t\t\tcontainer.appendChild(buffer, container);\n\t\t\t\t}\n\n\t\t\t\tif (renderCallbackMethod) {\n\t\t\t\t\tvar newElements = {};\n\t\t\t\t\tfor(var i in this.rendered) {\n\t\t\t\t\t\tif(!renderedItems[i] || renderCalledFor[i]){\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tappend: function (item, node, container) {\n\t\t\t\tif(!this.rendered){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!node) {\n\t\t\t\t\tif (this.rendered[item.id]) {\n\t\t\t\t\t\tthis.remove_item(item.id);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.rendered[item.id] && this.rendered[item.id].parentNode) {\n\t\t\t\t\tthis.replace_item(item.id, node);\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t}\n\t\t\t\tthis.rendered[item.id] = node;\n\t\t\t},\n\t\t\treplace_item: function (item_id, newNode) {\n\t\t\t\tvar item = this.rendered[item_id];\n\t\t\t\tif (item && item.parentNode) {\n\t\t\t\t\titem.parentNode.replaceChild(newNode, item);\n\n\t\t\t\t}\n\t\t\t\tthis.rendered[item_id] = newNode;\n\t\t\t},\n\t\t\tremove_item: function (item_id) {\n\t\t\t\tthis.hide(item_id);\n\t\t\t\tdelete this.rendered[item_id];\n\t\t\t},\n\t\t\thide: function (item_id) {\n\t\t\t\tvar item = this.rendered[item_id];\n\t\t\t\tif (item && item.parentNode) {\n\t\t\t\t\titem.parentNode.removeChild(item);\n\t\t\t\t}\n\t\t\t},\n\t\t\trestore: function (item, container) {\n\t\t\t\tvar dom = this.rendered[item.id];\n\t\t\t\tif (dom) {\n\t\t\t\t\tif (!dom.parentNode) {\n\t\t\t\t\t\tthis.append(item, dom, container || node);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.render_item(item, container || node);\n\t\t\t\t}\n\t\t\t},\n\t\t\tchange_id: function (oldid, newid) {\n\t\t\t\tthis.rendered[newid] = this.rendered[oldid];\n\t\t\t\tdelete this.rendered[oldid];\n\t\t\t},\n\t\t\trendered: task_area_pulls[id],\n\t\t\tnode: node,\n\t\t\tdestructor: function () {\n\t\t\t\tthis.clear();\n\t\t\t\tdelete task_area_renderers[id];\n\t\t\t\tdelete task_area_pulls[id];\n\t\t\t}\n\t\t};\n\n\t\treturn task_area_renderers[id];\n\t}\n\n\n\tfunction clearRenderers() {\n\t\tfor (var i in task_area_renderers) {\n\t\t\tgetRenderer(i).destructor();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetRenderer: getRenderer,\n\t\tclearRenderers: clearRenderers\n\t};\n\n};\n\nexport default rendererFactory;","import renderFactoryProvider from \"./render_factory\";\nimport * as utils from \"../../../utils/utils\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\n\nvar layerFactory = function(gantt){\n\n\tvar renderFactory = renderFactoryProvider(gantt);\n\treturn {\n\tcreateGroup: function (getContainer, relativeRoot, defaultFilters, initLayer) {\n\n\t\tvar renderGroup = {\n\t\t\ttempCollection: [],\n\t\t\trenderers: {},\n\t\t\tcontainer: getContainer,\n\t\t\tfilters: [],\n\t\t\tgetLayers: function () {\n\t\t\t\tthis._add();// add pending layers\n\n\t\t\t\tvar res = [];\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tres.push(this.renderers[i]);\n\t\t\t\t}\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\tgetLayer: function (id) {\n\t\t\t\treturn this.renderers[id];\n\t\t\t},\n\t\t\t_add: function (layer) {\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayer.id = layer.id || utils.uid();\n\t\t\t\t\tthis.tempCollection.push(layer);\n\t\t\t\t}\n\n\t\t\t\tvar container = this.container();\n\n\t\t\t\tvar pending = this.tempCollection;\n\t\t\t\tfor (var i = 0; i < pending.length; i++) {\n\t\t\t\t\tlayer = pending[i];\n\n\t\t\t\t\tif (!this.container() && !(layer && layer.container && domHelpers.isChildOf(layer.container, document.body))) continue;\n\n\t\t\t\t\tvar node = layer.container,\n\t\t\t\t\t\tid = layer.id,\n\t\t\t\t\t\ttopmost = layer.topmost;\n\t\t\t\t\tif (!node.parentNode) {\n\t\t\t\t\t\t//insert on top or below the tasks\n\t\t\t\t\t\tif (topmost) {\n\t\t\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar rel = relativeRoot ? relativeRoot() : container.firstChild;\n\t\t\t\t\t\t\t// GS-1274: if we don't add the second check, Gantt stops working if\n\t\t\t\t\t\t\t// we add the task layer without the timeline and switch to a layout with the timeline\n\t\t\t\t\t\t\tif (rel && rel.parentNode == container)\n\t\t\t\t\t\t\t\tcontainer.insertBefore(node, rel);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.renderers[id] = renderFactory.getRenderer(\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tlayer,\n\t\t\t\t\t\tnode\n\t\t\t\t\t);\n\n\t\t\t\t\tif (initLayer) {\n\t\t\t\t\t\tinitLayer(layer, gantt);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.tempCollection.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t},\n\t\t\taddLayer: function (config) {\n\t\t\t\tif(config){\n\t\t\t\t\tif(typeof config == \"function\"){\n\t\t\t\t\t\tconfig = {renderer: config};\n\t\t\t\t\t}\n\n\t\t\t\t\tif(config.filter === undefined){\n\t\t\t\t\t\tconfig.filter = mergeFilters(defaultFilters || []);\n\t\t\t\t\t}else if(config.filter instanceof Array){\n\t\t\t\t\t\tconfig.filter.push(defaultFilters);\n\t\t\t\t\t\tconfig.filter = mergeFilters(config.filter);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(!config.container){\n\t\t\t\t\t\tconfig.container = document.createElement(\"div\");\n\t\t\t\t\t}\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tconfig.requestUpdate = function(){\n\t\t\t\t\t\tif(gantt.config.smart_rendering && !isLegacyRender(gantt)){\n\t\t\t\t\t\t\tif(self.renderers[config.id]){\n\t\t\t\t\t\t\t\tself.onUpdateRequest(self.renderers[config.id]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis._add(config);\n\t\t\t\treturn (config ? config.id : undefined);\n\t\t\t},\n\t\t\tonUpdateRequest: function(layer){\n\n\t\t\t},\n\n\t\t\teachLayer: function(code){\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tcode(this.renderers[i]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveLayer: function (id) {\n\t\t\t\tif(!this.renderers[id])\n\t\t\t\t\treturn;\n\t\t\t\tthis.renderers[id].destructor();\n\t\t\t\tdelete this.renderers[id];\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tthis.renderers[i].destructor();\n\t\t\t\t}\n\t\t\t\tthis.renderers = {};\n\t\t\t}//,\n\t\t\t//prepareConfig: prepareConfig\n\t\t};\n\n\t\tgantt.attachEvent(\"onDestroy\", function(){\n\t\t\trenderGroup.clear();\n\t\t\trenderGroup = null;\n\t\t});\n\n\t\treturn renderGroup;\n\t}\n};};\n\n\nfunction mergeFilters(filter_methods){\n\tif(!(filter_methods instanceof Array)){\n\t\tfilter_methods = Array.prototype.slice.call(arguments, 0);\n\t}\n\n\treturn function(obj){\n\t\tvar res = true;\n\t\tfor(var i = 0, len = filter_methods.length; i < len; i++){\n\t\t\tvar filter_method = filter_methods[i];\n\t\t\tif(filter_method){\n\t\t\t\tres = res && (filter_method(obj.id, obj) !== false);\n\t\t\t}\n\t\t}\n\n\t\treturn res;\n\t};\n}\n\n\nexport default layerFactory;\n","export default function(item, view, config){\n\tif(!item.start_date || !item.end_date){\n\t\treturn null;\n\t}\n\tvar padding = 200;\n\tvar startCoord = view.posFromDate(item.start_date);\n\tvar endCoord = view.posFromDate(item.end_date);\n\tvar left = Math.min(startCoord, endCoord) - padding;\n\tvar right = Math.max(startCoord, endCoord) + padding;\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: left,\n\t\twidth: right - left\n\t};\n};","import getLinkRectangle from \"../get_link_rectangle\";\n\nexport default function(){\n\tvar coordinates = [];\n\tvar calculated = false;\n\n\tfunction clearCache(){\n\t\tcoordinates = [];\n\t\tcalculated = false;\n\t}\n\n\tfunction buildCache(datastore, view, gantt){\n\t\tvar config = view.$getConfig();\n\t\tvar visibleItems = datastore.getVisibleItems();\n\t\t//datastore.eachItem(function(link){\n\t\tvisibleItems.forEach(function(link){\n\t\t\tvar rec = getLinkRectangle(link, view, config, gantt);\n\t\t\tif(!rec){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcoordinates.push({id: link.id, rec: rec});\n\t\t});\n\n\t\tcoordinates.sort(function(a, b){\n\t\t\tif(a.rec.right < b.rec.right){\n\t\t\t\treturn -1;\n\t\t\t}else {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t});\n\n\t\tcalculated = true;\n\t}\n\n\tvar initialized = false;\n\tfunction init(datastore){\n\t\tif(initialized){\n\t\t\treturn;\n\t\t}\n\t\tinitialized = true;\n\t\tdatastore.attachEvent(\"onPreFilter\", clearCache);\n\t\tdatastore.attachEvent(\"onStoreUpdated\", clearCache);\n\t\tdatastore.attachEvent(\"onClearAll\", clearCache);\n\t\tdatastore.attachEvent(\"onBeforeStoreUpdate\", clearCache);\n\t}\n\n\treturn function getVisibleLinksRange(gantt, view, config, datastore, viewport){\n\t\tinit(datastore);\n\t\tif(!calculated){\n\t\t\tbuildCache(datastore, view, gantt);\n\t\t}\n\n\t\tvar visibleBoxes = [];\n\t\tfor(var i = 0; i < coordinates.length; i++){\n\t\t\tvar item = coordinates[i];\n\t\t\tvar box = item.rec;\n\t\t\tif(box.right < viewport.x){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(box.left < viewport.x_end && box.right > viewport.x && box.top < viewport.y_end && box.bottom > viewport.y){\n\t\t\t\tvisibleBoxes.push(item.id);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn {\n\t\t\tids: visibleBoxes\n\t\t};\n\t};\n};","\n\nimport barRectangle from \"./get_bar_rectangle\";\n\nexport default function getLinkBox(item, view, config, gantt){\n\tif(!gantt.isTaskExists(item.source)){\n\t\treturn null;\n\t}\n\n\tif(!gantt.isTaskExists(item.target)){\n\t\treturn null;\n\t}\n\tvar sourceBox = barRectangle(gantt.getTask(item.source), view, gantt);\n\tvar targetBox = barRectangle(gantt.getTask(item.target), view, gantt);\n\n\tif(!sourceBox || !targetBox){\n\t\treturn null;\n\t}\n\n\tvar padding = 100;\n\tvar left = Math.min(sourceBox.left, targetBox.left) - padding;\n\tvar right = Math.max(sourceBox.left + sourceBox.width, targetBox.left + targetBox.width) + padding;\n\tvar top = Math.min(sourceBox.top, targetBox.top) - padding;\n\tvar bottom = Math.max(sourceBox.top + sourceBox.height, targetBox.top + targetBox.height) + padding;\n\n\treturn {\n\t\ttop: top,\n\t\theight: bottom - top,\n\t\tbottom,\n\t\tleft: left,\n\t\twidth: right - left,\n\t\tright\n\t};\n};\n","\n// optimized checker for links smart rendering\n\n// first check the vertical position since it's easier to calculate\n\nexport default function isLinkInViewPort(item, viewport, view, config, gantt){\n\tvar source = view.$gantt.getTask(item.source);\n\tvar target = view.$gantt.getTask(item.target);\n\t// check vertical visibility first since it's a lighter check\n\tvar sourceTop = view.getItemTop(source.id);\n\tvar sourceHeight = view.getItemHeight(source.id);\n\n\tvar targetTop = view.getItemTop(target.id);\n\tvar targetHeight = view.getItemHeight(target.id);\n\n\tif(viewport.y > sourceTop + sourceHeight &&\n\t\tviewport.y > targetTop + targetHeight){\n\t\treturn false;\n\t}\n\n\tif(viewport.y_end < targetTop &&\n\t\tviewport.y_end < sourceTop){\n\t\treturn false;\n\t}\n\n\tvar padding = 100;\n\tvar sourceLeft = view.posFromDate(source.start_date);\n\tvar sourceRight = view.posFromDate(source.end_date);\n\tvar targetLeft = view.posFromDate(target.start_date);\n\tvar targetRight = view.posFromDate(target.end_date);\n\n\tif(sourceLeft > sourceRight){\n\t\t// rtl\n\t\tvar tmp = sourceRight;\n\t\tsourceRight = sourceLeft;\n\t\tsourceLeft = tmp;\n\t}\n\tif(targetLeft > targetRight){\n\t\t// rtl\n\t\tvar tmp = targetRight;\n\t\ttargetRight = targetLeft;\n\t\ttargetLeft = tmp;\n\t}\n\tsourceLeft += -padding; // add buffer for custom elements\n\tsourceRight += padding;\n\ttargetLeft += -padding; // add buffer for custom elements\n\ttargetRight += padding;\n\n\tif(viewport.x > sourceRight &&\n\t\tviewport.x > targetRight){\n\t\treturn false;\n\t}\n\n\tif(viewport.x_end < sourceLeft &&\n\t\tviewport.x_end < targetLeft){\n\t\treturn false;\n\t}\n\treturn true;\n};\n","import createLayerFactory from \"./render/layer_engine\";\n\nimport getVisibleTaskRange from \"./render/viewport/get_visible_bars_range\";\nimport getVisibleLinksRangeFactory from \"./render/viewport/factory/get_visible_link_range\";\n\nimport isLinkInViewport from \"./render/viewport/is_link_in_viewport\";\n\nfunction initLayer(layer, gantt){\n\tif(!layer.view){\n\t\treturn;\n\t}\n\n\tvar view = layer.view;\n\tif(typeof view === \"string\"){\n\t\tview = gantt.$ui.getView(view);\n\t}\n\n\tif(view && view.attachEvent){\n\t\tview.attachEvent(\"onScroll\", function(){\n\t\t\tvar state = gantt.$services.getService(\"state\");\n\t\t\t// don't repaint if we're inside batchUpdate, a complete repaint will be called afterwards\n\t\t\tif(!state.getState(\"batchUpdate\").batch_update && !view.$config.$skipSmartRenderOnScroll){\n\t\t\t\tif(layer.requestUpdate){\n\t\t\t\t\tlayer.requestUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nvar createLayerEngine = function(gantt){\n\tvar factory = createLayerFactory(gantt);\n\treturn {\n\t\tgetDataRender: function(name){\n\t\t\treturn gantt.$services.getService(\"layer:\" + name) || null;\n\t\t},\n\t\tcreateDataRender: function(config){\n\t\t\tvar name = config.name,\n\t\t\t\tdefaultContainer = config.defaultContainer,\n\t\t\t\tpreviusSiblingContainer = config.defaultContainerSibling;\n\n\t\t\tvar layers = factory.createGroup(\n\t\t\t\tdefaultContainer,\n\t\t\t\tpreviusSiblingContainer,\n\t\t\t\tfunction(itemId, item){\n\t\t\t\t\tif(layers.filters){\n\t\t\t\t\t\tfor(var i = 0; i < layers.filters.length; i++){\n\t\t\t\t\t\t\tif(layers.filters[i](itemId, item) === false){\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinitLayer\n\t\t\t);\n\n\t\t\tgantt.$services.setService(\"layer:\" + name, function(){\n\t\t\t\treturn layers;\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onGanttReady\", function () {\n\t\t\t\tlayers.addLayer();// init layers on start\n\t\t\t});\n\n\t\t\treturn layers;\n\t\t},\n\t\tinit: function(){\n\t\t\tvar taskLayers = this.createDataRender({\n\t\t\t\tname: \"task\",\n\t\t\t\tdefaultContainer: function(){\n\t\t\t\t\tif(gantt.$task_data){\n\t\t\t\t\t\treturn gantt.$task_data;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdefaultContainerSibling: function(){\n\t\t\t\t\tif(gantt.$task_links){\n\t\t\t\t\t\treturn gantt.$task_links;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_links;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfilter: function(item){\n\n\t\t\t\t}\n\t\t\t}, gantt);\n\n\t\t\tvar linkLayers = this.createDataRender({\n\t\t\t\tname: \"link\",\n\t\t\t\tdefaultContainer: function(){\n\t\t\t\t\tif(gantt.$task_data){\n\t\t\t\t\t\treturn gantt.$task_data;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, gantt);\n\n\t\t\treturn {\n\t\t\t\taddTaskLayer: function(config){\n\t\t\t\t\tconst rangeFunction = getVisibleTaskRange;\n\t\t\t\t\tif(typeof config === \"function\"){\n\t\t\t\t\t\tconfig = {\n\t\t\t\t\t\t\trenderer: {\n\t\t\t\t\t\t\t\trender: config,\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconfig.view = \"timeline\";\n\n\t\t\t\t\treturn taskLayers.addLayer(config);\n\t\t\t\t},\n\n\t\t\t\t_getTaskLayers: function(){\n\t\t\t\t\treturn taskLayers.getLayers();\n\t\t\t\t},\n\t\t\t\tremoveTaskLayer: function(id){\n\t\t\t\t\ttaskLayers.removeLayer(id);\n\t\t\t\t},\n\n\t\t\t\t_clearTaskLayers: function(){\n\t\t\t\t\ttaskLayers.clear();\n\t\t\t\t},\n\t\t\t\taddLinkLayer: function(config){\n\t\t\t\t\tconst rangeFunction = getVisibleLinksRangeFactory();\n\t\t\t\t\tif(typeof config === \"function\"){\n\t\t\t\t\t\tconfig = {\n\t\t\t\t\t\t\trenderer: {\n\t\t\t\t\t\t\t\trender: config,\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconfig.view = \"timeline\";\n\t\t\t\t\tif(config && config.renderer){\n\t\t\t\t\t\tif(!config.renderer.getRectangle && !config.renderer.isInViewPort){\n\t\t\t\t\t\t\tconfig.renderer.isInViewPort = isLinkInViewport;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn linkLayers.addLayer(config);\n\t\t\t\t},\n\n\t\t\t\t_getLinkLayers: function(){\n\t\t\t\t\treturn linkLayers.getLayers();\n\t\t\t\t},\n\t\t\t\tremoveLinkLayer: function(id){\n\t\t\t\t\tlinkLayers.removeLayer(id);\n\t\t\t\t},\n\n\t\t\t\t_clearLinkLayers: function(){\n\t\t\t\t\tlinkLayers.clear();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t};\n};\n\nexport default createLayerEngine;","import * as utils from \"../../../utils/utils\";\nimport eventable from \"../../../utils/eventable\";\nimport * as domHelpers from \"../utils/dom_helpers\";\n\nvar Cell = (function () {\n\t\"use strict\";\n\n\tfunction Cell(parent, config, factory, gantt) {\n\t\tif (parent) {\n\t\t\tthis.$container = domHelpers.toNode(parent);\n\t\t\tthis.$parent = parent;\n\t\t}\n\t\t// save config\n\t\tthis.$config = utils.mixin(config, {\n\t\t\theaderHeight: 33\n\t\t});\n\t\tthis.$gantt = gantt;\n\t\tthis.$domEvents = gantt._createDomEventScope();\n\t\t// set id\n\t\tthis.$id = config.id || \"c\" + utils.uid();\n\n\t\tthis.$name = \"cell\";\n\t\tthis.$factory = factory;\n\n\t\teventable(this);\n\n\t}\n\n\tCell.prototype.destructor = function () {\n\t\tthis.$parent = this.$container = this.$view = null;\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\n\t\tmouse.detach(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\n\t\tthis.$domEvents.detachAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t};\n\tCell.prototype.cell = function (id) {\n\t\treturn null;\n\t};\n\n\tCell.prototype.scrollTo = function(left, top){\n\n\t\t//GS-333 Add a way to scroll the HTML views:\n\t\tvar cell = this.$view;\n\t\tif (this.$config.html) cell = this.$view.firstChild;\n\n\t\tif (left*1 == left){\n\t\t\tcell.scrollLeft = left;\n\t\t}\n\t\tif(top*1 == top){\n\t\t\tcell.scrollTop = top;\n\t\t}\n\t};\n\n\tCell.prototype.clear = function(){\n\t\tthis.getNode().innerHTML = \"\";\n\t\tthis.getNode().className = \"gantt_layout_content\";\n\t\tthis.getNode().style.padding = \"0\";\n\t};\n\n\tCell.prototype.resize = function (final) {\n\t\tif (this.$parent) {\n\t\t\treturn this.$parent.resize(final);\n\t\t}\n\n\t\tif(final === false){\n\t\t\tthis.$preResize = true;\n\t\t}\n\n\t\tvar topCont = this.$container;\n\t\tvar x = topCont.offsetWidth;\n\t\tvar y = topCont.offsetHeight;\n\t\tvar topSize = this.getSize();\n\t\tif (topCont === document.body) {\n\t\t\tx = document.body.offsetWidth;\n\t\t\ty = document.body.offsetHeight;\n\t\t}\n\t\tif (x < topSize.minWidth) {\n\t\t\tx = topSize.minWidth;\n\t\t}\n\t\tif (x > topSize.maxWidth) {\n\t\t\tx = topSize.maxWidth;\n\t\t}\n\t\tif (y < topSize.minHeight) {\n\t\t\ty = topSize.minHeight;\n\t\t}\n\t\tif (y > topSize.maxHeight) {\n\t\t\ty = topSize.maxHeight;\n\t\t}\n\t\tthis.setSize(x, y);\n\n\t\tif(!this.$preResize){\n\t\t//\tself.callEvent(\"onResize\", [x, y]);\n\t\t}\n\t\tthis.$preResize = false;\n\t};\n\n\tCell.prototype.hide = function () {\n\t\tthis._hide(true);\n\t\tthis.resize();\n\t};\n\tCell.prototype.show = function (force) {\n\t\tthis._hide(false);\n\t\tif (force && this.$parent) {\n\t\t\tthis.$parent.show();\n\t\t}\n\t\tthis.resize();\n\t};\n\tCell.prototype._hide = function (mode) {\n\t\tif (mode === true && this.$view.parentNode) {\n\t\t\tthis.$view.parentNode.removeChild(this.$view);\n\t\t}\n\t\telse if (mode === false && !this.$view.parentNode) {\n\t\t\tvar index = this.$parent.cellIndex(this.$id);\n\t\t\tthis.$parent.moveView(this, index);\n\t\t}\n\t\tthis.$config.hidden = mode;\n\t};\n\tCell.prototype.$toHTML = function (content, css) {\n\t\tif (content === void 0) { content = \"\"; }\n\t\tcss = [(css || \"\"), (this.$config.css || \"\")].join(\" \");\n\t\tvar obj = this.$config;\n\t\tvar header = \"\";\n\t\tif (obj.raw) {\n\t\t\tcontent = typeof obj.raw === \"string\" ? obj.raw : \"\";\n\t\t}\n\t\telse {\n\t\t\tif (!content) {\n\t\t\t\tcontent = \"<div class='gantt_layout_content' \"+(css ? \" class='\"+css+\"' \" : \"\")+\" >\" + (obj.html || \"\") + \"</div>\";\n\t\t\t}\n\t\t\tif (obj.header) {\n\t\t\t\tvar collapseIcon = obj.canCollapse ? \"<div class='gantt_layout_header_arrow'></div>\" : \"\";\n\t\t\t\theader = \"<div class='gantt_layout_header'>\" + collapseIcon + \"<div class='gantt_layout_header_content'>\" + obj.header + \"</div></div>\";\n\t\t\t}\n\t\t}\n\t\treturn \"<div class='gantt_layout_cell \" + css + \"' data-cell-id='\" + this.$id + \"'>\" + header + content + \"</div>\";\n\t};\n\tCell.prototype.$fill = function (node, parent) {\n\t\tthis.$view = node;\n\t\tthis.$parent = parent;\n\t\tthis.init();\n\t};\n\tCell.prototype.getNode = function () {\n\t\treturn (this.$view.querySelector(\"gantt_layout_cell\") || this.$view);\n\t};\n\tCell.prototype.init = function () {\n\t\t// [NOT-GOOD] code is executed for each component, while it still has only one handler, it is no good\n\n\t\tvar self = this;\n\n\t\tthis._headerClickHandler = function(e){\n\t\t\tvar cellId = domHelpers.locateAttribute(e, \"data-cell-id\");\n\t\t\tif(cellId == self.$id){\n\t\t\t\tself.toggle();\n\t\t\t}\n\t\t};\n\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\n\t\tmouse.delegate(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\n\n\t\tthis.callEvent(\"onReady\", []);\n\t};\n\tCell.prototype.toggle = function () {\n\t\tthis.$config.collapsed = !this.$config.collapsed;\n\t\tthis.resize();\n\t};\n\tCell.prototype.getSize = function () {\n\t\tvar size = {\n\t\t\theight: this.$config.height || 0,\n\t\t\twidth: this.$config.width || 0,\n\t\t\tgravity: this.$config.gravity || 1,\n\t\t\tminHeight: this.$config.minHeight || 0,\n\t\t\tminWidth: this.$config.minWidth || 0,\n\t\t\tmaxHeight: this.$config.maxHeight || 100000000000,\n\t\t\tmaxWidth: this.$config.maxWidth || 100000000000\n\t\t};\n\t\tif (this.$config.collapsed) {\n\t\t\tvar mode = this.$config.mode === \"x\";\n\t\t\tsize[mode ? \"width\" : \"height\"] = size[mode ? \"maxWidth\" : \"maxHeight\"] = this.$config.headerHeight;\n\t\t}\n\t\treturn size;\n\t};\n\n\tCell.prototype.getContentSize = function(){\n\n\t\tvar width = this.$lastSize.contentX;\n\t\tif(width !== width*1){\n\t\t\twidth = this.$lastSize.width;\n\t\t}\n\n\t\tvar height = this.$lastSize.contentY;\n\t\tif(height !== height*1){\n\t\t\theight = this.$lastSize.height;\n\t\t}\n\n\t\treturn {\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t};\n\t};\n\n\tCell.prototype._getBorderSizes = function(){\n\t\tvar borders = {\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t\tleft: 0,\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t\tif(this._currentBorders){\n\t\t\tif(this._currentBorders[this._borders.left]){\n\t\t\t\tborders.left = 1;\n\t\t\t\tborders.horizontal++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.right]){\n\t\t\t\tborders.right = 1;\n\t\t\t\tborders.horizontal++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.top]){\n\t\t\t\tborders.top = 1;\n\t\t\t\tborders.vertical++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.bottom]){\n\t\t\t\tborders.bottom = 1;\n\t\t\t\tborders.vertical++;\n\t\t\t}\n\t\t}\n\n\t\treturn borders;\n\n\t};\n\n\tCell.prototype.setSize = function (x, y) {\n\t\tthis.$view.style.width = x + \"px\";\n\t\tthis.$view.style.height = y + \"px\";\n\n\t\tvar borders = this._getBorderSizes();\n\t\tvar contentY = y - borders.vertical;\n\t\tvar contentX = x - borders.horizontal;\n\n\t\tthis.$lastSize = { x: x, y: y, contentX: contentX, contentY: contentY };\n\t\tif (this.$config.header) {\n\t\t\tthis._sizeHeader();\n\t\t}else{\n\t\t\tthis._sizeContent();\n\t\t}\n\t};\n\n\tCell.prototype._borders = {\n\t\t\"left\":\"gantt_layout_cell_border_left\",\n\t\t\"right\":\"gantt_layout_cell_border_right\",\n\t\t\"top\":\"gantt_layout_cell_border_top\",\n\t\t\"bottom\":\"gantt_layout_cell_border_bottom\"\n\t};\n\n\tCell.prototype._setBorders = function(css, view){\n\t\tif(!view) {\n\t\t\tview = this;\n\t\t}\n\t\tvar node = view.$view;\n\n\t\tfor( var i in this._borders){\n\t\t\tdomHelpers.removeClassName(node, this._borders[i]);\n\t\t}\n\n\t\tif(typeof css == \"string\"){\n\t\t\tcss = [css];\n\t\t}\n\n\t\tvar cssHash = {};\n\n\t\tfor(var i = 0; i < css.length; i++){\n\t\t\tdomHelpers.addClassName(node, css[i]);\n\t\t\tcssHash[css[i]] = true;\n\t\t}\n\n\t\tview._currentBorders = cssHash;\n\t};\n\n\n\tCell.prototype._sizeContent = function(){\n\t\tvar content = this.$view.childNodes[0];\n\t\tif(content && content.className == \"gantt_layout_content\"){\n\t\t\tcontent.style.height = this.$lastSize.contentY + \"px\";\n\t\t}\n\t};\n\n\tCell.prototype._sizeHeader = function () {\n\t\tvar size = this.$lastSize;\n\t\tsize.contentY -= this.$config.headerHeight;\n\t\tvar header = this.$view.childNodes[0];\n\t\tvar content = this.$view.childNodes[1];\n\t\tvar xLayout = this.$config.mode === \"x\";\n\t\tif (this.$config.collapsed) {\n\t\t\tcontent.style.display = \"none\";\n\t\t\tif (xLayout) {\n\t\t\t\theader.className = \"gantt_layout_header collapsed_x\";\n\t\t\t\theader.style.width = size.y + \"px\";\n\t\t\t\tvar d = Math.floor(size.y / 2 - size.x / 2);\n\t\t\t\theader.style.transform = \"rotate(90deg) translate(\" + d + \"px, \" + d + \"px)\";\n\t\t\t\tcontent.style.display = \"none\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\theader.className = \"gantt_layout_header collapsed_y\";\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (xLayout) {\n\t\t\t\theader.className = \"gantt_layout_header\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\theader.className = \"gantt_layout_header vertical\";\n\t\t\t}\n\t\t\theader.style.width = 'auto';\n\t\t\theader.style.transform = '';\n\t\t\tcontent.style.display = \"\";\n\t\t\tcontent.style.height = size.contentY + \"px\";\n\t\t}\n\t\theader.style.height = this.$config.headerHeight + \"px\";\n\t};\n\treturn Cell;\n}());\n\nexport default Cell;\n","export default function (d, b) {\n\tfor (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\tfunction __() { this.constructor = d; }\n\td.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport Cell from \"./cell\";\n\nvar Layout = (function (_super) {\n\t\"use strict\";\n\n\t__extends(Layout, _super);\n\tfunction Layout(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tif(parent)\n\t\t\t_this.$root = true;\n\n\t\t_this._parseConfig(config);\n\t\t_this.$name = \"layout\";\n\t\treturn _this;\n\t}\n\n\tLayout.prototype.destructor = function () {\n\t\tif (this.$container && this.$view) {\n\t\t\tdomHelpers.removeNode(this.$view);\n\t\t}\n\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tvar child = this.$cells[i];\n\t\t\tchild.destructor();\n\t\t}\n\t\tthis.$cells = [];\n\n\t\t_super.prototype.destructor.call(this);\n\t};\n\n\tLayout.prototype._resizeScrollbars = function(autosize, scrollbars){\n\t\tvar scrollChanged = false;\n\t\tvar visibleScrollbars = [],\n\t\t\thiddenScrollbars = [];\n\n\t\tconst scrollbarsToHide = [];\n\n\t\tfunction showScrollbar(scrollbar){\n\t\t\tscrollbar.$parent.show();\n\t\t\tscrollChanged = true;\n\t\t\tvisibleScrollbars.push(scrollbar);\n\t\t}\n\t\tfunction hideScrollbar(scrollbar){\n\t\t\tscrollbar.$parent.hide();\n\t\t\tscrollChanged = true;\n\t\t\thiddenScrollbars.push(scrollbar);\n\t\t}\n\n\t\tvar scrollbar;\n\t\tfor(var i = 0; i < scrollbars.length; i++){\n\t\t\tscrollbar = scrollbars[i];\n\n\t\t\tif(autosize[scrollbar.$config.scroll]) {\n\t\t\t\thideScrollbar(scrollbar);\n\t\t\t}else if(scrollbar.shouldHide()){\n\t\t\t\t//hideScrollbar(scrollbar);\n\t\t\t\tscrollbarsToHide.push(scrollbar);\n\t\t\t}else if(scrollbar.shouldShow()){\n\t\t\t\tshowScrollbar(scrollbar);\n\t\t\t}else{\n\t\t\t\tif(scrollbar.isVisible()){\n\t\t\t\t\tvisibleScrollbars.push(scrollbar);\n\t\t\t\t}else{\n\t\t\t\t\thiddenScrollbars.push(scrollbar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar visibleGroups = {};\n\t\tfor(var i = 0; i < visibleScrollbars.length; i++){\n\t\t\tif(visibleScrollbars[i].$config.group){\n\t\t\t\tvisibleGroups[visibleScrollbars[i].$config.group] = true;\n\t\t\t}\n\t\t}\n\n\t\t// GS-2220\n\t\tscrollbarsToHide.forEach(function(scrollbar){\n\t\t\tif(!(scrollbar.$config.group && visibleGroups[scrollbar.$config.group])){\n\t\t\t\thideScrollbar(scrollbar);\n\t\t\t}\n\t\t});\n\n\t\tfor(var i = 0; i < hiddenScrollbars.length; i++){\n\t\t\tscrollbar = hiddenScrollbars[i];\n\n\t\t\tif(scrollbar.$config.group && visibleGroups[scrollbar.$config.group]){\n\t\t\t\tshowScrollbar(scrollbar);\n\t\t\t\t// GS-707 If the scrollbar was hidden then showed, the container resize shouldn't happen because of that\n\t\t\t\tfor(var j = 0; j < visibleScrollbars.length; j++){\n\t\t\t\t\tif(visibleScrollbars[j] == scrollbar){\n\t\t\t\t\t\tthis.$gantt.$scrollbarRepaint = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn scrollChanged;\n\t};\n\n\tLayout.prototype._syncCellSizes = function(groupName, newSize){\n\t\tif(!groupName)\n\t\t\treturn;\n\n\t\tvar groups = {};\n\n\t\tthis._eachChild(function(cell){\n\t\t\tif(cell.$config.group && cell.$name != \"scrollbar\" && cell.$name != \"resizer\"){\n\t\t\t\tif(!groups[cell.$config.group]){\n\t\t\t\t\tgroups[cell.$config.group] = [];\n\t\t\t\t}\n\t\t\t\tgroups[cell.$config.group].push(cell);\n\t\t\t}\n\t\t});\n\n\t\tif(groups[groupName]){\n\t\t\tthis._syncGroupSize(groups[groupName], newSize);\n\t\t}\n\t\treturn groups[groupName];\n\t};\n\n\tLayout.prototype._syncGroupSize = function(cells, newSize){\n\t\tif(!cells.length) return;\n\n\t\tvar property = cells[0].$parent._xLayout ? \"width\" : \"height\";\n\t\tvar direction = cells[0].$parent.getNextSibling(cells[0].$id) ? 1 : -1;\n\n\t\tvar newSizeValue = newSize.value;\n\t\tvar isGravity = newSize.isGravity;\n\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\tvar ownSize = cells[i].getSize();\n\n\t\t\tvar resizeSibling = direction > 0 ? cells[i].$parent.getNextSibling(cells[i].$id) : cells[i].$parent.getPrevSibling(cells[i].$id);\n\t\t\tif(resizeSibling.$name == \"resizer\"){\n\t\t\t\tresizeSibling = direction > 0 ? resizeSibling.$parent.getNextSibling(resizeSibling.$id) : resizeSibling.$parent.getPrevSibling(resizeSibling.$id);\n\t\t\t}\n\t\t\tvar siblingSize = resizeSibling.getSize();\n\n\t\t\tif(!isGravity) {\n\t\t\t\tif(resizeSibling[property]){\n\t\t\t\t\tvar totalGravity = ownSize.gravity + siblingSize.gravity;\n\t\t\t\t\tvar totalSize = ownSize[property] + siblingSize[property];\n\t\t\t\t\tvar k = totalGravity / totalSize;\n\t\t\t\t\tcells[i].$config.gravity = k * newSizeValue;\n\n\t\t\t\t\tresizeSibling.$config[property] = totalSize - newSizeValue;\n\t\t\t\t\tresizeSibling.$config.gravity = totalGravity - k * newSizeValue;\n\t\t\t\t}else{\n\t\t\t\t\tcells[i].$config[property] = newSizeValue;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tcells[i].$config.gravity = newSizeValue;\n\t\t\t}\n\n\t\t\tvar mainGrid = this.$gantt.$ui.getView(\"grid\");\n\t\t\tif(mainGrid && cells[i].$content === mainGrid && !mainGrid.$config.scrollable && !isGravity){\n\t\t\t\tthis.$gantt.config.grid_width = newSizeValue;\n\t\t\t}\n\t\t}\n\t};\n\n\tLayout.prototype.resize = function(startStage){\n\t\tvar mainCall = false;\n\t\tif(this.$root && !this._resizeInProgress){\n\t\t\tthis.callEvent(\"onBeforeResize\", []);\n\t\t\tmainCall = true;\n\t\t\tthis._resizeInProgress = true;\n\t\t}\n\n\t\t_super.prototype.resize.call(this, true);\n\t\t_super.prototype.resize.call(this, false);\n\n\t\tif(mainCall){\n\n\t\t\tvar contentViews = [];\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewCell\"));\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewLayout\"));\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"hostCell\"));\n\n\t\t\tvar scrollbars = this.getCellsByType(\"scroller\");\n\n\t\t\tfor(var i = 0; i < contentViews.length; i++){\n\t\t\t\tif(!contentViews[i].$config.hidden)\n\t\t\t\t\tcontentViews[i].setContentSize();\n\t\t\t}\n\n\t\t\tvar autosize = this._getAutosizeMode(this.$config.autosize);\n\n\t/* // possible to rollback set content size when autisize is disabled, not sure if need to\n\t\t\tcontentViews.forEach(function(view){\n\t\t\t\tconst parent = view.$parent;\n\t\t\t\tif(!autosize.x){\n\t\t\t\t\tif(parent.$config.$originalWidthStored){\n\t\t\t\t\t\tparent.$config.$originalWidthStored = false;\n\t\t\t\t\t\tparent.$config.width = parent.$config.$originalWidth;\n\t\t\t\t\t\tparent.$config.$originalWidth = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(!autosize.y){\n\t\t\t\t\tif(parent.$config.$originalHeightStored){\n\t\t\t\t\t\tparent.$config.$originalHeightStored = false;\n\t\t\t\t\t\tparent.$config.height = parent.$config.$originalHeight;\n\t\t\t\t\t\tparent.$config.$originalHeight = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});*/\n\t\t\t\n\t\t\tvar scrollChanged = this._resizeScrollbars(autosize, scrollbars);\n\n\t\t\tif(this.$config.autosize){\n\t\t\t\tthis.autosize(this.$config.autosize);\n\t\t\t\tcontentViews.forEach(function(view){\n\t\t\t\t\tconst parent = view.$parent;\n\t\t\t\t\tconst sizes = parent.getContentSize(autosize);\n\t\t\t\t\tif(autosize.x){\n\t\t\t\t\t\tif(!parent.$config.$originalWidthStored){\n\t\t\t\t\t\t\tparent.$config.$originalWidthStored = true;\n\t\t\t\t\t\t\tparent.$config.$originalWidth = parent.$config.width;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.$config.width = sizes.width;\n\t\t\t\t\t}\n\t\t\t\t\tif(autosize.y){\n\t\t\t\t\t\tif(!parent.$config.$originalHeightStored){\n\t\t\t\t\t\t\tparent.$config.$originalHeightStored = true;\n\t\t\t\t\t\t\tparent.$config.$originalHeight = parent.$config.height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.$config.height = sizes.height;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tscrollChanged = true;\n\t\t\t}\n\n\t\t\tif(scrollChanged){\n\t\t\t\tthis.resize();\n\t\t\t\tfor(var i = 0; i < contentViews.length; i++){\n\t\t\t\t\tif(!contentViews[i].$config.hidden)\n\t\t\t\t\t\tcontentViews[i].setContentSize();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onResize\", []);\n\t\t}\n\t\tif(mainCall){\n\t\t\tthis._resizeInProgress = false;\n\t\t}\n\t};\n\n\tLayout.prototype._eachChild = function(code, cell){\n\t\tcell = cell || this;\n\t\tcode(cell);\n\t\tif(cell.$cells){\n\t\t\tfor(var i = 0; i < cell.$cells.length; i++){\n\t\t\t\tthis._eachChild(code, cell.$cells[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\tLayout.prototype.isChild = function(view){\n\t\tvar res = false;\n\t\tthis._eachChild(function(child){\n\t\t\tif(child === view || child.$content === view){\n\t\t\t\tres = true;\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t};\n\n\tLayout.prototype.getCellsByType = function(type){\n\t\tvar res = [];\n\t\tif(type === this.$name){\n\t\t\tres.push(this);\n\t\t}\n\n\t\tif(this.$content && this.$content.$name == type){\n\t\t\tres.push(this.$content);\n\t\t}\n\n\t\tif(this.$cells){\n\t\t\tfor(var i = 0; i < this.$cells.length; i++){\n\t\t\t\tvar children = Layout.prototype.getCellsByType.call(this.$cells[i], type);\n\t\t\t\tif(children.length){\n\t\t\t\t\tres.push.apply(res, children);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\tLayout.prototype.getNextSibling = function(cellId){\n\t\tvar index = this.cellIndex(cellId);\n\t\tif(index >= 0 && this.$cells[index + 1]){\n\t\t\treturn this.$cells[index + 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t};\n\n\tLayout.prototype.getPrevSibling = function(cellId){\n\t\tvar index = this.cellIndex(cellId);\n\t\tif(index >= 0 && this.$cells[index - 1]){\n\t\t\treturn this.$cells[index - 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t};\n\n\n\tLayout.prototype.cell = function (id) {\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tvar child = this.$cells[i];\n\t\t\tif (child.$id === id) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tvar sub = child.cell(id);\n\t\t\tif (sub) {\n\t\t\t\treturn sub;\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.cellIndex = function (id) {\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tif (this.$cells[i].$id === id) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n\tLayout.prototype.moveView = function (view, ind) {\n\t\tif (this.$cells[ind] !== view) {\n\t\t\treturn window.alert(\"Not implemented\");\n\t\t}\n\t\telse {\n\t\t\tind += this.$config.header ? 1 : 0;\n\t\t\tvar node = this.$view;\n\t\t\tif (ind >= node.childNodes.length) {\n\t\t\t\tnode.appendChild(view.$view);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnode.insertBefore(view.$view, node.childNodes[ind]);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype._parseConfig = function (config) {\n\t\tthis.$cells = [];\n\t\tthis._xLayout = !config.rows;\n\t\tvar cells = config.rows || config.cols || config.views;\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tvar cell = cells[i];\n\t\t\tcell.mode = this._xLayout ? \"x\" : \"y\";\n\t\t\tvar $content = this.$factory.initUI(cell, this);\n\t\t\tif(!$content){\n\t\t\t\tcells.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\t$content.$parent = this;\n\t\t\t\tthis.$cells.push($content);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.getCells = function () {\n\t\treturn this.$cells;\n\t};\n\tLayout.prototype.render = function () {\n\t\tvar view = domHelpers.insertNode(this.$container, this.$toHTML());\n\t\tthis.$fill(view, null);\n\t\tthis.callEvent(\"onReady\", []);\n\t\tthis.resize();\n\n\t\t// do simple repaint after the first call\n\t\tthis.render = this.resize;\n\t};\n\tLayout.prototype.$fill = function (node, parent) {\n\t\tthis.$view = node;\n\t\tthis.$parent = parent;\n\t\tvar cells = domHelpers.getChildNodes(node, \"gantt_layout_cell\");\n\t\tfor (var i = cells.length - 1; i >= 0; i--) {\n\t\t\tvar sub = this.$cells[i];\n\t\t\tsub.$fill(cells[i], this);\n\t\t\t// initially hidden cell\n\t\t\tif (sub.$config.hidden) {\n\t\t\t\tsub.$view.parentNode.removeChild(sub.$view);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.$toHTML = function () {\n\t\tvar mode = this._xLayout ? \"x\" : \"y\";\n\t\tvar html = [];\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\thtml.push(this.$cells[i].$toHTML());\n\t\t}\n\t\treturn _super.prototype.$toHTML.call(this, html.join(\"\"), (this.$root ? \"gantt_layout_root \" : \"\") + \"gantt_layout gantt_layout_\" + mode);\n\t};\n\n\tLayout.prototype.getContentSize = function(mode){\n\t\tvar contentWidth = 0,\n\t\t\tcontentHeight = 0;\n\n\t\tvar cellSize, cell, borders;\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tcell = this.$cells[i];\n\t\t\tif(cell.$config.hidden)\n\t\t\t\tcontinue;\n\n\t\t\tcellSize = cell.getContentSize(mode);\n\n\t\t\tif(cell.$config.view === \"scrollbar\" && mode[cell.$config.scroll]){\n\t\t\t\tcellSize.height = 0;\n\t\t\t\tcellSize.width = 0;\n\t\t\t}\n\n\t\t\tif(cell.$config.resizer){\n\t\t\t\tif(this._xLayout){\n\t\t\t\t\tcellSize.height = 0;\n\t\t\t\t}else{\n\t\t\t\t\tcellSize.width = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tborders = cell._getBorderSizes();\n\n\t\t\tif(this._xLayout){\n\t\t\t\tcontentWidth += (cellSize.width + borders.horizontal);\n\t\t\t\tcontentHeight = Math.max(contentHeight, (cellSize.height + borders.vertical));\n\t\t\t}else{\n\t\t\t\tcontentWidth = Math.max(contentWidth, cellSize.width + borders.horizontal);\n\t\t\t\tcontentHeight += cellSize.height + borders.vertical;\n\t\t\t}\n\t\t}\n\n\t\tborders = this._getBorderSizes();\n\t\tcontentWidth += borders.horizontal;\n\t\tcontentHeight += borders.vertical;\n\n\t\t// GS-149 & GS-150: By default this code only increases the container sizes, because of that, the cell sizes\n\t\t// are also increased. Keep this code here in the case if something goes wrong\n\t\t/*\n\t\tif(this.$root){\n\t\t\tcontentWidth += 1;\n\t\t\tcontentHeight += 1;\n\t\t}\n\t\t*/\n\t\treturn {\n\t\t\twidth: contentWidth,\n\t\t\theight: contentHeight\n\t\t};\n\t};\n\n\tLayout.prototype._cleanElSize = function(value){\n\t\treturn ((value || \"\").toString().replace(\"px\", \"\") * 1 || 0);\n\t};\n\tLayout.prototype._getBoxStyles = function(div){\n\t\tvar computed = null;\n\t\tif(window.getComputedStyle){\n\t\t\tcomputed = window.getComputedStyle(div, null);\n\t\t}else{\n\t\t\t//IE with elem.currentStyle does not calculate sizes from %, so will use the default approach\n\t\t\tcomputed = {\n\t\t\t\t\"width\":div.clientWidth,\n\t\t\t\t\"height\":div.clientHeight\n\t\t\t};\n\t\t}\n\t\tvar properties = [\n\t\t\t\"width\",\n\t\t\t\"height\",\n\n\t\t\t\"paddingTop\",\n\t\t\t\"paddingBottom\",\n\t\t\t\"paddingLeft\",\n\t\t\t\"paddingRight\",\n\n\t\t\t\"borderLeftWidth\",\n\t\t\t\"borderRightWidth\",\n\t\t\t\"borderTopWidth\",\n\t\t\t\"borderBottomWidth\"\n\t\t];\n\t\tvar styles = {\n\t\t\tboxSizing:(computed.boxSizing == \"border-box\")\n\t\t};\n\n\t\tif(computed.MozBoxSizing){\n\t\t\tstyles.boxSizing = (computed.MozBoxSizing == \"border-box\");\n\t\t}\n\t\tfor(var i =0; i < properties.length; i++){\n\t\t\tstyles[properties[i]] = computed[properties[i]] ? this._cleanElSize(computed[properties[i]]) : 0;\n\t\t}\n\n\n\t\tvar box = {\n\t\t\thorPaddings : (styles.paddingLeft + styles.paddingRight + styles.borderLeftWidth + styles.borderRightWidth),\n\t\t\tvertPaddings : (styles.paddingTop + styles.paddingBottom + styles.borderTopWidth + styles.borderBottomWidth),\n\t\t\tborderBox: styles.boxSizing,\n\t\t\tinnerWidth : styles.width,\n\t\t\tinnerHeight : styles.height,\n\t\t\touterWidth : styles.width,\n\t\t\touterHeight : styles.height\n\t\t};\n\n\n\t\tif(box.borderBox){\n\t\t\tbox.innerWidth -= box.horPaddings;\n\t\t\tbox.innerHeight -= box.vertPaddings;\n\t\t}else{\n\t\t\tbox.outerWidth += box.horPaddings;\n\t\t\tbox.outerHeight += box.vertPaddings;\n\t\t}\n\n\t\treturn box;\n\t};\n\n\tLayout.prototype._getAutosizeMode = function(config){\n\t\tvar res = {x:false, y:false};\n\t\tif(config === \"xy\"){\n\t\t\tres.x = res.y = true;\n\t\t}else if(config === \"y\" || config === true){\n\t\t\tres.y = true;\n\t\t}else if(config === \"x\"){\n\t\t\tres.x = true;\n\t\t}\n\t\treturn res;\n\t};\n\n\tLayout.prototype.autosize = function(mode) {\n\t\tvar res = this._getAutosizeMode(mode);\n\t\tvar boxSizes = this._getBoxStyles(this.$container);\n\t\tvar contentSizes = this.getContentSize(mode);\n\n\t\tvar node = this.$container;\n\t\tif(res.x){\n\t\t\tif(boxSizes.borderBox){\n\t\t\t\tcontentSizes.width += boxSizes.horPaddings;\n\t\t\t}\n\t\t\tnode.style.width = contentSizes.width + \"px\";\n\t\t}\n\t\tif(res.y){\n\t\t\tif(boxSizes.borderBox){\n\t\t\t\tcontentSizes.height += boxSizes.vertPaddings;\n\t\t\t}\n\t\t\tnode.style.height = contentSizes.height + \"px\";\n\t\t}\n\t};\n\n\tLayout.prototype.getSize = function () {\n\t\tthis._sizes = [];\n\t\tvar width = 0;\n\t\tvar minWidth = 0;\n\t\tvar maxWidth = 100000000000;\n\t\tvar height = 0;\n\t\tvar maxHeight = 100000000000;\n\t\tvar minHeight = 0;\n\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\n\t\t\tvar size = this._sizes[i] = this.$cells[i].getSize();\n\t\t\tif (this.$cells[i].$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (this._xLayout) {\n\t\t\t\tif (!size.width && size.minWidth) {\n\t\t\t\t\twidth += size.minWidth;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\twidth += size.width;\n\t\t\t\t}\n\t\t\t\tmaxWidth += size.maxWidth;\n\t\t\t\tminWidth += size.minWidth;\n\t\t\t\theight = Math.max(height, size.height);\n\t\t\t\tmaxHeight = Math.min(maxHeight, size.maxHeight); // min of maxHeight\n\t\t\t\tminHeight = Math.max(minHeight, size.minHeight); // max of minHeight\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!size.height && size.minHeight) {\n\t\t\t\t\theight += size.minHeight;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\theight += size.height;\n\t\t\t\t}\n\t\t\t\tmaxHeight += size.maxHeight;\n\t\t\t\tminHeight += size.minHeight;\n\t\t\t\twidth = Math.max(width, size.width);\n\t\t\t\tmaxWidth = Math.min(maxWidth, size.maxWidth); // min of maxWidth\n\t\t\t\tminWidth = Math.max(minWidth, size.minWidth); // max of minWidth\n\t\t\t}\n\t\t}\n\t\tvar self = _super.prototype.getSize.call(this);\n\t\t// maxWidth\n\t\tif (self.maxWidth >= 100000) {\n\t\t\tself.maxWidth = maxWidth;\n\t\t}\n\t\t// maxHeight\n\t\tif (self.maxHeight >= 100000) {\n\t\t\tself.maxHeight = maxHeight;\n\t\t}\n\t\t// minWidth\n\t\tself.minWidth = self.minWidth !== self.minWidth ? 0 : self.minWidth;// || self.width || Math.max(minWidth, width);\n\t\t// minHeight\n\t\tself.minHeight = self.minHeight !== self.minHeight ? 0 : self.minHeight;//self.minHeight || self.height || Math.max(minHeight, height);\n\t\t// sizes with paddings and margins\n\t\tif (this._xLayout) {\n\t\t\tself.minWidth += this.$config.margin * (this.$cells.length) || 0;\n\t\t\tself.minWidth += this.$config.padding * 2 || 0;\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\n\t\t}\n\t\telse {\n\t\t\tself.minHeight += this.$config.margin * (this.$cells.length) || 0;\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\n\t\t}\n\t\t\n\t\treturn self;\n\t};\n\t// calc total gravity and free space\n\tLayout.prototype._calcFreeSpace = function (s, cell, xLayout) {\n\t\tvar min = xLayout ? cell.minWidth : cell.minHeight;\n\t\tvar max = xLayout ? cell.maxWidth : cell.maxWidth;\n\t\tvar side = s;\n\t\tif (!side) {\n\t\t\tside = Math.floor(this._free / this._gravity * cell.gravity);\n\t\t\tif (side > max) {\n\t\t\t\tside = max;\n\t\t\t\tthis._free -= side;\n\t\t\t\tthis._gravity -= cell.gravity;\n\t\t\t}\n\t\t\tif (side < min) {\n\t\t\t\tside = min;\n\t\t\t\tthis._free -= side;\n\t\t\t\tthis._gravity -= cell.gravity;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (side > max) {\n\t\t\t\tside = max;\n\t\t\t}\n\t\t\tif (side < min) {\n\t\t\t\tside = min;\n\t\t\t}\n\t\t\tthis._free -= side;\n\t\t}\n\t\treturn side;\n\t};\n\tLayout.prototype._calcSize = function (s, size, xLayout) {\n\t\tvar side = s;\n\t\tvar min = xLayout ? size.minWidth : size.minHeight;\n\t\tvar max = xLayout ? size.maxWidth : size.maxHeight;\n\t\tif (!side) {\n\t\t\tside = Math.floor(this._free / this._gravity * size.gravity);\n\t\t}\n\t\tif (side > max) {\n\t\t\tside = max;\n\t\t}\n\t\tif (side < min) {\n\t\t\tside = min;\n\t\t}\n\t\treturn side;\n\t};\n\n\tLayout.prototype._configureBorders = function(){\n\t\tif(this.$root){\n\t\t\tthis._setBorders([\n\t\t\t\tthis._borders.left,\n\t\t\t\tthis._borders.top,\n\t\t\t\tthis._borders.right,\n\t\t\t\tthis._borders.bottom\n\t\t\t],\n\t\t\tthis);\n\t\t}\n\n\t\tvar borderClass = this._xLayout ? this._borders.right : this._borders.bottom;\n\n\t\tvar cells = this.$cells;\n\n\t\tvar lastVisibleIndex = cells.length - 1;\n\t\tfor(var i = lastVisibleIndex; i >= 0; i--){\n\t\t\tif (!cells[i].$config.hidden) {\n\t\t\t\tlastVisibleIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tif (cells[i].$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar lastCell = i >= lastVisibleIndex;\n\t\t\tvar borderColorClass = \"\";\n\t\t\tif(!lastCell && cells[i + 1]){\n\t\t\t\tif(cells[i + 1].$config.view == \"scrollbar\"){\n\t\t\t\t\tif(this._xLayout){\n\t\t\t\t\t\tlastCell = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tborderColorClass = \"gantt_layout_cell_border_transparent\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tthis._setBorders(lastCell ? [] : [borderClass, borderColorClass], cells[i]);\n\t\t}\n\t};\n\n\tLayout.prototype._updateCellVisibility = function(){\n\t\tvar oldVisibleCells = this._visibleCells || {};\n\t\tvar firstCall = !this._visibleCells;\n\t\tvar visibleCells = {};\n\t\tvar cell = null;\n\t\tvar parentVisibility = [];\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\t\t\tif (cell.$config.hide_empty){\n\t\t\t\tparentVisibility.push(cell);\n\t\t\t}\n\n\t\t\tif (!firstCall && cell.$config.hidden && oldVisibleCells[cell.$id]) {\n\t\t\t\tcell._hide(true);\n\t\t\t}else if(!cell.$config.hidden && !oldVisibleCells[cell.$id]){\n\t\t\t\tcell._hide(false);\n\t\t\t}\n\n\t\t\tif(!cell.$config.hidden){\n\t\t\t\tvisibleCells[cell.$id] = true;\n\t\t\t}\n\t\t}\n\t\tthis._visibleCells = visibleCells;\n\n\t\t// GS-27. A way to hide the whole cell if all its children are hidden\n\t\tfor (var i = 0; i < parentVisibility.length; i++) {\n\t\t\tvar cell = parentVisibility[i];\n\t\t\tvar children = cell.$cells;\n\t\t\tvar hideCell = true;\n\t\t\tchildren.forEach(function(child){\n\t\t\t\tif (!child.$config.hidden && !child.$config.resizer){\n\t\t\t\t\thideCell = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tcell.$config.hidden = hideCell;\n\t\t}\n\t};\n\n\tLayout.prototype.setSize = function (x, y) {\n\t\tthis._configureBorders();\n\t\t_super.prototype.setSize.call(this, x, y);\n\t\ty = this.$lastSize.contentY;\n\t\tx = this.$lastSize.contentX;\n\n\t\tvar padding = (this.$config.padding || 0);\n\t\tthis.$view.style.padding = padding + \"px\";\n\t\tthis._gravity = 0;\n\t\tthis._free = this._xLayout ? x : y;\n\t\tthis._free -= padding * 2;\n\t\t// calc all gravity\n\n\t\tvar cell,\n\t\t\tsize;\n\n\t\tthis._updateCellVisibility();\n\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar margin = (this.$config.margin || 0);\n\t\t\tif(cell.$name == \"resizer\" && !margin){\n\t\t\t\tmargin = -1;\n\t\t\t}\n\n\t\t\t// set margins to child cell\n\t\t\tvar cellView = cell.$view;\n\n\t\t\tvar marginSide = this._xLayout ? \"marginRight\" : \"marginBottom\";\n\t\t\tif (i !== this.$cells.length - 1) {\n\t\t\t\tcellView.style[marginSide] = margin + \"px\";\n\t\t\t\tthis._free -= margin; // calc free space without margin\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tif (this._xLayout) {\n\t\t\t\tif (!size.width) {\n\t\t\t\t\tthis._gravity += size.gravity;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!size.height) {\n\t\t\t\t\tthis._gravity += size.gravity;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tvar width = size.width;\n\t\t\tvar height = size.height;\n\t\t\tif (this._xLayout) {\n\t\t\t\tthis._calcFreeSpace(width, size, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._calcFreeSpace(height, size, false);\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tvar dx = void 0;\n\t\t\tvar dy = void 0;\n\t\t\tif (this._xLayout) {\n\t\t\t\tdx = this._calcSize(size.width, size, true);\n\t\t\t\tdy = y - padding * 2; // layout height without paddings\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdx = x - padding * 2; // layout width without paddings\n\t\t\t\tdy = this._calcSize(size.height, size, false);\n\t\t\t}\n\n\t\t\tcell.setSize(dx, dy);\n\t\t}\n\n\t};\n\n\treturn Layout;\n}(Cell));\n\nexport default Layout;","import __extends from \"../../../utils/extends\";\nimport Layout from \"./layout\";\nimport Cell from \"./cell\";\n\nvar ViewLayout = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ViewLayout, _super);\n\tfunction ViewLayout(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\t\tfor (var i = 0; i < _this.$cells.length; i++) {\n\t\t\t_this.$cells[i].$config.hidden = (i !== 0);\n\t\t}\n\t\t_this.$cell = _this.$cells[0];\n\t\t_this.$name = \"viewLayout\";\n\n\t\treturn _this;\n\t}\n\tViewLayout.prototype.cell = function (id) {\n\t\tvar cell = _super.prototype.cell.call(this, id);\n\t\tif (!cell.$view) {\n\t\t\tthis.$fill(null, this);\n\t\t}\n\t\treturn cell;\n\t};\n\tViewLayout.prototype.moveView = function (view) {\n\t\tvar body = this.$view;\n\t\tif (this.$cell) {\n\t\t\tthis.$cell.$config.hidden = true;\n\t\t\tbody.removeChild(this.$cell.$view);\n\t\t}\n\t\tthis.$cell = view;\n\t\tbody.appendChild(view.$view);\n\t};\n\tViewLayout.prototype.setSize = function (x, y) {\n\t\tCell.prototype.setSize.call(this, x, y);\n\t};\n\n\tViewLayout.prototype.setContentSize = function(){\n\t\tvar size = this.$lastSize;\n\t\tthis.$cell.setSize(size.contentX, size.contentY);\n\t};\n\n\tViewLayout.prototype.getSize = function () {\n\t\tvar sizes = _super.prototype.getSize.call(this);\n\t\tif (this.$cell) {\n\t\t\tvar cellSize = this.$cell.getSize();\n\t\t\tif (this.$config.byMaxSize) {\n\t\t\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\t\t\tvar otherCell = this.$cells[i].getSize();\n\t\t\t\t\tfor (var cell in cellSize) {\n\t\t\t\t\t\tcellSize[cell] = Math.max(cellSize[cell], otherCell[cell]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var size in sizes) {\n\t\t\t\tsizes[size] = sizes[size] || cellSize[size];\n\t\t\t}\n\t\t\tsizes.gravity = Math.max(sizes.gravity, cellSize.gravity);\n\t\t}\n\t\treturn sizes;\n\t};\n\treturn ViewLayout;\n}(Layout));\n\nexport default ViewLayout;","import __extends from \"../../../utils/extends\";\nimport * as utils from \"../../../utils/utils\";\nimport Cell from \"./cell\";\n\nvar ViewCell = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ViewCell, _super);\n\tfunction ViewCell(parent, config, factory) {\n\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tif(config.view){\n\t\t\tif(config.id){\n\t\t\t\t// pass id to the nested view\n\t\t\t\tthis.$id = utils.uid();\n\t\t\t}\n\t\t\tvar childConfig = utils.copy(config);\n\t\t\tdelete childConfig.config;\n\t\t\tdelete childConfig.templates;\n\n\t\t\tthis.$content = this.$factory.createView(config.view, this, childConfig, this);\n\t\t\tif(!this.$content)\n\t\t\t\treturn false;\n\t\t}\n\n\t\t_this.$name = \"viewCell\";\n\t\treturn _this;\n\t}\n\n\tViewCell.prototype.destructor = function(){\n\t\tthis.clear();\n\t\t_super.prototype.destructor.call(this);\n\t};\n\n\tViewCell.prototype.clear = function(){\n\n\t\tthis.$initialized = false;\n\n\t\t// call destructor\n\t\tif (this.$content){\n\t\t\tvar method = this.$content.unload || this.$content.destructor;\n\t\t\tif (method){\n\t\t\t\tmethod.call(this.$content);\n\t\t\t}\n\t\t}\n\n\t\t_super.prototype.clear.call(this);\n\n\t};\n\n\tViewCell.prototype.scrollTo = function(left, top){\n\n\t\tif(this.$content && this.$content.scrollTo){\n\t\t\tthis.$content.scrollTo(left, top);\n\t\t}else{\n\t\t\t_super.prototype.scrollTo.call(this, left, top);\n\t\t}\n\t};\n\n\tViewCell.prototype._setContentSize = function(x, y){\n\t\tvar borders = this._getBorderSizes();\n\t\tif(typeof x === \"number\"){\n\t\t\tvar outerX = x + borders.horizontal;\n\t\t\tthis.$config.width = outerX;\n\t\t}\n\t\tif(typeof y === \"number\"){\n\t\t\tvar outerY = y + borders.vertical;\n\t\t\tthis.$config.height = outerY;\n\t\t}\n\t};\n\n\tViewCell.prototype.setSize = function(x, y){\n\t\t_super.prototype.setSize.call(this, x, y);\n\n\t\tif(!this.$preResize && this.$content) {\n\t\t\tif (!this.$initialized) {\n\t\t\t\tthis.$initialized = true;\n\t\t\t\tvar header = this.$view.childNodes[0];\n\t\t\t\tvar content = this.$view.childNodes[1];\n\t\t\t\tif(!content) content = header;\n\n\t\t\t\t/*if(this.$content.$config){\n\t\t\t\t\tthis.$content.$config.width = this.$lastSize.contentX;\n\t\t\t\t\tthis.$content.$config.height = this.$lastSize.contentY;\n\t\t\t\t}*/\n\t\t\t\tthis.$content.init(content);\n\t\t\t}\n\t\t}\n\t};\n\n\tViewCell.prototype.setContentSize = function(){\n\t\tif(!this.$preResize && this.$content) {\n\t\t\tif (this.$initialized) {\n\t\t\t\tthis.$content.setSize(this.$lastSize.contentX, this.$lastSize.contentY);\n\t\t\t}\n\t\t}\n\t};\n\n\n\tViewCell.prototype.getContentSize = function(){\n\t\tvar size = _super.prototype.getContentSize.call(this);\n\n\t\tif(this.$content && this.$initialized){\n\t\t\tvar childSize = this.$content.getSize();\n\t\t\tsize.width = childSize.contentX === undefined ? childSize.width : childSize.contentX;\n\t\t\tsize.height = childSize.contentY === undefined ? childSize.height : childSize.contentY;\n\t\t}\n\n\t\tvar borders = this._getBorderSizes();\n\t\tsize.width += borders.horizontal;\n\t\tsize.height += borders.vertical;\n\n\t\treturn size;\n\t};\n\n\treturn ViewCell;\n}(Cell));\n\nexport default ViewCell;","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport env from \"../../../utils/env\";\nimport Cell from \"./cell\";\n\nvar ScrollbarCell = (function (_super) {\n\t\"use strict\";\n\n\tvar SCROLL_MODIFIER_KEYS = [\"altKey\", \"shiftKey\", \"metaKey\"]; // it's no way to disable ctrl+wheel\n\t__extends(ScrollbarCell, _super);\n\tfunction ScrollbarCell(parent, config, factory, gantt) {\n\n\t\tvar _this = _super.apply(this, arguments) || this;\n\t\tthis.$config = utils.mixin(config, {scroll: \"x\"});\n\t\t_this._scrollHorizontalHandler = utils.bind(_this._scrollHorizontalHandler, _this);\n\t\t_this._scrollVerticalHandler = utils.bind(_this._scrollVerticalHandler, _this);\n\t\t_this._outerScrollVerticalHandler = utils.bind(_this._outerScrollVerticalHandler, _this);\n\t\t_this._outerScrollHorizontalHandler = utils.bind(_this._outerScrollHorizontalHandler, _this);\n\t\t_this._mouseWheelHandler = utils.bind(_this._mouseWheelHandler, _this);\n\n\t\tthis.$config.hidden = true;\n\t\tvar size = gantt.config.scroll_size;\n\n\t\tif(gantt.env.isIE){\n\t\t\t// full element height/width must be bigger than just a browser scrollbar,\n\t\t\t// otherwise the scrollbar element won't be scrolled on click\n\t\t\tsize += 1;\n\t\t}\n\n\t\tif(this._isHorizontal()){\n\t\t\t_this.$config.height = size;\n\t\t\t_this.$parent.$config.height = size;\n\t\t}else{\n\t\t\t_this.$config.width = size;\n\t\t\t_this.$parent.$config.width = size;\n\t\t}\n\n\t\tthis.$config.scrollPosition = 0;\n\n\t\t_this.$name = \"scroller\";\n\t\treturn _this;\n\t}\n\n\tScrollbarCell.prototype.init = function(container){\n\t\tcontainer.innerHTML = this.$toHTML();\n\t\tthis.$view = container.firstChild;\n\n\t\tif(!this.$view){\n\t\t\tthis.init();\n\t\t}\n\t\tif(this._isVertical()){\n\t\t\tthis._initVertical();\n\t\t}else{\n\t\t\tthis._initHorizontal();\n\t\t}\n\t\tthis._initMouseWheel();\n\t\tthis._initLinkedViews();\n\t};\n\n\tScrollbarCell.prototype.$toHTML = function () {\n\t\tvar className = this._isHorizontal() ? \"gantt_hor_scroll\" : \"gantt_ver_scroll\";\n\t\treturn \"<div class='gantt_layout_cell \"+className+\"'><div style='\"+(this._isHorizontal() ? \"width:2000px\" : \"height:2000px\")+\"'></div></div>\";\n\t};\n\n\tScrollbarCell.prototype._getRootParent = function(){\n\t\tvar parent = this.$parent;\n\t\twhile(parent && parent.$parent){\n\t\t\tparent = parent.$parent;\n\t\t}\n\t\tif(parent){\n\t\t\treturn parent;\n\t\t}\n\t};\n\n\n\tfunction eachCell(root, res){\n\t\tres.push(root);\n\t\tif(root.$cells){\n\t\t\tfor(var i = 0; i < root.$cells.length; i++){\n\t\t\t\teachCell(root.$cells[i], res);\n\t\t\t}\n\t\t}\n\t}\n\tScrollbarCell.prototype._eachView = function(){\n\t\tvar res = [];\n\t\teachCell(this._getRootParent(), res);\n\t\treturn res;\n\t};\n\n\tScrollbarCell.prototype._getLinkedViews = function(){\n\t\tvar views = this._eachView();\n\t\tvar res = [];\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].$config && ((this._isVertical() && views[i].$config.scrollY == this.$id) || (this._isHorizontal() && views[i].$config.scrollX == this.$id)) ){\n\t\t\t\tres.push(views[i]);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\n\tScrollbarCell.prototype._initHorizontal = function(){\n\t\tthis.$scroll_hor = this.$view;\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollHorizontalHandler);\n\n\t};\n\n\tScrollbarCell.prototype._initLinkedViews = function(){\n\t\tvar views = this._getLinkedViews();\n\t\tvar css = this._isVertical() ?\"gantt_layout_outer_scroll gantt_layout_outer_scroll_vertical\" : \"gantt_layout_outer_scroll gantt_layout_outer_scroll_horizontal\";\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\t//views[i].$config.css = [views[i].$config.css || \"\", css].join(\" \");\n\t\t\tdomHelpers.addClassName(views[i].$view || views[i].getNode(), css);\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._initVertical = function(){\n\t\tthis.$scroll_ver = this.$view;\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollVerticalHandler);\n\t};\n\n\tScrollbarCell.prototype._updateLinkedViews = function(){\n\t};\n\n\tScrollbarCell.prototype._initMouseWheel = function(){\n\t\tvar ff = env.isFF;\n\t\tif (ff)\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"wheel\", this._mouseWheelHandler, {passive: false});\n\t\telse\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"mousewheel\", this._mouseWheelHandler, {passive: false});\n\t};\n\n\n\n\n\tScrollbarCell.prototype.scrollHorizontally = function(left){\n\t\tif(this._scrolling) return;\n\t\tthis._scrolling = true;\n\n\t\tthis.$scroll_hor.scrollLeft = left;\n\t\tthis.$config.codeScrollLeft = left;\n\t\tleft = this.$scroll_hor.scrollLeft;\n\n\t\tvar views = this._getLinkedViews();\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].scrollTo){\n\t\t\t\tviews[i].scrollTo(left, undefined);\n\t\t\t}\n\t\t}\n\t\tvar oldSize = this.$config.scrollPosition;\n\t\tthis.$config.scrollPosition = left;\n\t\tthis.callEvent(\"onScroll\", [oldSize, left, this.$config.scroll]);\n\t\tthis._scrolling = false;\n\t};\n\tScrollbarCell.prototype.scrollVertically = function(top){\n\t\tif(this._scrolling) return;\n\t\tthis._scrolling = true;\n\n\t\tthis.$scroll_ver.scrollTop = top;\n\t\ttop = this.$scroll_ver.scrollTop;\n\n\t\tvar views = this._getLinkedViews();\n\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].scrollTo){\n\t\t\t\tviews[i].scrollTo(undefined, top);\n\t\t\t}\n\t\t}\n\t\tvar oldSize = this.$config.scrollPosition;\n\t\tthis.$config.scrollPosition = top;\n\t\tthis.callEvent(\"onScroll\", [oldSize, top, this.$config.scroll]);\n\t\tthis._scrolling = false;\n\t};\n\n\tScrollbarCell.prototype._isVertical = function(){\n\t\treturn this.$config.scroll == \"y\";\n\t};\n\tScrollbarCell.prototype._isHorizontal = function(){\n\t\treturn this.$config.scroll == \"x\";\n\t};\n\tScrollbarCell.prototype._scrollHorizontalHandler = function (e) {\n\t\tif(this._isVertical() || this._scrolling){\n\t\t\treturn;\n\t\t}\n\n\t\t//in safari we can catch previous onscroll after setting new value from mouse-wheel event\n\t\t//set delay to prevent value drifiting\n\t\tif ((new Date()) - ( this._wheel_time || 0 ) < 100) return true;\n\t\t//if (this.$gantt._touch_scroll_active) return;\n\t\tvar left = this.$scroll_hor.scrollLeft;\n\n\t\tthis.scrollHorizontally(left);\n\n\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\n\t};\n\tScrollbarCell.prototype._outerScrollHorizontalHandler = function(e){\n\t\tif(this._isVertical()){\n\t\t\treturn;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.show = function(){\n\t\tthis.$parent.show();\n\t};\n\tScrollbarCell.prototype.hide = function(){\n\t\tthis.$parent.hide();\n\t};\n\n\tScrollbarCell.prototype._getScrollSize = function(){\n\t\tvar scrollSize = 0;\n\t\tvar outerSize = 0;\n\t\tvar isHorizontal = this._isHorizontal();\n\n\t\tvar linked = this._getLinkedViews();\n\t\tvar view;\n\t\tvar scrollProperty = isHorizontal ? \"scrollWidth\" : \"scrollHeight\",\n\t\t\tinnerSizeProperty = isHorizontal ? \"contentX\" : \"contentY\";\n\t\tvar outerProperty = isHorizontal ? \"x\" : \"y\";\n\t\tvar offset = this._getScrollOffset();\n\n\t\tfor(var i = 0; i < linked.length; i++){\n\t\t\tview = linked[i];\n\t\t\tif(!(view && view.$content && view.$content.getSize && !view.$config.hidden)) continue;\n\n\t\t\tvar sizes = view.$content.getSize();\n\t\t\tvar cellScrollSize;\n\t\t\tif(sizes.hasOwnProperty(scrollProperty)){\n\t\t\t\tcellScrollSize = sizes[scrollProperty];\n\t\t\t}else{\n\t\t\t\tcellScrollSize = sizes[innerSizeProperty];\n\t\t\t}\n\n\t\t\tif(offset){\n\t\t\t\t// precalculated vertical/horizontal offsets of scrollbar to emulate 4.x look\n\t\t\t\tif(sizes[innerSizeProperty] > sizes[outerProperty] && sizes[innerSizeProperty] > scrollSize && (cellScrollSize > (sizes[outerProperty] - offset + 2))){\n\t\t\t\t\tscrollSize = cellScrollSize + (isHorizontal ? 0 : 2);\n\t\t\t\t\touterSize = sizes[outerProperty];\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar nonScrollableSize = Math.max(sizes[innerSizeProperty] - cellScrollSize, 0);\n\t\t\t\tvar scrollableViewPortSize = Math.max(sizes[outerProperty] - nonScrollableSize, 0);\n\t\t\t\tcellScrollSize = cellScrollSize + nonScrollableSize;\n\n\t\t\t\tif(cellScrollSize > scrollableViewPortSize && (cellScrollSize > scrollSize) ){\n\t\t\t\t\t//|| (cellScrollSize === scrollSize && sizes[outerProperty] < outerSize) // same scroll width but smaller scrollable view port\n\n\t\t\t\t\tscrollSize = cellScrollSize;\n\t\t\t\t\touterSize = sizes[outerProperty];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\touterScroll: outerSize,\n\t\t\tinnerScroll: scrollSize\n\t\t};\n\t};\n\n\tScrollbarCell.prototype.scroll = function(position){\n\t\tif(this._isHorizontal()){\n\t\t\tthis.scrollHorizontally(position);\n\t\t}else{\n\t\t\tthis.scrollVertically(position);\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.getScrollState = function(){\n\t\treturn {\n\t\t\tvisible: this.isVisible(),\n\t\t\tdirection: this.$config.scroll,\n\t\t\tsize: this.$config.outerSize,\n\t\t\tscrollSize: this.$config.scrollSize || 0,\n\t\t\tposition: this.$config.scrollPosition || 0\n\t\t};\n\t};\n\n\tScrollbarCell.prototype.setSize = function(width, height){\n\t\t_super.prototype.setSize.apply(this, arguments);\n\n\t\tvar scrollSizes = this._getScrollSize();\n\n\t\tvar ownSize = (this._isVertical() ? height : width) - this._getScrollOffset() + (this._isHorizontal() ? 1 : 0);\n\n\t\tif(scrollSizes.innerScroll && ownSize > scrollSizes.outerScroll){\n\t\t\tscrollSizes.innerScroll += (ownSize - scrollSizes.outerScroll);\n\t\t}\n\t\tthis.$config.scrollSize = scrollSizes.innerScroll;\n\n\t\tthis.$config.width = width;\n\t\tthis.$config.height = height;\n\t\tthis._setScrollSize(scrollSizes.innerScroll);\n\t};\n\n\tScrollbarCell.prototype.isVisible = function(){\n\t\treturn !!(this.$parent && this.$parent.$view.parentNode);\n\t};\n\n\tScrollbarCell.prototype.shouldShow = function(){\n\t\tvar scrollSizes = this._getScrollSize();\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn false;\n\t\t}else if(scrollSizes.innerScroll && !(this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.shouldHide = function(){\n\t\tvar scrollSizes = this._getScrollSize();\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\n\tScrollbarCell.prototype.toggleVisibility = function(){\n\t\tif(this.shouldHide()){\n\t\t\tthis.hide();\n\t\t}else if(this.shouldShow()){\n\t\t\tthis.show();\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._getScaleOffset = function(view){\n\t\tvar offset = 0;\n\t\tif(view && (view.$config.view == \"timeline\" || view.$config.view == \"grid\")){\n\t\t\toffset = view.$content.$getConfig().scale_height;\n\t\t}\n\t\treturn offset;\n\t};\n\n\tScrollbarCell.prototype._getScrollOffset = function(){\n\t\tvar offset = 0;\n\t\tif(this._isVertical()){\n\t\t\tvar parentLayout = this.$parent.$parent;\n\t\t\toffset = Math.max(\n\t\t\t\tthis._getScaleOffset(parentLayout.getPrevSibling(this.$parent.$id)),\n\t\t\t\tthis._getScaleOffset(parentLayout.getNextSibling(this.$parent.$id))\n\t\t\t\t);\n\t\t}else{\n\t\t\tvar linked = this._getLinkedViews();\n\n\t\t\tfor (var i = 0; i < linked.length; i++) {\n\t\t\t\tvar view = linked[i],\n\t\t\t\t\tvparent = view.$parent;\n\t\t\t\tvar cells = vparent.$cells;\n\n\t\t\t\tvar last = cells[cells.length - 1];\n\n\t\t\t\tif (last && last.$config.view == \"scrollbar\" && last.$config.hidden === false) {\n\t\t\t\t\toffset = last.$config.width;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn offset || 0;\n\t};\n\n\tScrollbarCell.prototype._setScrollSize = function(size){\n\t\tvar property = this._isHorizontal() ? \"width\" : \"height\";\n\t\tvar scrollbar = this._isHorizontal() ? this.$scroll_hor : this.$scroll_ver;\n\n\t\tvar offset = this._getScrollOffset();\n\n\t\tvar node = scrollbar.firstChild;\n\n\t\tif(offset){\n\t\t\tif(this._isVertical()){\n\n\t\t\t\tthis.$config.outerSize = (this.$config.height - offset + 3);\n\t\t\t\tscrollbar.style.height = this.$config.outerSize + \"px\";\n\t\t\t\tscrollbar.style.top = (offset-1) + \"px\";\n\t\t\t\tdomHelpers.addClassName(scrollbar, this.$parent._borders.top);\n\t\t\t\tdomHelpers.addClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\n\t\t\t}else{\n\t\t\t\tthis.$config.outerSize = (this.$config.width - offset + 1);\n\t\t\t\tscrollbar.style.width = this.$config.outerSize + \"px\";\n\t\t\t\t//domHelpers.addClassName(scrollbar, this.$parent._borders.right);\n\t\t\t}\n\t\t}else{\n\t\t\tscrollbar.style.top = \"auto\";\n\t\t\tdomHelpers.removeClassName(scrollbar, this.$parent._borders.top);\n\t\t\tdomHelpers.removeClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\n\t\t\tthis.$config.outerSize = this.$config.height;\n\t\t}\n\n\t\tnode.style[property] = size + \"px\";\n\t};\n\n\tScrollbarCell.prototype._scrollVerticalHandler = function (e) {\n\t\tif(this._scrollHorizontalHandler() || this._scrolling){\n\t\t\treturn;\n\t\t}\n\n\t\t//if (this.$gantt._touch_scroll_active) return;\n\t\tvar top = this.$scroll_ver.scrollTop;\n\t\tvar prev = this._oldTop;\n\t\tif(top == prev) return;\n\n\t\tthis.scrollVertically(top);\n\n\t\tthis._oldTop = this.$scroll_ver.scrollTop;\n\n\t};\n\tScrollbarCell.prototype._outerScrollVerticalHandler = function(e){\n\t\tif(this._scrollHorizontalHandler()){\n\t\t\treturn;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._checkWheelTarget = function(targetNode){\n\t\tvar connectedViews = this._getLinkedViews().concat(this);\n\n\t\tfor(var i = 0; i < connectedViews.length; i++){\n\t\t\tvar node = connectedViews[i].$view;\n\t\t\tif(domHelpers.isChildOf(targetNode, node)){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tScrollbarCell.prototype._mouseWheelHandler = function(e){\n\t\tvar target = e.target || e.srcElement;\n\n\t\tif(!this._checkWheelTarget(target))\n\t\t\treturn;\n\n\t\tthis._wheel_time = new Date();\n\n\t\tvar res = {};\n\n\t\tvar wheelSpeed = {x: 1, y: 1};\n\t\tvar wheelSpeedConfig = this.$gantt.config.wheel_scroll_sensitivity;\n\n\t\tif (typeof wheelSpeedConfig == \"number\" && !!wheelSpeedConfig) {\n\t\t\twheelSpeed = {x: wheelSpeedConfig, y: wheelSpeedConfig};\n\t\t}\n\t\telse if (({}).toString.apply(wheelSpeedConfig) == \"[object Object]\") {\n\t\t\twheelSpeed = {x: wheelSpeedConfig.x, y: wheelSpeedConfig.y};\n\t\t}\n\n\t\tvar ff = env.isFF;\n\t\tvar deltaX = ff ? (e.deltaX) : e.wheelDeltaX;\n\t\tvar deltaY = ff ? (e.deltaY) : e.wheelDelta;\n\n\t\tvar multiplier = -20;\n\t\tif (ff) {\n\t\t\tif (e.deltaMode !== 0) {\n\t\t\t\tmultiplier = -40;\n\t\t\t} else {\n\t\t\t\tmultiplier = -10;\n\t\t\t}\n\t\t}\n\n\t\tvar wx = ff ? (deltaX * multiplier * wheelSpeed.x) : deltaX * 2 * wheelSpeed.x;\n\t\tvar wy = ff ? (deltaY * multiplier * wheelSpeed.y) : deltaY * wheelSpeed.y;\n\n\t\tvar horizontalScrollModifier = this.$gantt.config.horizontal_scroll_key;\n\n\t\tif (horizontalScrollModifier !== false) {\n\t\t\tif (SCROLL_MODIFIER_KEYS.indexOf(horizontalScrollModifier) >= 0) {\n\t\t\t\tif(e[horizontalScrollModifier] && !(e.deltaX || e.wheelDeltaX)){\n\t\t\t\t\t// shift+mousewheel for horizontal scroll\n\t\t\t\t\twx = wy*2;\n\t\t\t\t\twy = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tif (wx && Math.abs(wx) > Math.abs(wy)){\n\t\t\tif(this._isVertical()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(res.x) return true;//no horisontal scroll, must not block scrolling\n\t\t\tif(!this.$scroll_hor || !this.$scroll_hor.offsetWidth) return true;\n\n\t\t\tvar dir  = wx/-40;\n\t\t\tvar oldLeft = this._oldLeft;\n\t\t\tvar left = oldLeft+dir*30;\n\t\t\tthis.scrollHorizontally(left);\n\t\t\tthis.$scroll_hor.scrollLeft = left;\n\t\t\t// not block scroll if position hasn't changed\n\t\t\tif(oldLeft == this.$scroll_hor.scrollLeft){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\n\t\t} else {\n\t\t\tif(this._isHorizontal()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(res.y) return true;//no vertical scroll, must not block scrolling\n\t\t\tif(!this.$scroll_ver || !this.$scroll_ver.offsetHeight) return true;\n\n\t\t\tvar dir  = wy/-40;\n\t\t\tif (typeof wy == \"undefined\")\n\t\t\t\tdir = e.detail;\n\n\t\t\tvar oldTop = this._oldTop;\n\t\t\tvar top = this.$scroll_ver.scrollTop+dir*30;\n\n\t\t\t//if(!this.$gantt.config.prevent_default_scroll &&\n\t\t\t//\t(this.$gantt._cached_scroll_pos && ((this.$gantt._cached_scroll_pos.y == top) || (this.$gantt._cached_scroll_pos.y <= 0 && top <= 0)))) return true;\n\n\n\t\t\tthis.scrollVertically(top);\n\t\t\tthis.$scroll_ver.scrollTop = top;\n\n\t\t\t// not block scroll if position hasn't changed\n\t\t\tif(oldTop == this.$scroll_ver.scrollTop){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tthis._oldTop = this.$scroll_ver.scrollTop;\n\t\t}\n\n\t\tif (e.preventDefault)\n\t\t\te.preventDefault();\n\t\te.cancelBubble=true;\n\t\treturn false;\n\t};\n\n\treturn ScrollbarCell;\n})(Cell);\n\nexport default ScrollbarCell;","import quickPositionHelperFactory from \"./row_position_fixed_height\";\n\nfunction createMixin(view){\n\tvar getItemTopCache = {};\n\tvar getRowTopCache = {};\n\tvar getItemHeightCache = null;\n\tvar totalHeightCache = -1;\n\tvar getItemHeightCacheState = null;\n\n\tvar quickPosition = quickPositionHelperFactory(view);\n\n\treturn {\n\t\t_resetTopPositionHeight: function(){\n\t\t\tgetItemTopCache = {};\n\t\t\tgetRowTopCache = {};\n\t\t\tquickPosition.resetCache();\n\t\t},\n\t\t_resetHeight: function(){\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tvar newState = this.getCacheStateTotalHeight(store);\n\t\t\tif(!getItemHeightCacheState){\n\t\t\t\tgetItemHeightCacheState = newState;\n\t\t\t}else if(this.shouldClearHeightCache(getItemHeightCacheState, newState)){\n\t\t\t\tgetItemHeightCacheState = newState;\n\t\t\t\tgetItemHeightCache = null;\n\t\t\t}\n\n\t\t\ttotalHeightCache = -1;\n\t\t\tquickPosition.resetCache();\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by row index (order)\n\t\t * @param {number} index\n\t\t */\n\t\tgetRowTop: function(index){\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getRowTop(index);\n\t\t\t}\n\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(getRowTopCache[index] !== undefined){\n\t\t\t\treturn getRowTopCache[index];\n\t\t\t}else {\n\t\t\t\tvar all = store.getIndexRange();\n\t\t\t\tvar top = 0;\n\t\t\t\tvar result = 0;\n\t\t\t\tfor(var i = 0; i < all.length; i++){\n\t\t\t\t\tgetRowTopCache[i] = top;\n\t\t\t\t\ttop += this.getItemHeight(all[i].id);\n\t\t\t\t\tif(i < index){\n\t\t\t\t\t\tresult = top;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by item id\n\t\t * @param {*} task_id\n\t\t */\n\t\tgetItemTop: function (taskId) {\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tif(getItemTopCache[taskId] !== undefined){\n\t\t\t\t\treturn getItemTopCache[taskId];\n\t\t\t\t}\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return 0;\n\n\t\t\t\tvar itemIndex = store.getIndexById(taskId);\n\n\t\t\t\tif (itemIndex === -1 && store.getParent && store.exists(taskId)) {\n\t\t\t\t\tvar parentId = store.getParent(taskId);\n\t\t\t\t\tif (store.exists(parentId)) {\n\t\t\t\t\t\t// if task is not found in list - maybe it's parent is a split task and we should use parents index instead\n\t\t\t\t\t\tvar parent = store.getItem(parentId);\n\t\t\t\t\t\tif (this.$gantt.isSplitTask(parent)) {\n\t\t\t\t\t\t\treturn this.getItemTop(parentId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgetItemTopCache[taskId] = this.getRowTop(itemIndex);\n\t\t\t\treturn getItemTopCache[taskId];\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t},\n\n\t\t/**\n\t\t * Get height of the item by item id\n\t\t * @param {*} itemId\n\t\t */\n\t\tgetItemHeight: function (itemId) {\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getItemHeight(itemId);\n\t\t\t}\n\n\t\t\tif(!getItemHeightCache && this.$config.rowStore){\n\t\t\t\tthis._fillHeightCache(this.$config.rowStore);\n\t\t\t}\n\n\t\t\tif(getItemHeightCache[itemId] !== undefined){\n\t\t\t\treturn getItemHeightCache[itemId];\n\t\t\t}\n\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\n\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return defaultHeight;\n\n\t\t\t\tvar item = store.getItem(itemId);\n\n\t\t\t\treturn getItemHeightCache[itemId] = item && item.row_height || defaultHeight;\n\t\t\t}else{\n\t\t\t\treturn defaultHeight;\n\t\t\t}\n\t\t},\n\n\t\t_fillHeightCache: function(store){\n\t\t\tif(!store){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgetItemHeightCache = {};\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\n\t\t\tstore.eachItem(function(item){\n\t\t\t\treturn getItemHeightCache[item.id] = item && item.row_height || defaultHeight;\n\t\t\t});\n\t\t},\n\n\t\tgetCacheStateTotalHeight: function(store){\n\n\t\t\tvar globalHeight = this.$getConfig().row_height;\n\t\t\tvar itemHeightCache = {};\n\t\t\tvar items = [];\n\t\t\tvar sumHeight = 0;\n\t\t\tif(store){\n\t\t\t\tstore.eachItem(function(item){\n\t\t\t\t\titems.push(item);\n\t\t\t\t\titemHeightCache[item.id] = item.row_height;\n\t\t\t\t\tsumHeight += item.row_height || globalHeight;\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\treturn {\n\t\t\t\tglobalHeight: globalHeight,\n\t\t\t\titems: items,\n\t\t\t\tcount: items.length,\n\t\t\t\tsumHeight: sumHeight\n\t\t\t};\n\t\t},\n\t\tshouldClearHeightCache: function(oldState, newState){\n\n\t\t\tif(oldState.count != newState.count){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(oldState.globalHeight != newState.globalHeight){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(oldState.sumHeight != newState.sumHeight){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tfor(var i in oldState.items){\n\t\t\t\tvar newValue = newState.items[i];\n\t\t\t\tif(newValue !== undefined && newValue != oldState.items[i]){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\t/**\n\t\t * Get total height of items\n\t\t */\n\t\tgetTotalHeight: function () {\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getTotalHeight();\n\t\t\t}\n\n\t\t\tif(totalHeightCache != -1){\n\t\t\t\treturn totalHeightCache;\n\t\t\t}\n\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tthis._fillHeightCache(store);\n\t\t\t\tvar getHeight = this.getItemHeight.bind(this);\n\t\t\t\tvar visibleItems = store.getVisibleItems();\n\t\t\t\tvar totalHeight = 0;\n\n\t\t\t\tvisibleItems.forEach(function(item){\n\t\t\t\t\ttotalHeight += getHeight(item.id);\n\t\t\t\t});\n\n\t\t\t\ttotalHeightCache = totalHeight;\n\t\t\t\treturn totalHeight;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get item by top position\n\t\t * @param {*} top\n\t\t */\n\t\tgetItemIndexByTopPosition: function (top) {\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\t\treturn quickPosition.getItemIndexByTopPosition(top);\n\t\t\t\t}\n\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tfor(var i = 0; i < store.countVisible(); i++){\n\t\t\t\t\tvar current = this.getRowTop(i);\n\t\t\t\t\tvar next = this.getRowTop(i+1);\n\t\t\t\t\tif(!next){\n\t\t\t\t\t\tvar taskId = store.getIdByIndex(i);\n\t\t\t\t\t\tnext = current + this.getItemHeight(taskId);\n\t\t\t\t\t}\n\t\t\t\t\tif(top >= current && top < next){\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-1723: If we iterated all tasks and didn't find the position, the target is below all other tasks\n\t\t\t\treturn store.countVisible() + 2;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createMixin;","function createHelper(view){\n\tvar cachedRowHeight = -1;\n\tvar canUseSimpleCalc = -1;\n\treturn {\n\t\tresetCache: function(){\n\t\t\tcachedRowHeight = -1;\n\t\t\tcanUseSimpleCalc = -1;\n\t\t},\n\t\t_getRowHeight: function(){\n\t\t\tif(cachedRowHeight === -1){\n\t\t\t\tcachedRowHeight = view.$getConfig().row_height;\n\t\t\t}\n\t\t\treturn cachedRowHeight;\n\t\t},\n\t\t_refreshState: function(){\n\t\t\tthis.resetCache();\n\t\t\tcanUseSimpleCalc = true;\n\t\t\tvar store = view.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar globalRowHeight = this._getRowHeight();\n\t\t\tfor (var i=0; i<store.fullOrder.length; i++) {\n\t\t\t\tvar item = store.getItem(store.fullOrder[i]);\n\t\t\t\t// GS-1491: ignore the task when it is filtered:\n\t\t\t\tif (!item) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(item.row_height && item.row_height !== globalRowHeight){\n\t\t\t\t\tcanUseSimpleCalc = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t},\n\t\tcanUseSimpleCalculation: function(){\n\t\t\tif(canUseSimpleCalc === -1){\n\t\t\t\tthis._refreshState();\n\t\t\t}\n\t\t\treturn canUseSimpleCalc;\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by row index (order)\n\t\t * @param {number} index\n\t\t */\n\t\tgetRowTop: function(index){\n\t\t\tvar store = view.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn index * this._getRowHeight();\n\t\t},\n\n\t\t/**\n\t\t * Get height of the item by item id\n\t\t * @param {*} itemId\n\t\t */\n\t\tgetItemHeight: function (itemId) {\n\t\t\treturn this._getRowHeight();\n\t\t},\n\n\t\t/**\n\t\t * Get total height of items\n\t\t */\n\t\tgetTotalHeight: function () {\n\t\t\tif(view.$config.rowStore){\n\t\t\t\tvar store = view.$config.rowStore;\n\t\t\t\treturn store.countVisible() * this._getRowHeight();\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get item by top position\n\t\t * @param {*} top\n\t\t */\n\t\tgetItemIndexByTopPosition: function (top) {\n\t\t\tif(view.$config.rowStore){\n\t\t\t\treturn Math.floor(top / this._getRowHeight());\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createHelper;","var createStaticBgHelper = function(){\n\treturn {\n\t\trender: function () { },\n\t\tdestroy: function () { }\n\t};\n};\n\nexport default {\n\tcreate: function(){\n\t\treturn createStaticBgHelper();\n\t}\n};\n\n","import ScaleHelper from \"./scales_ignore\";\nimport eventable from \"../../../utils/eventable\";\nimport * as utils from \"../../../utils/utils\";\nimport * as helpers from \"../../../utils/helpers\";\nimport topPositionMixin from \"../row_position_mixin\";\nimport canvasRender from \"./tasks_canvas_render\";\nimport createLayerConfig from \"./timeline_layers\";\n\nvar Timeline = function(parent, config, factory, gantt){\n\tthis.$config = utils.mixin({}, config || {});\n\tthis.$scaleHelper = new ScaleHelper(gantt);\n\tthis.$gantt = gantt;\n\tthis._posFromDateCache = {};\n\tthis._timelineDragScroll = null;\n\tutils.mixin(this, topPositionMixin(this));\n\teventable(this);\n};\n\nTimeline.prototype = {\n\tinit: function(container) {\n\t\tcontainer.innerHTML += \"<div class='gantt_task' style='width:inherit;height:inherit;'></div>\";\n\t\tthis.$task = container.childNodes[0];\n\n\t\tthis.$task.innerHTML = \"<div class='gantt_task_scale'></div><div class='gantt_data_area'></div>\";\n\t\tthis.$task_scale = this.$task.childNodes[0];\n\n\t\tthis.$task_data = this.$task.childNodes[1];\n\t\tconst taskBg = \"<div class='gantt_task_bg'></div>\";\n\t\tconst links = \"<div class='gantt_links_area'></div>\";\n\t\tconst taskBars = \"<div class='gantt_bars_area'></div>\";\n\n\t\tconst taskConstraints = \"<div class='gantt_task_constraints'></div>\";\n\t\tconst taskDeadlines = \"<div class='gantt_task_deadlines'></div>\";\n\t\tconst taskBaselines = \"<div class='gantt_task_baselines'></div>\";\n\n\t\tthis.$task_data.innerHTML = taskBg + taskBaselines + links + taskBars + taskConstraints + taskDeadlines;\n\n\t\tthis.$task_bg = this.$task_data.childNodes[0];\n\t\tthis.$task_baselines = this.$task_data.childNodes[1];\n\t\tthis.$task_links = this.$task_data.childNodes[2];\n\t\tthis.$task_bars = this.$task_data.childNodes[3];\n\t\tthis.$task_constraints = this.$task_data.childNodes[4];\n\t\tthis.$task_deadlines = this.$task_data.childNodes[5];\n\n\t\tthis._tasks = {\n\t\t\tcol_width: 0,\n\t\t\twidth: [], // width of each column\n\t\t\tfull_width: 0, // width of all columns\n\t\t\ttrace_x: [],\n\t\t\trendered: {}\n\t\t};\n\n\t\tvar config = this.$getConfig();\n\t\tvar attr = config[this.$config.bind + \"_attribute\"];\n\t\tvar linksAttr = config[this.$config.bindLinks + \"_attribute\"];\n\t\tif(!attr && this.$config.bind){\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t}\n\t\tif(!linksAttr && this.$config.bindLinks){\n\t\t\tlinksAttr = \"data-\" + this.$config.bindLinks + \"-id\";\n\t\t}\n\t\tthis.$config.item_attribute = attr || null;\n\t\tthis.$config.link_attribute = linksAttr || null;\n\n\t\tvar layers = this._createLayerConfig();\n\t\tif(!this.$config.layers){\n\t\t\tthis.$config.layers = layers.tasks;\n\t\t}\n\t\tif(!this.$config.linkLayers){\n\t\t\tthis.$config.linkLayers = layers.links;\n\t\t}\n\n\t\tthis._attachLayers(this.$gantt);\n\n\t\tthis.callEvent(\"onReady\", []);\n\t\t//this.refresh();\n\t\tif (this.$gantt.ext.dragTimeline) {\n\t\t\tthis._timelineDragScroll = this.$gantt.ext.dragTimeline.create();\n\t\t\tthis._timelineDragScroll.attach(this);\n\t\t}\n\t},\n\n\tsetSize: function(width, height){\n\t\tvar config = this.$getConfig();\n\n\t\tif(width*1 === width){\n\t\t\tthis.$config.width = width;\n\t\t}\n\t\tif(height*1 === height){\n\n\t\t\tthis.$config.height = height;\n\t\t\tvar dataHeight = Math.max(this.$config.height - config.scale_height);\n\t\t\tthis.$task_data.style.height = dataHeight + 'px';\n\t\t}\n\n\t\tthis.refresh();\n\t\tthis.$task_bg.style.backgroundImage = \"\";\n\n\t\tif(config.smart_rendering && this.$config.rowStore){\n\t\t\tthis.$task_bg.style.height = this.getTotalHeight() +\"px\";\n\t\t}else{\n\t\t\tthis.$task_bg.style.height = \"\";\n\t\t}\n\n\t\tvar scale = this._tasks;\n\t\t//timeline area layers\n\t\tvar data_els = this.$task_data.childNodes;\n\t\tfor(var i= 0, len = data_els.length; i < len; i++){\n\t\t\tvar el = data_els[i];\n\t\t\tif(el.hasAttribute(\"data-layer\") && el.style)\n\t\t\t\tel.style.width = scale.full_width + \"px\";\n\t\t}\n\t},\n\n\tisVisible: function(){\n\t\tif(this.$parent && this.$parent.$config){\n\t\t\treturn !this.$parent.$config.hidden;\n\t\t}else{\n\t\t\treturn this.$task.offsetWidth;\n\t\t}\n\t},\n\n\tgetSize: function(){\n\t\tvar config = this.$getConfig();\n\t\tvar store = this.$config.rowStore;\n\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\n\t\t\tcontentWidth = this.isVisible() ? this._tasks.full_width : 0;\n\n\t\treturn {\n\t\t\tx: this.isVisible() ? this.$config.width : 0,\n\t\t\ty: this.isVisible() ? this.$config.height : 0,\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\n\t\t};\n\t},\n\n\tscrollTo: function(left, top){\n\t\tif(!this.isVisible())\n\t\t\treturn;\n\n\t\tvar scrolled = false;\n\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\n\t\tif(top*1 === top){\n\t\t\tthis.$config.scrollTop = top;\n\t\t\tthis.$task_data.scrollTop = this.$config.scrollTop;\n\t\t\tscrolled = true;\n\t\t}\n\t\tif (left*1 === left){\n\t\t\tthis.$task.scrollLeft = left;\n\t\t\tthis.$config.scrollLeft = this.$task.scrollLeft;\n\t\t\tthis._refreshScales();\n\t\t\tscrolled = true;\n\t\t}\n\n\t\tif(scrolled){\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n\t\t}\n\t},\n\n\t_refreshScales: function _refreshScales() {\n\t\tif(!this.isVisible())\n\t\t\treturn;\n\n\t\tvar config = this.$getConfig();\n\t\tif (!config.smart_scales) return;\n\n\t\tvar viewPort = this.getViewPort();\n\n\t\tvar scales = this._scales;\n\t\tthis.$task_scale.innerHTML = this._getScaleChunkHtml(scales, viewPort.x, viewPort.x_end);\n\t},\n\n\tgetViewPort: function(){\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\n\t\tvar scrollTop = this.$config.scrollTop || 0;\n\t\tvar height = this.$config.height || 0;\n\t\tvar width = this.$config.width || 0;\n\t\treturn {\n\t\t\ty: scrollTop,\n\t\t\ty_end: scrollTop + height,\n\t\t\tx: scrollLeft,\n\t\t\tx_end: scrollLeft + width,\n\t\t\theight: height,\n\t\t\twidth: width\n\t\t};\n\t},\n\n\t_createLayerConfig: createLayerConfig,\n\n\t_attachLayers: function(gantt){\n\t\tthis._taskLayers = [];\n\t\tthis._linkLayers = [];\n\n\t\tvar self = this;\n\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\n\t\tif(this.$config.bind){\n\n\t\t\tthis._bindStore();\n\t\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\t\tif(!taskRenderer){\n\t\t\t\ttaskRenderer = layers.createDataRender({\n\t\t\t\t\tname: this.$config.bind,\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttaskRenderer.container = function(){ return self.$task_data;};\n\n\t\t\tvar taskLayers = this.$config.layers;\n\t\t\tfor(var i = 0; taskLayers && i < taskLayers.length; i++){\n\t\t\t\tvar layer = taskLayers[i];\n\n\t\t\t\tif(typeof layer == \"string\"){\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\n\t\t\t\t}\n\n\t\t\t\tif(typeof layer == \"function\" || (layer && layer.render && layer.update)){\n\t\t\t\t\tlayer = {renderer: layer};\n\t\t\t\t}\n\n\t\t\t\tlayer.view = this;\n\n\t\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\n\t\t\t\tthis._taskLayers.push(bar_layer);\n\t\t\t\tif(layer.expose){\n\t\t\t\t\tthis._taskRenderer = taskRenderer.getLayer(bar_layer);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._initStaticBackgroundRender();\n\t\t}\n\n\t\tif(this.$config.bindLinks){\n\t\t\tself.$config.linkStore = self.$gantt.getDatastore(self.$config.bindLinks);\n\n\t\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\n\n\t\t\tif(!linkRenderer){\n\t\t\t\tlinkRenderer = layers.createDataRender({\n\t\t\t\t\tname: this.$config.bindLinks,\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\n\t\t\t\t});\n\t\t\t}\n\t\t\tvar linkLayers = this.$config.linkLayers;\n\t\t\tfor(var i = 0; linkLayers && i < linkLayers.length; i++){\n\n\t\t\t\tif(typeof layer == \"string\"){\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\n\t\t\t\t}\n\n\t\t\t\tvar layer = linkLayers[i];\n\t\t\t\tlayer.view = this;\n\t\t\t//\tlayer.getViewPort = getViewPort;\n\t\t\t//\tsubscribeSmartRender(layer);\n\t\t\t\tvar linkLayer = linkRenderer.addLayer(layer);\n\t\t\t\tthis._taskLayers.push(linkLayer);\n\t\t\t\tif(linkLayers[i].expose){\n\t\t\t\t\tthis._linkRenderer = linkRenderer.getLayer(linkLayer);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_initStaticBackgroundRender: function(){\n\t\tvar self = this;\n\t\tvar staticRender = canvasRender.create();\n\t\tvar store = self.$config.rowStore;\n\t\tif(!store) return;\n\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", function(id, item, mode){\n\t\t\tif(id !== null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!self.isVisible())\n\t\t\t\treturn;\n\t\t\tvar config = self.$getConfig();\n\t\t\tif(config.static_background || config.timeline_placeholder) {\n\t\t\t\tvar store = self.$gantt.getDatastore(self.$config.bind);\n\t\t\t\tvar staticBgContainer = self.$task_bg_static;\n\t\t\t\tif(!staticBgContainer){\n\t\t\t\t\tstaticBgContainer = document.createElement(\"div\");\n\t\t\t\t\tstaticBgContainer.className = \"gantt_task_bg\";\n\t\t\t\t\tself.$task_bg_static = staticBgContainer;\n\t\t\t\t\tif(self.$task_bg.nextSibling){\n\t\t\t\t\t\tself.$task_data.insertBefore(staticBgContainer, self.$task_bg.nextSibling);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tself.$task_data.appendChild(staticBgContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (store) {\n\t\t\t\t\tvar staticBackgroundHeight = self.getTotalHeight();\n\t\t\t\t\tif (config.timeline_placeholder){\n\t\t\t\t\t\tstaticBackgroundHeight = config.timeline_placeholder.height || self.$task_data.offsetHeight || 99999;\n\t\t\t\t\t}\n\t\t\t\t\tstaticRender.render(staticBgContainer, config, self.getScale(), staticBackgroundHeight, self.getItemHeight(item ? item.id : null));\n\t\t\t\t}\n\t\t\t}else if(config.static_background){\n\t\t\t\tif(self.$task_bg_static && self.$task_bg_static.parentNode){\n\t\t\t\t\tself.$task_bg_static.parentNode.removeChild(self.$task_bg_static);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.attachEvent(\"onDestroy\", function () {\n\t\t\tstaticRender.destroy();\n\t\t});\n\t\tthis._initStaticBackgroundRender = function(){};//init once\n\t},\n\n\t_clearLayers: function(gantt){\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\n\n\t\tif (this._taskLayers) {\n\t\t\tfor(var i = 0; i < this._taskLayers.length; i++){\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\n\t\t\t}\n\t\t}\n\t\tif (this._linkLayers) {\n\t\t\tfor(var i = 0; i < this._linkLayers.length; i++){\n\t\t\t\tlinkRenderer.removeLayer(this._linkLayers[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis._linkLayers = [];\n\t\tthis._taskLayers = [];\n\t},\n\n\t_render_tasks_scales: function _render_tasks_scales() {\n\t\tvar config = this.$getConfig();\n\n\t\tvar scales_html = \"\",\n\t\t\touter_width = 0,\n\t\t\tscale_height = 0;\n\n\t\tvar state = this.$gantt.getState();\n\n\t\tif (this.isVisible()) {\n\t\t\tvar helpers = this.$scaleHelper;\n\t\t\tvar scales = this._getScales();\n\t\t\tscale_height = config.scale_height;\n\n\t\t\tvar availWidth = this.$config.width;\n\t\t\tif(config.autosize == \"x\" || config.autosize == \"xy\"){\n\t\t\t\tavailWidth = Math.max(config.autosize_min_width, 0);\n\t\t\t}\n\n\t\t\tvar cfgs = helpers.prepareConfigs(scales, config.min_column_width, availWidth, scale_height - 1, state.min_date, state.max_date, config.rtl);\n\t\t\tvar cfg = this._tasks = cfgs[cfgs.length - 1];\n\t\t\tthis._scales = cfgs;\n\t\t\tthis._posFromDateCache = {};\n\n\t\t\tscales_html = this._getScaleChunkHtml(cfgs, 0, this.$config.width);\n\n\t\t\touter_width = cfg.full_width + \"px\";//cfg.full_width + (this._scroll_sizes().y ? scrollSizes.scroll_size : 0) + \"px\";\n\t\t\tscale_height += \"px\";\n\t\t}\n\n\t\tthis.$task_scale.style.height = scale_height;\n\n\t\tthis.$task_data.style.width =\n\t\t\tthis.$task_scale.style.width = outer_width;\n\n\t\tthis.$task_scale.innerHTML = scales_html;\n\n\t},\n\n\t_getScaleChunkHtml: function _get_scale_chunk_html (scales, fromPos, toPos) {\n\t\tvar templates = this.$gantt.templates;\n\t\tvar html = [];\n\n\t\tvar css = templates.scale_row_class;\n\t\tfor (var i = 0; i < scales.length; i++) {\n\t\t\tvar cssClass = \"gantt_scale_line\";\n\t\t\tvar tplClass = css(scales[i]);\n\t\t\tif (tplClass) {\n\t\t\t\tcssClass += \" \" + tplClass;\n\t\t\t}\n\n\t\t\thtml.push(\"<div class=\\\"\" + cssClass + \"\\\" style=\\\"height:\" + (scales[i].height) +\n\t\t\t\t\"px;position:relative;line-height:\" + (scales[i].height) + \"px\\\">\" + this._prepareScaleHtml(scales[i], fromPos, toPos, i) + \"</div>\");\n\t\t}\n\n\t\treturn html.join(\"\");\n\t},\n\t_prepareScaleHtml: function _prepare_scale_html(config, fromPos, toPos, index) {\n\t\tvar globalConfig = this.$getConfig();\n\t\tvar globalTemplates = this.$gantt.templates;\n\n\t\tvar cells = [];\n\t\tvar date = null, css = null;\n\n\t\tvar content = config.format || config.template || config.date;\n\n\t\tif(typeof content === \"string\"){\n\t\t\tcontent = this.$gantt.date.date_to_str(content);\n\t\t}\n\n\t\tvar startIndex = 0,\n\t\t\tendIndex = config.count;\n\n\t\tif (globalConfig.smart_scales && (!isNaN(fromPos) && !isNaN(toPos))) {\n\t\t\tstartIndex = helpers.findBinary(config.left, fromPos);\n\t\t\tendIndex = helpers.findBinary(config.left, toPos) + 1;\n\t\t}\n\n\t\tcss = config.css || function () {\n\t\t\t};\n\t\tif (!config.css && globalConfig.inherit_scale_class) {\n\t\t\tcss = globalTemplates.scale_cell_class;\n\t\t}\n\n\t\tfor (var i = startIndex; i < endIndex; i++) {\n\t\t\tif (!config.trace_x[i]) break;\n\n\t\t\tdate = new Date(config.trace_x[i]);\n\t\t\tvar value = content.call(this, date),\n\t\t\t\twidth = config.width[i],\n\t\t\t\theight = config.height,\n\t\t\t\tleft = config.left[i],\n\t\t\t\tstyle = \"\",\n\t\t\t\ttemplate = \"\",\n\t\t\t\tcssclass = \"\";\n\n\t\t\tif (width) {\n\t\t\t\tvar position = globalConfig.smart_scales ? (\"position:absolute;left:\" + left + \"px\") : \"\";\n\n\t\t\t\tstyle = \"width:\" + (width) + \"px;\" + position;\n\t\t\t\t// GS-1188: Display the scale value in the viewport for long cells\n\t\t\t\tconst viewPort = this.getViewPort();\n\t\t\t\tconst floatConfig = (globalConfig.scales[index] || {}).sticky; // for old scale settings\n\n\t\t\t\tlet labelPosition = '';\n\t\t\t\tconst approxLabelWidth = 70;\n\t\t\t\t// if sticky config is not specified - sticky labels are enabled for long cells only\n\t\t\t\tif ((floatConfig !== false && width > approxLabelWidth) || floatConfig === true) {\n\t\t\t\t\t\n\t\t\t\t\tif (left < viewPort.x && left + width/2 - approxLabelWidth/2 < viewPort.x){\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${viewPort.x  - left + 10}px;' `;\n\t\t\t\t\t} else if(left + width/2 + approxLabelWidth/2 > viewPort.x_end && width > approxLabelWidth){\n\t\t\t\t\t\tlet labelPos = viewPort.x_end - left - 10;\n\t\t\t\t\t\tlet translateValue = \"-100%\";\n\t\t\t\t\t\tif(labelPos < approxLabelWidth) {\n\t\t\t\t\t\t\tlabelPos = approxLabelWidth;\n\t\t\t\t\t\t\ttranslateValue = `-${labelPos}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${labelPos}px;transform: translate(${translateValue},0);' `;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcssclass = \"gantt_scale_cell\" + (i == config.count - 1 ? \" gantt_last_cell\" : \"\");\n\n\t\t\t\ttemplate = css.call(this, date);\n\t\t\t\tif (template) cssclass += \" \" + template;\n\n\t\t\t\tvar ariaAttr = this.$gantt._waiAria.getTimelineCellAttr(value);\n\t\t\t\tvar cell = `<div class='${cssclass}' ${ariaAttr} style='${style}'><span ${labelPosition}>${value}</span></div>`;\n\t\t\t\tcells.push(cell);\n\t\t\t} else {\n\t\t\t\t//do not render ignored cells\n\t\t\t}\n\n\t\t}\n\t\treturn cells.join(\"\");\n\t},\n\tdateFromPos: function dateFromPos(x) {\n\t\tvar scale = this._tasks;\n\t\tif (x < 0 || x > scale.full_width || !scale.full_width) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar ind = helpers.findBinary(this._tasks.left, x);\n\t\tvar summ = this._tasks.left[ind];\n\n\t\tvar col_width = scale.width[ind] || scale.col_width;\n\t\tvar part = 0;\n\t\tif (col_width) {\n\t\t\tpart = (x - summ) / col_width;\n\t\t\tif(scale.rtl){\n\t\t\t\tpart = 1 - part;\n\t\t\t}\n\n\t\t}\n\n\t\tvar unit = 0;\n\t\tif (part) {\n\t\t\tunit = this._getColumnDuration(scale, scale.trace_x[ind]);\n\t\t}\n\n\t\tvar date = new Date(scale.trace_x[ind].valueOf() + Math.round(part * unit));\n\t\treturn date;\n\t},\n\tposFromDate: function posFromDate(date) {\n\t\tif (!this.isVisible())\n\t\t\treturn 0;\n\n\t\tif(!date){\n\t\t\treturn 0;\n\t\t}\n\n\t\tvar dateValue = String(date.valueOf());\n\n\t\tif(this._posFromDateCache[dateValue] !== undefined){\n\t\t\treturn this._posFromDateCache[dateValue];\n\t\t}\n\t\tvar ind = this.columnIndexByDate(date);\n\t\tthis.$gantt.assert(ind >= 0, \"Invalid day index\");\n\n\t\tvar wholeCells = Math.floor(ind);\n\t\tvar partCell = ind % 1;\n\n\t\tvar pos = this._tasks.left[Math.min(wholeCells, this._tasks.width.length - 1)];\n\t\tif (wholeCells == this._tasks.width.length)\n\t\t\tpos += this._tasks.width[this._tasks.width.length - 1];\n\t\t//for(var i=1; i <= wholeCells; i++)\n\t\t//\tpos += gantt._tasks.width[i-1];\n\n\t\tif (partCell) {\n\t\t\tif (wholeCells < this._tasks.width.length) {\n\t\t\t\tpos += this._tasks.width[wholeCells] * (partCell % 1);\n\t\t\t} else {\n\t\t\t\tpos += 1;\n\t\t\t}\n\n\t\t}\n\n\t\tvar roundPos = Math.round(pos);\n\t\tthis._posFromDateCache[dateValue] = roundPos;\n\t\treturn Math.round(roundPos);\n\t},\n\n\t_getNextVisibleColumn: function (startIndex, columns, ignores) {\n\t\t// iterate columns to the right\n\t\tvar date = +columns[startIndex];\n\t\tvar visibleDateIndex = startIndex;\n\t\twhile (ignores[date]) {\n\t\t\tvisibleDateIndex++;\n\t\t\tdate = +columns[visibleDateIndex];\n\t\t}\n\n\t\treturn visibleDateIndex;\n\t},\n\t_getPrevVisibleColumn: function (startIndex, columns, ignores) {\n\t\t// iterate columns to the left\n\t\tvar date = +columns[startIndex];\n\t\tvar visibleDateIndex = startIndex;\n\t\twhile (ignores[date]) {\n\t\t\tvisibleDateIndex--;\n\t\t\tdate = +columns[visibleDateIndex];\n\t\t}\n\t\treturn visibleDateIndex;\n\t},\n\t_getClosestVisibleColumn: function (startIndex, columns, ignores) {\n\t\tvar visibleDateIndex = this._getNextVisibleColumn(startIndex, columns, ignores);\n\t\tif (!columns[visibleDateIndex]) {\n\t\t\tvisibleDateIndex =  this._getPrevVisibleColumn(startIndex, columns, ignores);\n\t\t}\n\t\treturn visibleDateIndex;\n\t},\n\tcolumnIndexByDate: function columnIndexByDate(date) {\n\t\tvar pos = new Date(date).valueOf();\n\t\tvar days = this._tasks.trace_x_ascending,\n\t\t\tignores = this._tasks.ignore_x;\n\n\t\tvar state = this.$gantt.getState();\n\n\t\tif (pos <= state.min_date) {\n\t\t\tif(this._tasks.rtl){\n\t\t\t\treturn days.length;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t}\n\n\t\tif (pos >= state.max_date) {\n\t\t\tif(this._tasks.rtl){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn days.length;\n\t\t\t}\n\t\t}\n\n\t\tvar dateIndex = helpers.findBinary(days, pos);\n\n\t\tvar visibleIndex = this._getClosestVisibleColumn(dateIndex, days, ignores);\n\t\tvar visibleDate = days[visibleIndex];\n\t\tvar transition = this._tasks.trace_index_transition;\n\n\t\tif(!visibleDate){\n\t\t\tif(transition){\n\t\t\t\treturn transition[0];\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\tvar part = ((date - days[visibleIndex]) / this._getColumnDuration(this._tasks, days[visibleIndex]));\n\t\tif(transition){\n\t\t\treturn transition[visibleIndex] + (1 - part);\n\t\t}else{\n\t\t\treturn visibleIndex + part;\n\t\t}\n\t},\n\tgetItemPosition:function (task, start_date, end_date) {\n\t\tvar xLeft, xRight, width;\n\n\t\tlet displayStart = start_date || task.start_date || task.$auto_start_date;\n\t\tlet displayEnd = end_date || task.end_date || task.$auto_end_date;\n\t\tif(this._tasks.rtl){\n\t\t\txRight = this.posFromDate(displayStart);\n\t\t\txLeft = this.posFromDate(displayEnd);\n\t\t}else{\n\t\t\txLeft = this.posFromDate(displayStart);\n\t\t\txRight = this.posFromDate(displayEnd);\n\t\t}\n\t\twidth =  Math.max((xRight - xLeft), 0);\n\n\t\tvar y = this.getItemTop(task.id);\n\n\t\tvar height = this.getBarHeight(task.id);\n\t\tvar rowHeight = this.getItemHeight(task.id);\n\t\treturn {\n\t\t\tleft: xLeft,\n\t\t\ttop: y,\n\t\t\theight: height,\n\t\t\twidth: width,\n\t\t\trowHeight: rowHeight\n\t\t};\n\t},\n\n\tgetBarHeight: function(taskId, isMilestoneRender){\n\t\tvar config = this.$getConfig();\n\n\t\tvar task = this.$config.rowStore.getItem(taskId);\n\t\t// height of the bar item\n\t\tvar height = task.task_height || task.bar_height || config.bar_height || config.task_height;\n\t\tvar rowHeight = this.getItemHeight(taskId);\n\n\t\tif (height == \"full\") {\n\t\t\tvar offset = config.bar_height_padding || 3;\n\t\t\theight = rowHeight - offset;\n\t\t}\n\t\t//item height cannot be bigger than row height\n\t\theight = Math.min(height, rowHeight);\n\t\tif (isMilestoneRender) { // to get correct height for addapting Milestone to the row\n\t\t\theight = Math.round(height / Math.sqrt(2));\n\t\t}\n\t\treturn Math.max(height, 0);\n\t},\n\n\tgetScale: function(){\n\t\treturn this._tasks;\n\t},\n\n\t_getScales: function _get_scales() {\n\t\tvar config = this.$getConfig();\n\t\tvar helpers = this.$scaleHelper;\n\t\tvar scales = [helpers.primaryScale(config)].concat(helpers.getSubScales(config));\n\n\t\thelpers.sortScales(scales);\n\t\treturn scales;\n\t},\n\n\t_getColumnDuration: function _get_coll_duration(scale, date) {\n\t\treturn this.$gantt.date.add(date, scale.step, scale.unit) - date;\n\t},\n\t_bindStore: function () {\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tthis.$config.rowStore = rowStore;\n\t\t\tif(rowStore && !rowStore._timelineCacheAttached){\n\t\t\t\tvar self = this;\n\t\t\t\trowStore._timelineCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\n\t\t\t\t\tself._resetTopPositionHeight();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t_unbindStore: function(){\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tif(rowStore && rowStore._timelineCacheAttached){\n\t\t\t\trowStore.detachEvent(rowStore._timelineCacheAttached);\n\t\t\t\trowStore._timelineCacheAttached = false;\n\t\t\t}\n\t\t}\n\t},\n\trefresh: function(){\n\t\tthis._bindStore();\n\n\t\tif(this.$config.bindLinks) {\n\t\t\tthis.$config.linkStore = this.$gantt.getDatastore(this.$config.bindLinks);\n\t\t}\n\n\t\tthis._resetTopPositionHeight();\n\t\tthis._resetHeight();\n\t\tthis._initStaticBackgroundRender();\n\t\tthis._render_tasks_scales();\n\t},\n\n\tdestructor: function(){\n\t\tvar gantt = this.$gantt;\n\t\tthis._clearLayers(gantt);\n\t\tthis._unbindStore();\n\t\tthis.$task = null;\n\t\tthis.$task_scale = null;\n\t\tthis.$task_data = null;\n\t\tthis.$task_bg = null;\n\t\tthis.$task_links = null;\n\t\tthis.$task_bars = null;\n\n\t\tthis.$gantt = null;\n\n\t\tif(this.$config.rowStore){\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\n\t\t\tthis.$config.rowStore = null;\n\t\t}\n\t\tif(this.$config.linkStore){\n\t\t\tthis.$config.linkStore = null;\n\t\t}\n\n\t\tif(this._timelineDragScroll) {\n\t\t\tthis._timelineDragScroll.destructor();\n\t\t\tthis._timelineDragScroll = null;\n\t\t}\n\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t}\n};\n\nexport default Timeline;","\nexport default function(){\n\tvar self = this;\n\tvar taskFilter = function(){\n\t\treturn self.isVisible();\n\t};\n\n\tvar barVisible = function(id, task){\n\t\treturn !task.hide_bar;\n\t};\n\n\tconst gantt = this.$gantt;\n\n\tvar taskLayers = [\n\t\t{\n\t\t\texpose: true,\n\t\t\trenderer: this.$gantt.$ui.layers.taskBar(),\n\t\t\tcontainer: this.$task_bars,\n\t\t\tfilter: [taskFilter, barVisible]\n\t\t}\n\t];\n\n\ttaskLayers.push({\n\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\tcontainer: this.$task_bg,\n\t\tfilter: [\n\t\t\t//function(){\n\t\t\t//\treturn !self.$getConfig().static_background;\n\t\t\t//},\n\t\t\ttaskFilter\n\t\t]\n\t});\n\n\tvar linkLayers = [\n\t\t{\n\t\t\texpose: true,\n\t\t\trenderer: this.$gantt.$ui.layers.link(),\n\t\t\tcontainer: this.$task_links,\n\t\t\tfilter: [taskFilter]\n\t\t}\n\t];\n\n\treturn {\n\t\ttasks: taskLayers,\n\t\tlinks: linkLayers\n\t};\n\n};","const SENSITIVITY = 20;\nconst TIMEOUT = 50;\nconst SCROLLSTEP = 10;\n\nexport default class ScrollableGrid {\n\tpublic getCurrentX;\n\tprivate $gantt;\n\tprivate $grid;\n\tprivate _dnd;\n\tprivate _scrollView;\n\tprivate _scrollOrder: 0 | 1 | -1 = 0;\n\n\tconstructor(params) {\n\t\tconst {gantt, grid, dnd, getCurrentX} = params;\n\t\tthis.$gantt = gantt;\n\t\tthis.$grid = grid;\n\t\tthis._dnd = dnd;\n\t\tthis.getCurrentX = getCurrentX;\n\t\tthis._scrollView = this.$gantt.$ui.getView(this.$grid.$config.scrollX);\n\t\tthis.attachEvents();\n\t}\n\tattachEvents() {\n\t\tif (this.isScrollable()) {\n\t\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\n\t\t\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\n\t\t\t\tconst maxLeft = gridBoundingRect.right;\n\t\t\t\tconst minLeft = gridBoundingRect.left;\n\t\t\t\tconst currentX = this.getCurrentX(e.clientX);\n\n\t\t\t\tif (currentX >= maxLeft - SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollRight();\n\t\t\t\t\tthis.autoscrollStart();\n\t\t\t\t}\n\t\t\t\tif (currentX <= minLeft + SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollLeft();\n\t\t\t\t\tthis.autoscrollStart();\n\t\t\t\t}\n\t\t\t\tif (currentX < maxLeft - SENSITIVITY && currentX > minLeft + SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollStop();\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\n\t\t\t\tthis.autoscrollStop();\n\t\t\t});\n\t\t}\n\t}\n\tautoscrollStart() {\n\t\tif (this._scrollOrder === 0) {\n\t\t\treturn;\n\t\t}\n\t\tconst scrollStep = SCROLLSTEP * this._scrollOrder;\n\t\tconst scrollState = this._scrollView.getScrollState();\n\t\tthis._scrollView.scrollTo(scrollState.position + scrollStep);\n\t\tsetTimeout(() => { this.autoscrollStart(); }, TIMEOUT);\n\t}\n\tautoscrollRight() {\n\t\tthis._scrollOrder = 1;\n\t}\n\tautoscrollLeft() {\n\t\tthis._scrollOrder = -1;\n\t}\n\tautoscrollStop() {\n\t\tthis._scrollOrder = 0;\n\t}\n\tgetCorrection() {\n\t\tif (!this.isScrollable()) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn this._scrollView.getScrollState().position;\n\t}\n\tisScrollable() {\n\t\treturn !!this.$grid.$config.scrollable;\n\t}\n}","import * as domHelpers from \"../../utils/dom_helpers\";\nimport ScrollableGrid from \"./scrollable_grid\";\n\nconst COLUMN_ID_ATTR_NAME = \"data-column-id\";\n\nexport class ColumnsGridDnd {\n\tprivate $gantt;\n\tprivate $grid;\n\tprivate _dragX;\n\tprivate _dnd;\n\tprivate _originAutoscroll;\n\tprivate _scrollableGrid: ScrollableGrid;\n\tprivate _draggedCell;\n\tprivate _targetMarker = null;\n\tprivate _gridConfig;\n\tconstructor(gantt, grid) {\n\t\tthis.$gantt = gantt;\n\t\tthis.$grid = grid;\n\t}\n\tinit() {\n\t\tconst DND = this.$gantt.$services.getService(\"dnd\");\n\t\tthis._dnd = new DND(this.$grid.$grid_scale, { updates_per_second: 60 });\n\t\tthis._scrollableGrid = new ScrollableGrid({\n\t\t\tgantt: this.$gantt,\n\t\t\tgrid: this.$grid,\n\t\t\tdnd: this._dnd,\n\t\t\tgetCurrentX: this.calculateCurrentPosition\n\t\t});\n\t\tthis.attachEvents();\n\t}\n\tattachEvents() {\n\t\tthis._dnd.attachEvent(\"onBeforeDragStart\", (obj, e) => {\n\t\t\tthis._draggedCell = this.$gantt.utils.dom.closest(e.target, \".gantt_grid_head_cell\");\n\t\t\tif(!this._draggedCell){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst columns = this.$grid.$getConfig().columns;\n\t\t\tconst columnName = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\n\t\t\tlet draggedColumn;\n\t\t\tlet draggedIndex;\n\t\t\tcolumns.map(function(column, index){\n\t\t\t\tif(column.name === columnName){\n\t\t\t\t\tdraggedColumn = column;\n\t\t\t\t\tdraggedIndex = index;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.$grid.callEvent(\"onBeforeColumnDragStart\", [{ draggedColumn, draggedIndex}]) === false) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this._draggedCell || !draggedColumn) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._gridConfig = this.$grid.$getConfig();\n\t\t\tthis._originAutoscroll = this.$gantt.config.autoscroll;\n\t\t\tthis.$gantt.config.autoscroll = false;\n\t\t\treturn true;\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onAfterDragStart\", (obj, e) => {\n\t\t\tif (!this._draggedCell) {\n\t\t\t\treturn; // GS-1333: don't try to reorder a column when we resize it\n\t\t\t}\n\t\t\tthis._dnd.config.column = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\n\t\t\tthis._dnd.config.marker.innerHTML = this._draggedCell.outerHTML;\n\t\t\tthis._dnd.config.marker.classList.add(\"gantt_column_drag_marker\");\n\t\t\tthis._dnd.config.marker.style.height = this._gridConfig.scale_height + \"px\";\n\t\t\tthis._dnd.config.marker.style.lineHeight = this._gridConfig.scale_height + \"px\";\n\t\t\tthis._draggedCell.classList.add(\"gantt_grid_head_cell_dragged\");\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\n\t\t\tif(!this._draggedCell){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._dragX = e.clientX;\n\t\t\tconst x = this.calculateCurrentPosition(e.clientX);\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\n\t\t\tconst targetIndex = columnIndexes.targetIndex;\n\t\t\tconst draggedIndex = columnIndexes.draggedIndex;\n\t\t\tconst columns = this.$grid.$getConfig().columns;\n\n\t\t\tconst draggedColumn = columns[draggedIndex];\n\t\t\tconst targetColumn = columns[targetIndex];\n\t\t\tif (this.$grid.callEvent(\"onColumnDragMove\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\n\t\t\t\tthis.cleanTargetMarker();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.setMarkerPosition(x);\n\t\t\tthis.drawTargetMarker(columnIndexes);\n\t\t\treturn true;\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\n\t\t\tif (!this._draggedCell) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$gantt.config.autoscroll = this._originAutoscroll;\n\t\t\tthis._draggedCell.classList.remove(\"gantt_grid_head_cell_dragged\");\n\t\t\tthis.cleanTargetMarker();\n\t\t\tthis.reorderColumns();\n\t\t});\n\n\t}\n\treorderColumns() {\n\t\tconst { targetIndex, draggedIndex } = this.findColumnsIndexes();\n\n\t\tconst columns = this.$grid.$getConfig().columns;\n\t\tconst draggedColumn = columns[draggedIndex];\n\t\tconst targetColumn = columns[targetIndex];\n\n\t\tif (this.$grid.callEvent(\"onBeforeColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (targetIndex === draggedIndex) {\n\t\t\treturn;\n\t\t}\n\t\tcolumns.splice(draggedIndex, 1);\n\t\tcolumns.splice(targetIndex, 0, draggedColumn);\n\t\tthis.$gantt.render();\n\t\tthis.$grid.callEvent(\"onAfterColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]);\n\t}\n\tfindColumnsIndexes() {\n\t\tconst draggedId = this._dnd.config.column;\n\t\tconst columns = this.$grid.$getConfig().columns;\n\t\tlet targetIndex: number;\n\t\tlet draggedIndex: number;\n\t\tlet xBefore: number;\n\t\tlet xAfter: number;\n\t\tconst currentColumn = { startX: 0, endX: 0 };\n\n\t\tlet start = 0;\n\t\tlet end = columns.length - 1;\n\t\tlet compare = (a, b) => a <= b;\n\t\tlet next = (index) => ++index;\n\t\tif (this.$gantt.config.rtl) {\n\t\t\tstart = columns.length - 1;\n\t\t\tend = 0;\n\t\t\tcompare = (a, b) => a >= b;\n\t\t\tnext = (index) => --index;\n\t\t}\n\n\t\tlet columnRelativePos: number;\n\n\t\tconst relativeX = this._dragX - this.$grid.$grid.getBoundingClientRect().left + this._scrollableGrid.getCorrection();\n\t\tfor (let i = start; compare(i, end); i = next(i)) {\n\t\t\tif (targetIndex !== undefined && draggedIndex !== undefined) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(!columns[i].hide) {\n\t\t\t\tcurrentColumn.startX = currentColumn.endX;\n\t\t\t\tcurrentColumn.endX += columns[i].width;\n\n\t\t\t\t// if drop on a column or drop after the last column\n\t\t\t\tif (relativeX >= currentColumn.startX && (relativeX <= currentColumn.endX || !compare(next(i), end))) {\n\t\t\t\t\ttargetIndex = i;\n\t\t\t\t\txBefore = currentColumn.startX;\n\t\t\t\t\txAfter = currentColumn.endX;\n\t\t\t\t\tcolumnRelativePos = (relativeX - currentColumn.startX) / (currentColumn.endX - currentColumn.startX);\n\t\t\t\t}\n\t\t\t\tif (draggedId === columns[i].name) {\n\t\t\t\t\tdraggedIndex = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttargetIndex,\n\t\t\tdraggedIndex,\n\t\t\txBefore,\n\t\t\txAfter,\n\t\t\tcolumnRelativePos\n\t\t};\n\t}\n\tsetMarkerPosition(x: number, y: number = 10) {\n\t\tconst { marker } = this._dnd.config;\n\t\tconst gridOffset = this._dnd._obj.getBoundingClientRect();\n\t\tmarker.style.top = `${gridOffset.y + y}px`;\n\t\tmarker.style.left = `${x}px`;\n\t}\n\tcalculateCurrentPosition = (eventX: number) => {\n\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\n\t\tconst maxLeft = gridBoundingRect.right;\n\t\tconst minLeft = gridBoundingRect.left;\n\t\tlet x = eventX;\n\t\tif (x > maxLeft) {\n\t\t\tx = maxLeft;\n\t\t}\n\t\tif (x < minLeft) {\n\t\t\tx = minLeft;\n\t\t}\n\t\treturn x;\n\t};\n\tdrawTargetMarker({ targetIndex, draggedIndex, xBefore, xAfter, columnRelativePos }) {\n\t\tif (!this._targetMarker) {\n\t\t\tthis._targetMarker = document.createElement(\"div\");\n\t\t\tdomHelpers.addClassName(this._targetMarker, \"gantt_grid_target_marker\");\n\t\t\tthis._targetMarker.style.display = \"none\";\n\t\t\tthis._targetMarker.style.height = `${this._gridConfig.scale_height}px`;\n\t\t}\n\n\t\t// marker can be detached after gantt.render\n\t\tif(!this._targetMarker.parentNode){\n\t\t\tthis.$grid.$grid_scale.appendChild(this._targetMarker);\n\t\t}\n\n\t\tlet nextPosition: number;\n\t\tif (targetIndex > draggedIndex) {\n\t\t\tnextPosition = xAfter;\n\t\t} else if (targetIndex < draggedIndex) {\n\t\t\tnextPosition = xBefore;\n\t\t} else {\n\t\t\tif(columnRelativePos > 0.5){\n\t\t\t\tnextPosition = xAfter;\n\t\t\t}else{\n\t\t\t\tnextPosition = xBefore;\n\t\t\t}\n\t\t}\n\n\t\tthis._targetMarker.style.left = `${nextPosition}px`;\n\t\tthis._targetMarker.style.display = \"block\";\n\t}\n\tcleanTargetMarker() {\n\t\tif (this._targetMarker && this._targetMarker.parentNode) {\n\t\t\tthis.$grid.$grid_scale.removeChild(this._targetMarker);\n\t\t}\n\t\tthis._targetMarker = null;\n\t}\n}","function create(gantt){\n\tvar events = [];\n\n\treturn {\n\t\tdelegate:function(event, className, handler, root) {\n\t\t\tevents.push([event, className, handler, root]);\n\n\t\t\tvar helper = gantt.$services.getService(\"mouseEvents\");\n\t\t\thelper.delegate(event, className, handler, root);\n\t\t},\n\t\tdestructor: function(){\n\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\tfor(var i = 0; i < events.length; i++){\n\t\t\t\tvar h = events[i];\n\t\t\t\tmouseEvents.detach(h[0], h[1], h[2], h[3]);\n\t\t\t}\n\t\t\tevents = [];\n\t\t}\n\t};\n}\n\nexport default create;","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport eventable from \"../../../utils/eventable\";\nimport gridResize from \"./grid_resize\";\nimport topPositionMixin from \"../row_position_mixin\";\nimport rowResize from \"./task_grid_row_resize\";\n\nimport ColumnDnd from \"../plugins/column_grid_dnd\";\n\nimport mouseEventContainer from \"../mouse_event_container\";\n\nvar Grid = function (parent, config, factory, gantt) {\n\tthis.$config = utils.mixin({}, config || {});\n\tthis.$gantt = gantt;\n\tthis.$parent = parent;\n\teventable(this);\n\tthis.$state = {};\n\tutils.mixin(this, topPositionMixin(this));\n};\n\n\nGrid.prototype = {\n\tinit: function(container) {\n\t\tvar gantt = this.$gantt;\n\t\tvar gridAriaAttr = gantt._waiAria.gridAttrString();\n\t\tvar gridDataAriaAttr = gantt._waiAria.gridDataAttrString();\n\t\tvar _ganttConfig = this.$getConfig();\n\t\tvar reorderColumns = _ganttConfig.reorder_grid_columns || false;\n\t\tif (this.$config.reorder_grid_columns !== undefined) {\n\t\t\treorderColumns = this.$config.reorder_grid_columns;\n\t\t}\n\n\n\t\tcontainer.innerHTML = \"<div class='gantt_grid' style='height:inherit;width:inherit;' \" + gridAriaAttr + \"></div>\";\n\t\tthis.$grid = container.childNodes[0];\n\n\t\tthis.$grid.innerHTML = \"<div class='gantt_grid_scale' \" +\n\t\t\tgantt._waiAria.gridScaleRowAttrString() + \"></div><div class='gantt_grid_data' \" + gridDataAriaAttr + \"></div>\";\n\n\t\tthis.$grid_scale = this.$grid.childNodes[0];\n\t\tthis.$grid_data = this.$grid.childNodes[1];\n\n\t\tvar attr = _ganttConfig[this.$config.bind + \"_attribute\"];\n\t\tif (!attr && this.$config.bind) {\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t}\n\t\tthis.$config.item_attribute = attr || null;\n\n\t\tif (!this.$config.layers) {\n\t\t\tvar layers = this._createLayerConfig();\n\t\t\tthis.$config.layers = layers;\n\t\t}\n\n\t\tvar resizer = gridResize(gantt, this);\n\t\tresizer.init();\n\t\tthis._renderHeaderResizers = resizer.doOnRender;\n\t\tthis._mouseDelegates = mouseEventContainer(gantt);\n\n\t\tvar resizerrow = rowResize(gantt, this);\n\t\tresizerrow.init();\n\n\t\tthis._addLayers(this.$gantt);\n\t\tthis._initEvents();\n\n\t\tif (reorderColumns) {\n\t\t\tthis._columnDND = new ColumnDnd(gantt, this);\n\t\t\tthis._columnDND.init();\n\t\t}\n\n\t\tthis.callEvent(\"onReady\", []);\n\t\t//this.refresh();\n\t},\n\n\t_validateColumnWidth: function (column, property) {\n\t\t// user can set {name:\"text\", width:\"200\",...} for some reason,\n\t\t// check and convert it to number when possible\n\t\tvar value = column[property];\n\t\tif (value && value != \"*\") {\n\t\t\tvar gantt = this.$gantt;\n\t\t\tvar numericWidth = value * 1;\n\t\t\tif (isNaN(numericWidth)) {\n\t\t\t\tgantt.assert(false, \"Wrong \" + property + \" value of column \" + column.name);\n\t\t\t} else {\n\t\t\t\tcolumn[property] = numericWidth;\n\t\t\t}\n\t\t}\n\t},\n\n\tsetSize: function (width, height) {\n\t\tthis.$config.width = this.$state.width = width;\n\t\tthis.$config.height = this.$state.height = height;\n\n\t\t// TODO: maybe inherit and override in a subclass instead of extending here\n\n\t\tvar columns = this.getGridColumns(),\n\t\t\tinnerWidth = 0;\n\n\t\tvar config = this.$getConfig();\n\t\tvar elasticColumns = config.grid_elastic_columns;\n\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tthis._validateColumnWidth(columns[i], \"min_width\");\n\t\t\tthis._validateColumnWidth(columns[i], \"max_width\");\n\t\t\tthis._validateColumnWidth(columns[i], \"width\");\n\n\t\t\tinnerWidth += columns[i].width * 1;\n\t\t}\n\n\t\tvar outerWidth;\n\t\tif (isNaN(innerWidth) || !this.$config.scrollable) {\n\t\t\touterWidth = this._setColumnsWidth(width + 1);\n\t\t\tinnerWidth = outerWidth;\n\t\t}\n\n\t\tif(this.$config.scrollable && elasticColumns && !isNaN(innerWidth)){\n\t\t\t// GS-1352: Allow resizing the grid columns, then the grid width is increased\n\t\t\t// or keep the grid width, but don't allow column resize to affect the grid width\n\t\t\tlet columnProperty = \"width\";\n\t\t\tif (elasticColumns == \"min_width\"){\n\t\t\t\tcolumnProperty = \"min_width\";\n\t\t\t}\n\t\t\tlet newColumnWidth = 0;\n\t\t\tcolumns.forEach(function(col){\n\t\t\t\tnewColumnWidth += col[columnProperty] || config.min_grid_column_width;\n\t\t\t});\n\t\t\t//newColumnWidth--; // the total column width shouldn't match the outerWidth // GS-2190 reducing width seems to be not needed\n\t\t\tvar columnsWidth = Math.max(newColumnWidth, width);\n\t\t\tinnerWidth = this._setColumnsWidth(columnsWidth);\n\t\t\touterWidth = width;\n\t\t}\n\n\t\tif (this.$config.scrollable) {\n\t\t\tthis.$grid_scale.style.width = innerWidth + \"px\";\n\t\t\tthis.$grid_data.style.width = innerWidth + \"px\";\n\t\t} else {\n\t\t\tthis.$grid_scale.style.width = \"inherit\";\n\t\t\tthis.$grid_data.style.width = \"inherit\";\n\t\t}\n\t\tthis.$config.width -= 1;\n\n\t\tvar config = this.$getConfig();\n\t\tif (outerWidth !== width) {\n\t\t\tif(outerWidth !== undefined){\n\t\t\t\tconfig.grid_width = outerWidth;\n\t\t\t\tthis.$config.width = outerWidth - 1;\n\t\t\t}else{\n\t\t\t\tif(!isNaN(innerWidth)){\n\t\t\t\t\tthis._setColumnsWidth(innerWidth);\n\t\t\t\t\tconfig.grid_width = innerWidth;\n\t\t\t\t\tthis.$config.width = innerWidth - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar dataHeight = Math.max(this.$state.height - config.scale_height, 0);\n\t\tthis.$grid_data.style.height = dataHeight + \"px\";\n\t\tthis.refresh();\n\t},\n\tgetSize: function () {\n\n\t\tvar config = this.$getConfig();\n\n\t\tvar store = this.$config.rowStore;\n\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\n\t\t\tcontentWidth = this._getGridWidth();\n\n\t\tvar size = {\n\t\t\tx: this.$state.width,\n\t\t\ty: this.$state.height,\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\n\t\t};\n\n\t\treturn size;\n\t},\n\n\t_bindStore: function () {\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tthis.$config.rowStore = rowStore;\n\t\t\tif(rowStore && !rowStore._gridCacheAttached){\n\t\t\t\tvar self = this;\n\t\t\t\trowStore._gridCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\n\t\t\t\t\tself._resetTopPositionHeight();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t_unbindStore: function(){\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tif(rowStore && rowStore._gridCacheAttached){\n\t\t\t\trowStore.detachEvent(rowStore._gridCacheAttached);\n\t\t\t\trowStore._gridCacheAttached = false;\n\t\t\t}\n\t\t}\n\t},\n\n\trefresh: function () {\n\t\tthis._bindStore();\n\n\t\tthis._resetTopPositionHeight();\n\t\tthis._resetHeight();\n\t\tthis._initSmartRenderingPlaceholder();\n\n\t\tthis._calculateGridWidth();\n\t\tthis._renderGridHeader();\n\t},\n\n\tgetViewPort: function(){\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\n\t\tvar scrollTop = this.$config.scrollTop || 0;\n\t\tvar height = this.$config.height || 0;\n\t\tvar width = this.$config.width || 0;\n\t\treturn {\n\t\t\ty: scrollTop,\n\t\t\ty_end: scrollTop + height,\n\t\t\tx: scrollLeft,\n\t\t\tx_end: scrollLeft + width,\n\t\t\theight: height,\n\t\t\twidth: width\n\t\t};\n\t},\n\n\tscrollTo: function (left, top) {\n\t\tif (!this.isVisible())\n\t\t\treturn;\n\n\t\tvar scrolled = false;\n\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\n\n\t\tif (left * 1 == left) {\n\t\t\tthis.$config.scrollLeft = this.$state.scrollLeft = this.$grid.scrollLeft = left;\n\t\t\tscrolled = true;\n\t\t}\n\n\t\t// var config = this.$getConfig();\n\t\tif (top * 1 == top) {\n\t\t\tthis.$config.scrollTop = this.$state.scrollTop = this.$grid_data.scrollTop = top;\n\t\t\tscrolled = true;\n\t\t}\n\n\t\tif(scrolled){\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n\t\t}\n\t},\n\n\tgetColumnIndex: function (name, excludeHidden) {\n\t\tvar columns = this.$getConfig().columns;\n\t\tvar hiddenIndexShift = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\t// GS-1257. If the cell is hidden, the target column index should be correct\n\t\t\tif (excludeHidden && columns[i].hide){\n\t\t\t\thiddenIndexShift++;\n\t\t\t}\n\t\t\tif (columns[i].name == name) {\n\t\t\t\treturn i - hiddenIndexShift;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\tgetColumn: function (name) {\n\t\tvar index = this.getColumnIndex(name);\n\t\tif (index === null) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.$getConfig().columns[index];\n\t},\n\n\tgetGridColumns: function () {\n\t\tvar config = this.$getConfig();\n\t\treturn config.columns.slice();\n\t},\n\tisVisible: function () {\n\t\tif (this.$parent && this.$parent.$config) {\n\t\t\treturn !this.$parent.$config.hidden;\n\t\t} else {\n\t\t\treturn this.$grid.offsetWidth;\n\t\t}\n\t},\n\n\t// getItemHeight: function () {\n\t// \tvar config = this.$getConfig();\n\t// \treturn config.row_height;\n\t// },\n\n\t_createLayerConfig: function () {\n\t\tvar gantt = this.$gantt;\n\t\tvar self = this;\n\t\tvar layers = [\n\t\t\t{\n\t\t\t\trenderer: gantt.$ui.layers.gridLine(),\n\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\tfilter: [function () {\n\t\t\t\t\treturn self.isVisible();\n\t\t\t\t}]\n\t\t\t},\n\t\t\t{\n\t\t\t\trenderer: gantt.$ui.layers.gridTaskRowResizer(),\n\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\tappend: true,\n\t\t\t\tfilter: [function () {\n\t\t\t\t\treturn gantt.config.resize_rows;\n\t\t\t\t}]\n\t\t\t}\n\t\t];\n\t\treturn layers;\n\t},\n\n\t_addLayers: function (gantt) {\n\t\tif (!this.$config.bind)\n\t\t\treturn;\n\n\t\tthis._taskLayers = [];\n\n\t\tvar self = this;\n\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\tif (!taskRenderer) {\n\t\t\ttaskRenderer = layers.createDataRender({\n\t\t\t\tname: this.$config.bind,\n\t\t\t\tdefaultContainer: function () { return self.$grid_data; }\n\t\t\t});\n\t\t}\n\n\t\tvar taskLayers = this.$config.layers;\n\t\tfor (var i = 0; taskLayers && i < taskLayers.length; i++) {\n\t\t\tvar layer = taskLayers[i];\n\t\t\tlayer.view = this;\n\n\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\n\t\t\tthis._taskLayers.push(bar_layer);\n\t\t}\n\n\t\tthis._bindStore();\n\n\t\tthis._initSmartRenderingPlaceholder();\n\t},\n\n\t_refreshPlaceholderOnStoreUpdate: function (id) {\n\t\tvar config = this.$getConfig(),\n\t\t\tstore = this.$config.rowStore;\n\n\t\tif (!store || id !== null || !this.isVisible() || !config.smart_rendering) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar contentHeight;\n\t\tif (this.$config.scrollY) {\n\t\t\tvar scroll = this.$gantt.$ui.getView(this.$config.scrollY);\n\t\t\tif (scroll)\n\t\t\t\tcontentHeight = scroll.getScrollState().scrollSize;\n\t\t}\n\n\t\tif (!contentHeight) {\n\t\t\tcontentHeight = store ? this.getTotalHeight() : 0;\n\t\t}\n\n\t\tif (contentHeight) {\n\t\t\tif (this.$rowsPlaceholder && this.$rowsPlaceholder.parentNode) {\n\t\t\t\tthis.$rowsPlaceholder.parentNode.removeChild(this.$rowsPlaceholder);\n\t\t\t}\n\n\t\t\tvar placeholder = this.$rowsPlaceholder = document.createElement(\"div\");\n\t\t\tplaceholder.style.visibility = \"hidden\";\n\t\t\tplaceholder.style.height = contentHeight + \"px\";\n\t\t\tplaceholder.style.width = \"1px\";\n\t\t\tthis.$grid_data.appendChild(placeholder);\n\t\t}\n\t},\n\n\t_initSmartRenderingPlaceholder: function () {\n\t\tvar store = this.$config.rowStore;\n\t\tif (!store) {\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis._initSmartRenderingPlaceholder = function () { };\n\t\t}\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", utils.bind(this._refreshPlaceholderOnStoreUpdate, this));\n\t},\n\n\t_initEvents: function () {\n\t\tvar gantt = this.$gantt;\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_close\", gantt.bind(function (e, id, trg) {\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif (!store) return true;\n\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\tif (target) {\n\t\t\t\tstore.close(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t}\n\t\t\treturn false;\n\t\t}, this), this.$grid);\n\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_open\", gantt.bind(function (e, id, trg) {\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif (!store) return true;\n\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\tif (target) {\n\t\t\t\tstore.open(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t}\n\t\t\treturn false;\n\t\t}, this), this.$grid);\n\t},\n\n\t_clearLayers: function (gantt) {\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\tif (this._taskLayers) {\n\t\t\tfor (var i = 0; i < this._taskLayers.length; i++) {\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis._taskLayers = [];\n\t},\n\n\t_getColumnWidth: function (column, config, width) {\n\t\tvar min_width = column.min_width || config.min_grid_column_width;\n\t\tvar new_width = Math.max(width, min_width || 10);\n\t\tif (column.max_width)\n\t\t\tnew_width = Math.min(new_width, column.max_width);\n\t\treturn new_width;\n\t},\n\t// set min width only if width < than config.min_grid_column_width\n\t_checkGridColumnMinWidthLimits: function (columns, config) {\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tvar width = columns[i].width * 1;\n\t\t\tif (!columns[i].min_width && width < config.min_grid_column_width){\n\t\t\t\tcolumns[i].min_width = width;\n\t\t\t}\n\t\t}\n\t},\n\t// return min and max possible grid width according to restricts\n\t_getGridWidthLimits: function () {\n\t\tvar config = this.$getConfig(),\n\t\t\tcolumns = this.getGridColumns(),\n\t\t\tmin_limit = 0,\n\t\t\tmax_limit = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tmin_limit += columns[i].min_width ? columns[i].min_width : config.min_grid_column_width;\n\t\t\tif (max_limit !== undefined) {\n\t\t\t\tmax_limit = columns[i].max_width ? (max_limit + columns[i].max_width) : undefined;\n\t\t\t}\n\t\t}\n\t\tthis._checkGridColumnMinWidthLimits(columns, config); // FIX ME: should it be before calculating limits?\n\t\treturn [min_limit, max_limit];\n\t},\n\t// resize columns to get total newWidth, starting from columns[start_index]\n\t_setColumnsWidth: function (newWidth, start_index) {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = this.getGridColumns(),\n\t\t\tcolumns_width = 0,\n\t\t\tfinal_width = newWidth;\n\n\t\tstart_index = !window.isNaN(start_index) ? start_index : -1;\n\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tcolumns_width += columns[i].width * 1;\n\t\t}\n\n\t\tif (window.isNaN(columns_width)) {\n\t\t\tthis._calculateGridWidth();\n\t\t\tcolumns_width = 0;\n\t\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\t\tcolumns_width += columns[i].width * 1;\n\t\t\t}\n\t\t}\n\n\t\tvar extra_width = final_width - columns_width;\n\n\t\tvar start_width = 0;\n\t\tfor (var i = 0; i < start_index + 1; i++) {\n\t\t\tstart_width += columns[i].width;\n\t\t}\n\n\t\tcolumns_width -= start_width;\n\n\t\tfor (var i = start_index + 1; i < columns.length; i++) {\n\n\t\t\tvar col = columns[i];\n\t\t\tvar share = Math.round(extra_width * (col.width / columns_width));\n\n\t\t\t// columns have 2 additional restrict fields - min_width & max_width that are set by user\n\t\t\tif (extra_width < 0) {\n\t\t\t\tif (col.min_width && col.width + share < col.min_width)\n\t\t\t\t\tshare = col.min_width - col.width;\n\t\t\t\telse if (!col.min_width && config.min_grid_column_width && col.width + share < config.min_grid_column_width)\n\t\t\t\t\tshare = config.min_grid_column_width - col.width;\n\t\t\t} else if (col.max_width && col.width + share > col.max_width)\n\t\t\t\tshare = col.max_width - col.width;\n\n\t\t\tcolumns_width -= col.width;\n\t\t\tcol.width += share;\n\t\t\textra_width -= share;\n\n\t\t}\n\n\t\tvar iterator = extra_width > 0 ? 1 : -1;\n\t\twhile ((extra_width > 0 && iterator === 1) || (extra_width < 0 && iterator === -1)) {\n\t\t\tvar curExtra = extra_width;\n\t\t\tfor (i = start_index + 1; i < columns.length; i++) {\n\t\t\t\tvar new_width = columns[i].width + iterator;\n\n\t\t\t\tif (new_width == this._getColumnWidth(columns[i], config, new_width)) {\n\t\t\t\t\textra_width -= iterator;\n\t\t\t\t\tcolumns[i].width = new_width;\n\t\t\t\t}\n\n\t\t\t\tif (!extra_width)\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif (curExtra == extra_width)\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// if impossible to resize the right-side columns, resize the start column\n\t\tif (extra_width && start_index > -1) {\n\t\t\tvar new_width = columns[start_index].width + extra_width;\n\t\t\tif (new_width == this._getColumnWidth(columns[start_index], config, new_width))\n\t\t\t\tcolumns[start_index].width = new_width;\n\t\t}\n\n\t\t//if (this.callEvent(\"onGridResizeEnd\", [config.grid_width, final_width]) === false)\n\t\t//\treturn;\n\n\t\treturn this._getColsTotalWidth();\n\t},\n\n\t_getColsTotalWidth: function () {\n\t\tvar columns = this.getGridColumns();\n\t\tvar cols_width = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar v = parseFloat(columns[i].width);\n\t\t\tif (window.isNaN(v)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tcols_width += v;\n\t\t}\n\t\treturn cols_width;\n\t},\n\t_calculateGridWidth: function () {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = this.getGridColumns();\n\t\tvar cols_width = 0;\n\t\tvar unknown = [];\n\t\tvar width = [];\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar v = parseFloat(columns[i].width);\n\t\t\tif (window.isNaN(v)) {\n\t\t\t\tv = config.min_grid_column_width || 10;\n\t\t\t\tunknown.push(i);\n\t\t\t}\n\t\t\twidth[i] = v;\n\t\t\tcols_width += v;\n\t\t}\n\t\tvar gridWidth = this._getGridWidth() + 1;\n\t\tif (config.autofit || unknown.length) {\n\t\t\tvar diff = gridWidth - cols_width;\n\t\t\t// TODO: logic may be improved for proportional changing of width\n\n\t\t\t// autofit adjusts columns widths to the outer grid width\n\t\t\t// it doesn't makes sense if grid has inner scroll with elastic columns\n\t\t\tif (config.autofit && !config.grid_elastic_columns) {\n\t\t\t\t// delta must be added for all columns\n\t\t\t\tfor (var i = 0; i < width.length; i++) {\n\t\t\t\t\tvar delta = Math.round(diff / (width.length - i));\n\t\t\t\t\twidth[i] += delta;\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[i], config, width[i]);\n\n\t\t\t\t\tif (new_width != width[i]) {\n\t\t\t\t\t\tdelta = new_width - width[i];\n\t\t\t\t\t\twidth[i] = new_width;\n\t\t\t\t\t}\n\t\t\t\t\tdiff -= delta;\n\t\t\t\t}\n\t\t\t} else if (unknown.length) {\n\t\t\t\t// there are several columns with undefined width\n\t\t\t\tfor (var i = 0; i < unknown.length; i++) {\n\t\t\t\t\tvar delta = Math.round(diff / (unknown.length - i)); // no float values, just integer\n\t\t\t\t\tvar index = unknown[i];\n\t\t\t\t\twidth[index] += delta;\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[index], config, width[index]);\n\t\t\t\t\tif (new_width != width[index]) {\n\t\t\t\t\t\tdelta = new_width - width[index];\n\t\t\t\t\t\twidth[index] = new_width;\n\t\t\t\t\t}\n\t\t\t\t\tdiff -= delta;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < width.length; i++) {\n\t\t\t\tcolumns[i].width = width[i];\n\t\t\t}\n\t\t} else {\n\t\t\tvar changed = (gridWidth != cols_width);\n\t\t\tthis.$config.width = cols_width - 1;\n\t\t\tconfig.grid_width = cols_width;\n\t\t\tif (changed) {\n\t\t\t\tthis.$parent._setContentSize(this.$config.width, null);\n\t\t\t}\n\t\t}\n\n\t},\n\n\t_renderGridHeader: function () {\n\t\tvar gantt = this.$gantt;\n\t\tvar config = this.$getConfig();\n\t\tvar locale = this.$gantt.locale;\n\t\tvar templates = this.$gantt.templates;\n\n\t\tvar columns = this.getGridColumns();\n\t\tif (config.rtl) {\n\t\t\tcolumns = columns.reverse();\n\t\t}\n\t\tvar cells = [];\n\t\tvar width = 0,\n\t\t\tlabels = locale.labels;\n\n\t\tvar lineHeigth = config.scale_height - 1;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar last = i == columns.length - 1;\n\t\t\tvar col = columns[i];\n\n\t\t\t// ensure columns have non-empty names\n\t\t\tif (!col.name) {\n\t\t\t\tcol.name = gantt.uid() + \"\";\n\t\t\t}\n\n\t\t\tvar colWidth = col.width * 1;\n\n\t\t\tvar gridWidth = this._getGridWidth();\n\t\t\tif (last && gridWidth > width + colWidth)\n\t\t\t\tcol.width = colWidth = gridWidth - width;\n\t\t\twidth += colWidth;\n\t\t\tvar sort = (gantt._sort && col.name == gantt._sort.name) ? (`<div data-column-id=\"${col.name}\" class=\"gantt_sort gantt_${gantt._sort.direction}\"></div>`) : \"\";\n\t\t\tvar cssClass = [\"gantt_grid_head_cell\",\n\t\t\t\t(\"gantt_grid_head_\" + col.name),\n\t\t\t\t(last ? \"gantt_last_cell\" : \"\"),\n\t\t\t\ttemplates.grid_header_class(col.name, col)].join(\" \");\n\n\t\t\tvar style = \"width:\" + (colWidth - (last ? 1 : 0)) + \"px;\";\n\t\t\tvar label = (col.label || labels[\"column_\" + col.name] || labels[col.name]);\n\t\t\tlabel = label || \"\";\n\n\t\t\tvar ariaAttrs = gantt._waiAria.gridScaleCellAttrString(col, label);\n\n\t\t\tvar cell = \"<div class='\" + cssClass + \"' style='\" + style + \"' \" + ariaAttrs + \n\t\t\t\t\" data-column-id='\" + col.name + \"' column_id='\" + col.name + \"'\" +\n\t\t\t\t\" data-column-name='\" + col.name + \"' data-column-index='\" + i + \"'\" +\n\t\t\t\t\">\" + label + sort + \"</div>\";\n\t\t\tcells.push(cell);\n\t\t}\n\t\tthis.$grid_scale.style.height = (config.scale_height) + \"px\";\n\t\tthis.$grid_scale.style.lineHeight = lineHeigth + \"px\";\n\t\t//this.$grid_scale.style.width = \"inherit\";\n\t\tthis.$grid_scale.innerHTML = cells.join(\"\");\n\n\t\tif (this._renderHeaderResizers) {\n\t\t\tthis._renderHeaderResizers();\n\t\t}\n\t},\n\n\t_getGridWidth: function () {\n\t\t// TODO: refactor/remove/comment some of _getGridWidth/this.$config.width/this.$state.width, it's not clear what they do\n\t\treturn this.$config.width;\n\t},\n\n\tdestructor: function () {\n\t\tthis._clearLayers(this.$gantt);\n\t\tif (this._mouseDelegates) {\n\t\t\tthis._mouseDelegates.destructor();\n\t\t\tthis._mouseDelegates = null;\n\t\t}\n\t\tthis._unbindStore();\n\t\tthis.$grid = null;\n\t\tthis.$grid_scale = null;\n\t\tthis.$grid_data = null;\n\t\tthis.$gantt = null;\n\t\tif (this.$config.rowStore) {\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\n\t\t\tthis.$config.rowStore = null;\n\t\t}\n\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t}\n};\n\nexport default Grid;\n","function createResizer(gantt, grid){\n\treturn {\n\t\tinit: function(){},\n\t\tdoOnRender: function(){}\n\t};\n}\n\nexport default createResizer;","import * as domHelpers from \"../utils/dom_helpers\";\n\nfunction createRowResizer(gantt, grid){\n\n\tvar _task_grid_row_resize = {\n\t\trow_before_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar store = grid.$config.rowStore;\n\n\t\t\tvar el = domHelpers.locateAttribute(e, config.task_grid_row_resizer_attribute);\n\t\t\tif (!el) return false;\n\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute),\n\t\t\t\trow = store.getItem(row_id);\n\n\t\t\tif (grid.callEvent(\"onBeforeRowResize\", [row]) === false)\n\t\t\t\treturn false;\n\t\t}, gantt),\n\n\t\trow_after_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute);\n\t\t\tdnd.config.marker.innerHTML = \"\";\n\n\t\t\tdnd.config.marker.className += \" gantt_row_grid_resize_area\";\n\t\t\tdnd.config.marker.style.width = grid.$grid.offsetWidth + \"px\";\n\t\t\tdnd.config.drag_id = row_id;\n\n\t\t}, gantt),\n\n\t\trow_drag_move: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar store = grid.$config.rowStore;\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar dd = dnd.config;\n\t\t\tvar id = dd.drag_id,\n\t\t\t\titemHeight = grid.getItemHeight(id),\n\t\t\t\titemTop = grid.getItemTop(id) - obj.scrollTop;\n\t\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data),\n\t\t\t\tpointerPosition = parseInt(dd.marker.style.top, 10),\n\t\t\t\tmarkerStartPosition = itemTop + pos.y,\n\t\t\t\tmarker_height = 0,\n\t\t\t\tminPointerPosition = config.min_task_grid_row_height;\n\n\t\t\tmarker_height = pointerPosition - markerStartPosition;\n\t\t\tif(marker_height < minPointerPosition){\n\t\t\t\tmarker_height = minPointerPosition;\n\t\t\t}\n\n\t\t\tdd.marker.style.left = pos.x + \"px\";\n\t\t\tdd.marker.style.top = markerStartPosition - 1 + \"px\";\n\t\t\tdd.marker.style.height = Math.abs(marker_height) + 1 + \"px\";\n\n\t\t\tdd.marker_height = marker_height;\n\t\t\t\n\t\t\tgrid.callEvent(\"onRowResize\", [id, store.getItem(id), marker_height + itemHeight]);\n\t\t\treturn true;\n\t\t}, gantt),\n\n\t\trow_drag_end: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar store = grid.$config.rowStore;\n\t\t\tvar dd = dnd.config;\n\t\t\tvar id = dd.drag_id,\n\t\t\t\titem = store.getItem(id),\n\t\t\t\toldItemHeight = grid.getItemHeight(id);\n\n\t\t\tvar finalHeight = dd.marker_height;\n\n\t\t\tif (grid.callEvent(\"onBeforeRowResizeEnd\", [id, item, finalHeight]) === false)\n\t\t\t\treturn;\n\n\t\t\tif (item.row_height == finalHeight)\n\t\t\t\treturn;\n\n\t\t\titem.row_height = finalHeight;\n\t\t\tgantt.updateTask(id);\n\n\t\t\tgrid.callEvent(\"onAfterRowResize\", [id, item, oldItemHeight, finalHeight]);\n\n\t\t\tthis.render();\n\t\t}, gantt)\n\t};\n\n\t// calls the initialization of the D'n'D events for resize elements\n\tvar _init_resize = function () {\n\n\t\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\t\tvar config = grid.$getConfig();\n\n\t\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\t\tif (gantt.defined(config.dnd_sensitivity))\n\t\t\tdnd.config.sensitivity = config.dnd_sensitivity;\n\n\t\tdnd.attachEvent(\"onBeforeDragStart\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_before_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onAfterDragStart\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_after_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragMove\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_drag_move(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragEnd\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_drag_end(dnd, obj, e);\n\t\t});\n\n\t};\n\n\treturn {\n\t\tinit: _init_resize\n\t};\n}\n\nexport default createRowResizer;","export default {\n\tinit: function (controller, grid) {\n\t\tvar gantt = grid.$gantt;\n\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\n\t\t\tif (gantt._is_icon_open_click(e))\n\t\t\t\treturn true;\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t} else {\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\n\t\t\tif (controller.isVisible() && controller.isChanged()) {\n\t\t\t\tcontroller.save();\n\t\t\t} else {\n\t\t\t\tcontroller.hide();\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskDblClick\", function (id, e) {\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\t\t\tif (cell && controller.isVisible() && cell.columnName == state.columnName) {\n\t\t\t\t//GS-933 probably, we don't need to hide the inline editor because the lightbox cannot be opened if you double-click on an inline editor\n\t\t\t\t//remove this code later if people don't complain\n\t\t\t\t//controller.hide();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t},\n\n\tonShow: function (controller, placeholder, grid) {\n\t\tvar gantt = grid.$gantt;\n\t\t\n\n\t\tif(gantt.ext && gantt.ext.keyboardNavigation){\n\t\t\tvar keyNav = gantt.ext.keyboardNavigation;\n\t\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\n\t\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\t\tvar keyCode = e.keyCode;\n\t\t\t\tvar preventKeyNav = false;\n\n\t\t\t\tswitch (keyCode){\n\t\t\t\t\tcase keyboard.SPACE:\n\t\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (preventKeyNav){\n\t\t\t\t\treturn false;\n\t\t\t\t} else{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tplaceholder.onkeydown = function (e) {\n\t\t\te = e || window.event;\n\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\tif (e.defaultPrevented || (e.shiftKey && e.keyCode != keyboard.TAB)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar shouldPrevent = true;\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase gantt.keys.edit_save:\n\t\t\t\t\tcontroller.save();\n\t\t\t\t\tbreak;\n\t\t\t\tcase gantt.keys.edit_cancel:\n\t\t\t\t\tcontroller.hide();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.UP:\n\t\t\t\tcase keyboard.DOWN:\n\t\t\t\t\tif (controller.isVisible()) {\n\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\tshouldPrevent = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.TAB:\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\tcontroller.editPrevCell(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.editNextCell(true);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tshouldPrevent = false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (shouldPrevent) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t},\n\tonHide: function () {\n\n\t},\n\n\tdestroy: function () {\n\n\t}\n};\n\n","export default {\n\tinit: function(controller, grid){\n\t\tvar self = controller;\n\t\tvar gantt = grid.$gantt;\n\n\t\tvar onBlurDelay = null;\n\t\tvar keyNav = gantt.ext.keyboardNavigation;\n\t\tkeyNav.attachEvent(\"onBeforeFocus\", function (node) {\n\t\t\tvar activeCell = controller.locateCell(node);\n\t\t\tclearTimeout(onBlurDelay);\n\t\t\tif (activeCell) {\n\t\t\t\tvar columnName = activeCell.columnName;\n\t\t\t\tvar id = activeCell.id;\n\n\t\t\t\tvar editorState = self.getState();\n\t\t\t\tif(self.isVisible()){\n\t\t\t\t\tif(editorState.id == id && editorState.columnName === columnName) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onFocus\", function (node) {\n\t\t\tvar activeCell = controller.locateCell(node);\n\t\t\tvar state = controller.getState();\n\t\t\tclearTimeout(onBlurDelay);\n\t\t\tif (activeCell && !(activeCell.id == state.id && activeCell.columnName == state.columnName)) {\n\t\t\t\tif(self.isVisible()){\n\t\t\t\t\tself.save();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tcontroller.attachEvent(\"onHide\", function(){\n\t\t\tclearTimeout(onBlurDelay);\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onBlur\", function () {\n\t\t\tonBlurDelay = setTimeout(function(){\n\t\t\t\tself.save();\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskDblClick\", function(id,e){\n\t\t\t// block lightbox on double click inside editor\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\t\t\tif(cell && controller.isVisible() && cell.columnName == state.columnName){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\n\t\t\tif(gantt._is_icon_open_click(e))\n\t\t\t\treturn true;\n\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif(controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName){\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t}else{\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\n\t\t\tself.save();\n\t\t\treturn true;\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\n\t\t\tvar activeCell = controller.locateCell(e.target);\n\t\t\tvar hasEditor = activeCell ? controller.getEditorConfig(activeCell.columnName) : false;\n\n\t\t\tvar state = controller.getState();\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\tvar keyCode = e.keyCode;\n\t\t\tvar preventKeyNav = false;\n\n\t\t\tswitch (keyCode){\n\t\t\t\tcase keyboard.ENTER:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tcontroller.save();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}else if(hasEditor && !(e.ctrlKey || e.metaKey || e.shiftKey)){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.ESC:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.UP:\n\t\t\t\tcase keyboard.DOWN:\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.LEFT:\n\t\t\t\tcase keyboard.RIGHT:\n\t\t\t\t\tif((hasEditor && controller.isVisible()) || state.editorType === \"date\"){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.SPACE:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.DELETE:\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t} else if(hasEditor && controller.isVisible()){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.TAB:\n\t\t\t\t\tif(controller.isVisible()){\n\n\t\t\t\t\t\tif(e.shiftKey){\n\t\t\t\t\t\t\tcontroller.editPrevCell(true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcontroller.editNextCell(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar newState = controller.getState();\n\t\t\t\t\t\tif(newState.id){\n\t\t\t\t\t\t\tkeyNav.focus({type:\"taskCell\", id: newState.id, column:newState.columnName});\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif(controller.isVisible())\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\telse{\n\n\t\t\t\t\t\t// start editing on character key\n\t\t\t\t\t\tif((keyCode >= 48 && keyCode <= 57) || // [0-9]\n\t\t\t\t\t\t\t(keyCode > 95 && keyCode < 112) || // numpad\n\t\t\t\t\t\t\t(keyCode >= 64 && keyCode <= 91) || // [a-z]\n\t\t\t\t\t\t\t(keyCode > 185 && keyCode < 193) || //;=-,etc\n\t\t\t\t\t\t\t(keyCode > 218  && keyCode < 223)\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tvar modifiers = command.modifiers;\n\n\t\t\t\t\t\t\tvar anyModifier = modifiers.alt || modifiers.ctrl || modifiers.meta || modifiers.shift;\n\t\t\t\t\t\t\tif(modifiers.alt){\n\t\t\t\t\t\t\t\t// don't start editing on alt+key\n\t\t\t\t\t\t\t}else if (anyModifier && keyNav.getCommandHandler(command, \"taskCell\")){\n\t\t\t\t\t\t\t\t// don't start editing if command already have a keyboard shortcut\n\t\t\t\t\t\t\t}else if(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (preventKeyNav){\n\t\t\t\treturn false;\n\t\t\t} else{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t});\n\t},\n\tonShow: function(controller, placeholder, grid){},\n\tonHide: function(controller, placeholder, grid){\n\t\tconst gantt = grid.$gantt;\n\t\tif (gantt){\n\t\t\tgantt.focus();\n\t\t}\n\n\t},\n\tdestroy: function(){}\n};\n\n","export default function (gantt) {\n\n\tvar BaseEditor = function () {\n\t};\n\n\tBaseEditor.prototype = {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t},\n\t\thide: function () {\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = value;\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn this.get_input(node).value || \"\";\n\t\t},\n\t\tis_changed: function (value, id, column, node) {\n\t\t\tvar currentValue = this.get_value(id, column, node);\n\t\t\tif (currentValue && value && currentValue.valueOf && value.valueOf) {\n\t\t\t\treturn currentValue.valueOf() != value.valueOf();\n\t\t\t} else {\n\t\t\t\treturn currentValue != value;\n\t\t\t}\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\treturn true;\n\t\t},\n\n\t\tsave: function (id, column, node) {\n\n\t\t},\n\t\tget_input: function (node) {\n\t\t\treturn node.querySelector(\"input\");\n\t\t},\n\t\tfocus: function (node) {\n\t\t\tvar input = this.get_input(node);\n\t\t\tif (!input) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (input.focus) {\n\t\t\t\tinput.focus();\n\t\t\t}\n\n\t\t\tif (input.select) {\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t};\n\treturn BaseEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction TextEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(TextEditor, BaseEditor);\n\n\tutils.mixin(TextEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t}\n\t}, true);\n\n\treturn TextEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction NumberEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(NumberEditor, BaseEditor);\n\n\tutils.mixin(NumberEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar min = config.min || 0,\n\t\t\t\tmax = config.max || 100;\n\n\t\t\tvar html = `<div role='cell'><input type='number' min='${min}' max='${max}' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\n\t\t\tplaceholder.oninput = function (e) {\n\t\t\t\tif (+e.target.value < min) {\n\t\t\t\t\te.target.value = min;\n\t\t\t\t}\n\t\t\t\tif (+e.target.value > max) {\n\t\t\t\t\te.target.value = max;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn this.get_input(node).value || \"\";\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\treturn !isNaN(parseInt(value, 10));\n\t\t}\n\t}, true);\n\n\treturn NumberEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction SelectEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(SelectEditor, BaseEditor);\n\n\tutils.mixin(SelectEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><select name='${column.name}' title='${column.name}'>`;\n\t\t\tvar optionsHtml = [],\n\t\t\t\toptions = config.options || [];\n\n\t\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\t\toptionsHtml.push(\"<option value='\" + config.options[i].key + \"'>\" + options[i].label + \"</option>\");\n\t\t\t}\n\n\t\t\thtml += optionsHtml.join(\"\") + \"</select></div>\";\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\tget_input: function (node) {\n\t\t\treturn node.querySelector(\"select\");\n\t\t}\n\t}, true);\n\n\treturn SelectEditor;\n};","import * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\nimport BaseFactory from \"./base\";\n\nexport default function (gantt) {\n\tvar BaseEditor = BaseFactory(gantt);\n\t\n\t\n\n\tvar html5DateFormat = \"%Y-%m-%d\";\n\n\tvar dateToStr = null;\n\tvar strToDate = null;\n\n\tfunction init() {\n\t\tif (!dateToStr) {\n\t\t\tdateToStr = gantt.date.date_to_str(html5DateFormat);\n\t\t}\n\t\tif (!strToDate) {\n\t\t\tstrToDate = gantt.date.str_to_date(html5DateFormat);\n\t\t}\n\t}\n\n\tfunction DateEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(DateEditor, BaseEditor);\n\n\tutils.mixin(DateEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tinit();\n\t\t\tvar minValue = null;\n\t\t\tvar maxValue = null;\n\n\t\t\tif(typeof config.min === \"function\"){\n\t\t\t\tminValue = config.min(id, column);\n\t\t\t}else{\n\t\t\t\tminValue = config.min;\n\t\t\t}\n\n\t\t\tif(typeof config.max === \"function\"){\n\t\t\t\tmaxValue = config.max(id, column);\n\t\t\t}else{\n\t\t\t\tmaxValue = config.max;\n\t\t\t}\n\n\t\t\tvar minAttr = minValue ? \" min='\" + dateToStr(minValue)+\"' \"  : \"\";\n\t\t\tvar maxAttr = maxValue ? \" max='\" + dateToStr(maxValue)+\"' \"  : \"\";\n\t\t\tvar html = `<div style='width:140px' role='cell'><input type='date' ${minAttr} ${maxAttr} name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\n\t\t\tplaceholder.oninput = function (e) {\n\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) < +minValue) {\n\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(minValue);\n\t\t\t\t}\n\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) > +maxValue) {\n\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(maxValue);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tif (value && value.getFullYear) {\n\t\t\t\tthis.get_input(node).value = dateToStr(value);\n\t\t\t} else {\n\t\t\t\tthis.get_input(node).value = value;\n\t\t\t}\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\tif (!value || isNaN(value.getTime()))\n\t\t\t\treturn false;\n\t\t\treturn true;\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\tvar parsed;\n\t\t\ttry {\n\t\t\t\tparsed = strToDate(this.get_input(node).value || \"\");\n\t\t\t} catch (e) {\n\t\t\t\tparsed = null;// return null will cancel changes\n\t\t\t}\n\n\t\t\treturn parsed;\n\t\t}\n\t}, true);\n\n\treturn DateEditor;\n};\n","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction PredecessorEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(PredecessorEditor, BaseEditor);\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || gantt.ext.formatters.linkFormatter();\n\t}\n\n\tfunction parseInputString(value, config) {\n\t\tvar predecessors = (value || \"\").split(config.delimiter || \",\");\n\t\tfor (var i = 0; i < predecessors.length; i++) {\n\t\t\tvar val = predecessors[i].trim();\n\t\t\tif (val) {\n\t\t\t\tpredecessors[i] = val;\n\t\t\t} else {\n\t\t\t\tpredecessors.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\tpredecessors.sort();\n\t\treturn predecessors;\n\t}\n\n\tfunction formatPredecessors(task, config, gantt) {\n\t\tvar links = task.$target;\n\t\tvar labels = [];\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tvar link = gantt.getLink(links[i]);\n\t\t\tlabels.push(getFormatter(config).format(link));\n\t\t}\n\t\treturn labels.join((config.delimiter || \",\") + \" \");\n\t}\n\n\tfunction getSelectedLinks(taskId, predecessorCodes, config) {\n\t\tvar links = [];\n\t\t// select only unique codes GS-1439\n\t\t[...new Set(predecessorCodes)].forEach(function (code) {\n\t\t\tvar link = getFormatter(config).parse(code);\n\t\t\tif(link){\n\t\t\t\tlink.target = taskId;\n\t\t\t\t// GS-1290 A way to preserve the link. Otherwise validation will return false\n\t\t\t\t// because the existing link ID is not passed there\n\t\t\t\tlink.id = \"predecessor_generated\";\n\t\t\t\tif (gantt.isLinkAllowed(link)) {\n\t\t\t\t\tlink.id = undefined;\n\t\t\t\t\tlinks.push(link);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn links;\n\t}\n\n\tfunction formatLinkKey(link){\n\t\treturn link.source + \"_\" + link.target + \"_\" + link.type + \"_\" + (link.lag||0);\n\t}\n\n\tfunction getLinksDiff(task, predecessorCodes, config) {\n\t\tvar selectedLinks = getSelectedLinks(task.id, predecessorCodes, config);\n\t\tvar existingLinksSearch = {};\n\t\ttask.$target.forEach(function (linkId) {\n\t\t\tvar link = gantt.getLink(linkId);\n\t\t\texistingLinksSearch[formatLinkKey(link)] = link.id;\n\t\t});\n\n\t\tvar linksToAdd = [];\n\t\tselectedLinks.forEach(function (link) {\n\t\t\tvar linkKey = formatLinkKey(link);\n\t\t\tif (!existingLinksSearch[linkKey]) {\n\t\t\t\tlinksToAdd.push(link);\n\t\t\t} else {\n\t\t\t\tdelete existingLinksSearch[linkKey];\n\t\t\t}\n\t\t});\n\n\t\tvar linksToDelete = [];\n\t\tfor (var i in existingLinksSearch) {\n\t\t\tlinksToDelete.push(existingLinksSearch[i]);\n\t\t}\n\n\t\treturn {\n\t\t\tadd: linksToAdd,\n\t\t\tremove: linksToDelete\n\t\t};\n\t}\n\n\tutils.mixin(PredecessorEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\thide: function () {\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = formatPredecessors(value, column.editor, gantt);\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn parseInputString((this.get_input(node).value || \"\"), column.editor);\n\t\t},\n\t\tsave: function (id, column, node) {\n\t\t\tvar task = gantt.getTask(id);\n\n\t\t\tvar linksDiff = getLinksDiff(task, this.get_value(id, column, node), column.editor);\n\n\t\t\tif (linksDiff.add.length || linksDiff.remove.length) {\n\t\t\t\tgantt.batchUpdate(function () {\n\t\t\t\t\tlinksDiff.add.forEach(function (link) {\n\t\t\t\t\t\tgantt.addLink(link);\n\t\t\t\t\t});\n\t\t\t\t\tlinksDiff.remove.forEach(function (linkId) {\n\t\t\t\t\t\tgantt.deleteLink(linkId);\n\t\t\t\t\t});\n\n\t\t\t\t\tif (gantt.autoSchedule)\n\t\t\t\t\t\tgantt.autoSchedule();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tis_changed: function (value, id, column, node) {\n\t\t\tvar inputPredecessors = this.get_value(id, column, node);\n\t\t\tvar taskPredecessors = parseInputString(formatPredecessors(value, column.editor, gantt), column.editor);\n\n\t\t\treturn inputPredecessors.join() !== taskPredecessors.join();\n\t\t}\n\t}, true);\n\n\treturn PredecessorEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction TextEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(TextEditor, BaseEditor);\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || gantt.ext.formatters.durationFormatter();\n\t}\n\tutils.mixin(TextEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = getFormatter(column.editor).format(value);\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn getFormatter(column.editor).parse(this.get_input(node).value || \"\");\n\t\t}\n\t}, true);\n\n\treturn TextEditor;\n};","export default function (gantt) {\n\treturn function processTaskDateProperties(item, mapTo, mode) {\n\t\tif (mode == \"keepDates\") {\n\t\t\tkeepDatesOnEdit(item, mapTo);\n\t\t} else if (mode == \"keepDuration\") {\n\t\t\tkeepDurationOnEdit(item, mapTo);\n\t\t} else {\n\t\t\tdefaultActionOnEdit(item, mapTo);\n\t\t}\n\t};\n\n\t// resize task\n\t// resize task when start/end/duration changes\n\tfunction keepDatesOnEdit(item, mapTo) {\n\t\tif (mapTo == \"duration\") {\n\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t} else if (mapTo == \"end_date\" || mapTo == \"start_date\") {\n\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t}\n\t}\n\n\t// move task(before 6.2)\n\t// move task when start/end dates changes\n\t// resize task when duration changes\n\tfunction keepDurationOnEdit(item, mapTo) {\n\t\tif (mapTo == \"end_date\") {\n\t\t\titem.start_date = decreaseStartDate(item);\n\t\t} else if (mapTo == \"start_date\" || mapTo == \"duration\") {\n\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t}\n\t}\n\n\t// default behavior\n\t// move task when start date changes\n\t// resize task when end date/duration changes\n\tfunction defaultActionOnEdit(item, mapTo) {\n\t\tif (gantt.config.schedule_from_end){\n\t\t\tif (mapTo == \"end_date\" || mapTo == \"duration\") {\n\t\t\t\titem.start_date = decreaseStartDate(item);\n\t\t\t} else if (mapTo == \"start_date\") {\n\t\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t\t}\n\t\t} else {\n\t\t\tif (mapTo == \"start_date\" || mapTo == \"duration\") {\n\t\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t\t} else if (mapTo == \"end_date\") {\n\t\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction decreaseStartDate(item){\n\t\treturn gantt.calculateEndDate({\n\t\t\tstart_date: item.end_date,\n\t\t\tduration: -item.duration,\n\t\t\ttask: item\n\t\t});\n\t}\n};","import getKeyboardMapping from \"./keyboard_mappings\";\nimport textEditorFactory from \"./editors/text\";\nimport numberEditorFactory from \"./editors/number\";\nimport selectEditorFactory from \"./editors/select\";\nimport dateEditorFactory from \"./editors/date\";\nimport predecessorEditorFactory from \"./editors/predecessor\";\nimport durationEditorFactory from \"./editors/duration\";\nimport * as utils from \"../../../../utils/utils\";\nimport * as domHelpers from \"../../utils/dom_helpers\";\nimport eventable from \"../../../../utils/eventable\";\nimport linkedPropertiesProcessor from \"./linked_properties\";\n\nfunction initConfigs(gantt){\n\tgantt.config.editor_types = {\n\t\ttext: new (textEditorFactory(gantt))(),\n\t\tnumber: new (numberEditorFactory(gantt))(),\n\t\tselect: new (selectEditorFactory(gantt))(),\n\t\tdate: new (dateEditorFactory(gantt))(),\n\t\tpredecessor: new (predecessorEditorFactory(gantt))(),\n\t\tduration: new (durationEditorFactory(gantt))()\n\t};\n}\n\nfunction create(gantt){\n\tvar keyboardMapping = getKeyboardMapping(gantt);\n\n\tvar eventBus = {};\n\teventable(eventBus);\n\n\tfunction createGridEditors(grid) {\n\n\t\tfunction _getGridCellFromNode(node){\n\t\t\tif(!domHelpers.isChildOf(node, grid.$grid)){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar row = domHelpers.locateAttribute(node, grid.$config.item_attribute);\n\t\t\tvar cell = domHelpers.locateAttribute(node, \"data-column-name\");\n\t\t\tif(row && cell){\n\t\t\t\tvar columnName = cell.getAttribute(\"data-column-name\");\n\t\t\t\tvar id = row.getAttribute(grid.$config.item_attribute);\n\t\t\t\treturn {\n\t\t\t\t\tid: id,\n\t\t\t\t\tcolumnName: columnName\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfunction _getEditorPosition(itemId, columnName) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar top = grid.getItemTop(itemId);\n\t\t\tvar height = grid.getItemHeight(itemId);\n\t\t\tvar cols = grid.getGridColumns();\n\t\t\tvar left = 0,\n\t\t\t\tright = 0,\n\t\t\t\twidth = 0;\n\n\t\t\tfor (var i = 0; i < cols.length; i++) {\n\t\t\t\tif (cols[i].name == columnName) {\n\t\t\t\t\twidth = cols[i].width;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (config.rtl) {\n\t\t\t\t\tright += cols[i].width;\n\t\t\t\t}\telse {\n\t\t\t\t\tleft += cols[i].width;\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (config.rtl) {\n\t\t\t\treturn {\n\t\t\t\t\ttop: top,\n\t\t\t\t\tright: right,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\ttop: top,\n\t\t\t\t\tleft: left,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width\n\t\t\t\t};\n\t\t\t}\n\n\t\t}\n\n\t\tfunction findVisibleIndex(grid, columnName) {\n\t\t\tvar columns = grid.getGridColumns();\n\t\t\tfor (var i = 0; i < columns.length; i++){\n\t\t\t\tif(columns[i].name == columnName){\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\n\t\tfunction _createPlaceholder(itemId, columnName) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar pos = _getEditorPosition(itemId, columnName);\n\t\t\tvar el = document.createElement(\"div\");\n\t\t\tel.className = \"gantt_grid_editor_placeholder\";\n\t\t\tel.setAttribute(grid.$config.item_attribute, itemId);\n\t\t\tel.setAttribute(grid.$config.bind + \"_id\", itemId);// for backward compatibility\n\n\t\t\tel.setAttribute(\"data-column-name\", columnName);\n\n\t\t\tvar visibleIndex = findVisibleIndex(grid, columnName);\n\t\t\tel.setAttribute(\"data-column-index\", visibleIndex);\n\n\t\t\tgantt._waiAria.inlineEditorAttr(el);\n\n\t\t\tif (config.rtl) {\n\t\t\t\tel.style.cssText = [\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\t\t\"right:\" + pos.right + \"px\",\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\n\t\t\t\t].join(\";\");\n\t\t\t} else {\n\t\t\t\tel.style.cssText = [\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\n\t\t\t\t].join(\";\");\n\t\t\t}\n\n\t\t\treturn el;\n\t\t}\n\n\t\tvar updateTaskDateProperties = linkedPropertiesProcessor(gantt);\n\n\t\tvar handlers = [];\n\t\tvar ganttHandlers = [];\n\t\tvar store = null;\n\t\tvar controller = {\n\t\t\t_itemId: null,\n\t\t\t_columnName: null,\n\t\t\t_editor: null,\n\t\t\t_editorType: null,\n\t\t\t_placeholder: null,\n\n\t\t\tlocateCell: _getGridCellFromNode,\n\t\t\tgetEditorConfig: function (columnName) {\n\t\t\t\tvar column = grid.getColumn(columnName);\n\t\t\t\treturn column.editor;\n\t\t\t},\n\n\t\t\tinit: function () {\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.init){\n\t\t\t\t\tmapping.init(this, grid);\n\t\t\t\t}\n\n\t\t\t\tstore = grid.$gantt.getDatastore(grid.$config.bind);\n\n\t\t\t\tvar self = this;\n\n\t\t\t\thandlers.push(store.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\t\t\t\tif(self._itemId == oldId){\n\t\t\t\t\t\tself._itemId = newId;\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\thandlers.push(store.attachEvent(\"onStoreUpdated\", function(){\n\t\t\t\t\tif(grid.$gantt.getState(\"batchUpdate\").batch_update){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(self.isVisible() && !store.isVisible(self._itemId)){\n\t\t\t\t\t\tself.hide();\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tganttHandlers.push(gantt.attachEvent(\"onDataRender\", function(){\n\t\t\t\t\tif(self._editor && self._placeholder && !domHelpers.isChildOf(self._placeholder, gantt.$root)){\n\t\t\t\t\t\tgrid.$grid_data.appendChild(self._placeholder);\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis.init = function(){};\n\t\t\t},\n\n\t\t\tgetState: function(){\n\t\t\t\treturn {\n\t\t\t\t\teditor: this._editor,\n\t\t\t\t\teditorType: this._editorType,\n\t\t\t\t\tplaceholder: this._placeholder,\n\t\t\t\t\tid: this._itemId,\n\t\t\t\t\tcolumnName: this._columnName\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tstartEdit: function(itemId, columnName) {\n\t\t\t\tif (this.isVisible()) {\n\t\t\t\t\tthis.save();\n\t\t\t\t}\n\n\t\t\t\tif(!store.exists(itemId)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\n\t\t\t\tif (gantt.isReadonly(store.getItem(itemId))) {\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.callEvent(\"onBeforeEditStart\", [editorState]) === false) {\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.show(editorState.id, editorState.columnName);\n\t\t\t\tthis.setValue();\n\n\t\t\t\tthis.callEvent(\"onEditStart\", [editorState]);\n\t\t\t},\n\t\t\tisVisible: function(){\n\t\t\t\treturn !!(this._editor && domHelpers.isChildOf(this._placeholder, gantt.$root));\n\t\t\t},\n\t\t\tshow: function (itemId, columnName) {\n\t\t\t\tif (this.isVisible()) {\n\t\t\t\t\tthis.save();\n\t\t\t\t}\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\n\n\t\t\t\tvar column = grid.getColumn(editorState.columnName);\n\t\t\t\tvar editorConfig = this.getEditorConfig(column.name);\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar editor = grid.$getConfig().editor_types[editorConfig.type];\n\n\t\t\t\tvar placeholder = _createPlaceholder(editorState.id, editorState.columnName);\n\t\t\t\tgrid.$grid_data.appendChild(placeholder);\n\t\t\t\teditor.show(editorState.id, column, editorConfig, placeholder);\n\t\t\t\tthis._editor = editor;\n\t\t\t\tthis._placeholder = placeholder;\n\t\t\t\tthis._itemId = editorState.id;\n\t\t\t\tthis._columnName = editorState.columnName;\n\t\t\t\tthis._editorType = editorConfig.type;\n\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.onShow){\n\t\t\t\t\tmapping.onShow(this, placeholder, grid);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetValue: function () {\n\t\t\t\tvar state = this.getState();\n\t\t\t\tvar itemId = state.id,\n\t\t\t\t\tcolumnName = state.columnName;\n\n\t\t\t\tvar column = grid.getColumn(columnName);\n\t\t\t\tvar item = store.getItem(itemId);\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\n\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar value = item[editorConfig.map_to];\n\t\t\t\tif(editorConfig.map_to == \"auto\"){\n\t\t\t\t\tvalue = store.getItem(itemId);\n\t\t\t\t}\n\n\t\t\t\tthis._editor.set_value(value, itemId, column, this._placeholder);\n\t\t\t\tthis.focus();\n\t\t\t},\n\n\t\t\tfocus: function(){\n\t\t\t\tthis._editor.focus(this._placeholder);\n\t\t\t},\n\n\t\t\tgetValue: function () {\n\t\t\t\tvar column = grid.getColumn(this._columnName);\n\t\t\t\treturn this._editor.get_value(this._itemId, column, this._placeholder);\n\t\t\t},\n\n\t\t\t_getItemValue: function() {\n\t\t\t\tvar editorConfig = this.getEditorConfig(this._columnName);\n\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar item = gantt.getTask(this._itemId);\n\t\t\t\tvar value = item[editorConfig.map_to];\n\t\t\t\tif(editorConfig.map_to == \"auto\"){\n\t\t\t\t\tvalue = store.getItem(this._itemId);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\n\t\t\tisChanged: function(){\n\n\t\t\t\tvar column = grid.getColumn(this._columnName);\n\n\t\t\t\tvar value = this._getItemValue();\n\n\t\t\t\treturn this._editor.is_changed(value, this._itemId, column, this._placeholder);\n\t\t\t},\n\n\t\t\thide: function () {\n\t\t\t\tif(!this._itemId)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar itemId = this._itemId,\n\t\t\t\t\tcolumnName = this._columnName;\n\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.onHide){\n\t\t\t\t\tmapping.onHide(this, this._placeholder, grid);\n\t\t\t\t}\n\n\t\t\t\tthis._itemId = null;\n\t\t\t\tthis._columnName = null;\n\t\t\t\tthis._editorType = null;\n\t\t\t\tif (!this._placeholder) return;\n\n\t\t\t\tif (this._editor && this._editor.hide) {\n\t\t\t\t\tthis._editor.hide(this._placeholder);\n\t\t\t\t}\n\t\t\t\tthis._editor = null;\n\t\t\t\tif (this._placeholder.parentNode) {\n\t\t\t\t\tthis._placeholder.parentNode.removeChild(this._placeholder);\n\t\t\t\t}\n\t\t\t\tthis._placeholder = null;\n\n\t\t\t\tthis.callEvent(\"onEditEnd\", [{id: itemId, columnName: columnName}]);\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tif(!(this.isVisible() && store.exists(this._itemId) && this.isChanged())) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar itemId = this._itemId,\n\t\t\t\t\tcolumnName = this._columnName;\n\n\t\t\t\tif(!store.exists(itemId)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar item = store.getItem(itemId);\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\n\t\t\t\tvar editorState = {\n\t\t\t\t\tid: itemId,\n\t\t\t\t\tcolumnName: columnName,\n\t\t\t\t\tnewValue: this.getValue(),\n\t\t\t\t\toldValue: this._getItemValue()\n\t\t\t\t};\n\t\t\t\tif (this.callEvent(\"onBeforeSave\", [editorState]) !== false) {\n\t\t\t\t\tif (!this._editor.is_valid || this._editor.is_valid(editorState.newValue, editorState.id, grid.getColumn(columnName), this._placeholder)) {\n\n\t\t\t\t\t\tvar mapTo = editorConfig.map_to;\n\t\t\t\t\t\tvar value = editorState.newValue;\n\t\t\t\t\t\tif (mapTo != \"auto\") {\n\t\t\t\t\t\t\titem[mapTo] = value;\n\t\t\t\t\t\t\tupdateTaskDateProperties(item, mapTo, gantt.config.inline_editors_date_processing);\n\n\t\t\t\t\t\t\tstore.updateItem(itemId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._editor.save(itemId, grid.getColumn(columnName), this._placeholder);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.callEvent(\"onSave\", [editorState]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.hide();\n\t\t\t},\n\n\t\t\t_findEditableCell: function findEditableCell(start, direction){\n\t\t\t\tvar nextIndex = start;\n\t\t\t\tvar columns = grid.getGridColumns();\n\t\t\t\tvar nextColumn = columns[nextIndex];\n\n\t\t\t\tvar columnName = nextColumn ? nextColumn.name : null;\n\t\t\t\tif(columnName){\n\t\t\t\t\twhile(columnName && !this.getEditorConfig(columnName)){\n\t\t\t\t\t\tcolumnName = this._findEditableCell(start + direction, direction);\n\t\t\t\t\t}\n\t\t\t\t\treturn columnName;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tgetNextCell: function moveCell(dir){\n\t\t\t\t// GS-1257. true means to exclude hidden columns\n\t\t\t\treturn this._findEditableCell(grid.getColumnIndex(this._columnName, true) + dir, dir);\n\t\t\t},\n\n\t\t\tgetFirstCell: function getFirstCell(){\n\t\t\t\treturn this._findEditableCell(0, 1);\n\t\t\t},\n\n\t\t\tgetLastCell: function getLastCell(){\n\t\t\t\treturn this._findEditableCell(grid.getGridColumns().length - 1, -1);\n\t\t\t},\n\n\t\t\teditNextCell: function nextCell(canChangeRow){\n\t\t\t\tvar cell = this.getNextCell(1);\n\t\t\t\tif(cell){\n\t\t\t\t\tvar nextColumn = this.getNextCell(1);\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\n\t\t\t\t\t}\n\t\t\t\t}else if(canChangeRow && this.moveRow(1)){\n\t\t\t\t\tvar task = this.moveRow(1);\n\t\t\t\t\tcell = this.getFirstCell();\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\n\t\t\t\t\t\tthis.startEdit(task, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\teditPrevCell: function prevCell(canChangeRow){\n\t\t\t\tvar cell = this.getNextCell(-1);\n\t\t\t\tif(cell){\n\t\t\t\t\tvar nextColumn = this.getNextCell(-1);\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\n\t\t\t\t\t}\n\t\t\t\t}else if(canChangeRow && this.moveRow(-1)){\n\t\t\t\t\tvar task = this.moveRow(-1);\n\t\t\t\t\tcell = this.getLastCell();\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\n\t\t\t\t\t\tthis.startEdit(task, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tmoveRow: function moveRow(dir) {\n\t\t\t\tvar moveTask = dir > 0 ? gantt.getNext : gantt.getPrev;\n\t\t\t\tmoveTask = gantt.bind(moveTask, gantt);\n\n\t\t\t\tvar nextItem = moveTask(this._itemId);\n\t\t\t\t// skip readonly rows\n\t\t\t\twhile (gantt.isTaskExists(nextItem) && gantt.isReadonly(gantt.getTask(nextItem))) {\n\t\t\t\t\tnextItem = moveTask(nextItem);\n\t\t\t\t}\n\t\t\t\treturn nextItem;\n\t\t\t},\n\n\t\t\teditNextRow: function nextRow(skipReadonly){\n\t\t\t\tvar id = this.getState().id;\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\n\n\t\t\t\tvar next = null;\n\t\t\t\tif (skipReadonly){\n\t\t\t\t\tnext = this.moveRow(1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnext = gantt.getNext(id);\n\t\t\t\t}\n\n\t\t\t\tif (gantt.isTaskExists(next)){\n\t\t\t\t\tthis.startEdit(next, this._columnName);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\teditPrevRow: function prevRow(skipReadonly){\n\t\t\t\tvar id = this.getState().id;\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\n\n\t\t\t\tvar prev = null;\n\t\t\t\tif (skipReadonly){\n\t\t\t\t\tprev = this.moveRow(-1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tprev = gantt.getPrev(id);\n\t\t\t\t}\n\n\t\t\t\tif (gantt.isTaskExists(prev)){\n\t\t\t\t\tthis.startEdit(prev, this._columnName);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdetachStore: function(){\n\t\t\t\thandlers.forEach(function(handlerId){\n\t\t\t\t\tstore.detachEvent(handlerId);\n\t\t\t\t});\n\n\t\t\t\tganttHandlers.forEach(function(handlerId){\n\t\t\t\t\tgantt.detachEvent(handlerId);\n\t\t\t\t});\n\t\t\t\thandlers = [];\n\t\t\t\tganttHandlers = [];\n\n\t\t\t\tstore = null;\n\t\t\t\tthis.hide();\n\t\t\t},\n\t\t\tdestructor: function(){\n\t\t\t\tthis.detachStore();\n\t\t\t\tthis.detachAllEvents();\n\t\t\t}\n\t\t};\n\n\t\tutils.mixin(controller, keyboardMapping);\n\t\tutils.mixin(controller, eventBus);\n\n\t\treturn controller;\n\t}\n\n\n\tvar inlineEditController = {\n\t\tinit: initConfigs,\n\t\tcreateEditors: createGridEditors\n\t};\n\n\tutils.mixin(inlineEditController, keyboardMapping);\n\tutils.mixin(inlineEditController, eventBus);\n\n\treturn inlineEditController;\n}\n\n\n\n\nexport default create;","import defaultMapping from \"./keyboard_mappings/default\";\nimport keyNavMappings from \"./keyboard_mappings/keyboard_navigation\";\n\nexport default function(gantt){\n\n\tvar mapping = null;\n\n\treturn {\n\t\tsetMapping: function(map){\n\t\t\tmapping = map;\n\t\t},\n\t\tgetMapping: function(){\n\n\t\t\tif(mapping){\n\t\t\t\treturn mapping;\n\t\t\t}else if(gantt.config.keyboard_navigation_cells && gantt.ext.keyboardNavigation){\n\t\t\t\treturn keyNavMappings;\n\t\t\t}else{\n\t\t\t\treturn defaultMapping;\n\t\t\t}\n\t\t}\n\t};\n};\n","// optimized checker for task bars smart rendering\n\n// first check the vertical position since it's easier to calculate\nexport default function isBarInViewport(item, viewport, view, config, gantt){\n\tif(!item.start_date || !item.end_date){\n\t\treturn null;\n\t}\n\n\tvar top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\tvar padding = 200;\n\tvar startCoord = view.posFromDate(item.start_date);\n\tvar endCoord = view.posFromDate(item.end_date);\n\tvar left = Math.min(startCoord, endCoord) - padding;\n\tvar right = Math.max(startCoord, endCoord) + padding;\n\n\tif(left > viewport.x_end || right < viewport.x){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","function createTaskRenderer(gantt) {\n\n\tfunction _render_task_element(task, view, config) {\n\t\tvar config = view.$getConfig();\n\t\tvar painters = config.type_renderers;\n\t\tvar renderer = painters[gantt.getTaskType(task.type)],\n\t\t\tdefaultRenderer = _task_default_render;\n\n\t\tif (!renderer) {\n\t\t\treturn defaultRenderer.call(gantt, task, view, config);\n\t\t}else{\n\t\t\treturn renderer.call(gantt, task, function(task){ return defaultRenderer.call(gantt, task, view, config);}, view);\n\t\t}\n\t}\n\n\tfunction _task_default_render(task, view, config) {\n\t\tif (gantt._isAllowedUnscheduledTask(task))\n\t\t\treturn;\n\n\t\tif (!gantt._isTaskInTimelineLimits(task)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pos = view.getItemPosition(task);\n\n\t\tvar cfg = config,\n\t\t\ttemplates = view.$getTemplates();\n\n\t\tvar taskType = gantt.getTaskType(task.type);\n\t\tvar height = view.getBarHeight(task.id, taskType == cfg.types.milestone);\n\n\t\tvar controlsMargin = 0;\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tcontrolsMargin = (height - pos.height)/2;\n\t\t}\n\n\t\tvar padd = Math.floor((view.getItemHeight(task.id) - height) / 2);\n\t\tconst hasBaselines = gantt.config.baselines !== false && task.baselines && task.baselines.length;\n\t\tconst baselinesOnDifferentRow = gantt.config.baselines !== false && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\t\tif (hasBaselines && baselinesOnDifferentRow){\n\t\t\tif (task.bar_height !== \"full\" && task.bar_height < task.row_height){\n\t\t\t\tif (taskType === cfg.types.milestone){\n\t\t\t\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\t\t\t\tlet milestoneWidth = Math.sqrt(2 * milestoneHeight * milestoneHeight);\n\t\t\t\t\tpadd = Math.floor((milestoneWidth - height) / 2) + 2;\n\t\t\t\t} else {\n\t\t\t\t\tpadd = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t//\tif(task.type == cfg.types.milestone){\n\t//\t\tpadd -= 1;\n\t//\t}\n\t//\tif (taskType == cfg.types.milestone && cfg.link_line_width > 1) {\n\t//\t\t//little adjust milestone position, so horisontal corners would match link arrow when thickness of link line is more than 1px\n\t//\t\tpadd += 1;\n\t//\t}\n\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tpos.left -= Math.round(height / 2);\n\t\t\tpos.width = height;\n\t\t}\n\n\t\tvar div = document.createElement(\"div\");\n\n\t\tvar width = Math.round(pos.width);\n\n\t\tif(view.$config.item_attribute) {\n\t\t\tdiv.setAttribute(view.$config.item_attribute, task.id);\n\t\t\tdiv.setAttribute(view.$config.bind + \"_id\", task.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\tif (cfg.show_progress && taskType != cfg.types.milestone) {\n\t\t\t_render_task_progress(task, div, width, cfg, templates);\n\t\t}\n\n\t\t//use separate div to display content above progress bar\n\t\tvar content = _render_task_content(task, width, templates);\n\n\t\tdiv.appendChild(content);\n\n\t\tvar css = _combine_item_class(\"gantt_task_line\",\n\t\t\ttemplates.task_class(task.start_date, task.end_date, task),\n\t\t\ttask.id,\n\t\t\tview);\n\t\tif (task.color || task.progressColor || task.textColor) {\n\t\t\tcss += \" gantt_task_inline_color\";\n\t\t}\n\t\tif (pos.width < 20){\n\t\t\tcss += \" gantt_thin_task\";\n\t\t}\n\t\tdiv.className = css;\n\n\t\tvar styles = [\n\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\"top:\" + (padd + pos.top) + 'px',\n\t\t\t\"height:\" + (height) + 'px',\n\t\t\t\"line-height:\" + (Math.max(height < 30 ? height - 2 : height, 0)) + 'px',\n\t\t\t\"width:\" + width + 'px'\n\t\t];\n\n\t\tdiv.style.cssText = styles.join(\";\");\n\t\tif (task.color) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-background\", task.color);\n\t\t}\n\t\tif (task.textColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-color\", task.textColor);\n\t\t}\n\n\t\tif (task.progressColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-progress-color\", task.progressColor);\n\t\t}\n\n\t\t\n\t\tvar side = _render_leftside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) div.appendChild(side);\n\n\t\tside = _render_rightside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) div.appendChild(side);\n\n\t\tgantt._waiAria.setTaskBarAttr(task, div);\n\n\t\tvar state = gantt.getState();\n\n\t\tif (!gantt.isReadonly(task)) {\n\t\t\tif (cfg.drag_resize && !gantt.isSummaryTask(task) && taskType != cfg.types.milestone) {\n\t\t\t\t_render_pair(div, \"gantt_task_drag\", task, function (css) {\n\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\tel.className = css;\n\t\t\t\t\treturn el;\n\t\t\t\t}, cfg);\n\t\t\t}\n\t\t\tif (cfg.drag_links && cfg.show_links) {\n\t\t\t\t_render_pair(div, \"gantt_link_control\", task, function (css) {\n\t\t\t\t\tvar outer = document.createElement(\"div\");\n\t\t\t\t\touter.className = css;\n\t\t\t\t\touter.style.cssText = [\n\t\t\t\t\t\t\"height:\" + height + 'px',\n\t\t\t\t\t\t\"line-height:\" + height + 'px'\n\t\t\t\t\t].join(\";\");\n\t\t\t\t\tvar inner = document.createElement(\"div\");\n\t\t\t\t\tinner.className = \"gantt_link_point\";\n\n\t\t\t\t\tvar showLinkPoints = false;\n\t\t\t\t\tif(state.link_source_id && cfg.touch){\n\t\t\t\t\t\tshowLinkPoints = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinner.style.display = showLinkPoints ? \"block\" : \"\";\n\t\t\t\t\touter.appendChild(inner);\n\t\t\t\t\treturn outer;\n\t\t\t\t}, cfg, controlsMargin);\n\t\t\t}\n\t\t}\n\t\treturn div;\n\t}\n\n\tfunction _render_side_content(task, template, cssClass, marginStyle) {\n\t\tif (!template) return null;\n\n\t\tvar text = template(task.start_date, task.end_date, task);\n\t\tif (!text) return null;\n\t\tvar content = document.createElement(\"div\");\n\t\tcontent.className = \"gantt_side_content \" + cssClass;\n\t\tcontent.innerHTML = text;\n\t\tif(marginStyle){\n\t\t\tcontent.style[marginStyle.type] = Math.abs(marginStyle.value) + \"px\";\n\t\t}\n\t\treturn content;\n\t}\n\n\tfunction _render_leftside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_left \" + _get_link_crossing_css(!cfg.rtl ? true : false, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginRight\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.leftside_text, css, marginStyle);\n\t}\n\n\tfunction _render_rightside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_right \" + _get_link_crossing_css(!cfg.rtl ? false : true, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginLeft\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.rightside_text, css, marginStyle);\n\t}\n\n\tfunction _get_link_crossing_css(left, task) {\n\t\tvar cond = _get_conditions(left);\n\n\t\tfor (var i in cond) {\n\t\t\tvar links = task[i];\n\t\t\tfor (var ln = 0; ln < links.length; ln++) {\n\t\t\t\tvar link = gantt.getLink(links[ln]);\n\n\t\t\t\tfor (var tp = 0; tp < cond[i].length; tp++) {\n\t\t\t\t\tif (link.type == cond[i][tp]) {\n\t\t\t\t\t\treturn \"gantt_link_crossing\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\n\tfunction _render_task_content(task, width, templates) {\n\t\tvar content = document.createElement(\"div\");\n\t\tif (gantt.getTaskType(task.type) != gantt.config.types.milestone){\n\t\t\tcontent.innerHTML = templates.task_text(task.start_date, task.end_date, task);\n\t\t} else if(gantt.getTaskType(task.type) == gantt.config.types.milestone && width) {\n\t\t\tcontent.style.height = content.style.width = width + \"px\";\n\t\t}\n\t\tcontent.className = \"gantt_task_content\";\n\t\t//content.style.width = width + 'px';\n\t\treturn content;\n\t}\n\n\tfunction _render_task_progress(task, element, maxWidth, cfg, templates) {\n\t\tvar done = task.progress * 1 || 0;\n\n\t\tmaxWidth = Math.max(maxWidth - 2, 0);//2px for borders\n\t\tvar pr = document.createElement(\"div\");\n\t\tvar width = Math.round(maxWidth * done);\n\n\t\twidth = Math.min(maxWidth, width);\n\n\t\tpr.style.width = width + 'px';\n\t\tpr.className = \"gantt_task_progress\";\n\t\tpr.innerHTML = templates.progress_text(task.start_date, task.end_date, task);\n\n\t\tif(cfg.rtl){\n\t\t\tpr.style.position = \"absolute\";\n\t\t\tpr.style.right = \"0px\";\n\t\t}\n\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.className = \"gantt_task_progress_wrapper\";\n\t\twrapper.appendChild(pr);\n\t\telement.appendChild(wrapper);\n\n\t\tif (gantt.config.drag_progress && !gantt.isReadonly(task)) {\n\t\t\tvar drag = document.createElement(\"div\");\n\n\t\t\tvar markerPos = width;\n\t\t\tif(cfg.rtl){\n\t\t\t\tmarkerPos = maxWidth - width;\n\t\t\t}\n\n\t\t\tdrag.style.left = markerPos + 'px';\n\t\t\tdrag.className = \"gantt_task_progress_drag\";\n\t\t\tdrag.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"9\" viewBox=\"0 0 12 9\" fill=\"none\">\n<path d=\"M5.58397 1.52543C5.78189 1.22856 6.21811 1.22856 6.41602 1.52543L10.5475 7.72265C10.769 8.05493 10.5308 8.5 10.1315 8.5L1.86852 8.5C1.46917 8.5 1.23097 8.05493 1.45249 7.72265L5.58397 1.52543Z\" fill=\"var(--dhx-gantt-progress-handle-background)\" stroke=\"var(--dhx-gantt-progress-handle-border)\"/>\n</svg>`;\n\t\t\tpr.appendChild(drag);\n\t\t\telement.appendChild(drag);\n\t\t}\n\t}\n\n\tfunction _get_conditions(leftside) {\n\t\tif (leftside) {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.start_to_start\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.start_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_start\n\t\t\t\t]\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.finish_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t}\n\n\tfunction _combine_item_class(basic, template, itemId, view) {\n\t\tvar cfg = view.$getConfig();\n\t\tvar css = [basic];\n\t\tif (template)\n\t\t\tcss.push(template);\n\n\t\tvar state = gantt.getState();\n\n\t\tvar task = gantt.getTask(itemId);\n\n\t\tif (gantt.getTaskType(task.type) == cfg.types.milestone) {\n\t\t\tcss.push(\"gantt_milestone\");\n\t\t}else if (gantt.getTaskType(task.type) == cfg.types.project) {\n\t\t\tcss.push(\"gantt_project\");\n\t\t}\n\n\t\tcss.push(\"gantt_bar_\" + gantt.getTaskType(task.type));\n\n\n\t\tif (gantt.isSummaryTask(task))\n\t\t\tcss.push(\"gantt_dependent_task\");\n\n\t\tif (gantt.isSplitTask(task) && ((cfg.open_split_tasks && !task.$open) || !cfg.open_split_tasks)) {\n\t\t\tcss.push(\"gantt_split_parent\");\n\t\t}\n\n\t\tif (cfg.select_task && gantt.isSelectedTask(itemId)) {\n\t\t\tcss.push(\"gantt_selected\");\n\t\t}\n\n\t\tif (itemId == state.drag_id) {\n\t\t\tcss.push(\"gantt_drag_\" + state.drag_mode);\n\t\t\tif (state.touch_drag) {\n\t\t\t\tcss.push(\"gantt_touch_\" + state.drag_mode);\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_source_id == itemId){\n\t\t\tcss.push(\"gantt_link_source\");\n\t\t\tif(state.link_from_start) {\n\t\t\t\tcss.push(\"gantt_link_from_start\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"gantt_link_from_end\");\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_target_id == itemId)\n\t\t\tcss.push(\"gantt_link_target\");\n\n\n\t\tif (cfg.highlight_critical_path && gantt.isCriticalTask) {\n\t\t\tif (gantt.isCriticalTask(task))\n\t\t\t\tcss.push(\"gantt_critical_task\");\n\t\t}\n\n\t\tif (state.link_landing_area &&\n\t\t\t(state.link_target_id && state.link_source_id) &&\n\t\t\t(state.link_target_id != state.link_source_id) &&\n\t\t\t(state.link_target_id == itemId || state.link_source_id == itemId)) {\n\n\t\t\tvar from_id = state.link_source_id;\n\t\t\tvar from_start = state.link_from_start;\n\t\t\tvar to_start = state.link_to_start;\n\n\t\t\tvar allowDrag = gantt.isLinkAllowed(from_id, itemId, from_start, to_start);\n\n\t\t\tvar dragClass = \"\";\n\t\t\tif (allowDrag) {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_allow\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_allow\";\n\t\t\t} else {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_deny\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_deny\";\n\t\t\t}\n\t\t\tcss.push(dragClass);\n\t\t}\n\t\treturn css.join(\" \");\n\t}\n\n\tfunction _render_pair(parent, css, task, content, config, margin) {\n\t\tvar state = gantt.getState();\n\t\tvar className, element;\n\t\tif (+task.start_date >= +state.min_date) {\n\t\t\tclassName = [css, config.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"start_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginLeft = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t\tif (+task.end_date <= +state.max_date){\n\t\t\tclassName = [css, config.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"end_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginRight = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t}\n\n\treturn _render_task_element;\n}\n\nexport default createTaskRenderer;","import isInViewPort from \"./viewport/is_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport createBaseBarRender from \"./task_bar_render\";\n\nexport default function createTaskRenderer(gantt){\n\tvar defaultRender = createBaseBarRender(gantt);\n\treturn {\n\t\trender: defaultRender,\n\t\tupdate: null,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n};","export default function () {\n  // eslint-disable-next-line no-console\n  console.error(\"You are trying to use a Pro feature that is not available in the GPL version.\");\n  return {\n    render: function (){},\n    isInViewPort: function (){},\n    getVisibleRange: function (){}\n  };\n};\n","export default function(item, view, config){\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: 0,\n\t\tright: Infinity\n\t};\n};","export default function getVisibleCellsRange(scale, viewport){\n\tvar firstCellIndex = 0;\n\tvar lastCellIndex = scale.left.length - 1;\n\tif(viewport){\n\t\tfor(var i = 0; i < scale.left.length; i++){\n\t\t\tvar left = scale.left[i];\n\t\t\tif(left < viewport.x){\n\t\t\t\tfirstCellIndex = i;\n\t\t\t}\n\t\t\tif(left > viewport.x_end){\n\t\t\t\tlastCellIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tstart: firstCellIndex,\n\t\tend: lastCellIndex\n\t};\n};","import isLegacyRender from \"../is_legacy_smart_render\";\n\nexport default function isColumnVisible(columnIndex, scale, viewPort, gantt){\n\tvar width = scale.width[columnIndex];\n\tif(width <= 0){\n\t\treturn false;\n\t}\n\tif(!gantt.config.smart_rendering || isLegacyRender(gantt)){\n\t\treturn true;\n\t}\n\tvar cellLeftCoord = scale.left[columnIndex] - width;\n\tvar cellRightCoord = scale.left[columnIndex] + width;\n\treturn (cellLeftCoord <= viewPort.x_end && cellRightCoord >= viewPort.x);//do not render skipped columns\n};","export default function (items, gantt){\n\tvar placeholderConfig = gantt.config.timeline_placeholder;\n\titems = items || [];\n\tif (placeholderConfig && items.filter(e => e.id === 'timeline_placeholder_task').length === 0){\n\t\tvar state = gantt.getState();\n\t\tvar lastTaskId = null;\n\t\tvar start_date = state.min_date;\n\t\tvar end_date = state.max_date;\n\t\tif (items.length){\n\t\t\tlastTaskId = items[items.length -1].id;\n\t\t}\n\t\tvar placeholderTask = {\n\t\t\tstart_date: start_date, \n\t\t\tend_date: end_date, \n\t\t\trow_height: placeholderConfig.height || 0,\n\t\t\tid: \"timeline_placeholder_task\", \n\t\t\tunscheduled: true,\n\t\t\tlastTaskId: lastTaskId, \n\t\t\tcalendar_id: placeholderConfig.calendar || \"global\",\n\t\t\t$source:[], \n\t\t\t$target: []\n\t\t};\n\t\titems.push(placeholderTask);\n\t}\n};","import isInViewPort from \"./viewport/is_link_in_viewport\";\nimport getVisibleRange from \"./viewport/factory/get_visible_link_range\";\nimport { childrenHaveBaselines, getMaxParentHeight } from \"./baseline_helper\";\n\n\nfunction createLinkRender(gantt){\n\nfunction _render_link_element(link, view, config) {\n\tvar source = gantt.getTask(link.source);\n\tif(source.hide_bar){\n\t\treturn;\n\t}\n\n\tvar target = gantt.getTask(link.target);\n\tif(target.hide_bar){\n\t\treturn;\n\t}\n\n\tvar pt = path_builder.get_endpoint(link, view, source, target);\n\tvar dy = pt.e_y - pt.y;\n\tvar dx = pt.e_x - pt.x;\n\tif(!dx && !dy){\n\t\treturn null;\n\t}\n\n\n\tvar dots = path_builder.get_points(link, view, source, target);\n\tconst lines = drawer.get_lines(dots, view);\n\n\tconst shapes = transform_lines_to_shapes(lines.filter(l => l.size > 0), config);\n  \n\tconst div = render_shapes(shapes, view, link, config);\n\n\n\tvar css = \"gantt_task_link\";\n\n\tif (link.color) {\n\t\tcss += \" gantt_link_inline_color\";\n\t}\n\tvar cssTemplate = gantt.templates.link_class ? gantt.templates.link_class(link) : \"\";\n\tif (cssTemplate) {\n\t\tcss += \" \" + cssTemplate;\n\t}\n\n\tif (config.highlight_critical_path && gantt.isCriticalLink) {\n\t\tif (gantt.isCriticalLink(link))\n\t\t\tcss += \" gantt_critical_link\";\n\t}\n\n\tdiv.className = css;\n\n\tif(view.$config.link_attribute){\n\t\tdiv.setAttribute(view.$config.link_attribute, link.id);\n\t\tdiv.setAttribute(\"link_id\", link.id);\n\t}\n\tif (link.color) {\n\t\tdiv.style.setProperty(\"--dhx-gantt-link-background\", link.color);\n\t}\n\n\tgantt._waiAria.linkAttr(link, div);\n\n\treturn div;\n}\n\n\tfunction render_shapes(shapes, view, link, config) {\n\t\tconst container = document.createElement(\"div\");\n\n\t\tshapes.forEach(shape => {\n\t\t\tlet element;\n\t\t\tif (shape.type === 'line') {\n\t\t\t\telement = drawer.render_line(shape.data, null, view, link.source);\n\t\t\t} else if (shape.type === 'corner') {\n\t\t\t\telement = drawer.render_corner(shape.data, view);\n\t\t\t}else if (shape.type === 'arrow') {\n\t\t\t\telement = drawer.render_arrow(shape.data, config);\n\t\t\t}\n\n\t\t\tcontainer.appendChild(element);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tfunction transform_lines_to_shapes(lines, config) {\n\t\tconst radius = config.link_radius || 4;\n\t\tconst arrowSize = config.link_arrow_size || 6; // Arrow size from config\n\t\tconst shapes = [];\n\t\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\tconst line = lines[i];\n\t\t\tconst nextLine = lines[i + 1];\n\t\n\t\t\tif (!nextLine || config.link_radius <= 1) {\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t\tcontinue;\n\t\t\t}\n\t\n\t\t\tif (line.direction !== nextLine.direction) {\n\t\t\t\tif(line.size < radius || nextLine.size < radius){\n\t\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tline.size -= radius;\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\n\t\t\t\tlet cornerX = line.x;\n\t\t\t\tlet cornerY = line.y - config.link_line_width / 2;\n\t\n\t\t\t\tswitch (line.direction) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tcornerX += line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tcornerX -= line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'down':\n\t\t\t\t\t\tcornerY += line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'up':\n\t\t\t\t\t\tcornerY -= line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\n\t\t\t\tconst corner = {\n\t\t\t\t\tx: cornerX,\n\t\t\t\t\ty: cornerY,\n\t\t\t\t\tdirection: { from: line.direction, to: nextLine.direction },\n\t\t\t\t\tradius\n\t\t\t\t};\n\t\t\t\tshapes.push({ type: 'corner', data: corner });\n\t\n\t\t\t\tswitch (nextLine.direction) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tnextLine.x += radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tnextLine.x -= radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'down':\n\t\t\t\t\t\tnextLine.y += radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'up':\n\t\t\t\t\t\tnextLine.y -= radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t}\n\t\t}\n\t\n\t\tconst lastLine = lines[lines.length - 1];\n\t\n\t\tif (lastLine.direction === 'right' || lastLine.direction === 'left') {\n\t\t\tlastLine.size -= arrowSize*3/4; \n\t\n\t\t\tlet arrowX = lastLine.direction === 'right' ? (lastLine.x + lastLine.size) : lastLine.x - lastLine.size - arrowSize/2;\n\t\t\tlet arrowY = lastLine.y - (config.link_line_width / 2) - (arrowSize / 2) + 1;\n\t\n\t\t\tif(lastLine.direction === 'left'){\n\t\t\t\tarrowY -= 1;// left pointing arrows for some reason need adjustments\n\t\t\t\tarrowX -= 2;\n\t\t\t}else{\n\t\t\t\tarrowX -= 1;\n\t\t\t}\n\t\t\tconst arrow = {\n\t\t\t\tx: arrowX,\n\t\t\t\ty: arrowY,\n\t\t\t\tsize: arrowSize,\n\t\t\t\tdirection: lastLine.direction\n\t\t\t};\n\t\n\t\t\tshapes.push({ type: 'line', data: lastLine });\n\t\t\tshapes.push({ type: 'arrow', data: arrow });\n\t\t} else {\n\t\t\tshapes.push({ type: 'line', data: lastLine });\n\t\t}\n\t\n\t\treturn shapes;\n\t}\n\t\n\n\nvar drawer = {\n\tcurrent_pos: null,\n\tdirs: {\"left\": 'left', \"right\": 'right', \"up\": 'up', \"down\": 'down'},\n\tpath: [],\n\tclear: function () {\n\t\tthis.current_pos = null;\n\t\tthis.path = [];\n\t},\n\tpoint: function (pos) {\n\t\tthis.current_pos = gantt.copy(pos);\n\t},\n\tget_lines: function (dots) {\n\t\tthis.clear();\n\t\tthis.point(dots[0]);\n\t\tfor (var i = 1; i < dots.length; i++) {\n\t\t\tthis.line_to(dots[i]);\n\t\t}\n\t\treturn this.get_path();\n\t},\n\tline_to: function (pos) {\n\t\tvar next = gantt.copy(pos);\n\t\tvar prev = this.current_pos;\n\n\t\tvar line = this._get_line(prev, next);\n\t\tthis.path.push(line);\n\t\tthis.current_pos = next;\n\t},\n\tget_path: function () {\n\t\treturn this.path;\n\t},\n\tget_wrapper_sizes: function (v, view, itemId) {\n\t\tvar config = view.$getConfig();\n\t\tvar res,\n\t\t\twrapper_size = config.link_wrapper_width,\n\t\t\ty = v.y - (wrapper_size) / 2;\n\t\tswitch (v.direction) {\n\t\t\tcase this.dirs.left:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y,\n\t\t\t\t\theight: wrapper_size,\n\t\t\t\t\tlineHeight: wrapper_size,\n\t\t\t\t\tleft: v.x - v.size - wrapper_size / 2,\n\t\t\t\t\twidth: v.size + wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.right:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y,\n\t\t\t\t\tlineHeight: wrapper_size,\n\t\t\t\t\theight: wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: v.size + wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.up:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y - v.size,\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\n\t\t\t\t\theight: v.size + wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.down:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y /*- wrapper_size/2*/,\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\n\t\t\t\t\theight: v.size + wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn res;\n\t},\n\tget_line_sizes: function (v, view) {\n\t\tvar config = view.$getConfig();\n\t\tvar res,\n\t\t\tline_size = config.link_line_width,\n\t\t\twrapper_size = config.link_wrapper_width,\n\t\t\tsize = v.size + line_size;\n\t\tswitch (v.direction) {\n\t\t\tcase this.dirs.left:\n\t\t\tcase this.dirs.right:\n\t\t\t\tres = {\n\t\t\t\t\theight: line_size,\n\t\t\t\t\twidth: size,\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.up:\n\t\t\tcase this.dirs.down:\n\t\t\t\tres = {\n\t\t\t\t\theight: size,\n\t\t\t\t\twidth: line_size,\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\n\t\treturn res;\n\t},\n\trender_line: function (v, end, view, itemId) {\n\t\tvar pos = this.get_wrapper_sizes(v, view, itemId);\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.style.cssText = [\n\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\"height:\" + pos.height + \"px\",\n\t\t\t\"width:\" + pos.width + \"px\"\n\t\t].join(';');\n\t\twrapper.className = \"gantt_line_wrapper\";\n\n\t\tvar innerPos = this.get_line_sizes(v, view);\n\t\tvar inner = document.createElement(\"div\");\n\t\tinner.style.cssText = [\n\t\t\t\"height:\" + innerPos.height + \"px\",\n\t\t\t\"width:\" + innerPos.width + \"px\",\n\t\t\t\"margin-top:\" + innerPos.marginTop + \"px\",\n\t\t\t\"margin-left:\" + innerPos.marginLeft + \"px\"\n\t\t].join(\";\");\n\n\t\tinner.className = \"gantt_link_line_\" + v.direction;\n\t\twrapper.appendChild(inner);\n\n\t\treturn wrapper;\n\t},\n\n\trender_corner: function (corner, view) {\n\t\tconst radius = corner.radius;\n\t\tconst config = view.$getConfig();\n\t\tconst lineWidth = config.link_line_width || 2;\n\t\tconst cornerDiv = document.createElement(\"div\");\n\t\n\t\tcornerDiv.classList.add(\"gantt_link_corner\");\n\t\tcornerDiv.classList.add(`gantt_link_corner_${corner.direction.from}_${corner.direction.to}`);\n\t\n\t\tcornerDiv.style.width = `${radius}px`;\n\t\tcornerDiv.style.height = `${radius}px`;\n\t\n\t\tlet borderVertical;\n\t\tlet borderHorizontal;\n\n\t\tif (corner.direction.from === 'right' && corner.direction.to === 'down') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'right') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'right' && corner.direction.to === 'up') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'right') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'down') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'left') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'up') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'left') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t}\n\n\t\tcornerDiv.style[`border${borderHorizontal}Width`] = `${lineWidth}px`;\n\t\tcornerDiv.style[`border${borderVertical}Width`] = `${lineWidth}px`;\n\t\tcornerDiv.style[`border${borderVertical}Style`] = `solid`;\n\t\tcornerDiv.style[`border${borderHorizontal}Style`] = `solid`;\n\t\tcornerDiv.style[`border${borderHorizontal}${borderVertical}Radius`] = `${radius}px`;\n\n\t\n\t\treturn cornerDiv;\n\t},\n\n\trender_arrow(arrow, config) {\n\t\tvar div = document.createElement(\"div\");\n\t\tvar top = arrow.y;\n\t\tvar left = arrow.x;\n\t\n\t\tvar size = config.link_arrow_size;\n\t\tdiv.style.setProperty(\"--dhx-gantt-icon-size\", `${size}px`);\n\t\n\t\tvar className = \"gantt_link_arrow gantt_link_arrow_\" + arrow.direction;\n\n\t\tdiv.style.top = top + \"px\";\n\t\tdiv.style.left = left + 'px';\n\t\tdiv.className = className;\n\t\n\t\treturn div;\n\t},\n\t\n\t_get_line: function (from, to) {\n\t\tvar direction = this.get_direction(from, to);\n\t\tvar vect = {\n\t\t\tx: from.x,\n\t\t\ty: from.y,\n\t\t\tdirection: this.get_direction(from, to)\n\t\t};\n\t\tif (direction == this.dirs.left || direction == this.dirs.right) {\n\t\t\tvect.size = Math.abs(from.x - to.x);\n\t\t} else {\n\t\t\tvect.size = Math.abs(from.y - to.y);\n\t\t}\n\t\treturn vect;\n\t},\n\tget_direction: function (from, to) {\n\t\tvar direction = 0;\n\t\tif (to.x < from.x) {\n\t\t\tdirection = this.dirs.left;\n\t\t} else if (to.x > from.x) {\n\t\t\tdirection = this.dirs.right;\n\t\t} else if (to.y > from.y) {\n\t\t\tdirection = this.dirs.down;\n\t\t} else {\n\t\t\tdirection = this.dirs.up;\n\t\t}\n\t\treturn direction;\n\t}\n\n};\n\nvar path_builder = {\n\n\tpath: [],\n\tclear: function () {\n\t\tthis.path = [];\n\t},\n\tcurrent: function () {\n\t\treturn this.path[this.path.length - 1];\n\t},\n\tpoint: function (next) {\n\t\tif (!next)\n\t\t\treturn this.current();\n\n\t\tthis.path.push(gantt.copy(next));\n\t\treturn next;\n\t},\n\tpoint_to: function (direction, diff, point) {\n\t\tif (!point)\n\t\t\tpoint = gantt.copy(this.point());\n\t\telse\n\t\t\tpoint = {x: point.x, y: point.y};\n\t\tvar dir = drawer.dirs;\n\t\tswitch (direction) {\n\t\t\tcase (dir.left):\n\t\t\t\tpoint.x -= diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.right):\n\t\t\t\tpoint.x += diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.up):\n\t\t\t\tpoint.y -= diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.down):\n\t\t\t\tpoint.y += diff;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn this.point(point);\n\t},\n\tget_points: function (link, view, source, target) {\n\t\tvar pt = this.get_endpoint(link, view, source, target);\n\t\tvar xy = gantt.config;\n\n\t\tvar dy = pt.e_y - pt.y;\n\t\tvar dx = pt.e_x - pt.x;\n\n\t\tvar dir = drawer.dirs;\n\n\t\tvar rowHeight = view.getItemHeight(link.source);\n\n\t\tthis.clear();\n\t\tthis.point({x: pt.x, y: pt.y});\n\n\t\tvar shiftX = 2 * xy.link_arrow_size;//just random size for first line\n\t\tvar lineType = this.get_line_type(link, view.$getConfig());\n\n\t\tvar forward = (pt.e_x > pt.x);\n\t\tif (lineType.from_start && lineType.to_start) {\n\t\t\tthis.point_to(dir.left, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t}\n\t\t\tthis.point_to(dir.right, shiftX);\n\n\t\t} else if (!lineType.from_start && lineType.to_start) {\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\n\t\t\tif (dy !== 0){\n\t\t\t\tforward = (pt.e_x > (pt.x + 2 * shiftX));\n\t\t\t}\n\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tdx -= shiftX;\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tdx -= 2 * shiftX;\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\n\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\n\t\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\t}\n\n\t\t} else if (!lineType.from_start && !lineType.to_start) {\n\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t} else {\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t}\n\t\t\tthis.point_to(dir.left, shiftX);\n\t\t} else if (lineType.from_start && !lineType.to_start) {\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\n\t\t\tif (dy !== 0){\n\t\t\t\tforward = (pt.e_x > (pt.x - 2 * shiftX));\n\t\t\t}\n\t\t\tthis.point_to(dir.left, shiftX);\n\n\t\t\tif (!forward) {\n\t\t\t\tdx += shiftX;\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tdx += 2 * shiftX;\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\n\t\t\t\tthis.point_to(dir.left, shiftX);\n\t\t\t}\n\n\t\t}\n\n\t\treturn this.path;\n\t},\n\tget_line_type: function(link, config){\n\t\tvar types = config.links;\n\t\tvar from_start = false, to_start = false;\n\t\tif (link.type == types.start_to_start) {\n\t\t\tfrom_start = to_start = true;\n\t\t} else if (link.type == types.finish_to_finish) {\n\t\t\tfrom_start = to_start = false;\n\t\t} else if (link.type == types.finish_to_start) {\n\t\t\tfrom_start = false;\n\t\t\tto_start = true;\n\t\t} else if (link.type == types.start_to_finish) {\n\t\t\tfrom_start = true;\n\t\t\tto_start = false;\n\t\t} else {\n\t\t\tgantt.assert(false, \"Invalid link type\");\n\t\t}\n\n\t\tif(config.rtl){\n\t\t\tfrom_start = !from_start;\n\t\t\tto_start = !to_start;\n\t\t}\n\n\t\treturn {from_start: from_start, to_start: to_start};\n\t},\n\n\tget_endpoint: function (link, view, source, target) {\n\t\tvar config = view.$getConfig();\n\n\t\tvar lineType = this.get_line_type(link, config);\n\t\tvar from_start = lineType.from_start,\n\t\t\tto_start = lineType.to_start;\n\n\t\tvar from = getMilestonePosition(source, view, config),\n\t\t\tto = getMilestonePosition(target, view, config);\n\n\t\treturn {\n\t\t\tx: from_start ? from.left : (from.left + from.width),\n\t\t\te_x: to_start ? to.left : (to.left + to.width),\n\t\t\ty: from.top + (from.rowHeight/2) - 1,\n\t\t\te_y: to.top + (to.rowHeight/2) - 1\n\t\t};\n\t}\n};\n\nfunction getMilestonePosition(task, view, config){\n\tvar pos = view.getItemPosition(task);\n\n\t// GS-2270: Link to the split children shouldn't exceed the parent row height\n\tlet splitParams = getMaxParentHeight(gantt, view, task);\n\tlet maxHeight = splitParams.maxHeight;\n\n\tlet splitChild = splitParams.splitChild;\n\tconst baselinesOnDifferentRow = gantt.config.baselines !== false && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\tconst baselines = baselinesOnDifferentRow && task.baselines && task.baselines.length;\n\n\tif (splitParams.shrinkHeight){\n\t\tpos.rowHeight = maxHeight;\n\t}\n\n\tlet milestoneWidth;\n\tlet milestoneTask = gantt.getTaskType(task.type) == config.types.milestone;\n\tif(milestoneTask){\n\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\tmilestoneWidth = Math.sqrt(2*milestoneHeight*milestoneHeight);\n\t\tif (splitParams.shrinkHeight && maxHeight < milestoneHeight){\n\t\t\tmilestoneHeight = maxHeight;\n\t\t\tmilestoneWidth = maxHeight;\n\t\t}\n\t\tpos.left -= milestoneWidth / 2;\n\t\tpos.width = milestoneWidth;\n\t} \n\tif (splitChild){\n\t\tif (maxHeight >= pos.height) {\n\t\t\tconst siblingBaselines = childrenHaveBaselines(gantt, task.parent);\n\t\t\tif (baselines || siblingBaselines){\n\t\t\t\tif (milestoneTask){\n\t\t\t\t\tpos.rowHeight = pos.height + 4;\n\t\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\n\t\t\t\t\tpos.width = pos.rowHeight - 3;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpos.rowHeight = pos.height + 6;\n\t\t\t\t}\n\t\t\t} else if (milestoneTask) {\n\t\t\t\tpos.left += (milestoneWidth - pos.height) / 2;\n\t\t\t}\n\t\t} else {\n\t\t\tpos.rowHeight = maxHeight + 2;\n\t\t\tif (milestoneTask){\n\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\n\t\t\t\tpos.width = pos.rowHeight - 3;\n\t\t\t}\n\t\t}\n\t} else if (baselines){\n\t\tpos.rowHeight = pos.height + 4;\n\t}\n\n\treturn pos;\n}\n\n\nreturn {\n\trender: _render_link_element,\n\tupdate: null,\n\t//getRectangle: getLinkRectangle\n\tisInViewPort: isInViewPort,\n\tgetVisibleRange: getVisibleRange()\n};\n}\n\nexport default createLinkRender;","export default function(item, viewport, view, config, gantt){\n    // GS-2481 and GS-1715, don't remove selected task when using keyboard shortcuts and when the inline editor is opened\n    if(gantt.$ui.getView(\"grid\") && ((gantt.config.keyboard_navigation && gantt.getSelectedId()) || (gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id))) {\n\t\treturn true;\n\t}\n    var top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","import * as helpers from \"../utils/helpers\";\n\nexport default function createResourceTimelineBuilder(gantt){\n\n\tlet resourceTaskCache = {};\n\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\n\t\tresourceTaskCache = {};\n\t});\n\n\tfunction getResourceLoad(resource, resourceProperty, scale, timeline){\n\t\tconst cacheKey = resource.id + \"_\" + resourceProperty  + \"_\" + scale.unit + \"_\" + scale.step;\n\t\tlet res;\n\t\tif (!resourceTaskCache[cacheKey]) {\n\t\t\tres = resourceTaskCache[cacheKey] = calculateResourceLoad(resource, resourceProperty, scale, timeline);\n\n\t\t} else {\n\t\t\tres = resourceTaskCache[cacheKey];\n\t\t}\n\t\treturn res;\n\t}\n\n\tfunction calculateResourceLoadFromAssignments(items, scale, assignmentsPassed){\n\t\tconst scaleUnit = scale.unit;\n\t\tconst scaleStep = scale.step;\n\t\tconst timegrid = {};\n\n\t\tconst precalculatedTimes = {};\n\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\tconst item = items[i];\n\t\t\tlet task = item;\n\t\t\tif(assignmentsPassed){\n\t\t\t\ttask = gantt.getTask(item.task_id);\n\t\t\t}\n\t\t\tif (task.unscheduled){\n\t\t\t\tcontinue; // do not process assignments for unscheduled tasks\n\t\t\t}\n\t\t\tlet minDate = (item.start_date || task.start_date);\n\t\t\tlet maxDate = (item.end_date || task.end_date);\n\t\t\tif(assignmentsPassed){\n\t\t\t\tif(item.start_date){\n\t\t\t\t\tminDate = new Date(Math.max(item.start_date.valueOf(), task.start_date.valueOf()));\n\t\t\t\t}\n\t\t\t\tif(item.end_date){\n\t\t\t\t\tmaxDate = new Date(Math.min(item.end_date.valueOf(), task.end_date.valueOf()));\n\t\t\t\t}\n\t\t\t\t// GS-2063: handle case with fixedDates mode\n\t\t\t\tif(item.mode && item.mode == \"fixedDates\"){\n\t\t\t\t\tminDate = item.start_date;\n\t\t\t\t\tmaxDate = item.end_date;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet firstColumn = helpers.findBinary(scale.trace_x, minDate.valueOf());\n\t\t\tlet minScaleDate = new Date(scale.trace_x[firstColumn] || gantt.date[scaleUnit + \"_start\"](new Date(minDate)));\n\t\t\t// GS-2307: need to take into account that task could start before the min scale date\n\t\t\t// so the task would be added to timegrid\n\t\t\tlet currDate = new Date(Math.min(minDate.valueOf(), minScaleDate.valueOf())); \n\n\t\t\tlet calendar = gantt.config.work_time ? gantt.getTaskCalendar(task) : gantt;\n\t\t\tprecalculatedTimes[calendar.id] = {};\n\t\t\twhile (currDate < maxDate) {\n\t\t\t\tconst cachedTimes = precalculatedTimes[calendar.id];\n\n\t\t\t\tlet date = currDate;\n\t\t\t\tconst timestamp = date.valueOf();\n\n\t\t\t\tcurrDate = gantt.date.add(currDate, scaleStep, scaleUnit);\n\n\t\t\t\tif(cachedTimes[timestamp] === false){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!timegrid[timestamp]){\n\t\t\t\t\ttimegrid[timestamp] = {tasks: [], assignments: []};\n\t\t\t\t}\n\n\t\t\t\ttimegrid[timestamp].tasks.push(task);\n\t\t\t\tif(assignmentsPassed){\n\t\t\t\t\ttimegrid[timestamp].assignments.push(item);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn timegrid;\n\t}\n\n\tfunction calculateResourceLoad(resource, resourceProperty, scale, timeline) {\n\n\t\tlet items;\n\t\tlet assignmentsPassed = false;\n\t\tlet timegrid = {};\n\n\t\tif(gantt.config.process_resource_assignments && resourceProperty === gantt.config.resource_property){\n\t\t\tif(resource.$role == \"task\"){\n\t\t\t\titems = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\n\t\t\t}else{\n\t\t\t\titems = gantt.getResourceAssignments(resource.id);\n\t\t\t}\n\n\t\t\tassignmentsPassed = true;\n\t\t}else if(resource.$role == \"task\"){\n\t\t\titems = [];\n\t\t}else{\n\t\t\titems = gantt.getTaskBy(resourceProperty, resource.id);\n\t\t}\n\n\t\ttimegrid = calculateResourceLoadFromAssignments(items, scale, assignmentsPassed);\n\t\tconst scaleUnit = scale.unit;\n\t\tconst scaleStep = scale.step;\n\n\t\tconst timetable = [];\n\t\tlet start, end, tasks, assignments, cell;\n\t\tconst config = timeline.$getConfig();\n\n\t\tfor(let i = 0; i < scale.trace_x.length; i++){\n\t\t\tstart = new Date(scale.trace_x[i]);\n\t\t\tend = gantt.date.add(start, scaleStep, scaleUnit);\n\t\t\tcell = timegrid[start.valueOf()] || {};\n\t\t\ttasks = cell.tasks || [];\n\t\t\tassignments = cell.assignments || [];\n\t\t\tif(tasks.length || config.resource_render_empty_cells){\n\t\t\t\ttimetable.push({\n\t\t\t\t\tstart_date: start,\n\t\t\t\t\tend_date: end,\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tassignments: assignments\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\ttimetable.push(null);\n\t\t\t}\n\t\t}\n\n\t\treturn timetable;\n\t}\n\n\n\n\treturn getResourceLoad;\n};","import * as domHelpers from \"../utils/dom_helpers\";\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\n\nfunction _init_dnd(gantt, grid) {\n\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\n\t\treturn;\n\t}\n\n\tfunction locate(e){\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\n\t}\n\n\tfunction getStore(){\n\t\treturn gantt.getDatastore(grid.$config.bind);\n\t}\n\n\tfunction checkPlaceholderTask(id){\n\t\treturn isPlaceholderTask(id, gantt, getStore());\n\t}\n\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tif (!el) return false;\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\n\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\n\t\tif (checkPlaceholderTask(id)) return false;\n\n\t\tvar datastore = getStore();\n\n\t\tvar task = datastore.getItem(id);\n\n\t\tif (gantt.isReadonly(task))\n\t\t\treturn false;\n\n\t\tdnd.config.initial_open_state = task.$open;\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\n\t\t\treturn false;\n\t\t}\n\n\t}, gantt));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\n\t\tvar element = dnd.config.marker.firstChild;\n\t\tif(element){\n\t\t\telement.style.position = \"static\";\n\t\t}\n\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\n\n\t\tvar store = getStore();\n\n\t\tvar task = store.getItem(dnd.config.id);\n\t\tdnd.config.index = store.getBranchIndex(dnd.config.id);\n\t\tdnd.config.parent = task.parent;\n\t\ttask.$open = false;\n\t\ttask.$transparent = true;\n\t\tthis.refreshData();\n\t}, gantt));\n\n\tdnd.lastTaskOfLevel = function (level) {\n\t\tvar last_item = null;\n\t\tvar store = getStore();\n\t\tvar tasks = store.getItems();\n\t\tfor (var i = 0, len = tasks.length; i < len; i++) {\n\t\t\tif (tasks[i].$level == level) {\n\t\t\t\tlast_item = tasks[i];\n\t\t\t}\n\t\t}\n\t\treturn last_item ? last_item.id : null;\n\t};\n\tdnd._getGridPos = gantt.bind(function (e) {\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\t\t// row offset\n\t\tvar x = pos.x + grid.$grid.scrollLeft;\n\t\tvar y = e.pos.y - 10;\n\n\t\tvar rowHeight = grid.getItemHeight(dnd.config.id);\n\t\t// prevent moving row out of grid_data container\n\t\tif (y < pos.y) y = pos.y;\n\t\tvar gridHeight = grid.getTotalHeight();\n\t\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\n\t\tconst maxBottom = pos.y + pos.height;\n\t\tif (y > maxBottom - rowHeight) {\n\t\t\ty = maxBottom - rowHeight;\n\t\t}\n\n\t\tpos.x = x;\n\t\tpos.y = y;\n\t\treturn pos;\n\t}, gantt);\n\tdnd._getTargetY = gantt.bind(function (e) {\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos;\n\n\t\tvar y = e.pageY - pos.y + scrollPos;\n\t\tif (y > maxBottom) {\n\t\t\ty = maxBottom;\n\t\t} else if (y < scrollPos) {\n\t\t\ty = scrollPos;\n\t\t}\n\t\treturn y;\n\t}, gantt);\n\tdnd._getTaskByY = gantt.bind(function (y, dropIndex) {\n\n\t\tvar store = getStore();\n\n\t\ty = y || 0;\n\n\t\tvar index = grid.getItemIndexByTopPosition(y);\n\t\tindex = dropIndex < index ? index - 1 : index;\n\n\t\tif (index > store.countVisible() - 1)\n\t\t\treturn null;\n\n\t\treturn store.getIdByIndex(index);\n\t}, gantt);\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\n\t\tvar gridDataSizes = gantt.$grid_data.getBoundingClientRect();\n\t\tvar maxBottom = gridDataSizes.height + gridDataSizes.y + (grid.$state.scrollTop || 0) + window.scrollY;\n\t\tvar dd = dnd.config;\n\t\tvar pos = dnd._getGridPos(e);\n\n\t\tgantt._waiAria.reorderMarkerAttr(dd.marker);\n\n\t\tvar config = grid.$getConfig(),\n\t\t\tstore = getStore();\n\n\t\t// setting position of row\n\t\tif (pos.y < maxBottom) {\n\t\t\tdd.marker.style.top = pos.y + \"px\";\n\t\t} else {\n\t\t\tdd.marker.style.top = maxBottom + \"px\";\n\t\t}\n\t\tdd.marker.style.left = pos.x + 10 + \"px\";\n\t\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\n\t\tif (pos.width > containerSize.width){\n\t\t\tdd.marker.style.width = containerSize.width - 10 - 2 + \"px\";\n\t\t\tdd.marker.style.overflow = \"hidden\";\t\n\t\t}\n\n\t\t// highlight row when mouseover\n\t\tvar item = store.getItem(dnd.config.id);\n\t\tvar targetY = dnd._getTargetY(e);\n\t\tvar el = dnd._getTaskByY(targetY, store.getIndexById(item.id));\n\n\t\tif (!store.exists(el)) {\n\t\t\tel = dnd.lastTaskOfLevel(config.order_branch_free ? item.$level : 0);\n\t\t\tif (el == dnd.config.id) {\n\t\t\t\tel = null;\n\t\t\t}\n\t\t}\n\n\t\tfunction allowedLevel(next, item) {\n\t\t\treturn (!(store.isChildOf(over.id, item.id)) && (next.$level == item.$level || config.order_branch_free));\n\t\t}\n\n\t\tif (store.exists(el)) {\n\t\t\tvar over = store.getItem(el);\n\n\t\t\tvar itemTop = grid.getItemTop(over.id);\n\t\t\tvar itemHeight = grid.getItemHeight(over.id);\n\t\t\tif (itemTop + itemHeight / 2 < targetY) {\n\t\t\t\t//hovering over bottom part of item, check can be drop to bottom\n\t\t\t\tvar index = store.getIndexById(over.id);\n\t\t\t\tvar nextId = store.getNext(over.id);//adds +1 when hovering over placeholder\n\t\t\t\tvar next = store.getItem(nextId);\n\t\t\t\tif (checkPlaceholderTask(nextId)){\n\t\t\t\t\tvar prevId = store.getPrev(next.id);\n\t\t\t\t\tnext = store.getItem(prevId);\n\t\t\t\t}\n\t\t\t\tif (next) {\n\t\t\t\t\tif (next.id != item.id) {\n\t\t\t\t\t\tover = next; //there is a valid target\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config.order_branch_free) {\n\t\t\t\t\t\t\tif (!(store.isChildOf(item.id, over.id) && store.getChildren(over.id).length == 1))\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tstore.move(item.id, store.getBranchIndex(over.id) + 1, store.getParent(over.id));\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//we at end of the list, check and drop at the end of list\n\t\t\t\t\tnextId = store.getIdByIndex(index);\n\t\t\t\t\tnext = store.getItem(nextId);\n\n\t\t\t\t\tif (checkPlaceholderTask(nextId)){\n\t\t\t\t\t\tvar prevId = store.getPrev(next.id);\n\t\t\t\t\t\tnext = store.getItem(prevId);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (allowedLevel(next, item) && next.id != item.id) {\n\t\t\t\t\t\tstore.move(item.id, -1, store.getParent(next.id));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (config.order_branch_free) {\n\t\t\t\tif (over.id != item.id && allowedLevel(over, item) && !checkPlaceholderTask(over.id)) {\n\t\t\t\t\tif (!store.hasChild(over.id)) {\n\t\t\t\t\t\tover.$open = true;\n\t\t\t\t\t\tstore.move(item.id, -1, over.id);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (store.getIndexById(over.id) || itemHeight / 3 < targetY) return;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//if item is on different level, check the one before it\n\t\t\tvar index = store.getIndexById(over.id),\n\t\t\t\tprevId = store.getIdByIndex(index - 1);\n\n\t\t\tvar prev = store.getItem(prevId);\n\n\t\t\tvar shift = 1;\n\t\t\twhile ((!prev || prev.id == over.id) && index - shift >= 0) {\n\n\t\t\t\tprevId = store.getIdByIndex(index - shift);\n\t\t\t\tprev = store.getItem(prevId);\n\t\t\t\tshift++;\n\t\t\t}\n\n\t\t\tif (item.id == over.id || checkPlaceholderTask(over.id)) return;\n\t\t\t//replacing item under cursor\n\t\t\tif (allowedLevel(over, item) && item.id != over.id) {\n\t\t\t\tstore.move(item.id, 0, 0, over.id);\n\n\t\t\t} else if (over.$level == item.$level - 1 && !store.getChildren(over.id).length) {\n\t\t\t\tstore.move(item.id, 0, over.id);\n\n\t\t\t} else if (prev && (allowedLevel(prev, item)) && (item.id != prev.id)) {\n\t\t\t\tstore.move(item.id, -1, store.getParent(prev.id));\n\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}, gantt));\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\n\t\tvar store = getStore();\n\t\tvar task = store.getItem(dnd.config.id);\n\t\ttask.$transparent = false;\n\t\ttask.$open = dnd.config.initial_open_state;\n\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, dnd.config.parent, dnd.config.index]) === false) {\n\t\t\tstore.move(dnd.config.id, dnd.config.index, dnd.config.parent);\n\t\t\ttask.$drop_target = null;\n\t\t} else {\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, task.$drop_target]);\n\t\t}\n\t\tgantt.render();\n\t\tthis.refreshData();\n\t}, gantt));\n}\n\nexport default {\n\tinit: _init_dnd\n};","/**\n * The state object for order branch drag and drop\n */\n\nimport * as utils from \"../../../../utils/utils\";\n\nexport default {\n\tcreateDropTargetObject: function createDropTargetObject(parent) {\n\t\tvar res = {\n\t\t\ttargetParent: null,\n\t\t\ttargetIndex: 0,\n\t\t\ttargetId: null,\n\t\t\tchild: false,\n\t\t\tnextSibling: false,\n\t\t\tprevSibling: false\n\t\t};\n\n\t\tif (parent) {\n\t\t\tutils.mixin(res, parent, true);\n\t\t}\n\t\treturn res;\n\t},\n\tnextSiblingTarget: function nextSiblingTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.nextSibling = true;\n\t\tresult.targetParent = store.getParent(result.targetId);\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\n\t\tif(store.getParent(dndTaskId) != result.targetParent || result.targetIndex < store.getBranchIndex(dndTaskId)){\n\t\t\tresult.targetIndex += 1;\n\t\t}\n\t\treturn result;\n\t},\n\tprevSiblingTarget: function prevSiblingTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.prevSibling = true;\n\t\tresult.targetParent = store.getParent(result.targetId);\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\n\t\tif(store.getParent(dndTaskId) == result.targetParent && result.targetIndex > store.getBranchIndex(dndTaskId)){\n\t\t\tresult.targetIndex -= 1;\n\t\t}\n\t\treturn result;\n\t},\n\tfirstChildTarget: function firstChildTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.targetParent = result.targetId;\n\t\tresult.targetIndex = 0;\n\t\tresult.child = true;\n\t\treturn result;\n\t},\n\tlastChildTarget: function lastChildTarget(dndTaskId, targetTaskId, store) {\n\t\tvar children = store.getChildren(targetTaskId);\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = children[children.length - 1];\n\t\tresult.targetParent = targetTaskId;\n\t\tresult.targetIndex = children.length;\n\t\tresult.nextSibling = true;\n\t\treturn result;\n\t}\n};","/**\n * resolve dnd position of the task when gantt.config.order_branch_free = false\n */\n\nimport dropTarget from \"./drop_target\";\n\nfunction getLast(store){\n\tvar current = store.getNext();\n\twhile(store.exists(current)){\n\n\t\tvar next = store.getNext(current);\n\t\tif(!store.exists(next)){\n\t\t\treturn current;\n\t\t}else{\n\t\t\tcurrent = next;\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findClosesTarget(dndTaskId, taskId, allowedLevel, store, up){\n\tvar prev = taskId;\n\twhile(store.exists(prev)){\n\t\tvar targetLevel = store.calculateItemLevel(store.getItem(prev));\n\t\tif((targetLevel === allowedLevel || targetLevel === (allowedLevel - 1)) && store.getBranchIndex(prev) > -1){\n\t\t\tbreak;\n\t\t}else {\n\t\t\tprev = up ? store.getPrev(prev) : store.getNext(prev);\n\t\t}\n\t}\n\n\tif(store.exists(prev)){\n\t\tif(store.calculateItemLevel(store.getItem(prev)) === allowedLevel){\n\t\t\treturn up ? dropTarget.nextSiblingTarget(dndTaskId, prev, store) : dropTarget.prevSiblingTarget(dndTaskId, prev, store);\n\t\t}else{\n\t\t\treturn dropTarget.firstChildTarget(dndTaskId, prev, store);\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findTargetAbove(dndTaskId, taskId, allowedLevel, store){\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, true);\n}\nfunction findTargetBelow(dndTaskId, taskId, allowedLevel, store){\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, false);\n}\n\nexport default function getSameLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store, level){\n\tvar result;\n\tif(targetTaskId !== store.$getRootId()){\n\t\tvar targetTask = store.getItem(targetTaskId);\n\t\tvar targetLevel = store.calculateItemLevel(targetTask);\n\t\tif(targetLevel === level){\n\t\t\tvar prevSibling = store.getPrevSibling(targetTaskId);\n\t\t\tif(relTargetPos < 0.5 && !prevSibling){\n\t\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t\t}else{\n\t\t\t\tif(relTargetPos < 0.5){\n\t\t\t\t\ttargetTaskId = prevSibling;\n\t\t\t\t}\n\t\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t\t}\n\t\t}else if(targetLevel > level){\n\t\t\tstore.eachParent(function(parent){\n\t\t\t\tif(store.calculateItemLevel(parent) === level){\n\t\t\t\t\ttargetTaskId = parent.id;\n\t\t\t\t}\n\t\t\t}, targetTask); \n\t\t\tresult = findTargetAbove(dndTaskId, targetTaskId, level, store);\n\t\t}else{\n\t\t\tvar targetAbove = findTargetAbove(dndTaskId, targetTaskId, level, store);\n\t\t\tvar targetBelow = findTargetBelow(dndTaskId, targetTaskId, level, store);\n\t\t\tresult = (relTargetPos < 0.5) ? targetAbove : targetBelow;\n\t\t}\n\t}else{\n\t\tvar rootId = store.$getRootId();\n\t\tvar rootLevel = store.getChildren(rootId);\n\t\tresult = dropTarget.createDropTargetObject();\n\t\tif(rootLevel.length && eventTop >= 0){\n\t\t\tresult = findTargetAbove(dndTaskId, getLast(store), level, store);\n\t\t}else{\n\t\t\tresult = findTargetBelow(dndTaskId, rootId, level, store);\n\t\t}\n\t}\n\n\treturn result;\n};\n","import * as domHelpers from \"../../utils/dom_helpers\";\n\n/**\n * methods for highlighting current drag and drop position\n */\n\nfunction highlightPosition(target, root, grid){\n\tvar markerPos = getTaskMarkerPosition(target, grid);\n\t// setting position of row\n\troot.marker.style.left = markerPos.x + 9 + \"px\";\n\troot.marker.style.width = markerPos.width + \"px\";\n\troot.marker.style.overflow = \"hidden\";\n\tvar markerLine = root.markerLine;\n\tif(!markerLine){\n\t\tmarkerLine = document.createElement(\"div\");\n\t\tmarkerLine.className = \"gantt_drag_marker gantt_grid_dnd_marker\";\n\t\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\n\t\tmarkerLine.style.pointerEvents = \"none\";\n\t}\n\n\tif(target.child){\n\t\thighlightFolder(target, markerLine, grid);\n\t}else{\n\t\thighlightRow(target, markerLine, grid);\n\t}\n\n\tif(!root.markerLine){\n\t\tdocument.body.appendChild(markerLine);\n\t\troot.markerLine = markerLine;\n\t}\n}\n\nfunction removeLineHighlight(root){\n\tif(root.markerLine && root.markerLine.parentNode){\n\t\troot.markerLine.parentNode.removeChild(root.markerLine);\n\t}\n\troot.markerLine = null;\n}\n\nfunction highlightRow(target, markerLine, grid){\n\tvar linePos = getLineMarkerPosition(target, grid);\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n\n\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\n\tmarkerLine.style.left = linePos.x + \"px\";\n\tmarkerLine.style.height = \"4px\";\n\n\tvar markerLineTop = linePos.y - 2;\n\tmarkerLine.style.top = markerLineTop + \"px\";\n\tmarkerLine.style.width = linePos.width + \"px\";\n\n\tif (markerLineTop > maxBottom) {\n\t\tmarkerLine.style.top = maxBottom + 'px';\n\t}\n\n\treturn markerLine;\n}\nfunction highlightFolder(target, markerFolder, grid){\n\tvar id = target.targetParent;\n\tvar pos = gridToPageCoordinates({x: 0, y: grid.getItemTop(id)}, grid);\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n\n\tlet folderHighlightWidth = setWidthWithinContainer(grid.$gantt, grid.$grid_data.offsetWidth);\t\n\n\tmarkerFolder.innerHTML = \"<div class='gantt_grid_dnd_marker_folder'></div>\";\n\tmarkerFolder.style.width = folderHighlightWidth + \"px\";\n\tmarkerFolder.style.top = pos.y + \"px\";\n\tmarkerFolder.style.left = pos.x  + \"px\";\n\tmarkerFolder.style.height = grid.getItemHeight(id) + \"px\";\n\tif (pos.y > maxBottom) {\n\t\tmarkerFolder.style.top = maxBottom + 'px';\n\t}\n\n\treturn markerFolder;\n}\n\nfunction getLineMarkerPosition(target, grid){\n\tvar store = grid.$config.rowStore;\n\tvar pos = {x:0, y:0};\n\tvar indentNode = grid.$grid_data.querySelector(\".gantt_tree_indent\");\n\tvar indent = 15;\n\tvar level = 0;\n\tif(indentNode){\n\t\tindent = indentNode.offsetWidth;\n\t}\n\tvar iconWidth = 40;\n\tif(target.targetId !== store.$getRootId()){\n\t\tvar itemTop = grid.getItemTop(target.targetId);\n\t\tvar itemHeight = grid.getItemHeight(target.targetId);\n\t\tlevel = store.exists(target.targetId) ? store.calculateItemLevel(store.getItem(target.targetId)) : 0;\n\n\t\tif(target.prevSibling){\n\t\t\tpos.y = itemTop;\n\t\t}else if(target.nextSibling){\n\t\t\tvar childCount = 0;\n\t\t\tstore.eachItem(function(child){\n\t\t\t\tif(store.getIndexById(child.id) !== -1)\n\t\t\t\t\tchildCount++;\n\t\t\t}, target.targetId);\n\n\t\t\tpos.y = itemTop + itemHeight + childCount*itemHeight;\n\t\t}else {\n\t\t\tpos.y = itemTop + itemHeight;\n\t\t\tlevel += 1;\n\t\t}\n\t}\n\tpos.x = iconWidth + level * indent;\n\tpos.width = setWidthWithinContainer(grid.$gantt, Math.max(grid.$grid_data.offsetWidth - pos.x, 0), pos.x);\n\treturn gridToPageCoordinates(pos, grid);\n}\n\nfunction gridToPageCoordinates(pos, grid){\n\tvar gridPos = domHelpers.getNodePosition(grid.$grid_data);\n\tpos.x += gridPos.x + grid.$grid.scrollLeft;\n\tpos.y += gridPos.y - grid.$grid_data.scrollTop;\n\treturn pos;\n}\n\nfunction getTaskMarkerPosition(e, grid) {\n\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\tvar ePos = domHelpers.getRelativeEventPosition(e, grid.$grid_data);\n\t// row offset\n\tvar x = pos.x + grid.$grid.scrollLeft;\n\tvar y = ePos.y - 10;\n\n\tvar rowHeight = grid.getItemHeight(e.targetId);\n\t// prevent moving row out of grid_data container\n\tif (y < pos.y) y = pos.y;\n\tvar gridHeight = grid.getTotalHeight();\n\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\n\n\tpos.x = x;\n\tpos.y = y;\n\tpos.width = setWidthWithinContainer(grid.$gantt, pos.width, 9);\n\treturn pos;\n}\n\nfunction setWidthWithinContainer(gantt, width, offset = 0){\n\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\n\tif (width > containerSize.width){\n\t\twidth = containerSize.width - offset - 2;\n\t}\n\treturn width;\n}\n\nexport default {\n\tremoveLineHighlight: removeLineHighlight,\n\thighlightPosition: highlightPosition\n};\n","import * as domHelpers from \"../utils/dom_helpers\";\nimport dropTarget from \"./tasks_grid_dnd_marker_helpers/drop_target\";\nimport getLockedLevelTarget from \"./tasks_grid_dnd_marker_helpers/locked_level\";\nimport getMultiLevelTarget from \"./tasks_grid_dnd_marker_helpers/multi_level\";\nimport higlighter from \"./tasks_grid_dnd_marker_helpers/highlight\";\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\n\nfunction _init_dnd(gantt, grid) {\n\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\n\t\treturn;\n\t}\n\n\tfunction locate(e){\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\n\t}\n\n\tfunction getStore(){\n\t\treturn gantt.getDatastore(grid.$config.bind);\n\t}\n\n\tfunction checkPlaceholderTask(id){\n\t\treturn isPlaceholderTask(id, gantt, getStore());\n\t}\n\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tif (!el) return false;\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\n\t\tvar datastore = grid.$config.rowStore;\n\t\tvar task = datastore.getItem(id);\n\n\t\tif (gantt.isReadonly(task) || checkPlaceholderTask(id))\n\t\t\treturn false;\n\n\t\tdnd.config.initial_open_state = task.$open;\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\n\t\t\treturn false;\n\t\t}\n\n\t}, gantt));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\n\t\tvar element = dnd.config.marker.firstChild;\n\t\tif(element){\n\t\t\tdnd.config.marker.style.opacity = 0.4;\n\t\t\telement.style.position = \"static\";\n\t\t\telement.style.pointerEvents = \"none\";\n\t\t}\n\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\n\n\t\tvar store = grid.$config.rowStore;\n\n\t\tvar task = store.getItem(dnd.config.id);\n\t\tdnd.config.level = store.calculateItemLevel(task);\n\t\tdnd.config.drop_target = dropTarget.createDropTargetObject({\n\t\t\ttargetParent: store.getParent(task.id),\n\t\t\ttargetIndex: store.getBranchIndex(task.id),\n\t\t\ttargetId: task.id,\n\t\t\tnextSibling: true\n\t\t});\n\n\t\ttask.$open = false;\n\t\ttask.$transparent = true;\n\t\tthis.refreshData();\n\t}, gantt));\n\n\tfunction getTargetTaskId(e){\n\t\tvar y = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\n\t\tvar store = grid.$config.rowStore;\n\n\t\tif (!document.doctype){\n\t\t\ty += window.scrollY;\n\t\t}\n\t\ty = y || 0;\n\n\t\t// limits for the marker according to the layout layer\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos + window.scrollY;\n\t\tvar minTop = scrollPos;\n\n\t\tvar firstVisibleTaskIndex = grid.getItemIndexByTopPosition(grid.$state.scrollTop);\n\t\tif (!store.exists(firstVisibleTaskIndex)){\n\t\t\tfirstVisibleTaskIndex = store.countVisible() - 1;\n\t\t}\n\t\tif (firstVisibleTaskIndex < 0) {\n\t\t\treturn store.$getRootId();\n\t\t}\n\n\t\tvar firstVisibleTaskId = store.getIdByIndex(firstVisibleTaskIndex);\n\n\t\tvar firstVisibleTaskPos = grid.$state.scrollTop / grid.getItemHeight(firstVisibleTaskId);\n\t\tvar hiddenTaskPart = firstVisibleTaskPos - Math.floor(firstVisibleTaskPos);\n\t\tif (hiddenTaskPart > 0.1 && hiddenTaskPart < 0.9) {\n\t\t\tmaxBottom = maxBottom - grid.getItemHeight(firstVisibleTaskId) * hiddenTaskPart;\n\t\t\tminTop = minTop + grid.getItemHeight(firstVisibleTaskId) * (1 - hiddenTaskPart);\n\t\t}\n\n\t\t// GS-715. The placeholder task row shouldn't be draggable below the Gantt container\n\t\tconst gridPosition = domHelpers.getNodePosition(grid.$grid_data);\n\t\tconst gridBottom = gridPosition.y + gridPosition.height;\n\t\tconst placeholderRowHeight = dnd.config.marker.offsetHeight;\n\t\tif (y + placeholderRowHeight + window.scrollY >= maxBottom){\n\t\t\tdnd.config.marker.style.top = gridBottom - placeholderRowHeight\t+ \"px\";\n\t\t}\n\n\t\tif (y >= maxBottom) {\n\t\t\ty = maxBottom;\n\t\t} else if (y <= minTop) {\n\t\t\ty = minTop;\n\t\t\tdnd.config.marker.style.top = gridPosition.y + \"px\";\n\t\t}\n\n\t\tvar index = grid.getItemIndexByTopPosition(y);\n\n\t\tif (index > store.countVisible() - 1 || index < 0) {\n\t\t\treturn store.$getRootId();\n\t\t}\n\n\t\tvar targetId = store.getIdByIndex(index);\n\t\tif (checkPlaceholderTask(targetId)) {\n\t\t\treturn store.getPrevSibling(targetId);\n\t\t}\n\n\t\treturn store.getIdByIndex(index);\n\t}\n\n\tfunction getDropPosition(e){\n\t\tvar targetTaskId = getTargetTaskId(e);\n\t\tvar relTargetPos = null;\n\t\tvar store = grid.$config.rowStore;\n\t\tvar config = grid.$getConfig();\n\t\tvar lockLevel = !config.order_branch_free;\n\n\t\tvar eventTop = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\n\t\tif (!document.doctype){\n\t\t\teventTop += window.scrollY;\n\t\t}\n\n\t\tif(targetTaskId !== store.$getRootId()) {\n\t\t\tvar rowTop = grid.getItemTop(targetTaskId);\n\t\t\tvar rowHeight = grid.getItemHeight(targetTaskId);\n\t\t\trelTargetPos = (eventTop - rowTop) / rowHeight;\n\t\t}\n\n\t\tvar result;\n\t\tif(!lockLevel){\n\t\t\tresult = getMultiLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store);\n\t\t}else{\n\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\n\t\t\tif(result && result.targetParent && checkPlaceholderTask(result.targetParent)){\n\t\t\t\ttargetTaskId = store.getPrevSibling(result.targetParent);\n\t\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\n\t\tvar target = getDropPosition(e);\n\n\t\tif(!target ||\n\t\t\tgantt.callEvent(\"onBeforeRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]) === false){\n\t\t\t\ttarget = dropTarget.createDropTargetObject(dnd.config.drop_target);\n\t\t\t}\n\n\t\thiglighter.highlightPosition(target, dnd.config, grid);\n\t\tdnd.config.drop_target = target;\n\t\tgantt._waiAria.reorderMarkerAttr(dnd.config.marker);\n\n\t\tthis.callEvent(\"onRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]);\n\t\treturn true;\n\t}, gantt));\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\n\t\tvar store = grid.$config.rowStore;\n\t\tvar task = store.getItem(dnd.config.id);\n\n\t\thiglighter.removeLineHighlight(dnd.config);\n\n\t\ttask.$transparent = false;\n\t\ttask.$open = dnd.config.initial_open_state;\n\t\tvar target = dnd.config.drop_target;\n\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]) === false) {\n\t\t\ttask.$drop_target = null;\n\t\t} else {\n\t\t\tstore.move(dnd.config.id, target.targetIndex, target.targetParent);\n\t\t\tgantt.render();\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]);\n\t\t}\n\t\tstore.refresh(task.id);\n\t}, gantt));\n}\n\nexport default {\n\tinit: _init_dnd\n};","/**\n * resolve dnd position of the task when gantt.config.order_branch_free = true\n */\n\nimport dropTarget from \"./drop_target\";\n\nexport default function getMultiLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store){\n\tvar result;\n\n\tif(targetTaskId !== store.$getRootId()){\n\t\tif(relTargetPos < 0.25){\n\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t}else if(relTargetPos > 0.60 && !(store.hasChild(targetTaskId) && store.getItem(targetTaskId).$open)){\n\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t}else {\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, targetTaskId, store);\n\t\t}\n\t}else{\n\t\tvar rootId = store.$getRootId();\n\t\tif(store.hasChild(rootId) && eventTop >= 0){\n\t\t\tresult = dropTarget.lastChildTarget(dndTaskId, rootId, store);\n\t\t}else{\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, rootId, store);\n\t\t}\n\t}\n\n\treturn result;\n};","import * as utils from \"../../../utils/utils\";\nimport rowDnd from \"./tasks_grid_dnd\";\nimport rowDndMarker from \"./tasks_grid_dnd_marker\";\nimport mouseEventContainer from \"../mouse_event_container\";\n\nvar initializer = (function(){\n\treturn function(gantt){\n\t\treturn {\n\t\t\tonCreated: function (grid) {\n\t\t\t\tgrid.$config = utils.mixin(grid.$config, {\n\t\t\t\t\tbind: \"task\"\n\t\t\t\t});\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\tthis.extendGantt(grid);\n\t\t\t\t\tgantt.ext.inlineEditors = gantt.ext._inlineEditors.createEditors(grid);\n\t\t\t\t\tgantt.ext.inlineEditors.init();\n\t\t\t\t}\n\n\t\t\t\tthis._mouseDelegates = mouseEventContainer(gantt);\n\t\t\t},\n\t\t\tonInitialized: function (grid) {\n\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\tif (config.order_branch) {\n\t\t\t\t\tif(config.order_branch == \"marker\"){\n\t\t\t\t\t\trowDndMarker.init(grid.$gantt, grid);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trowDnd.init(grid.$gantt, grid);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.initEvents(grid, gantt);\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\tthis.extendDom(grid);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonDestroyed: function (grid) {\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\t// GS-1288. We need to only detach the store and its events without detaching the\n\t\t\t\t\t// inline editor's events. Otherwise, we won't be able to access them\n\t\t\t\t\tgantt.ext.inlineEditors.detachStore();\n\t\t\t\t}\n\t\t\t\tthis.clearEvents(grid, gantt);\n\t\t\t},\n\n\t\t\tinitEvents: function (grid, gantt) {\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_row\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\t\tif (id !== null) {\n\t\t\t\t\t\tvar task = this.getTask(id);\n\t\t\t\t\t\tif (config.scroll_on_click && !gantt._is_icon_open_click(e))\n\t\t\t\t\t\t\tthis.showDate(task.start_date);\n\t\t\t\t\t\tgantt.callEvent(\"onTaskRowClick\", [id, trg]);\n\t\t\t\t\t}\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_grid_head_cell\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar column = trg.getAttribute(\"data-column-id\");\n\n\t\t\t\t\tif (!gantt.callEvent(\"onGridHeaderClick\", [column, e]))\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar config = grid.$getConfig();\n\n\t\t\t\t\tif (column == \"add\") {\n\t\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\t\t\t\tmouseEvents.callHandler(\"click\", \"gantt_add\", grid.$grid, [e, config.root_id]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (config.sort && column) { // GS-929: if there is no column name, we cannot sort the column\n\t\t\t\t\t\tvar sorting_method = column,\n\t\t\t\t\t\t\tconf;\n\n\t\t\t\t\t\tfor (var i = 0; i < config.columns.length; i++) {\n\t\t\t\t\t\t\tif (config.columns[i].name == column) {\n\t\t\t\t\t\t\t\tconf = config.columns[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (conf && conf.sort !== undefined && conf.sort !== true) {\n\t\t\t\t\t\t\tsorting_method = conf.sort;\n\n\t\t\t\t\t\t\tif (!sorting_method) { // column sort property 'false', no sorting\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar sort = (this._sort && this._sort.direction && this._sort.name == column) ? this._sort.direction : \"desc\";\n\t\t\t\t\t\t// invert sort direction\n\t\t\t\t\t\tsort = (sort == \"desc\") ? \"asc\" : \"desc\";\n\t\t\t\t\t\tthis._sort = {\n\t\t\t\t\t\t\tname: column,\n\t\t\t\t\t\t\tdirection: sort\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.sort(sorting_method, sort == \"desc\");\n\t\t\t\t\t}\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_add\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\t\tif (config.readonly) return;\n\n\t\t\t\t\tvar item = {};\n\t\t\t\t\tthis.createTask(item, id ? id : gantt.config.root_id);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t},\n\n\t\t\tclearEvents: function(grid, gantt){\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t},\n\n\t\t\textendDom: function(grid){\n\t\t\t\tgantt.$grid = grid.$grid;\n\t\t\t\tgantt.$grid_scale = grid.$grid_scale;\n\t\t\t\tgantt.$grid_data = grid.$grid_data;\n\t\t\t},\n\t\t\textendGantt: function(grid){\n\t\t\t\tgantt.getGridColumns = gantt.bind(grid.getGridColumns, grid);\n\n\t\t\t\tgrid.attachEvent(\"onColumnResizeStart\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeStart\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onColumnResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onColumnResizeEnd\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeEnd\", arguments);\n\t\t\t\t});\n\n\t\t\t\tgrid.attachEvent(\"onColumnResizeComplete\", function(columns, totalWidth){\n\t\t\t\t\tgantt.config.grid_width = totalWidth;\n\t\t\t\t});\n\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onRowResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResizeEnd\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResizeEnd\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onAfterRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onAfterRowResize\", arguments);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t};\n})();\n\nexport default initializer;","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport timeout from \"../../../utils/timeout\";\nimport * as helpers from \"../../../utils/helpers\";\n\nfunction createTaskDND(timeline, gantt) {\n\tvar services = gantt.$services;\n\treturn {\n\t\tdrag: null,\n\t\tdragMultiple: {},\n\t\t_events: {\n\t\t\tbefore_start: {},\n\t\t\tbefore_finish: {},\n\t\t\tafter_finish: {}\n\t\t},\n\t\t_handlers: {},\n\t\tinit: function() {\n\t\t\tthis._domEvents = gantt._createDomEventScope();\n\t\t\tthis.clear_drag_state();\n\t\t\tvar drag = gantt.config.drag_mode;\n\t\t\tthis.set_actions();\n\n\t\t\tvar stateService = services.getService(\"state\");\n\t\t\tstateService.registerProvider(\"tasksDnd\", utils.bind(function() {\n\t\t\t\treturn {\n\t\t\t\t\tdrag_id : this.drag ? this.drag.id : undefined,\n\t\t\t\t\tdrag_mode : this.drag ? this.drag.mode : undefined,\n\t\t\t\t\tdrag_from_start : this.drag ? this.drag.left : undefined\n\t\t\t\t};\n\t\t\t}, this));\n\n\t\t\tvar evs = {\n\t\t\t\t\"before_start\": \"onBeforeTaskDrag\",\n\t\t\t\t\"before_finish\": \"onBeforeTaskChanged\",\n\t\t\t\t\"after_finish\": \"onAfterTaskDrag\"\n\t\t\t};\n\t\t\t//for now, all drag operations will trigger the same events\n\t\t\tfor (var stage in this._events) {\n\t\t\t\tfor (var mode in drag) {\n\t\t\t\t\tthis._events[stage][mode] = evs[stage];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._handlers[drag.move] = this._move;\n\t\t\tthis._handlers[drag.resize] = this._resize;\n\t\t\tthis._handlers[drag.progress] = this._resize_progress;\n\t\t},\n\t\tset_actions: function() {\n\t\t\tvar data = timeline.$task_data;\n\t\t\tthis._domEvents.attach(data, \"mousemove\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_move(e);\n\t\t\t}, this));\n\t\t\tthis._domEvents.attach(data, \"mousedown\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_down(e);\n\t\t\t}, this));\n\t\t\tthis._domEvents.attach(document.body, \"mouseup\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_up(e);\n\t\t\t}, this));\n\t\t},\n\n\t\tclear_drag_state: function() {\n\t\t\tthis.drag = {\n\t\t\t\tid: null,\n\t\t\t\tmode: null,\n\t\t\t\tpos: null,\n\t\t\t\tstart_x: null,\n\t\t\t\tstart_y: null,\n\t\t\t\tobj: null,\n\t\t\t\tleft: null\n\t\t\t};\n\t\t\tthis.dragMultiple = {};\n\t\t},\n\t\t_resize: function(task, shift, drag) {\n\t\t\tvar cfg = timeline.$getConfig();\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\tif (drag.left) {\n\t\t\t\ttask.start_date = gantt.dateFromPos(coords_x.start + shift);\n\t\t\t\tif (!task.start_date) {\n\t\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttask.end_date = gantt.dateFromPos(coords_x.end + shift);\n\t\t\t\tif (!task.end_date) {\n\t\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar minDurationInUnits = this._calculateMinDuration(cfg.min_duration, cfg.duration_unit);\n\t\t\tif (task.end_date - task.start_date < cfg.min_duration) {\n\t\t\t\tif (drag.left)\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate(task.end_date, -minDurationInUnits, cfg.duration_unit, task);\n\t\t\t\telse\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate(task.start_date, minDurationInUnits, cfg.duration_unit, task);\n\t\t\t}\n\t\t\tgantt._init_task_timing(task);\n\t\t},\n\t\t_calculateMinDuration: function(duration, unit) {\n\t\t\tvar inMs = {\n\t\t\t\t\"minute\": 60000,\n\t\t\t\t\"hour\": 3600000,\n\t\t\t\t\"day\": 86400000,\n\t\t\t\t\"week\": 604800000,\n\t\t\t\t\"month\": 2419200000,\n\t\t\t\t\"year\": 31356000000\n\t\t\t};\n\t\t\treturn Math.ceil(duration / inMs[unit]);\n\t\t},\n\t\t_resize_progress: function(task, shift, drag) {\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar diffValue = !config.rtl ? (drag.pos.x - coords_x.start) : (coords_x.start - drag.pos.x);\n\n\t\t\tvar diff = Math.max(0, diffValue);\n\t\t\ttask.progress = Math.min(1, diff / Math.abs(coords_x.end - coords_x.start));\n\t\t},\n\t\t_find_max_shift: function(dragItems, shift) {\n\t\t\tvar correctShift;\n\t\t\tfor (var i in dragItems) {\n\t\t\t\tvar drag = dragItems[i];\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\n\t\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\t\tvar minX = gantt.posFromDate(new Date(gantt.getState().min_date));\n\t\t\t\tvar maxX = gantt.posFromDate(new Date(gantt.getState().max_date));\n\n\t\t\t\tif (coords_x.end + shift > maxX) {\n\t\t\t\t\tvar maxShift = maxX - coords_x.end;\n\t\t\t\t\tif (maxShift < correctShift || correctShift === undefined) {\n\t\t\t\t\t\tcorrectShift = maxShift;\n\t\t\t\t\t}\n\t\t\t\t} else if (coords_x.start + shift < minX) {\n\t\t\t\t\tvar minShift = minX - coords_x.start;\n\t\t\t\t\tif (minShift > correctShift || correctShift === undefined) {\n\t\t\t\t\t\tcorrectShift = minShift;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn correctShift;\n\t\t},\n\t\t_move: function(task, shift, drag, multipleDragShift) {\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\tvar new_start = null,\n\t\t\tnew_end = null;\n\t\t\t// GS-454: If we drag multiple tasks, rely on the dates instead of timeline coordinates\n\t\t\tif (multipleDragShift){\n\t\t\t\tnew_start = new Date(+drag.obj.start_date + multipleDragShift),\n\t\t\t\tnew_end = new Date(+drag.obj.end_date + multipleDragShift);\n\t\t\t} else {\n\t\t\t\tnew_start = gantt.dateFromPos(coords_x.start + shift),\n\t\t\t\tnew_end = gantt.dateFromPos(coords_x.end + shift);\n\t\t\t}\n\t\t\tif (!new_start) {\n\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\n\t\t\t\ttask.end_date = gantt.dateFromPos(gantt.posFromDate(task.start_date) + (coords_x.end - coords_x.start));\n\t\t\t} else if (!new_end) {\n\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\n\t\t\t\ttask.start_date = gantt.dateFromPos(gantt.posFromDate(task.end_date) - (coords_x.end - coords_x.start));\n\t\t\t} else {\n\t\t\t\ttask.start_date = new_start;\n\t\t\t\ttask.end_date = new_end;\n\t\t\t}\n\t\t},\n\t\t_drag_task_coords: function(t, drag) {\n\t\t\tvar start = drag.obj_s_x = drag.obj_s_x || gantt.posFromDate(t.start_date);\n\t\t\tvar end = drag.obj_e_x = drag.obj_e_x || gantt.posFromDate(t.end_date);\n\t\t\treturn {\n\t\t\t\tstart: start,\n\t\t\t\tend: end\n\t\t\t};\n\t\t},\n\t\t_mouse_position_change: function(oldPos, newPos) {\n\t\t\tvar dx = oldPos.x - newPos.x,\n\t\t\t\tdy = oldPos.y - newPos.y;\n\t\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t\t},\n\t\t_is_number: function(n) {\n\t\t\treturn !isNaN(parseFloat(n)) && isFinite(n);\n\t\t},\n\n\t\ton_mouse_move: function(e) {\n\t\t\tif (this.drag.start_drag) {\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\n\t\t\t\tvar sX = this.drag.start_drag.start_x,\n\t\t\t\t\tsY = this.drag.start_drag.start_y;\n\n\t\t\t\tif ((Date.now() - this.drag.timestamp > 50) ||\n\t\t\t\t\t(this._is_number(sX) && this._is_number(sY) && this._mouse_position_change({\n\t\t\t\t\t\tx: sX,\n\t\t\t\t\t\ty: sY\n\t\t\t\t\t}, pos) > 20)) {\n\t\t\t\t\tthis._start_dnd(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar drag = this.drag;\n\n\t\t\tif (drag.mode) {\n\t\t\t\tif (!timeout(this, 40))//limit update frequency\n\t\t\t\t\treturn;\n\n\t\t\t\tthis._update_on_move(e);\n\n\t\t\t}\n\t\t},\n\n\t\t_update_item_on_move: function(shift, id, mode, drag, e, multipleDragShift) {\n\t\t\tvar task = gantt.getTask(id);\n\t\t\tvar original = gantt.mixin({}, task);\n\t\t\tvar copy = gantt.mixin({}, task);\n\t\t\tthis._handlers[mode].apply(this, [copy, shift, drag, multipleDragShift]);\n\t\t\tgantt.mixin(task, copy, true);\n\t\t\t//gantt._update_parents(drag.id, true);\n\t\t\tgantt.callEvent(\"onTaskDrag\", [task.id, mode, copy, original, e]);\n\t\t\tgantt.mixin(task, copy, true);\n\t\t\tgantt.refreshTask(id);\n\t\t},\n\n\t\t_update_on_move: function(e) {\n\t\t\tvar drag = this.drag;\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tif (drag.mode) {\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\n\t\t\t\tif (drag.pos && drag.pos.x == pos.x)\n\t\t\t\t\treturn;\n\n\t\t\t\tdrag.pos = pos;\n\n\t\t\t\tvar curr_date = gantt.dateFromPos(pos.x);\n\t\t\t\tif (!curr_date || isNaN(curr_date.getTime()))\n\t\t\t\t\treturn;\n\n\n\t\t\t\tvar shift = pos.x - drag.start_x;\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\t\t\t\tif (this._handlers[drag.mode]) {\n\t\t\t\t\tif (drag.mode === config.drag_mode.move) {\n\t\t\t\t\t\tvar dragHash = {};\n\n\t\t\t\t\t\tif (this._isMultiselect()) {\n\t\t\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\n\t\t\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\n\t\t\t\t\t\t\t\tdragHash = this.dragMultiple;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar dragProject = false;\n\t\t\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project) {\n\t\t\t\t\t\t\tvar initialDrag = {};\n\t\t\t\t\t\t\tinitialDrag[drag.id] = utils.copy(drag);\n\t\t\t\t\t\t\tdragProject = true;\n\t\t\t\t\t\t\tdragHash = utils.mixin(initialDrag, this.dragMultiple);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar maxShift = this._find_max_shift(dragHash, shift);\n\t\t\t\t\t\tif (maxShift !== undefined) {\n\t\t\t\t\t\t\tshift = maxShift;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\n\n\t\t\t\t\t\tfor (var i in dragHash) {\n\t\t\t\t\t\t\tvar childDrag =  dragHash[i];\n\t\t\t\t\t\t\tif(dragProject && childDrag.id != drag.id){\n\t\t\t\t\t\t\t\tgantt._bulk_dnd = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// GS-454: Calculate the date shift in milliseconds instead of pixels\n\t\t\t\t\t\t\tif (maxShift === undefined && (dragProject || Object.keys(dragHash).length > 1)) {\n\t\t\t\t\t\t\t\tvar shiftDate = gantt.dateFromPos(drag.start_x);\n\t\t\t\t\t\t\t\tvar multipleDragShift = curr_date - shiftDate;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._update_item_on_move(shift, childDrag.id, childDrag.mode, childDrag, e, multipleDragShift);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt._bulk_dnd = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// for resize and progress\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\n\t\t\t\t\t}\n\t\t\t\t\tgantt._update_parents(drag.id);\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\ton_mouse_down: function(e, src) {\n\t\t\t// on Mac we do not get onmouseup event when clicking right mouse button leaving us in dnd state\n\t\t\t// let's ignore right mouse button then\n\t\t\tif (e.button == 2 && e.button !== undefined)\n\t\t\t\treturn;\n\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar id = gantt.locate(e);\n\t\t\tvar task = null;\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\ttask = gantt.getTask(id);\n\t\t\t}\n\n\t\t\tif (gantt.isReadonly(task) || this.drag.mode) return;\n\n\t\t\tthis.clear_drag_state();\n\n\t\t\tsrc = src || (e.target || e.srcElement);\n\n\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\tvar drag = this._get_drag_mode(className, src);\n\n\t\t\tif (!className || !drag) {\n\t\t\t\tif (src.parentNode)\n\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\n\t\t\t\telse\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!drag) {\n\t\t\t\tif (gantt.checkEvent(\"onMouseDown\") && gantt.callEvent(\"onMouseDown\", [className.split(\" \")[0]])) {\n\t\t\t\t\tif (src.parentNode)\n\t\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\n\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (drag.mode && drag.mode != config.drag_mode.ignore && config[\"drag_\" + drag.mode]) {\n\t\t\t\t\tid = gantt.locate(src);\n\t\t\t\t\ttask = gantt.copy(gantt.getTask(id) || {});\n\n\t\t\t\t\tif (gantt.isReadonly(task)) {\n\t\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && !(task.auto_scheduling === false) && !config.drag_project) && drag.mode != config.drag_mode.progress) {//only progress drag is allowed for tasks with flexible duration\n\t\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdrag.id = id;\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\n\t\t\t\t\tdrag.start_x = pos.x;\n\t\t\t\t\tdrag.start_y = pos.y;\n\t\t\t\t\tdrag.obj = task;\n\t\t\t\t\tthis.drag.start_drag = drag;\n\t\t\t\t\tthis.drag.timestamp = Date.now();\n\n\t\t\t\t} else\n\t\t\t\t\tthis.clear_drag_state();\n\t\t\t}\n\t\t},\n\t\t_fix_dnd_scale_time: function(task, drag) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar unit = gantt.getScale().unit,\n\t\t\t\tstep = gantt.getScale().step;\n\t\t\tif (!config.round_dnd_dates) {\n\t\t\t\tunit = 'minute';\n\t\t\t\tstep = config.time_step;\n\t\t\t}\n\n\t\t\tfunction fixStart(task) {\n\t\t\t\tif (!gantt.config.correct_work_time)\n\t\t\t\t\treturn;\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\tif (!gantt.isWorkTime(task.start_date, undefined, task))\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\tduration: -1,\n\t\t\t\t\t\tunit: config.duration_unit,\n\t\t\t\t\t\ttask: task\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction fixEnd(task) {\n\t\t\t\tif (!gantt.config.correct_work_time)\n\t\t\t\t\treturn;\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\tif (!gantt.isWorkTime(new Date(task.end_date - 1), undefined, task))\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\t\tduration: 1,\n\t\t\t\t\t\tunit: config.duration_unit,\n\t\t\t\t\t\ttask: task\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (drag.mode == config.drag_mode.resize) {\n\t\t\t\tif (drag.left) {\n\t\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\n\t\t\t\t\tfixStart(task);\n\t\t\t\t} else {\n\t\t\t\t\ttask.end_date = gantt.roundDate({date: task.end_date, unit: unit, step: step});\n\t\t\t\t\tfixEnd(task);\n\t\t\t\t}\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\n\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\n\t\t\t\tfixStart(task);\n\t\t\t\ttask.end_date = gantt.calculateEndDate(task);\n\t\t\t}\n\t\t},\n\t\t_fix_working_times: function(task, drag) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar drag = drag || {mode: config.drag_mode.move};\n\n\t\t\tif (drag.mode == config.drag_mode.resize) {\n\t\t\t\tif (drag.left) {\n\t\t\t\t\ttask.start_date = gantt.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\n\t\t\t\t} else {\n\t\t\t\t\ttask.end_date = gantt.getClosestWorkTime({date: task.end_date, dir: 'past', task: task});\n\t\t\t\t}\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\n\t\t\t\tgantt.correctTaskWorkTime(task);\n\t\t\t}\n\t\t},\n\n\t\t_finalize_mouse_up: function(taskId, config, drag, e) {\n\t\t\tvar task = gantt.getTask(taskId);\n\n\t\t\tif (config.work_time && config.correct_work_time) {\n\t\t\t\tthis._fix_working_times(task, drag);\n\t\t\t}\n\n\t\t\tthis._fix_dnd_scale_time(task, drag);\n\n\t\t\tif (!this._fireEvent(\"before_finish\", drag.mode, [taskId, drag.mode, gantt.copy(drag.obj), e])) {\n\t\t\t\t//drag.obj._dhx_changed = false;\n\t\t\t\tthis.clear_drag_state();\n\t\t\t\tif (taskId == drag.id) {\n\t\t\t\t\tdrag.obj._dhx_changed = false;\n\t\t\t\t\tgantt.mixin(task, drag.obj, true);\n\t\t\t\t}\n\n\n\t\t\t\tgantt.refreshTask(task.id);\n\t\t\t} else {\n\t\t\t\tvar drag_id = taskId;\n\n\t\t\t\tgantt._init_task_timing(task);\n\n\t\t\t\tthis.clear_drag_state();\n\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\tthis._fireEvent(\"after_finish\", drag.mode, [drag_id, drag.mode, e]);\n\t\t\t}\n\n\t\t},\n\n\t\ton_mouse_up: function(e) {\n\n\t\t\tvar drag = this.drag;\n\t\t\tif (drag.mode && drag.id) {\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\t//drop\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\t\t\t\tvar dragMultiple = this.dragMultiple;\n\n\t\t\t\tvar finalizingBulkMove = false;\n\t\t\t\tvar moveCount = 0;\n\t\t\t\tif (drag.mode === config.drag_mode.move) {\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && config.drag_project) || (this._isMultiselect())) {\n\t\t\t\t\t\tfinalizingBulkMove = true;\n\t\t\t\t\t\tmoveCount = Object.keys(dragMultiple).length;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar doFinalize = function doFinalize(){\n\t\t\t\t\tif(finalizingBulkMove){\n\t\t\t\t\t\tfor (var i in dragMultiple) {\n\t\t\t\t\t\t\t// GS-1057: Don't call drag events for the dragged task as they will be called later\n\t\t\t\t\t\t\tif (dragMultiple[i].id != drag.id){\n\t\t\t\t\t\t\t\tthis._finalize_mouse_up(dragMultiple[i].id, config, dragMultiple[i], e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._finalize_mouse_up(drag.id, config, drag, e);\n\n\t\t\t\t};\n\n\t\t\t\tif(finalizingBulkMove && moveCount > 10){// 10 - arbitrary threshold for bulk dnd at which we start doing complete repaint to refresh\n\t\t\t\t\tgantt.batchUpdate(function(){\n\t\t\t\t\t\tdoFinalize.call(this);\n\t\t\t\t\t}.bind(this));\n\t\t\t\t}else{\n\t\t\t\t\tdoFinalize.call(this);\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis.clear_drag_state();\n\t\t},\n\t\t_get_drag_mode: function(className, el) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar modes = config.drag_mode;\n\t\t\tvar classes = (className || \"\").split(\" \");\n\t\t\tvar classname = classes[0];\n\t\t\tvar drag = {mode: null, left: null};\n\t\t\tswitch (classname) {\n\t\t\t\tcase \"gantt_task_line\":\n\t\t\t\tcase \"gantt_task_content\":\n\t\t\t\t\tdrag.mode = modes.move;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_task_drag\":\n\t\t\t\t\tdrag.mode = modes.resize;\n\n\t\t\t\t\tvar dragProperty = el.getAttribute(\"data-bind-property\");\n\n\t\t\t\t\tif (dragProperty == \"start_date\") {\n\t\t\t\t\t\tdrag.left = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdrag.left = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_task_progress_drag\":\n\t\t\t\t\tdrag.mode = modes.progress;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_link_control\":\n\t\t\t\tcase \"gantt_link_point\":\n\t\t\t\t\tdrag.mode = modes.ignore;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdrag = null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn drag;\n\n\t\t},\n\n\t\t_start_dnd: function(e) {\n\t\t\tvar drag = this.drag = this.drag.start_drag;\n\t\t\tdelete drag.start_drag;\n\n\t\t\tvar cfg = timeline.$getConfig();\n\t\t\tvar id = drag.id;\n\n\t\t\tif (!cfg[\"drag_\" + drag.mode] || !gantt.callEvent(\"onBeforeDrag\", [id, drag.mode, e]) || !this._fireEvent(\"before_start\", drag.mode, [id, drag.mode, e])) {\n\t\t\t\tthis.clear_drag_state();\n\t\t\t} else {\n\t\t\t\tdelete drag.start_drag;\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (gantt.isReadonly(task)){\n\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this._isMultiselect()) {\n\t\t\t\t\t// for don't move selected tasks when drag unselected task\n\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\n\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\n\t\t\t\t\t\thelpers.forEach(selectedTasksIds, gantt.bind(function(taskId) {\n\t\t\t\t\t\t\tvar selectedTask = gantt.getTask(taskId);\n\t\t\t\t\t\t\tif (gantt.isSummaryTask(selectedTask) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\n\t\t\t\t\t\t\t\tthis._addSubtasksToDragMultiple(selectedTask.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.dragMultiple[taskId] = gantt.mixin({\n\t\t\t\t\t\t\t\tid: selectedTask.id,\n\t\t\t\t\t\t\t\tobj: gantt.copy(selectedTask)\n\t\t\t\t\t\t\t}, this.drag);\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// for move unselected summary\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\n\t\t\t\t\tthis._addSubtasksToDragMultiple(task.id);\n\t\t\t\t}\n\t\t\t\tgantt.callEvent(\"onTaskDragStart\", []);\n\t\t\t}\n\n\t\t},\n\t\t_fireEvent: function(stage, mode, params) {\n\t\t\tgantt.assert(this._events[stage], \"Invalid stage:{\" + stage + \"}\");\n\n\t\t\tvar trigger = this._events[stage][mode];\n\n\t\t\tgantt.assert(trigger, \"Unknown after drop mode:{\" + mode + \"}\");\n\t\t\tgantt.assert(params, \"Invalid event arguments\");\n\n\n\t\t\tif (!gantt.checkEvent(trigger))\n\t\t\t\treturn true;\n\n\t\t\treturn gantt.callEvent(trigger, params);\n\t\t},\n\n\t\tround_task_dates: function(task) {\n\t\t\tvar drag_state = this.drag;\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tif (!drag_state) {\n\t\t\t\tdrag_state = {mode: config.drag_mode.move};\n\t\t\t}\n\t\t\tthis._fix_dnd_scale_time(task, drag_state);\n\t\t},\n\t\tdestructor: function() {\n\t\t\tthis._domEvents.detachAll();\n\t\t},\n\t\t_isMultiselect: function() {\n\t\t\treturn gantt.config.drag_multiple && !!(gantt.getSelectedTasks && gantt.getSelectedTasks().length > 0);\n\t\t},\n\t\t_addSubtasksToDragMultiple: function(summaryId) {\n\t\t\tgantt.eachTask(function(child) {\n\t\t\t\tthis.dragMultiple[child.id] = gantt.mixin({\n\t\t\t\t\tid: child.id,\n\t\t\t\t\tobj: gantt.copy(child)\n\t\t\t\t}, this.drag);\n\t\t\t}, summaryId, this);\n\t\t}\n\t};\n}\n\nfunction initTaskDND() {\n\tvar _tasks_dnd;\n\treturn {\n\t\textend: function(timeline) {\n\t\t\ttimeline.roundTaskDates = function(task) {\n\t\t\t\t_tasks_dnd.round_task_dates(task);\n\t\t\t};\n\n\t\t},\n\t\tinit: function(timeline, gantt) {\n\t\t\t_tasks_dnd = createTaskDND(timeline, gantt);\n\t\t\t// TODO: entry point for touch handlers, move touch to timeline\n\t\t\ttimeline._tasks_dnd = _tasks_dnd;\n\t\t\treturn _tasks_dnd.init(gantt);\n\t\t},\n\t\tdestructor: function() {\n\t\t\tif (_tasks_dnd) {\n\t\t\t\t_tasks_dnd.destructor();\n\t\t\t\t_tasks_dnd = null;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tcreateTaskDND: initTaskDND\n};","import * as domHelpers from \"../utils/dom_helpers\";\n\nvar initLinksDND = function(timeline, gantt) {\n\tvar _link_landing,\n\t\t_link_target_task,\n\t\t_link_target_task_start,\n\t\t_link_source_task,\n\t\t_link_source_task_start,\n\t\tmarkerDefaultOffset = 10,\n\t\tscrollDefaultSize = 18;\n\n\tfunction getDndState(){\n\t\treturn {\n\t\t\tlink_source_id : _link_source_task,\n\t\t\tlink_target_id : _link_target_task,\n\t\t\tlink_from_start : _link_source_task_start,\n\t\t\tlink_to_start : _link_target_task_start,\n\t\t\tlink_landing_area : _link_landing\n\t\t};\n\t}\n\n\tvar services = gantt.$services;\n\n\tvar state = services.getService(\"state\");\n\tvar DnD = services.getService(\"dnd\");\n\n\tstate.registerProvider(\"linksDnD\", getDndState);\n\n\tvar start_marker = \"task_start_date\",\n\t\tend_marker = \"task_end_date\",\n\t\tlink_edge_marker = \"gantt_link_point\",\n\t\tlink_landing_hover_area = \"gantt_link_control\";\n\n\tvar dnd = new DnD(timeline.$task_bars, {\n\t\tsensitivity : 0,\n\t\tupdates_per_second : 60,\n\t\tmousemoveContainer: gantt.$root,\n\t\tselector: \".\" + link_edge_marker,\n\t\tpreventDefault: true\n\t});\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function(obj,e) {\n\t\tvar target = (e.target||e.srcElement);\n\t\tresetDndState();\n\t\tif(gantt.getState(\"tasksDnd\").drag_id)\n\t\t\treturn false;\n\n\t\tif(domHelpers.locateClassName(target, link_edge_marker)){\n\t\t\tif(domHelpers.locateClassName(target, start_marker))\n\t\t\t\t_link_source_task_start = true;\n\n\t\t\tvar sid = gantt.locate(e);\n\t\t\t_link_source_task = sid;\n\n\t\t\tvar t = gantt.getTask(sid);\n\t\t\tif(gantt.isReadonly(t)){\n\t\t\t\tresetDndState();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._dir_start = {\n\t\t\t\tx: dnd.config.original_element_sizes.x + dnd.config.original_element_sizes.width/2,\n\t\t\t\ty: dnd.config.original_element_sizes.y + dnd.config.original_element_sizes.height/2\n\t\t\t};\n\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\n\t}, this));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function(obj,e) {\n\t\tif(gantt.config.touch) {\n\t\t\tgantt.refreshData();\n\t\t}\n\t\tupdateMarkedHtml(dnd.config.marker);\n\t}, this));\n\n\tfunction getVieportSize(){\n\t\tvar root = gantt.$root;\n\t\treturn { right: root.offsetWidth, bottom: root.offsetHeight };\n\t}\n\tfunction getMarkerSize (marker){\n\t\tvar width = 0, height = 0;\n\t\tif(marker){\n\t\t\twidth = marker.offsetWidth || 0;\n\t\t\theight = marker.offsetHeight || 0;\n\t\t}\n\t\treturn { width: width, height: height };\n\t}\n\n\tfunction getPosition(e, marker){\n\t\tvar oldPos = dnd.getPosition(e);\n\n\t\tvar markerSize = getMarkerSize(marker);\n\t\tvar viewportSize = getVieportSize();\n\n\t\tvar offsetX = gantt.config.tooltip_offset_x || markerDefaultOffset;\n\t\tvar offsetY = gantt.config.tooltip_offset_y || markerDefaultOffset;\n\n\t\tvar scrollSize = gantt.config.scroll_size || scrollDefaultSize;\n\n\t\t// GS-1315: Add offset if there are elements above Gantt\n\t\tvar ganttOffsetY = gantt.$container.getBoundingClientRect().y + window.scrollY;\n\n\t\tvar position = {\n\t\t\ty: oldPos.y + offsetY,\n\t\t\tx: oldPos.x + offsetX,\n\t\t\tbottom: oldPos.y + markerSize.height + offsetY + scrollSize,\n\t\t\tright: oldPos.x + markerSize.width + offsetX + scrollSize\n\t\t};\n\n\t\tif(position.bottom > viewportSize.bottom + ganttOffsetY){\n\t\t\tposition.y = viewportSize.bottom + ganttOffsetY - markerSize.height - offsetY;\n\t\t}\n\n\t\tif(position.right > viewportSize.right){\n\t\t\tposition.x = viewportSize.right - markerSize.width - offsetX;\n\t\t}\n\t\treturn position;\n\t}\n\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function(obj,e) {\n\t\tvar dd = dnd.config;\n\t\tvar pos = getPosition(e, dd.marker);\n\t\tadvanceMarker(dd.marker, pos);\n\t\tvar landing = !!domHelpers.locateClassName(e, link_landing_hover_area);\n\n\t\tvar prevTarget = _link_target_task;\n\t\tvar prevLanding = _link_landing;\n\t\tvar prevToStart = _link_target_task_start;\n\n\t\tvar targ = gantt.locate(e),\n\t\t\tto_start = true;\n\n\t\t// can drag and drop link to another gantt on the page, such links are not supported\n\t\tvar eventTarget = domHelpers.getTargetNode(e);\n\n\t\tvar sameGantt = domHelpers.isChildOf(eventTarget, gantt.$root);\n\t\tif(!sameGantt){\n\t\t\tlanding = false;\n\t\t\ttarg = null;\n\t\t}\n\n\t\tif(landing){\n\t\t\t//refreshTask\n\t\t\tto_start = !domHelpers.locateClassName(e, end_marker);\n\t\t\tlanding = !!targ;\n\t\t}\n\n\t\t_link_target_task = targ;\n\t\t_link_landing = landing;\n\t\t_link_target_task_start = to_start;\n\n\t\tif(landing){\n\n\t\t\tvar node = domHelpers.locateClassName(e, link_landing_hover_area);\n\t\t\n\t\t\tconst point = node.querySelector(`.${link_edge_marker}`);\n\t\t\tif(point){\n\t\t\t\tconst absCoords = domHelpers.getRelativeNodePosition(point, timeline.$task_bg);\n\t\t\t\tthis._dir_end = {\n\t\t\t\t\tx: absCoords.x + point.offsetWidth/2,\n\t\t\t\t\ty: absCoords.y + point.offsetHeight/2\n\t\t\t\t};\n\t\t\t}\n\n\t\t}else{\n\t\t\tthis._dir_end = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\n\t\t\tif(gantt.env.isEdge){ // to fix margin collapsing\n\t\t\t\tthis._dir_end.y += window.scrollY;\n\t\t\t}\n\t\t}\n\n\t\tvar targetChanged = !(prevLanding == landing && prevTarget == targ && prevToStart == to_start);\n\t\tif(targetChanged){\n\t\t\tif(prevTarget)\n\t\t\t\tgantt.refreshTask(prevTarget, false);\n\t\t\tif(targ)\n\t\t\t\tgantt.refreshTask(targ, false);\n\t\t}\n\n\t\tif(targetChanged){\n\t\t\tupdateMarkedHtml(dd.marker);\n\t\t}\n\n\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n\n\t\treturn true;\n\t}, this));\n\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function() {\n\t\tvar drag = getDndState();\n\n\t\tif(drag.link_source_id && drag.link_target_id && drag.link_source_id != drag.link_target_id){\n\t\t\tvar type = gantt._get_link_type(drag.link_from_start, drag.link_to_start);\n\n\t\t\tvar link = {source : drag.link_source_id, target: drag.link_target_id, type:type};\n\t\t\tif(link.type && gantt.isLinkAllowed(link)) {\n\t\t\t\tif(gantt.callEvent(\"onLinkCreated\", [link])){\n\t\t\t\t\tgantt.addLink(link);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tresetDndState();\n\n\t\tif(gantt.config.touch) {\n\t\t\tgantt.refreshData();\n\t\t}\n\t\telse {\n\t\t\tif (drag.link_source_id)\n\t\t\t\tgantt.refreshTask(drag.link_source_id, false);\n\t\t\tif (drag.link_target_id)\n\t\t\t\tgantt.refreshTask(drag.link_target_id, false);\n\t\t}\n\t\tremoveDirectionLine();\n\t}, this));\n\n\tfunction updateMarkedHtml(marker){\n\t\tvar link = getDndState();\n\n\t\tvar css = [\"gantt_link_tooltip\"];\n\t\tif(link.link_source_id && link.link_target_id){\n\t\t\tif(gantt.isLinkAllowed(link.link_source_id, link.link_target_id, link.link_from_start, link.link_to_start)){\n\t\t\t\tcss.push(\"gantt_allowed_link\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"gantt_invalid_link\");\n\t\t\t}\n\t\t}\n\n\t\tvar className = gantt.templates.drag_link_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start);\n\t\tif(className)\n\t\t\tcss.push(className);\n\n\t\tvar html = \"<div class='\"+className+ \"'>\" +\n\t\t\tgantt.templates.drag_link(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start) +\n\t\t\t\"</div>\";\n\t\tmarker.innerHTML = html;\n\t}\n\n\tfunction advanceMarker(marker, pos){\n\t\tmarker.style.left = pos.x + \"px\";\n\t\tmarker.style.top = pos.y + \"px\";\n\t}\n\n\tfunction resetDndState(){\n\t\t_link_source_task =\n\t\t\t_link_source_task_start =\n\t\t\t\t_link_target_task = null;\n\t\t_link_target_task_start = true;\n\t}\n\tfunction showDirectingLine(s_x, s_y, e_x, e_y){\n\t\tvar div = getDirectionLine();\n\n\t\tvar link = getDndState();\n\n\t\tvar css = [\"gantt_link_direction\"];\n\t\tif(gantt.templates.link_direction_class){\n\t\t\tcss.push(gantt.templates.link_direction_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start));\n\t\t}\n\n\t\tvar dist =Math.sqrt( (Math.pow(e_x - s_x, 2)) + (Math.pow(e_y - s_y, 2)) );\n\t\tdist = Math.max(0, dist - 3);\n\t\tif(!dist)\n\t\t\treturn;\n\n\t\tdiv.className = css.join(\" \");\n\t\tvar tan = (e_y - s_y)/(e_x - s_x),\n\t\t\tangle = Math.atan(tan);\n\n\t\tif(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 2){\n\t\t\tangle += Math.PI;\n\t\t}else if(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 3){\n\t\t\tangle -= Math.PI;\n\t\t}\n\n\n\n\t\tvar sin = Math.sin(angle),\n\t\t\tcos = Math.cos(angle),\n\t\t\ttop = Math.round(s_y),\n\t\t\tleft = Math.round(s_x);\n\n\n\t\tvar style = [\n\t\t\t\"-webkit-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-moz-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-ms-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-o-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"width:\" + Math.round(dist) + \"px\"\n\t\t];\n\n\t\tif(window.navigator.userAgent.indexOf(\"MSIE 8.0\") != -1){\n\t\t\t//ms-filter breaks styles in ie9, so add it only for 8th\n\t\t\tstyle.push(\"-ms-filter: \\\"\" + ieTransform(sin, cos) + \"\\\"\");\n\n\t\t\tvar shiftLeft = Math.abs(Math.round(s_x - e_x)),\n\t\t\t\tshiftTop = Math.abs(Math.round(e_y - s_y));\n\t\t\t//fix rotation axis\n\t\t\tswitch(coordinateCircleQuarter(s_x, e_x, s_y, e_y)){\n\t\t\t\tcase 1:\n\t\t\t\t\ttop -= shiftTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tleft -= shiftLeft;\n\t\t\t\t\ttop -= shiftTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tleft -= shiftLeft;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tstyle.push(\"top:\" +  top + \"px\");\n\t\tstyle.push(\"left:\" +  left + \"px\");\n\n\t\tdiv.style.cssText = style.join(\";\");\n\t}\n\n\tfunction ieTransform(sin, cos){\n\t\treturn \"progid:DXImageTransform.Microsoft.Matrix(\"+\n\t\t\t\"M11 = \"+cos+\",\"+\n\t\t\t\"M12 = -\"+sin+\",\"+\n\t\t\t\"M21 = \"+sin+\",\"+\n\t\t\t\"M22 = \"+cos+\",\"+\n\t\t\t\"SizingMethod = 'auto expand'\"+\n\t\t\")\";\n\t}\n\tfunction coordinateCircleQuarter(sX, eX, sY, eY){\n\t\tif(eX >= sX){\n\t\t\tif(eY <= sY){\n\t\t\t\treturn 1;\n\t\t\t}else{\n\t\t\t\treturn 4;\n\t\t\t}\n\t\t}else{\n\t\t\tif(eY <= sY){\n\t\t\t\treturn 2;\n\t\t\t}else{\n\t\t\t\treturn 3;\n\t\t\t}\n\t\t}\n\n\t}\n\tfunction getDirectionLine(){\n\t\tif(!dnd._direction || !dnd._direction.parentNode){\n\t\t\tdnd._direction = document.createElement(\"div\");\n\t\t\ttimeline.$task_links.appendChild(dnd._direction);\n\t\t}\n\t\treturn dnd._direction;\n\t}\n\tfunction removeDirectionLine(){\n\t\tif(dnd._direction){\n\t\t\tif (dnd._direction.parentNode)\t//the event line can be detached because of data refresh\n\t\t\t\tdnd._direction.parentNode.removeChild(dnd._direction);\n\n\t\t\tdnd._direction = null;\n\t\t}\n\t}\n\tgantt.attachEvent(\"onGanttRender\", gantt.bind(function() {\n\t\tif(dnd._direction){\n\t\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n\t\t}\n\t}, this));\n};\n\nexport default {\n\tcreateLinkDND: function(){\n\t\treturn {\n\t\t\tinit: initLinksDND\n\t\t};\n\t}\n};","import * as utils from \"../../../utils/utils\";\nimport taskDnD from \"./tasks_dnd\";\nimport linkDnD from \"./links_dnd\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport MouseDelegates from \"../mouse_event_container\";\n\nvar initializer = (function(){\n\treturn function(gantt){\n\t\tvar services = gantt.$services;\n\t\treturn {\n\t\t\tonCreated: function (timeline) {\n\t\t\t\tvar config = timeline.$config;\n\t\t\t\tconfig.bind = utils.defined(config.bind) ? config.bind : \"task\";\n\t\t\t\tconfig.bindLinks = utils.defined(config.bindLinks) ? config.bindLinks : \"link\";\n\n\t\t\t\ttimeline._linksDnD = linkDnD.createLinkDND();\n\t\t\t\ttimeline._tasksDnD = taskDnD.createTaskDND();\n\t\t\t\ttimeline._tasksDnD.extend(timeline);\n\n\t\t\t\tthis._mouseDelegates = MouseDelegates(gantt);\n\t\t\t},\n\t\t\tonInitialized: function (timeline) {\n\t\t\t\tthis._attachDomEvents(gantt);\n\n\t\t\t\tthis._attachStateProvider(gantt, timeline);\n\n\t\t\t\ttimeline._tasksDnD.init(timeline, gantt);\n\t\t\t\ttimeline._linksDnD.init(timeline, gantt);\n\n\t\t\t\tif(timeline.$config.id == \"timeline\"){\n\t\t\t\t\tthis.extendDom(timeline);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tonDestroyed: function (timeline) {\n\t\t\t\tthis._clearDomEvents(gantt);\n\t\t\t\tthis._clearStateProvider(gantt);\n\t\t\t\tif (timeline._tasksDnD) {\n\t\t\t\t\ttimeline._tasksDnD.destructor();\n\t\t\t\t}\n\t\t\t},\n\t\t\textendDom: function(timeline){\n\t\t\t\tgantt.$task = timeline.$task;\n\t\t\t\tgantt.$task_scale = timeline.$task_scale;\n\t\t\t\tgantt.$task_data = timeline.$task_data;\n\t\t\t\tgantt.$task_bg = timeline.$task_bg;\n\t\t\t\tgantt.$task_links = timeline.$task_links;\n\t\t\t\tgantt.$task_bars = timeline.$task_bars;\n\t\t\t},\n\n\t\t\t_clearDomEvents: function(){\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t},\n\n\t\t\t_attachDomEvents: function(gantt){\n\t\t\t\tfunction _delete_link_handler(id, e) {\n\t\t\t\t\tif (id && this.callEvent(\"onLinkDblClick\", [id, e])) {\n\n\t\t\t\t\t\tvar link = this.getLink(id);\n\t\t\t\t\t\tif (this.isReadonly(link)) return;\n\n\t\t\t\t\t\tvar title = \"\";\n\t\t\t\t\t\tvar question = this.locale.labels.link + \" \" + this.templates.link_description(this.getLink(id)) + \" \" + this.locale.labels.confirm_link_deleting;\n\n\t\t\t\t\t\twindow.setTimeout(function () {\n\t\t\t\t\t\t\tgantt._simple_confirm(question, title, function () {\n\t\t\t\t\t\t\t\tgantt.deleteLink(id);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, (this.config.touch ? 300 : 1));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_task_link\", gantt.bind(function (e, trg) {\n\t\t\t\t\tvar id = this.locate(e, this.config.link_attribute);\n\t\t\t\t\tif (id) {\n\t\t\t\t\t\tthis.callEvent(\"onLinkClick\", [id, e]);\n\t\t\t\t\t}\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_scale_cell\", gantt.bind(function (e, trg) {\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\t\t\t\t\tvar date = gantt.dateFromPos(pos.x);\n\t\t\t\t\tvar coll = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\t\t\tvar coll_date = gantt.getScale().trace_x[coll];\n\n\t\t\t\t\tgantt.callEvent(\"onScaleClick\", [e, coll_date]);\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_task_link\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar id = this.locate(e, gantt.config.link_attribute);\n\t\t\t\t\t_delete_link_handler.call(this, id, e);\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_link_point\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar id = this.locate(e),\n\t\t\t\t\t\ttask = this.getTask(id);\n\n\t\t\t\t\tvar link = null;\n\t\t\t\t\tif (trg.parentNode && domHelpers.getClassName(trg.parentNode)) {\n\t\t\t\t\t\tif (domHelpers.getClassName(trg.parentNode).indexOf(\"_left\") > -1) {\n\t\t\t\t\t\t\tlink = task.$target[0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlink = task.$source[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (link)\n\t\t\t\t\t\t_delete_link_handler.call(this, link, e);\n\t\t\t\t\treturn false;\n\t\t\t\t}, gantt), this.$task);\n\t\t\t},\n\n\t\t\t_attachStateProvider: function(gantt, timeline){\n\t\t\t\tvar self = timeline;\n\t\t\t\tvar state = services.getService(\"state\");\n\t\t\t\tstate.registerProvider(\"tasksTimeline\", function(){\n\t\t\t\t\treturn {\n\t\t\t\t\t\tscale_unit: self._tasks ? self._tasks.unit : undefined,\n\t\t\t\t\t\tscale_step:  self._tasks ? self._tasks.step  : undefined\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_clearStateProvider: function(){\n\t\t\t\tvar state = services.getService(\"state\");\n\t\t\t\tstate.unregisterProvider(\"tasksTimeline\");\n\t\t\t}\n\t\t};\n\t};\n\n})();\n\nexport default initializer;","import * as domHelpers from \"./utils/dom_helpers\";\n\nvar initializer = (function() {\n\treturn function (gantt) {\n\t\treturn {\n\n\t\t\tgetVerticalScrollbar: function(){\n\t\t\t\treturn gantt.$ui.getView(\"scrollVer\");\n\t\t\t},\n\t\t\tgetHorizontalScrollbar: function(){\n\t\t\t\treturn gantt.$ui.getView(\"scrollHor\");\n\t\t\t},\n\n\t\t\t_legacyGridResizerClass: function(layout){\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\n\t\t\t\t\tvar r = resizers[i];\n\t\t\t\t\tvar gridResizer = false;\n\n\t\t\t\t\tvar prev = r.$parent.getPrevSibling(r.$id);\n\t\t\t\t\tif(prev && prev.$config && prev.$config.id === \"grid\"){\n\t\t\t\t\t\tgridResizer= true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar next = r.$parent.getNextSibling(r.$id);\n\t\t\t\t\t\tif(next && next.$config && next.$config.id === \"grid\"){\n\t\t\t\t\t\t\tgridResizer= true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif(gridResizer){\n\t\t\t\t\t\tr.$config.css = (r.$config.css ? r.$config.css + \" \" : \"\") + \"gantt_grid_resize_wrap\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonCreated: function(layout) {\n\t\t\t\tvar first = true;\n\n\t\t\t\tthis._legacyGridResizerClass(layout);\n\n\t\t\t\tlayout.attachEvent(\"onBeforeResize\", function() {\n\t\t\t\t\tvar mainTimeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\t\tif (mainTimeline)\n\t\t\t\t\t\tmainTimeline.$config.hidden = mainTimeline.$parent.$config.hidden = !gantt.config.show_chart;\n\n\t\t\t\t\tvar mainGrid = gantt.$ui.getView(\"grid\");\n\n\t\t\t\t\tif(!mainGrid)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar colsWidth = mainGrid._getColsTotalWidth();\n\t\t\t\t\tvar hideGrid = !gantt.config.show_grid || !gantt.config.grid_width || colsWidth === 0;\n\t\t\t\t\tif (first && !hideGrid && colsWidth !== false){\n\t\t\t\t\t\t\tgantt.config.grid_width = colsWidth;\n\t\t\t\t\t}\n\t\t\t\t\tmainGrid.$config.hidden = mainGrid.$parent.$config.hidden = hideGrid;\n\n\t\t\t\t\tif (!mainGrid.$config.hidden) {\n\t\t\t\t\t\t/* restrict grid width due to min_width, max_width, min_grid_column_width */\n\t\t\t\t\t\tvar grid_limits = mainGrid._getGridWidthLimits();\n\t\t\t\t\t\tif (grid_limits[0] && gantt.config.grid_width < grid_limits[0])\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[0];\n\t\t\t\t\t\tif (grid_limits[1] && gantt.config.grid_width > grid_limits[1])\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[1];\n\t\t\t\t\t\tif (mainTimeline && gantt.config.show_chart){\n\n\t\t\t\t\t\t\tmainGrid.$config.width = gantt.config.grid_width - 1;\n\n\t\t\t\t\t\t\t// GS-1314: Don't let the non-scrollable grid to be larger than the container with the correct width\n\t\t\t\t\t\t\tif (!mainGrid.$config.scrollable && mainGrid.$config.scrollY && gantt.$root.offsetWidth){\n\t\t\t\t\t\t\t\tvar ganttContainerWidth = mainGrid.$gantt.$layout.$container.offsetWidth;\n\t\t\t\t\t\t\t\tvar verticalScrollbar = gantt.$ui.getView(mainGrid.$config.scrollY);\n\t\t\t\t\t\t\t\tvar verticalScrollbarWidth = verticalScrollbar.$config.width;\n\n\t\t\t\t\t\t\t\t// GS-2488: to prevent grid from occupying the whole gantt container(timeline will be disabled) \n\t\t\t\t\t\t\t\t// need to leave min width for timeline\n\t\t\t\t\t\t\t\tvar gridOverflow = ganttContainerWidth - (mainGrid.$config.width + verticalScrollbarWidth) - 4;\n\t\t\t\t\t\t\t\tif (gridOverflow < 0){\n\t\t\t\t\t\t\t\t\tmainGrid.$config.width += gridOverflow;\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width += gridOverflow;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tif (mainTimeline && !domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\n\t\t\t\t\t\t\t\t\t// timeline is being displayed after being not visible, reset grid with from full screen\n\t\t\t\t\t\t\t\t\tif (!mainGrid.$config.original_grid_width) {\n\t\t\t\t\t\t\t\t\t\tvar skinSettings = gantt.skins[gantt.skin];\n\t\t\t\t\t\t\t\t\t\tif(skinSettings && skinSettings.config && skinSettings.config.grid_width){\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width =  skinSettings.config.grid_width;\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = 0;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width = mainGrid.$config.original_grid_width;\n\t\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmainGrid.$parent._setContentSize(mainGrid.$config.width, null);\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: gantt.config.grid_width, isGravity: false});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\n\t\t\t\t\t\t\t\tif (mainGrid.$parent.$config.group) {\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: mainGrid.$parent.$config.width, isGravity: false});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (mainTimeline && domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\n\t\t\t\t\t\t\t\t// hiding timeline, remember grid with to restore it when timeline is displayed again\n\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = gantt.config.grid_width;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfirst = false;\n\t\t\t\t});\n\t\t\t\tthis._initScrollStateEvents(layout);\n\t\t\t},\n\n\t\t\t_initScrollStateEvents: function(layout) {\n\t\t\t\tgantt._getVerticalScrollbar = this.getVerticalScrollbar;\n\t\t\t\tgantt._getHorizontalScrollbar = this.getHorizontalScrollbar;\n\n\t\t\t\tvar vertical = this.getVerticalScrollbar();\n\t\t\t\tvar horizontal = this.getHorizontalScrollbar();\n\t\t\t\tif (vertical) {\n\t\t\t\t\tvertical.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [scrollState.x, oldPos, scrollState.x, newPos]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (horizontal) {\n\t\t\t\t\thorizontal.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [oldPos, scrollState.y, newPos, scrollState.y]);\n\n\t\t\t\t\t\t// if the grid doesn't fit the width, scroll the row container\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tif (grid && grid.$grid_data && !grid.$config.scrollable){\n\t\t\t\t\t\t\tgrid.$grid_data.style.left = grid.$grid.scrollLeft + \"px\";\n\t\t\t\t\t\t\tgrid.$grid_data.scrollLeft = grid.$grid.scrollLeft;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tlayout.attachEvent(\"onResize\", function(){\n\t\t\t\t\tif (vertical && !gantt.$scroll_ver){\n\t\t\t\t\t\tgantt.$scroll_ver = vertical.$scroll_ver;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (horizontal && !gantt.$scroll_hor){\n\t\t\t\t\t\tgantt.$scroll_hor = horizontal.$scroll_hor;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_findGridResizer: function(layout, grid){\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\n\t\t\t\tvar gridFirst = true;\n\t\t\t\tvar gridResizer;\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\n\t\t\t\t\tvar res = resizers[i];\n\t\t\t\t\tres._getSiblings();\n\t\t\t\t\tvar prev = res._behind;\n\t\t\t\t\tvar next = res._front;\n\t\t\t\t\tif(prev && prev.$content === grid || (prev.isChild && prev.isChild(grid))){\n\t\t\t\t\t\tgridResizer = res;\n\t\t\t\t\t\tgridFirst = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else if(next && next.$content === grid || (next.isChild && next.isChild(grid))){\n\t\t\t\t\t\tgridResizer = res;\n\t\t\t\t\t\tgridFirst = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tresizer: gridResizer,\n\t\t\t\t\tgridFirst: gridFirst\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tonInitialized: function (layout) {\n\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\n\t\t\t\tvar resizeInfo = this._findGridResizer(layout, grid);\n\n\t\t\t\t// expose grid resize events\n\t\t\t\tif(resizeInfo.resizer){\n\t\t\t\t\tvar gridFirst = resizeInfo.gridFirst,\n\t\t\t\t\t\tnext = resizeInfo.resizer;\n\t\t\t\t\t\t\n\t\t\t\t\tif(next.$config.mode !== \"x\"){\n\t\t\t\t\t\treturn;// track only horizontal resize\n\t\t\t\t\t}\n\n\t\t\t\t\tvar initialWidth;\n\t\t\t\t\tnext.attachEvent(\"onResizeStart\", function(prevCellWidth, nextCellWidth){\n\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\n\t\t\t\t\t\tif(viewCell){\n\t\t\t\t\t\t\tvar limits = grid._getGridWidthLimits();\n\n\t\t\t\t\t\t\t// min grid width is defined by min widths of its columns, unless grid has horizontal scroll\n\t\t\t\t\t\t\tif(!grid.$config.scrollable)\n\t\t\t\t\t\t\t\tviewCell.$config.minWidth = limits[0];\n\n\t\t\t\t\t\t\tviewCell.$config.maxWidth = limits[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinitialWidth = gridFirst ? prevCellWidth : nextCellWidth;\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResizeStart\", [initialWidth]);\n\t\t\t\t\t});\n\t\t\t\t\tnext.attachEvent(\"onResize\", function(newBehindSize, newFrontSize){\n\t\t\t\t\t\tvar newSize = gridFirst ? newBehindSize : newFrontSize;\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResize\", [initialWidth, newSize]);\n\t\t\t\t\t});\n\t\t\t\t\tnext.attachEvent(\"onResizeEnd\", function(oldBackSize, oldFrontSize, newBackSize, newFrontSize){\n\n\t\t\t\t\t\tvar oldSize = gridFirst ? oldBackSize : oldFrontSize;\n\t\t\t\t\t\tvar newSize = gridFirst ? newBackSize : newFrontSize;\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\n\t\t\t\t\t\tif(viewCell){\n\t\t\t\t\t\t\tviewCell.$config.minWidth = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar res = gantt.callEvent(\"onGridResizeEnd\", [oldSize, newSize]);\n\t\t\t\t\t\tif(res && newSize !== 0){// new size may be numeric zero when cell size is defined by 'gravity', actual size will be calculated by layout later\n\t\t\t\t\t\t\tgantt.config.grid_width = newSize;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tonDestroyed: function (timeline) {\n\n\t\t\t}\n\t\t};\n\n\t};\n})();\n\nexport default initializer;","import uiFactory from \"./ui_factory\";\nimport mouseEvents from \"./mouse\";\nimport createLayers from \"./gantt_layers\";\nimport Cell from \"./layout/cell\";\nimport Layout from \"./layout/layout\";\nimport ViewLayout from \"./layout/view_layout\";\nimport ViewCell from \"./layout/view_cell\";\nimport Resizer from \"./layout/resizer_cell\";\nimport Scrollbar from \"./layout/scrollbar_cell\";\nimport Timeline from \"./timeline/timeline\";\nimport Grid from \"./grid/grid\";\nimport ResourceGrid from \"./grid/resource_grid\";\nimport ResourceTimeline from \"./timeline/resource_timeline\";\nimport ResourceHistogram from \"./timeline/resource_histogram\";\n\n\nimport gridEditorsFactory from \"./grid/editors/controller\";\n\nimport renderTaskBar from \"./render/task_bar_smart_render\";\nimport renderTimedProjectBar from \"./render/task_project_smart_render\";\nimport renderSplitTaskBar from \"./render/task_split_render\";\nimport renderRollupTaskBar from \"./render/task_rollup_render\";\nimport renderTaskBg from \"./render/task_bg_render\";\nimport renderLink from \"./render/link_render\";\nimport gridRenderer from \"./render/task_grid_line_render\";\nimport resourceMatrixRenderer from \"./render/resource_matrix_render\";\nimport resourceHistogramRenderer from \"./render/resource_histogram_render\";\nimport gridTaskRowResizerRenderer from \"./render/task_grid_row_resize_render\";\nimport renderConstraints from \"./render/task_constraints_render\";\nimport renderDeadline from \"./render/task_deadline_render\";\nimport renderBaselines from \"./render/task_baselines_render\";\nimport mainGridInitializer from \"./grid/main_grid_initializer\";\nimport mainTimelineInitializer from \"./timeline/main_timeline_initializer\";\nimport mainLayoutInitializer from \"./main_layout_initializer\";\n\nfunction initUI(gantt){\n\tfunction attachInitializer(view, initializer){\n\t\tvar ext = initializer(gantt);\n\t\tif(ext.onCreated)\n\t\t\text.onCreated(view);\n\t\tview.attachEvent(\"onReady\", function(){\n\t\t\tif(ext.onInitialized)\n\t\t\t\text.onInitialized(view);\n\t\t});\n\t\tview.attachEvent(\"onDestroy\", function(){\n\t\t\tif(ext.onDestroyed)\n\t\t\t\text.onDestroyed(view);\n\t\t});\n\t}\n\n\tvar factory = uiFactory.createFactory(gantt);\n\tfactory.registerView(\"cell\", Cell);\n\tfactory.registerView(\"resizer\", Resizer);\n\tfactory.registerView(\"scrollbar\", Scrollbar);\n\tfactory.registerView(\"layout\", Layout, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"main\"){\n\t\t\tattachInitializer(view, mainLayoutInitializer);\n\t\t}\n\t});\n\tfactory.registerView(\"viewcell\", ViewCell);\n\tfactory.registerView(\"multiview\", ViewLayout);\n\tfactory.registerView(\"timeline\", Timeline, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"timeline\" || view.$config.bind == \"task\"){\n\t\t\tattachInitializer(view, mainTimelineInitializer);\n\t\t}\n\t});\n\tfactory.registerView(\"grid\", Grid, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"grid\" || view.$config.bind == \"task\"){\n\t\t\tattachInitializer(view, mainGridInitializer);\n\t\t}\n\t});\n\n\tfactory.registerView(\"resourceGrid\", ResourceGrid);\n\tfactory.registerView(\"resourceTimeline\", ResourceTimeline);\n\tfactory.registerView(\"resourceHistogram\", ResourceHistogram);\n\n\tvar layersEngine = createLayers(gantt);\n\n\tvar inlineEditors = gridEditorsFactory(gantt);\n\n\tgantt.ext.inlineEditors = inlineEditors;\n\tgantt.ext._inlineEditors = inlineEditors;\n\tinlineEditors.init(gantt);\n\n\treturn {\n\t\tfactory:factory,\n\t\tmouseEvents: mouseEvents.init(gantt),\n\t\tlayersApi: layersEngine.init(),\n\t\trender:{\n\t\t\tgridLine: function(){\n\t\t\t\treturn gridRenderer(gantt);\n\t\t\t},\n\t\t\ttaskBg: function(){\n\t\t\t\treturn renderTaskBg(gantt);\n\t\t\t},\n\t\t\ttaskBar: function(){\n\t\t\t\treturn renderTaskBar(gantt);\n\t\t\t},\n\t\t\ttimedProjectBar: function(){\n\t\t\t\treturn renderTimedProjectBar(gantt);\n\t\t\t},\n\t\t\ttaskRollupBar: function() {\n\t\t\t\treturn renderRollupTaskBar(gantt);\n\t\t\t},\n\t\t\ttaskSplitBar: function(){\n\t\t\t\treturn renderSplitTaskBar(gantt);\n\t\t\t},\n\t\t\ttaskConstraints: function(){\n\t\t\t\treturn renderConstraints(gantt);\n\t\t\t},\n\t\t\ttaskDeadline: function(){\n\t\t\t\treturn renderDeadline(gantt);\n\t\t\t},\n\t\t\ttaskBaselines: function(){\n\t\t\t\treturn renderBaselines(gantt);\n\t\t\t},\n\t\t\tlink: function(){\n\t\t\t\treturn renderLink(gantt);\n\t\t\t},\n\t\t\tresourceRow: function(){\n\t\t\t\treturn resourceMatrixRenderer(gantt);\n\t\t\t},\n\t\t\tresourceHistogram: function(){\n\t\t\t\treturn resourceHistogramRenderer(gantt);\n\t\t\t},\n\t\t\tgridTaskRowResizer: function(){\n\t\t\t\treturn gridTaskRowResizerRenderer(gantt);\n\t\t\t}\n\t\t},\n\t\tlayersService: {\n\t\t\tgetDataRender: function(name){\n\t\t\t\treturn layersEngine.getDataRender(name, gantt);\n\t\t\t},\n\t\t\tcreateDataRender: function(config){\n\t\t\t\treturn layersEngine.createDataRender(config, gantt);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tinit: initUI\n};","export default null;","import * as helpers from \"../../../utils/helpers\";\nimport getRowRectangle from \"./viewport/get_grid_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport isInViewPort from \"./viewport/is_grid_row_in_viewport\";\n\nfunction createGridLineRender(gantt){\n\n\tfunction _render_grid_item(item, view, config, viewport) {\n\t\tvar columns = view.getGridColumns();\n\t\tvar templates = view.$getTemplates();\n\n\t\tvar store = view.$config.rowStore;\n\n\t\tvar cells = [];\n\t\tvar has_child;\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar last = i == columns.length - 1;\n\t\t\tvar col = columns[i];\n\t\t\tvar cell;\n\n\t\t\tvar value;\n\t\t\tvar textValue;\n\t\t\tif (col.name == \"add\") {\n\t\t\t\tvar aria = gantt._waiAria.gridAddButtonAttrString(col);\n\n\t\t\t\tvalue = \"<div \" + aria + \" class='gantt_add'></div>\";\n\t\t\t\ttextValue = \"\";\n\t\t\t} else {\n\t\t\t\tif (col.template)\n\t\t\t\t\tvalue = col.template(item);\n\t\t\t\telse\n\t\t\t\t\tvalue = item[col.name];\n\n\t\t\t\tif (helpers.isDate(value)){\n\t\t\t\t\tvalue = templates.date_grid(value, item, col.name);\n\t\t\t\t}\n\n\t\t\t\tif (value === null || value === undefined) {\n\t\t\t\t\tvalue = \"\";\n\t\t\t\t}\n\n\t\t\t\ttextValue = value;\n\t\t\t\tvalue = \"<div class='gantt_tree_content'>\" + value + \"</div>\";\n\t\t\t}\n\t\t\tvar css = \"gantt_cell\" + (last ? \" gantt_last_cell\" : \"\");\n\n\t\t\tvar tree = [];\n\t\t\tif (col.tree) {\n\t\t\t\tcss += \" gantt_cell_tree\";\n\t\t\t\tfor (var j = 0; j < item.$level; j++)\n\t\t\t\t\ttree.push(templates.grid_indent(item));\n\n\t\t\t\thas_child = store.hasChild(item.id) && !(gantt.isSplitTask(item) && !gantt.config.open_split_tasks);\n\t\t\t\tif (has_child) {\n\t\t\t\t\ttree.push(templates.grid_open(item));\n\t\t\t\t\ttree.push(templates.grid_folder(item));\n\t\t\t\t} else {\n\t\t\t\t\ttree.push(templates.grid_blank(item));\n\t\t\t\t\ttree.push(templates.grid_file(item));\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar style = \"width:\" + (col.width - (last ? 1 : 0)) + \"px;\";\n\t\t\tif (this.defined(col.align)){\n\t\t\t\tvar flexAlign = {\n\t\t\t\t\tright: \"flex-end\",\n\t\t\t\t\tleft: \"flex-start\",\n\t\t\t\t\tcenter: \"center\"\n\t\t\t\t};\n\t\t\t\tvar justifyContent = flexAlign[col.align];\n\n\t\t\t\tstyle += \"text-align:\" + col.align + \";justify-content:\"  + justifyContent + \";\";\n\t\t\t}\n\n\t\t\tvar aria = gantt._waiAria.gridCellAttrString(col, textValue, item);\n\n\t\t\ttree.push(value);\n\t\t\tcell = \"<div class='\" + css + \"' data-column-index='\"+i+\"' data-column-name='\"+col.name+\"' style='\" + style + \"' \" + aria + \">\" + tree.join(\"\") + \"</div>\";\n\t\t\tcells.push(cell);\n\t\t}\n\t\t// GS-291. The odd class should be assigned correctly\n\t\tcss = \"\";\n\t\tconst storeName = store.$config.name;\n\t\tswitch (storeName) {\n\t\t\tcase \"task\":\n\t\t\t\tcss = gantt.getGlobalTaskIndex(item.id) % 2 === 0 ? \"\" : \" odd\";\n\t\t\t\tbreak;\n\t\t\tcase \"resource\":\n\t\t\t\tcss = store.visibleOrder.indexOf(item.id) % 2 === 0 ? \"\" : \" odd\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tcss += (item.$transparent) ? \" gantt_transparent\" : \"\";\n\n\t\tcss += (item.$dataprocessor_class ? \" \" + item.$dataprocessor_class : \"\");\n\n\t\tif (templates.grid_row_class) {\n\t\t\tvar css_template = templates.grid_row_class.call(gantt, item.start_date, item.end_date, item);\n\t\t\tif (css_template)\n\t\t\t\tcss += \" \" + css_template;\n\t\t}\n\n\t\tif(store.isSelected(item.id)) {\n\t\t\tcss += \" gantt_selected\";\n\t\t}\n\n\t\tvar el = document.createElement(\"div\");\n\t\tel.className = \"gantt_row\" + css + \" gantt_row_\" + gantt.getTaskType(item.type);\n\t\tvar height = view.getItemHeight(item.id);\n\t\tel.style.height = height + \"px\";\n\t\tel.style.lineHeight = height + \"px\";\n\n\t\tif(config.smart_rendering){\n\t\t\tel.style.position = \"absolute\";\n\t\t\tel.style.left = \"0px\";\n\t\t\tel.style.top = view.getItemTop(item.id) + \"px\";\n\t\t}\n\n\t\tif(view.$config.item_attribute){\n\t\t\tel.setAttribute(view.$config.item_attribute, item.id);\n\t\t\tel.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\tgantt._waiAria.taskRowAttr(item, el);\n\n\t\tel.innerHTML = cells.join(\"\");\n\t\treturn el;\n\t}\n\n\tfunction onrender(item, rowNode, view){\n\t\tvar columns = view.getGridColumns();\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar column = columns[i];\n\t\t\tif (column.onrender){\n\n\t\t\t\t// find cell node for current column\n\t\t\t\tvar cellNode = rowNode.querySelector(\"[data-column-name=\" + column.name + \"]\");\n\t\t\t\tif (cellNode) {\n\t\t\t\t\tvar content = column.onrender(item, cellNode);\n\t\t\t\t\tif (content && typeof content === \"string\") {\n\t\t\t\t\t\tcellNode.innerHTML = content;\n\t\t\t\t\t} else if (content && typeof content === \"object\") {\n\t\t\t\t\t\t// render object to node using additional functionality\n\t\t\t\t\t\tif (gantt.config.external_render){\n\t\t\t\t\t\t\tvar adapter = gantt.config.external_render;\n\t\t\t\t\t\t\tif (adapter.isElement(content)){\n\t\t\t\t\t\t\t\tadapter.renderElement(content, cellNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\trender: _render_grid_item,\n\t\tupdate: null,\n\t\tgetRectangle: getRowRectangle,\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange,\n\t\tonrender: onrender\n\t};\n}\n\nexport default createGridLineRender;","import getRowRectangle from \"./viewport/get_bg_row_rectangle\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport bgPlaceholder from \"./prerender/task_bg_placeholder\";\n\nfunction createTaskBgRender(gantt){\n\tvar renderedCells = {};\n\tvar visibleCells = {};\n\n\tfunction isRendered(item, columnIndex){\n\t\tif(renderedCells[item.id][columnIndex] && renderedCells[item.id][columnIndex].parentNode){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction detachRenderedCell(itemId, columnIndex){\n\t\tif(renderedCells[itemId] && renderedCells[itemId][columnIndex] &&\n\t\t\trenderedCells[itemId][columnIndex].parentNode\n\t\t\t){\n\t\t\t\trenderedCells[itemId][columnIndex].parentNode.removeChild(renderedCells[itemId][columnIndex]);\n\t\t\t}\n\t}\n\n\tfunction getCellClassTemplate(view){\n\t\tvar templates = view.$getTemplates();\n\t\tvar cssTemplate;\n\t\tif (typeof templates.task_cell_class !== \"undefined\") {\n\t\t\tcssTemplate = templates.task_cell_class;\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tvar log = console.warn || console.log;\n\t\t\tlog('gantt.templates.task_cell_class template is deprecated and will be removed soon. Please use gantt.templates.timeline_cell_class instead.');\n\t\t} else {\n\t\t\tcssTemplate = templates.timeline_cell_class;\n\t\t}\n\t\treturn cssTemplate;\n\t}\n\tfunction getCellContentTemplate(view){\n\t\tvar templates = view.$getTemplates();\n\t\tvar contentTemplate = templates.timeline_cell_content;\n\t\treturn contentTemplate;\n\t}\n\n\tfunction renderCells(item, node, view, config, viewPort){\n\t\tvar cfg = view.getScale();\n\t\tvar count = cfg.count;\n\t\tvar cssTemplate = getCellClassTemplate(view);\n\t\tvar contentTemplate = getCellContentTemplate(view);\n\n\t\tif (config.show_task_cells) {\n\t\t\tif(!renderedCells[item.id]){\n\t\t\t\trenderedCells[item.id] = {};\n\t\t\t}\n\t\t\tif(!visibleCells[item.id]){\n\t\t\t\tvisibleCells[item.id] = {};\n\t\t\t}\n\n\t\t\tvar range = getVisibleCellsRange(cfg, viewPort);\n\n\t\t\tfor(var i in visibleCells[item.id]){\n\t\t\t\tvar index = visibleCells[item.id][i];\n\n\t\t\t\tif(Number(index) < range.start || Number(index) > range.end){\n\t\t\t\t\tdetachRenderedCell(item.id, index);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvisibleCells[item.id] = {};\n\t\t\t// TODO: do not iterate all cell, only ones in the viewport and once that are already rendered\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config);\n\t\t\t\tif(!cell && isRendered(item, columnIndex)){\n\t\t\t\t\tdetachRenderedCell(item.id, columnIndex);\n\t\t\t\t}else if (cell && !cell.parentNode){\n\t\t\t\t\tnode.appendChild(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction renderOneCell(scale, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config){\n\t\tvar width = scale.width[columnIndex],\n\t\t\tcssclass = \"\";\n\n\t\tif (isColumnVisible(columnIndex, scale, viewPort, gantt)) {//do not render skipped columns\n\n\t\t\tvar cssTemplateContent = cssTemplate(item, scale.trace_x[columnIndex]);\n\t\t\tvar htmlTemplateContent = \"\";\n\t\t\tif (contentTemplate) {// for backward compatibility, contentTemplate was added in 7.2.0+, will be undefined if someone used copy of old config/template object\n\t\t\t\thtmlTemplateContent = contentTemplate(item, scale.trace_x[columnIndex]);\n\t\t\t}\n\n\t\t\tif(config.static_background){\n\t\t\t\t// if cell render in static background is not allowed, or if it's a blank cell\n\t\t\t\tvar customCell = !!(cssTemplateContent || htmlTemplateContent);\n\t\t\t\tif(!(config.static_background_cells && customCell)){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(renderedCells[item.id][columnIndex]){\n\t\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\n\t\t\t\treturn renderedCells[item.id][columnIndex];\n\t\t\t}\n\t\t\tvar cell = document.createElement(\"div\");\n\t\t\tcell.style.width = (width) + \"px\";\n\n\t\t\tcssclass = \"gantt_task_cell\" + (columnIndex == count - 1 ? \" gantt_last_cell\" : \"\");\n\t\t\tif (cssTemplateContent) {\n\t\t\t\tcssclass += \" \" + cssTemplateContent;\n\t\t\t}\n\t\t\tcell.className = cssclass;\n\n\t\t\tif (htmlTemplateContent) {\n\t\t\t\tcell.innerHTML = htmlTemplateContent;\n\t\t\t}\n\n\t\t\tcell.style.position = \"absolute\";\n\t\t\tcell.style.left = scale.left[columnIndex] + \"px\";\n\t\t\trenderedCells[item.id][columnIndex] = cell;\n\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\n\n\t\t\treturn cell;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction _render_bg_line(item, view, config, viewPort) {\n\t\tvar templates = view.$getTemplates();\n\t\tvar cfg = view.getScale();\n\t\tvar count = cfg.count;\n\n\t\tif(config.static_background && !config.static_background_cells){\n\t\t\treturn null;\n\t\t}\n\n\t\tvar row = document.createElement(\"div\");\n\n\t\tvar cellCssTemplate = getCellClassTemplate(view);\n\t\tvar cellHtmlTemplate = getCellContentTemplate(view);\n\n\t\tvar range;\n\n\t\tif(!viewPort || !config.smart_rendering || isLegacyRender(gantt)){\n\t\t\trange = {\n\t\t\t\tstart: 0,\n\t\t\t\tend: count - 1\n\t\t\t};\n\t\t} else {\n\t\t\trange = getVisibleCellsRange(cfg, viewPort.x);\n\t\t}\n\t\tif (config.show_task_cells) {\n\t\t\trenderedCells[item.id] = {};\n\t\t\tvisibleCells[item.id] = {};\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cellCssTemplate, cellHtmlTemplate, config);\n\t\t\t\tif(cell){\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// GS-291. The odd class should be assigned correctly\n\t\tconst store = view.$config.rowStore;\n\t\tconst odd = store.getIndexById(item.id) % 2 !== 0;\n\n\t\tvar cssTemplate = templates.task_row_class(item.start_date, item.end_date, item);\n\t\tvar css = \"gantt_task_row\" + (odd ? \" odd\" : \"\") + (cssTemplate ? ' ' + cssTemplate : '');\n\n\t\tif(store.isSelected(item.id)) {\n\t\t\tcss += \" gantt_selected\";\n\t\t}\n\n\t\trow.className = css;\n\n\t\tif (config.smart_rendering) {\n\t\t\trow.style.position = \"absolute\";\n\t\t\trow.style.top = view.getItemTop(item.id) + \"px\";\n\t\t\trow.style.width = \"100%\";\n\t\t}else{\n\t\t\trow.style.position = \"relative\";\n\t\t}\n\t\trow.style.height = (view.getItemHeight(item.id)) + \"px\";\n\n\t\tif (item.id == \"timeline_placeholder_task\"){\n\t\t\tvar placeholderTop = 0;\n\t\t\tif (item.lastTaskId){\n\t\t\t\tvar lastTaskTop = view.getItemTop(item.lastTaskId);\n\t\t\t\tvar lastTaskHeight = view.getItemHeight(item.lastTaskId);\n\t\t\t\tplaceholderTop = lastTaskTop + lastTaskHeight;\t\n\t\t\t}\n\n\t\t\tvar maxHeight = item.row_height || view.$task_data.offsetHeight;\n\n\t\t\tvar placeholderHeight = maxHeight - placeholderTop;\n\t\t\t// So that it won't exceed the placeholder timeline height\n\t\t\tif (placeholderHeight < 0){\n\t\t\t\tplaceholderHeight = 0;\n\t\t\t}\n\n\t\t\tif (config.smart_rendering) {\n\t\t\t\trow.style.top = placeholderTop + \"px\";\t\n\t\t\t}\n\t\t\trow.style.height = placeholderHeight + \"px\";\n\t\t}\n\n\n\t\tif(view.$config.item_attribute){\n\t\t\trow.setAttribute(view.$config.item_attribute, item.id);\n\t\t\trow.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\treturn row;\n\t}\n\n\treturn {\n\t\trender: _render_bg_line,\n\t\tupdate: renderCells,\n\t\tgetRectangle: getRowRectangle,\n\t\tgetVisibleRange: getVisibleRange,\n\t\tprepareData: bgPlaceholder\n\t};\n}\n\nexport default createTaskBgRender;\n","import createBaseBarRender from \"./task_bar_render\";\nimport isInViewPort from \"./viewport/is_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nfunction createTaskRenderer(gantt){\n\tconst defaultRender = createBaseBarRender(gantt);\n\n\tconst renderedNodes = {};\n\n\tfunction checkVisibility(child, viewPort, timeline, config, gantt){\n\t\tlet isVisible = true;\n\t\t// GS-2123. Don't render rollup tasks that are outside the viewport\n\t\tif (config.smart_rendering){\n\t\t\tisVisible = isInViewPort(child, viewPort, timeline, config, gantt);\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tfunction generateChildElement(task, child, timeline, sizes){\n\t\tconst childCopy = gantt.copy(gantt.getTask(child.id));\n\t\tchildCopy.$rendered_at = task.id;\n\t\t// a way to filter rollup tasks:\n\t\tconst displayRollup = gantt.callEvent(\"onBeforeRollupTaskDisplay\", [childCopy.id, childCopy, task.id]);\n\t\tif (displayRollup === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = defaultRender(childCopy, timeline);\n\t\tif(!element){\n\t\t\treturn;\n\t\t}\n\n\t\tconst height = timeline.getBarHeight(task.id, child.type == gantt.config.types.milestone);\n\t\tconst padding = Math.floor((timeline.getItemHeight(task.id) - height) / 2);\n\n\t\telement.style.top = (sizes.top + padding) + \"px\";\n\t\telement.classList.add(\"gantt_rollup_child\");\n\t\telement.setAttribute(\"data-rollup-parent-id\", task.id);\n\n\t\treturn element;\n\t}\n\n\tfunction getKey(childId, renderParentId){\n\t\treturn childId + \"_\" + renderParentId;\n\t}\n\n\n\tfunction renderRollupTask(task, timeline, config, viewPort) {\n\t\tif (task.rollup !== false && task.$rollup && task.$rollup.length) {\n\t\t\tconst el = document.createElement('div'),\n\t\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\n\t\t\tif (viewPort){\n\t\t\t\tviewPort.y = 0;\n\t\t\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\n\t\t\t}\n\n\t\t\ttask.$rollup.forEach(function(itemId){\n\t\t\t\tif (!gantt.isTaskExists(itemId)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst child = gantt.getTask(itemId);\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (!isVisible){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\n\t\t\t\tif (element) {\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\tel.appendChild(element);\n\t\t\t\t} else{\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\treturn el;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction repaintRollupTask(task, itemNode, timeline, config, viewPort) {\n\t\tconst el = document.createElement(\"div\"),\n\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\n\t\tviewPort.y = 0;\n\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\n\n\t\ttask.$rollup.forEach(function(itemId){\n\t\t\tconst child = gantt.getTask(itemId);\n\t\t\tconst rollupKey = getKey(child.id, task.id);\n\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\tif (isVisible !== !!renderedNodes[rollupKey]) {\n\n\t\t\t\tif (isVisible) {\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\n\t\t\t\t\trenderedNodes[rollupKey] = element || false;\n\t\t\t\t} else {\n\t\t\t\t\trenderedNodes[rollupKey] = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!!renderedNodes[rollupKey]) {\n\t\t\t\tel.appendChild(renderedNodes[rollupKey]);\n\t\t\t}\n\t\t\titemNode.innerHTML = \"\";\n\t\t\titemNode.appendChild(el);\n\t\t});\n\t}\n\n\n\n\treturn {\n\t\trender: renderRollupTask,\n\t\tupdate: repaintRollupTask,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createTaskRenderer;","import getRectangle from \"./viewport/get_bg_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport resourceTimetable from \"../../resource_timetable_builder\";\n\nfunction generateRenderResourceLine(gantt){\n\tvar getResourceLoad = resourceTimetable(gantt);\n\tvar renderedResourceLines = {};\n\n\tfunction renderResourceLineCell(resource, day, templates, config, timeline){\n\t\tvar css = templates.resource_cell_class(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar content = templates.resource_cell_value(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar height = timeline.getItemHeight(resource.id) - 1;\n\n\t\tif (css || content){\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\t\t\tvar el = document.createElement('div');\n\t\t\tel.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tel.className = [\"gantt_resource_marker\", css].join(\" \");\n\n\t\t\tel.style.cssText = [\n\t\t\t\t'left:' + sizes.left + 'px',\n\t\t\t\t'width:' + sizes.width + 'px',\n\t\t\t\t'height:' + (height) + 'px',\n\t\t\t\t'line-height:' + (height) + 'px',\n\t\t\t\t'top:' + sizes.top + 'px'\n\t\t\t].join(\";\");\n\n\t\t\tif(content)\n\t\t\t\tel.innerHTML = content;\n\n\t\t\treturn el;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction detachRenderedResourceLine(id, index){\n\t\tif(renderedResourceLines[id] && renderedResourceLines[id][index] &&\n\t\t\trenderedResourceLines[id][index].parentNode\n\t\t\t){\n\t\t\t\trenderedResourceLines[id][index].parentNode.removeChild(renderedResourceLines[id][index]);\n\t\t\t}\n\t}\n\n\tfunction renderResourceLine(resource, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\t\tvar cells = [];\n\t\trenderedResourceLines[resource.id] = {};\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\n\t\t\tif(cell){\n\t\t\t\tcells.push(cell);\n\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\n\t\t\t}\n\t\t}\n\n\t\tvar row = null;\n\t\tif(cells.length){\n\t\t\trow = document.createElement(\"div\");\n\t\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\t\trow.appendChild(cells[i]);\n\t\t\t}\n\t\t}\n\t\treturn row;\n\t}\n\n\tfunction updateResourceLine(resource, node, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\n\t\tvar checkedColumns = {};\n\t\tif(renderedResourceLines && renderedResourceLines[resource.id]){\n\t\t\tfor(var i in renderedResourceLines[resource.id]){\n\t\t\t\tcheckedColumns[i] = i;\n\t\t\t}\n\t\t}\n\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tcheckedColumns[columnIndex] = false;\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(!isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tdetachRenderedResourceLine(resource.id, columnIndex);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(!renderedResourceLines[resource.id] || !renderedResourceLines[resource.id][columnIndex]){\n\t\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\n\t\t\t\tif(cell){\n\t\t\t\t\tnode.appendChild(cell);\n\t\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(renderedResourceLines[resource.id] && renderedResourceLines[resource.id][columnIndex] && !renderedResourceLines[resource.id][columnIndex].parentNode){\n\t\t\t\tnode.appendChild(renderedResourceLines[resource.id][columnIndex]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i in checkedColumns){\n\t\t\tif(checkedColumns[i] !== false){\n\t\t\t\tdetachRenderedResourceLine(resource.id, i);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\trender: renderResourceLine,\n\t\tupdate: updateResourceLine,\n\t\tgetRectangle: getRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default generateRenderResourceLine;","import getRowRectangle from \"./viewport/get_grid_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nfunction createGridTaskRowResizerRender(gantt){\n\n\tfunction _render_grid_item(item, view, viewport) {\n\n\t\tvar config = view.$getConfig();\n\t\tvar resize_el = document.createElement(\"div\");\n\t\tresize_el.className = \"gantt_task_grid_row_resize_wrap\";\n\n\t\tresize_el.style.top = (view.getItemTop(item.id) + view.getItemHeight(item.id)) + \"px\";\n\n\t\tresize_el.innerHTML = \"<div class='gantt_task_grid_row_resize' role='cell'></div>\";\n\t\tresize_el.setAttribute(config.task_grid_row_resizer_attribute, item.id);\n\n\t\tgantt._waiAria.rowResizerAttr(resize_el);\n\t\treturn resize_el;\n\t}\n\n\treturn {\n\t\trender: _render_grid_item,\n\t\tupdate: null,\n\t\tgetRectangle: getRowRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createGridTaskRowResizerRender;","function _configure(col, data, force) {\n\tfor (var key in data)\n\t\tif (typeof col[key] == \"undefined\" || force)\n\t\t\tcol[key] = data[key];\n}\n\nfunction _get_skin(force, gantt) {\n\n\tconst styles = getComputedStyle(gantt.$root);\n\tconst themeVar = styles.getPropertyValue(\"--dhx-gantt-theme\");\n\tlet isCssVarTheme = !!themeVar;\n\tlet themeName;\n\n\t\n\tif(isCssVarTheme){\n\t\tthemeName = themeVar;\n\t}else{\n\t\tvar skin = gantt.skin;\n\t\tthemeName = skin;\n\t\tif (!skin || force) {\n\t\t\tvar links = document.getElementsByTagName(\"link\");\n\t\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\t\tvar res = links[i].href.match(\"dhtmlxgantt_([a-z_]+).css\");\n\t\t\t\tif (res) {\n\t\t\t\t\tif (gantt.skins[res[1]] || !skin) {\n\t\t\t\t\t\tthemeName = res[1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tgantt._theme_info = {\n\t\ttheme: themeName,\n\t\tcssVarTheme: isCssVarTheme\n\t};\n\n\n\n\tgantt.skin = themeName || \"terrace\";\n\tvar skinset = gantt.skins[gantt.skin] || gantt.skins[\"terrace\"];\n\n\t//apply skin related settings\n\t_configure(gantt.config, skinset.config, force);\n\n\tif(!isCssVarTheme){\n\t\tgantt.config.link_radius = 1;\n\t}\n\n\tvar config = gantt.getGridColumns();\n\tif (config[1] && !gantt.defined(config[1].width))\n\t\tconfig[1].width = skinset._second_column_width;\n\tif (config[2] && !gantt.defined(config[2].width))\n\t\tconfig[2].width = skinset._third_column_width;\n\t\n\tfor (var i=0; i<config.length; i++) {\n\t\tvar column = config[i];\n\t\tif (column.name == \"add\") {\n\t\t\tif(!column.width){\n\t\t\t\tcolumn.width = 44;\n\t\t\t}\n\t\t\tif (!(gantt.defined(column.min_width) && gantt.defined(column.max_width))) {\n\t\t\t\tcolumn.min_width = column.min_width || column.width;\n\t\t\t\tcolumn.max_width = column.max_width || column.width;\n\t\t\t}\n\t\t\tif (column.min_width)\n\t\t\t\tcolumn.min_width = +column.min_width;\n\t\t\tif (column.max_width)\n\t\t\t\tcolumn.max_width = +column.max_width;\n\t\t\tif (column.width) {\n\t\t\t\tcolumn.width = +column.width;\n\t\t\t\tcolumn.width = (column.min_width && column.min_width > column.width) ? column.min_width : column.width;\n\t\t\t\tcolumn.width = (column.max_width && column.max_width < column.width) ? column.max_width : column.width;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (skinset.config.task_height){\n\t\tgantt.config.task_height = skinset.config.task_height || \"full\";\n\t}\n\tif (skinset.config.bar_height){\n\t\tgantt.config.bar_height = skinset.config.bar_height || \"full\";\n\t}\n\n\tif (skinset._lightbox_template)\n\t\tgantt._lightbox_template = skinset._lightbox_template;\n\n\tif (skinset._redefine_lightbox_buttons) {\n\t\tgantt.config.buttons_right = skinset._redefine_lightbox_buttons[\"buttons_right\"];\n\t\tgantt.config.buttons_left = skinset._redefine_lightbox_buttons[\"buttons_left\"];\n\t}\n\n\n\tgantt.resetLightbox();\n}\n\n\n\nexport default function(gantt) {\n\t\n\tif(!gantt.resetSkin){\n\t\tgantt.resetSkin = function () {\n\t\t\tthis.skin = \"\";\n\t\t\t_get_skin(true, this);\n\t\t};\n\t\tgantt.skins = {};\n\n\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\t\t_get_skin(false, this);\n\t\t\tmonitorThemeChange();\n\t\t});\n\t}\n\n\tgantt._addThemeClass = function(){\n\t\tdocument.documentElement.setAttribute(\"data-gantt-theme\", gantt.skin);\n\t};\n\n\tgantt.setSkin = function(value){\n\t\tthis.skin = value;\n\t\tgantt._addThemeClass();\n\t\tmonitorThemeChange();\n\t\tif(gantt.$root){\n\t\t\t_get_skin(true, gantt);\n\t\t\tthis.render();\n\t\t}\n\t\t\n\t\t//\n\t};\n\n\n\tlet monitorIntervalId = null;\n\tfunction monitorThemeChange(){\n\t\tconst container = gantt.$root;\n\t\t\n\t\tif(monitorIntervalId){\n\t\t\tclearInterval(monitorIntervalId);\n\t\t}\n\t\t\n\t\tif(container){\n\t\t\tmonitorIntervalId = setInterval(() => {\n\t\t\t\tconst csstheme = getComputedStyle(container).getPropertyValue('--dhx-gantt-theme');\n\t\t\t\tif(csstheme && csstheme !== gantt.skin){\n\t\t\t\t\tgantt.setSkin(csstheme);\n\t\t\t\t}\n\n\t\t\t}, 100);\n\t\t}\n\t}\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tclearInterval(monitorIntervalId);\n\t});\n};","import * as domHelpers from \"../utils/dom_helpers\";\nimport isHeadless from \"../../../utils/is_headless\";\n\nexport default function(gantt){\n\n\tvar scrollRange = 50,\n\t\tscrollStep = 30,\n\t\tscrollDelay = 10,\n\t\tscrollSpeed = 50;\n\n\tvar interval = null,\n\t\tisMove = false,\n\t\tdelayTimeout = null,\n\t\tstartPos = {\n\t\t\tstarted: false\n\t\t},\n\t\teventPos = {};\n\n\n\tfunction isDisplayed(element){\n\t\treturn element &&\n\t\t\tdomHelpers.isChildOf(element, gantt.$root) &&\n\t\t\telement.offsetHeight;\n\t}\n\n\tfunction getAutoscrollContainer(){\n\t\tvar element;\n\t\tif(isDisplayed(gantt.$task)){\n\t\t\telement = gantt.$task;\n\t\t}else if(isDisplayed(gantt.$grid)){\n\t\t\telement = gantt.$grid;\n\t\t}else{\n\t\t\telement = gantt.$root;\n\t\t}\n\n\t\treturn element;\n\t}\n\n\tfunction isScrollState() {\n\t\tvar dragMarker = !!document.querySelector(\".gantt_drag_marker\");\n\t\tvar isResize = !!document.querySelector(\".gantt_drag_marker.gantt_grid_resize_area\")\n\t\t\t|| !!document.querySelector(\".gantt_drag_marker.gantt_row_grid_resize_area\") ;\n\t\tvar isLink = !!document.querySelector(\".gantt_link_direction\");\n\t\tvar state = gantt.getState();\n\t\tvar isClickDrag = state.autoscroll;\n\t\tisMove = dragMarker && !isResize && !isLink;\n\n\t\treturn !((!state.drag_mode && !dragMarker) || isResize) || isClickDrag;\n\t}\n\n\tfunction defineDelayTimeout(state) {\n\t\tif (delayTimeout) {\n\t\t\tclearTimeout(delayTimeout);\n\t\t\tdelayTimeout = null;\n\t\t}\n\t\tif (state) {\n\t\t\tvar speed = gantt.config.autoscroll_speed;\n\t\t\tif (speed && speed < 10) // limit speed value to 10\n\t\t\t\tspeed = 10;\n\n\t\t\tdelayTimeout = setTimeout(function() {\n\t\t\t\tinterval = setInterval(tick, speed || scrollSpeed);\n\t\t\t}, gantt.config.autoscroll_delay || scrollDelay);\n\t\t}\n\t}\n\n\tfunction defineScrollInterval(state) {\n\t\tif (state) {\n\t\t\tdefineDelayTimeout(true);\n\t\t\tif (!startPos.started) {\n\t\t\t\tstartPos.x = eventPos.x;\n\t\t\t\tstartPos.y = eventPos.y;\n\t\t\t\tstartPos.started = true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (interval) {\n\t\t\t\tclearInterval(interval);\n\t\t\t\tinterval = null;\n\t\t\t}\n\t\t\tdefineDelayTimeout(false);\n\t\t\tstartPos.started = false;\n\t\t}\n\t}\n\n\tfunction autoscrollInterval(event) {\n\t\tvar isScroll = isScrollState();\n\n\t\tif ((interval || delayTimeout) && !isScroll) {\n\t\t\tdefineScrollInterval(false);\n\t\t}\n\n\t\tif (!gantt.config.autoscroll || !isScroll) {\n\t\t\treturn false;\n\t\t}\n\n\t\teventPos = {\n\t\t\tx: event.clientX,\n\t\t\ty: event.clientY\n\t\t};\n\n\t\t// if it is a mobile device, we need to detect the touch event coords\n\t\tif (event.type == \"touchmove\"){\n\t\t\teventPos.x = event.targetTouches[0].clientX;\n\t\t\teventPos.y = event.targetTouches[0].clientY;\n\t\t}\n\n\t\tif (!interval && isScroll) {\n\t\t\tdefineScrollInterval(true);\n\t\t}\n\t}\n\n\tfunction tick() {\n\n\t\tif (!isScrollState()) {\n\t\t\tdefineScrollInterval(false);\n\t\t\treturn false;\n\t\t}\n\n\t\tvar container = getAutoscrollContainer();\n\t\tif(!container){\n\t\t\treturn;\n\t\t}\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\n\t\tvar gridDrag = false;\n\t\tvar gridMarkers = [\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\n\t\t];\n\t\tgridMarkers.forEach(function (selector) {\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\n\t\t});\n\t\tif (gridDrag){\n\t\t\tcontainer = gantt.$grid;\n\t\t}\n\n\t\tvar box = domHelpers.getNodePosition(container);\n\n\t\tvar posX = eventPos.x - box.x;\n\t\tvar posY = eventPos.y - box.y + window.scrollY; // GS-1315: window.scrollY here and below for the elements above Gantt\n\n\t\tvar scrollLeft = isMove ? 0 : need_scroll(posX, box.width, startPos.x - box.x);\n\t\tvar scrollTop = need_scroll(posY, box.height, startPos.y - box.y + window.scrollY);\n\n\t\tvar scrollState = gantt.getScrollState();\n\n\t\tvar currentScrollTop = scrollState.y,\n\t\t\tscrollOuterHeight = scrollState.inner_height,\n\t\t\tscrollInnerHeight = scrollState.height,\n\t\t\tcurrentScrollLeft = scrollState.x,\n\t\t\tscrollOuterWidth = scrollState.inner_width,\n\t\t\tscrollInnerWidth = scrollState.width;\n\n\t\t// do scrolling only if we have scrollable area to do so\n\t\tif (scrollTop && !scrollOuterHeight) {\n\t\t\tscrollTop = 0;\n\t\t} else if (scrollTop < 0 && !currentScrollTop) {\n\t\t\tscrollTop = 0;\n\t\t} else if (scrollTop > 0 && currentScrollTop + scrollOuterHeight >= scrollInnerHeight + 2) {\n\t\t\tscrollTop = 0;\n\t\t}\n\n\t\tif (scrollLeft && !scrollOuterWidth) {\n\t\t\tscrollLeft = 0;\n\t\t} else if (scrollLeft < 0 && !currentScrollLeft) {\n\t\t\tscrollLeft = 0;\n\t\t} else if (scrollLeft > 0 && currentScrollLeft + scrollOuterWidth >= scrollInnerWidth) {\n\t\t\tscrollLeft = 0;\n\t\t}\n\n\t\tvar step = gantt.config.autoscroll_step;\n\n\t\tif (step && step < 2) // limit step value to 2\n\t\t\tstep = 2;\n\n\t\tscrollLeft = scrollLeft * (step || scrollStep);\n\t\tscrollTop = scrollTop * (step || scrollStep);\n\n\t\tif (scrollLeft || scrollTop) {\n\t\t\tscroll(scrollLeft, scrollTop);\n\t\t}\n\t}\n\n\tfunction need_scroll(pos, boxSize, startCoord) {\n\t\tif ((pos - scrollRange < 0) && (pos < startCoord))\n\t\t\treturn -1;\n\t\telse if ((pos > boxSize - scrollRange) && (pos > startCoord))\n\t\t\treturn 1;\n\t\treturn 0;\n\t}\n\n\tfunction scroll(left, top) {\n\t\tvar scrollState = gantt.getScrollState();\n\n\t\tvar scrollLeft = null,\n\t\t\tscrollTop = null;\n\n\t\tif (left) {\n\t\t\tscrollLeft = scrollState.x + left;\n\t\t\tscrollLeft = Math.min(scrollState.width, scrollLeft);\n\t\t\tscrollLeft = Math.max(0, scrollLeft);\n\t\t}\n\n\t\tif (top) {\n\t\t\tscrollTop = scrollState.y + top;\n\t\t\tscrollTop = Math.min(scrollState.height, scrollTop);\n\t\t\tscrollTop = Math.max(0, scrollTop);\n\t\t}\n\n\t\tgantt.scrollTo(scrollLeft, scrollTop);\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\tif(!isHeadless(gantt)){\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\n\t\t\tgantt.eventRemove(eventElement, \"mousemove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"mousemove\", autoscrollInterval);\n\n\t\t\tgantt.eventRemove(eventElement, \"touchmove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"touchmove\", autoscrollInterval);\n\n\t\t\tgantt.eventRemove(eventElement, \"pointermove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"pointermove\", autoscrollInterval);\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tdefineScrollInterval(false);\n\t});\n\n};","if (window.jQuery){\n\n\t(function( $ ){\n\n\t\tvar methods = [];\n\t\t$.fn.dhx_gantt = function(config){\n\t\t\tconfig = config || {};\n\t\t\tif (typeof(config) === 'string') {\n\t\t\t\tif (methods[config] ) {\n\t\t\t\t\treturn methods[config].apply(this, []);\n\t\t\t\t}else {\n\t\t\t\t\t$.error('Method ' +  config + ' does not exist on jQuery.dhx_gantt');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar views = [];\n\t\t\t\tthis.each(function() {\n\t\t\t\t\tif (this && this.getAttribute){\n\t\t\t\t\t\tif (!this.gantt && !(window.gantt.$root == this)){\n\n\t\t\t\t\t\t\tvar newgantt = (window.gantt.$container && window.Gantt) ? window.Gantt.getGanttInstance():window.gantt;\n\t\t\t\t\t\t\tfor (var key in config)\n\t\t\t\t\t\t\t\tif (key!=\"data\")\n\t\t\t\t\t\t\t\t\tnewgantt.config[key] = config[key];\n\n\t\t\t\t\t\t\tnewgantt.init(this);\n\t\t\t\t\t\t\tif (config.data)\n\t\t\t\t\t\t\t\tnewgantt.parse(config.data);\n\n\t\t\t\t\t\t\tviews.push(newgantt);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tviews.push(typeof this.gantt == \"object\" ? this.gantt : window.gantt);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n\t\t\t\tif (views.length === 1) return views[0];\n\t\t\t\treturn views;\n\t\t\t}\n\t\t};\n\n\t})(window.jQuery);\n\n}\n\n\nexport default null;","if (window.dhtmlx){\n\n\tif (!window.dhtmlx.attaches)\n\twindow.dhtmlx.attaches = {};\n\n\twindow.dhtmlx.attaches.attachGantt=function(start, end, gantt){\n\t\tvar obj = document.createElement(\"DIV\");\n\n\t\tgantt = gantt || window.gantt;\n\n\t\tobj.id = \"gantt_\"+ gantt.uid();\n\t\tobj.style.width = \"100%\";\n\t\tobj.style.height = \"100%\";\n\t\tobj.cmp = \"grid\";\n\n\t\tdocument.body.appendChild(obj);\n\t\tthis.attachObject(obj.id);\n\t\tthis.dataType = \"gantt\";\n\t\tthis.dataObj = gantt;\n\n\t\tvar that = this.vs[this.av];\n\t\tthat.grid = gantt;\n\n\t\tgantt.init(obj.id, start, end);\n\t\tobj.firstChild.style.border = \"none\";\n\n\t\tthat.gridId = obj.id;\n\t\tthat.gridObj = obj;\n\n\t\tvar method_name=\"_viewRestore\";\n\t\treturn this.vs[this[method_name]()].grid;\n\t};\n\n}\nif (typeof(window.dhtmlXCellObject) != \"undefined\") {\n\n\twindow.dhtmlXCellObject.prototype.attachGantt=function(start, end, gantt){\n\t\tgantt = gantt || window.gantt;\n\n\t\tvar obj = document.createElement(\"DIV\");\n\t\tobj.id = \"gantt_\"+gantt.uid();\n\t\tobj.style.width = \"100%\";\n\t\tobj.style.height = \"100%\";\n\t\tobj.cmp = \"grid\";\n\n\t\tdocument.body.appendChild(obj);\n\t\tthis.attachObject(obj.id);\n\n\t\tthis.dataType = \"gantt\";\n\t\tthis.dataObj = gantt;\n\n\t\tgantt.init(obj.id, start, end);\n\t\tobj.firstChild.style.border = \"none\";\n\n\t\tobj = null;\n\t\tthis.callEvent(\"_onContentAttach\",[]);\n\n\t\treturn this.dataObj;\n\t};\n}\n\nexport default null;","import env from \"../../../utils/env\";\nimport eventable from \"../../../utils/eventable\";\nimport { IScale, TModifierKeys } from \"../../common/config\";\n\ninterface ITimelineZoomConfig {\n\thandler?: (e: Event) => {};\n\tstartDate?: Date;\n\tendDate?: Date;\n\tlevels: IZoomLevel[];\n\tactiveLevelIndex?: number;\n\twidthStep?: number;\n\tminColumnWidth?: number;\n\tmaxColumnWidth?: number;\n\tuseKey?: \"ctrlKey\" | \"altKey\" | \"shiftKey\";\n\ttrigger?: \"wheel\" | null | undefined;\n\telement?: Element | (() => Element);\n}\n\nconst USE_KEY = [\"ctrlKey\", \"altKey\", \"shiftKey\", \"metaKey\"];\n\ninterface IZoomLevel {\n\tname?: string;\n\tscale_height?: number;\n\tmin_column_width: number;\n\tscales: IScale[];\n}\n\nconst _defaultScales = [\n\t[\n\t\t{\n\t\t\tunit: \"month\",\n\t\t\tdate: \"%M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d\",\n\t\t\tstep: 1\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"hour\",\n\t\t\tdate: \"%H:00\",\n\t\t\tstep: 8\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"hour\",\n\t\t\tdate: \"%H:00\",\n\t\t\tstep: 1\n\t\t}\n\t]\n];\n\nexport default class TimelineZoom {\n\tpublic attachEvent: (eventName: string, handler: () => void) => string;\n\tpublic callEvent: (eventName: string, args: any[]) => any;\n\tpublic detachEvent: (eventName: string) => any;\n\tprotected _initialStartDate: Date;\n\tprotected _initialEndDate: Date;\n\tprotected _activeLevelIndex: number;\n\tprotected _levels: IZoomLevel[];\n\tprotected _handler: (e: any) => void;\n\tprotected $gantt;\n\tprotected _widthStep: number;\n\tprotected _minColumnWidth: number;\n\tprotected _maxColumnWidth: number;\n\tprotected _useKey: TModifierKeys;\n\tprotected _visibleDate: Date;\n\tprotected _initialized: boolean;\n\tprotected _domEvents: any;\n\n\tconstructor(gantt) {\n\t\tthis.$gantt = gantt;\n\t\tthis._domEvents = this.$gantt._createDomEventScope();\n\t}\n\n\tpublic init(config: ITimelineZoomConfig) {\n\t\t// GS-1354 and GS-1318. If we check the headless mode using the function,\n\t\t// it will return false when Gantt is not initialized, but we may want to do it later\n\t\tif(this.$gantt.env.isNode){\n\t\t\treturn;\n\t\t}\n\t\tthis._initialStartDate = config.startDate;\n\t\tthis._initialEndDate = config.endDate;\n\t\tthis._activeLevelIndex = config.activeLevelIndex ? config.activeLevelIndex : 0;\n\t\tthis._levels = this._mapScales(config.levels || _defaultScales);\n\t\tthis._handler = config.handler || this._defaultHandler;\n\t\tthis._minColumnWidth = config.minColumnWidth || 60;\n\t\tthis._maxColumnWidth = config.maxColumnWidth || 240;\n\t\tthis._widthStep = config.widthStep || 3/8 * config.minColumnWidth;\n\t\tthis._useKey = config.useKey;\n\n\t\tif(!this._initialized){\n\t\t\teventable(this);\n\t\t\tthis.$gantt.attachEvent(\"onGanttScroll\", () => {\n\t\t\t\tthis._getVisibleDate();\n\t\t\t});\n\t\t}\n\n\t\tthis._domEvents.detachAll();\n\n\t\tif(config.trigger === \"wheel\"){\n\t\t\tif(this.$gantt.$root){\n\t\t\t\tthis._attachWheelEvent(config);\n\t\t\t}else{\n\t\t\t\tthis.$gantt.attachEvent(\"onGanttReady\", () => {\n\t\t\t\t\tthis._attachWheelEvent(config);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis._initialized = true;\n\t\tthis.setLevel(this._activeLevelIndex);\n\t}\n\n\tpublic zoomIn = () => {\n\t\tconst index = this.getCurrentLevel() - 1;\n\t\tif(index < 0){\n\t\t\treturn;\n\t\t}\n\t\tthis.setLevel(index);\n\t};\n\n\tpublic zoomOut = () => {\n\t\tconst index = this.getCurrentLevel() + 1;\n\t\tif(index > this._levels.length - 1){\n\t\t\treturn;\n\t\t}\n\t\tthis.setLevel(index);\n\t};\n\n\tpublic getCurrentLevel = () => {\n\t\treturn this._activeLevelIndex;\n\t};\n\n\tpublic getLevels = () => {\n\t\treturn this._levels;\n\t};\n\n\tpublic setLevel = (level: number|string) => {\n\t\tconst zoomLevel = this._getZoomIndexByName(level);\n\n\t\tif(zoomLevel === -1){\n\t\t\tthis.$gantt.assert(zoomLevel !== -1, \"Invalid zoom level for gantt.ext.zoom.setLevel. \" + level + \" is not an expected value.\");\n\t\t}\n\t\tthis._setLevel(zoomLevel, 0);\n\t};\n\n\tprotected _getZoomIndexByName = (levelName: number|string) => {\n\t\tlet zoomLevel:number = -1;\n\t\tif(typeof levelName === \"string\"){\n\t\t\tif(!isNaN(Number(levelName)) &&  this._levels[Number(levelName)]){\n\t\t\t\tzoomLevel = Number(levelName);\n\t\t\t}else{\n\t\t\t\tfor(let i = 0; i < this._levels.length; i++){\n\t\t\t\t\tif(this._levels[i].name === levelName){\n\t\t\t\t\t\tzoomLevel = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tzoomLevel = levelName;\n\t\t}\n\t\treturn zoomLevel;\n\t};\n\n\tprotected _mapScales(levels: IScale[][] | any): IZoomLevel[]{\n\t\treturn levels.map((l) => {\n\t\t\tif(Array.isArray(l)){\n\t\t\t\treturn {\n\t\t\t\t\tscales: l\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\treturn l;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected _getVisibleDate = () => {\n\t\t// GS-1450. Don't try to get the visible date if there is no timeline\n\t\tif (!this.$gantt.$task){\n\t\t\treturn null;\n\t\t}\n\t\tconst scrollPos = this.$gantt.getScrollState().x;\n\t\tconst viewPort = this.$gantt.$task.offsetWidth;\n\t\tthis._visibleDate = this.$gantt.dateFromPos(scrollPos + viewPort/2);\n\t};\n\n\tprotected _setLevel = (level: number, cursorOffset: number) => {\n\t\tthis._activeLevelIndex = level;\n\n\t\tconst gantt = this.$gantt;\n\t\tconst nextConfig = gantt.copy(this._levels[this._activeLevelIndex]);\n\t\tconst chartConfig = gantt.copy(nextConfig);\n\t\tdelete chartConfig.name;\n\n\t\tgantt.mixin(gantt.config, chartConfig, true);\n\n\t\t// GS-1148: Change scales for the resource views\n\t\tconst resourceViews = [\n\t\t\t\"resourceTimeline\",\n\t\t\t\"resourceHistogram\"\n\t\t];\n\n\t\tresourceViews.forEach(function(name){\n\t\t\tconst resourceView = gantt.$ui.getView(name);\n\t\t\tif (resourceView){\n\t\t\t\tconst resourceConfig = resourceView.$getConfig();\n\t\t\t\tif (!resourceConfig.fixed_scales){\n\t\t\t\t\tgantt.mixin(resourceConfig, chartConfig, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst isRendered = !!gantt.$root && !!gantt.$task;\n\n\t\tif(isRendered){\n\t\t\tif(cursorOffset){\n\t\t\t\tconst cursorDate = this.$gantt.dateFromPos(cursorOffset + this.$gantt.getScrollState().x);\n\t\t\t\tthis.$gantt.render();\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(cursorDate);\n\t\t\t\tthis.$gantt.scrollTo(newPosition - cursorOffset);\n\t\t\t}else{\n\t\t\t\tconst viewPort = this.$gantt.$task.offsetWidth;\n\t\t\t\tif(!this._visibleDate){\n\t\t\t\t\tthis._getVisibleDate();\n\t\t\t\t}\n\t\t\t\tconst middleDate = this._visibleDate;\n\t\t\t\tthis.$gantt.render();\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(middleDate);\n\t\t\t\tthis.$gantt.scrollTo(newPosition - viewPort/2);\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onAfterZoom\", [this._activeLevelIndex, nextConfig]);\n\t\t}\n\t};\n\n\tprivate _attachWheelEvent = (config) => {\n\t\tconst event = env.isFF ? \"wheel\" : \"mousewheel\";\n\t\tlet el: Element;\n\t\tif(typeof config.element === \"function\"){\n\t\t\tel = config.element();\n\t\t}else{\n\t\t\tel = config.element as Element;\n\t\t}\n\t\tif (!el){\n\t\t\treturn;\n\t\t}\n\n\t\tthis._domEvents.attach(el, event, this.$gantt.bind(function(e) {\n\t\t\tif (this._useKey) {\n\t\t\t\tif (USE_KEY.indexOf(this._useKey) < 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!e[this._useKey]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof this._handler === \"function\") {\n\t\t\t\tthis._handler.apply(this, [e]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, this), {passive: false});\n\t};\n\n\tprivate _defaultHandler = (e: any):void => {\n\t\tconst timelineOffset = this.$gantt.$task.getBoundingClientRect().x;\n\t\tconst cursorOffset = e.clientX - timelineOffset;\n\t\tconst wheelY = this.$gantt.env.isFF ? (e.deltaY*-40) : e.wheelDelta;\n\t\tlet wheelUp = false;\n\t\tif (wheelY > 0) {\n\t\t\twheelUp = true;\n\t\t}\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis._setScaleSettings(wheelUp, cursorOffset);\n\t};\n\n\tprivate _setScaleSettings(wheelUp: boolean, cursorOffset: number) {\n\t\tif (wheelUp) {\n\t\t\tthis._stepUp(cursorOffset);\n\t\t} else {\n\t\t\tthis._stepDown(cursorOffset);\n\t\t}\n\t}\n\n\tprivate _setScaleDates = () => {\n\t\tif(this._initialStartDate && this._initialEndDate){\n\t\t\tthis.$gantt.config.start_date = this._initialStartDate;\n\t\t\tthis.$gantt.config.end_date = this._initialEndDate;\n\t\t}\n\t};\n\n\tprivate _stepUp(cursorOffset) {\n\t\tif (this._activeLevelIndex >= this._levels.length - 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet nextLevel = this._activeLevelIndex;\n\t\tthis._setScaleDates();\n\n\t\tif(this._widthStep){\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width + this._widthStep;\n\t\t\tif (newColumnWidth > this._maxColumnWidth) {\n\t\t\t\tnewColumnWidth = this._minColumnWidth;\n\t\t\t\tnextLevel++;\n\t\t\t}\n\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\n\t\t}else{\n\t\t\tnextLevel++;\n\t\t}\n\t\tthis._setLevel(nextLevel, cursorOffset);\n\t}\n\tprivate _stepDown(cursorOffset) {\n\t\tif (this._activeLevelIndex < 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet nextLevel = this._activeLevelIndex;\n\t\tthis._setScaleDates();\n\n\t\tif(this._widthStep){\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width - this._widthStep;\n\t\t\tif (newColumnWidth < this._minColumnWidth) {\n\t\t\t\tnewColumnWidth = this._maxColumnWidth;\n\t\t\t\tnextLevel--;\n\t\t\t}\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\n\t\t}else{\n\t\t\tnextLevel--;\n\t\t}\n\t\tthis._setLevel(nextLevel, cursorOffset);\n\t}\n}","export default function(gantt) {\n\n\tgantt.config.touch_drag = 75; //nearly immediate dnd\n\tgantt.config.touch = true;\n\tgantt.config.touch_feedback = true;\n\tgantt.config.touch_feedback_duration = 1;\n\tgantt._prevent_touch_scroll = false;\n\n\n\tgantt._touch_feedback = function () {\n\t\tif (gantt.config.touch_feedback) {\n\t\t\tif (navigator.vibrate)\n\t\t\t\tnavigator.vibrate(gantt.config.touch_feedback_duration);\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif (gantt.$container)\t{\n\t\t\taddTouchEvents();\n\t\t}\n\t});\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\tif (gantt.$container)\t{\n\t\t\t\tgantt.attachEvent(\"onGanttRender\", addTouchEvents, {once: true});\n\t\t}\n\t});\n\n\tfunction addTouchEvents(){\n\t\tif (gantt.config.touch != \"force\")\n\t\t\tgantt.config.touch = gantt.config.touch &&\n\t\t\t\t((navigator.userAgent.indexOf(\"Mobile\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"iPad\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Android\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Touch\") != -1)) ||\n\t\t\t\t\t((navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1));\n\n\t\tif (gantt.config.touch) {\n\n\t\t\tvar touchEventsSupported = true;\n\t\t\ttry {\n\t\t\t\tdocument.createEvent(\"TouchEvent\");\n\t\t\t} catch (e) {\n\t\t\t\ttouchEventsSupported = false;\n\t\t\t}\n\n\t\t\tif (touchEventsSupported) {\n\t\t\t\tgantt._touch_events([\"touchmove\", \"touchstart\", \"touchend\"], function (ev) {\n\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\t\tif (ev.touches[0])\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttarget: ev.target,\n\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t\t};\n\t\t\t\t\telse\n\t\t\t\t\t\treturn ev;\n\t\t\t\t}, function () {\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\t\t\t} else if (window.navigator.pointerEnabled) {\n\t\t\t\tgantt._touch_events([\"pointermove\", \"pointerdown\", \"pointerup\"], function (ev) {\n\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\t\treturn ev;\n\t\t\t\t}, function (ev) {\n\t\t\t\t\treturn (!ev || (ev.pointerType == \"mouse\" ));\n\t\t\t\t});\n\t\t\t} else if (window.navigator.msPointerEnabled) {\n\t\t\t\tgantt._touch_events([\"MSPointerMove\", \"MSPointerDown\", \"MSPointerUp\"], function (ev) {\n\t\t\t\t\tif (ev.pointerType == ev.MSPOINTER_TYPE_MOUSE) return null;\n\t\t\t\t\treturn ev;\n\t\t\t\t}, function (ev) {\n\t\t\t\t\treturn (!ev || ev.pointerType == ev.MSPOINTER_TYPE_MOUSE);\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t}\n\n\n\tfunction findTargetView(event){\n\t\tvar allViews = gantt.$layout.getCellsByType(\"viewCell\");\n\n\t\tfor(var i = 0; i < allViews.length; i++){\n\t\t\tvar box = allViews[i].$view.getBoundingClientRect();\n\t\t\tif(event.clientX >= box.left && event.clientX <= box.right &&\n\t\t\t\tevent.clientY <= box.bottom && event.clientY >= box.top){\n\t\t\t\t\treturn allViews[i];\n\t\t\t\t}\n\t\t}\n\t}\n\n\tfunction getScrollState(view){\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\n\n\t\tvar scrollState = {x: null, y: null};\n\t\tif(scrollX){\n\t\t\tvar state = scrollX.getScrollState();\n\t\t\tif(state.visible){\n\t\t\t\tscrollState.x = scrollX.$view.scrollLeft;\n\t\t\t}\n\t\t}\n\t\tif(scrollY){\n\t\t\tvar state = scrollY.getScrollState();\n\t\t\tif(state.visible){\n\t\t\t\tscrollState.y = scrollY.$view.scrollTop;\n\t\t\t}\n\t\t}\n\t\treturn scrollState;\n\t}\n\n\tfunction scrollView(view, left, top){\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\n\n\t\tif(scrollX){\n\t\t\tscrollX.scrollTo(left, null);\n\t\t}\n\t\tif(scrollY){\n\t\t\tscrollY.scrollTo(null, top);\n\t\t}\n\t}\n\n\tfunction getTaskDND(){\n\t\tvar tasksDnD;\n\t\tif(gantt.$ui.getView(\"timeline\")){\n\t\t\ttasksDnD = gantt.$ui.getView(\"timeline\")._tasks_dnd;\n\t\t}\n\t\treturn tasksDnD;\n\t}\n\n\tvar touchHandlers = [];\n\n//we can't use native scrolling, as we need to sync momentum between different parts\n//so we will block native scroll and use the custom one\n//in future we can add custom momentum\n\tgantt._touch_events = function (names, accessor, ignore) {\n\t\t//webkit on android need to be handled separately\n\t\tvar dblclicktime = 0;\n\t\tvar actionMode = false;\n\t\tvar scrollMode = false;\n\t\tvar actionStart = null;\n\t\tvar scrollState;\n\t\tvar longTapTimer = null;\n\t\tvar currentDndId = null;\n\t\tvar dndNodes = [];\n\t\tvar targetView = null;\n\t\tlet multiTouchEvents = {};\n\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\n\t\t\tgantt.eventRemove(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\n\t\t}\n\t\ttouchHandlers = [];\n\n\t\t//touch move\n\t\ttouchHandlers.push([gantt.$container, names[0], function (e) {\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\t\tif (ignore(e)) return;\n\n\t\t\t\t//ignore common and scrolling moves\n\t\t\t\tif (!actionMode) return;\n\n\t\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\n\n\t\t\t\tvar source = accessor(e);\n\t\t\t\tif (tasksDnD && (tasksDnD.drag.id || tasksDnD.drag.start_drag)) {\n\t\t\t\t\ttasksDnD.on_mouse_move(source);\n\t\t\t\t\tif (e.preventDefault)\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!gantt._prevent_touch_scroll) {\n\t\t\t\t\tif (source && actionStart) {\n\t\t\t\t\t\tvar dx = actionStart.pageX - source.pageX;\n\t\t\t\t\t\tvar dy = actionStart.pageY - source.pageY;\n\t\t\t\t\t\tif (!scrollMode && (Math.abs(dx) > 5 || Math.abs(dy) > 5)) {\n\t\t\t\t\t\t\tscrollMode = true;\n\t\t\t\t\t\t\t//gantt._touch_scroll_active = scroll_mode = true;\n\t\t\t\t\t\t\tdblclicktime = 0;\n\n\t\t\t\t\t\t\tif(targetView){\n\t\t\t\t\t\t\t\tscrollState = getScrollState(targetView);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscrollState = gantt.getScrollState();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (scrollMode) {\n\n\t\t\t\t\t\t\tvar newScrollState;\n\t\t\t\t\t\t\tvar scrollX = scrollState.x + dx;\n\t\t\t\t\t\t\tvar scrollY = scrollState.y + dy;\n\t\t\t\t\t\t\tif(targetView){\n\t\t\t\t\t\t\t\tscrollView(targetView, scrollX, scrollY);\n\t\t\t\t\t\t\t\tnewScrollState = getScrollState(targetView);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tgantt.scrollTo(scrollX, scrollY);\n\t\t\t\t\t\t\t\tnewScrollState = gantt.getScrollState();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ((scrollState.x != newScrollState.x && dy > 2 * dx) ||\n\t\t\t\t\t\t\t\t(scrollState.y != newScrollState.y && dx > 2 * dy )) {\n\t\t\t\t\t\t\t\treturn block_action(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn block_action(e);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}]);\n\n\t\t// prevent page drag on touch move\n\t\ttry{\n\t\t\tdocument.addEventListener('touchmove', function(e) {\n\t\t\t\tif (gantt._touch_drag) {\n\t\t\t\t\tblock_action(e);\n\t\t\t\t}\n\t\t\t}, { passive: false });\n\t\t}\n\t\tcatch(e){\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(\"Cannot prevent touch event for the page drag\");\n\t\t}\n\n\t\t//block touch context menu in IE10\n\t\ttouchHandlers.push([this.$container, \"contextmenu\", function (e) {\n\t\t\tif (actionMode)\n\t\t\t\treturn block_action(e);\n\t\t}]);\n\n\t\t//touch start\n\t\ttouchHandlers.push([this.$container, names[1], function (e) {\n\t\t\tmultiTouchEvents = e.touches.length;\n\t\t\t// block pull-to-refresh\n\t\t\tif(document && document.body){\n\t\t\t\tdocument.body.classList.add(\"gantt_touch_active\");\n\t\t\t}\n\n\t\t\tif (ignore(e)) return;\n\t\t\tif (e.touches && e.touches.length > 1) {\n\t\t\t\tactionMode = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tactionStart = accessor(e);\n\t\t\ttargetView = findTargetView(actionStart);\n\t\t\tif (!gantt._locate_css(actionStart, \"gantt_hor_scroll\") && !gantt._locate_css(actionStart, \"gantt_ver_scroll\")) {\n\t\t\t\tactionMode = true;\n\t\t\t}\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\t//long tap\n\t\t\tlongTapTimer = setTimeout(function () {\n\t\t\t\tvar taskId = gantt.locate(actionStart);\n\t\t\t\tif (tasksDnD && (taskId && !gantt._locate_css(actionStart, \"gantt_link_control\") && !gantt._locate_css(actionStart, \"gantt_grid_data\"))) {\n\t\t\t\t\ttasksDnD.on_mouse_down(actionStart);\n\n\t\t\t\t\tif (tasksDnD.drag && tasksDnD.drag.start_drag) {\n\t\t\t\t\t\t// we need that as touch events break if the target node is removed from the DOM\n\t\t\t\t\t\tcloneTaskRendered(taskId);\n\t\t\t\t\t\ttasksDnD._start_dnd(actionStart);\n\t\t\t\t\t\tgantt._touch_drag = true;\n\n\t\t\t\t\t\tgantt.refreshTask(taskId);\n\n\t\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tlongTapTimer = null;\n\t\t\t}, gantt.config.touch_drag);\n\t\t}]);\n\n\t\t//touch end\n\t\ttouchHandlers.push([this.$container, names[2], function (e) {\n\t\t\tif(document && document.body){\n\t\t\t\tdocument.body.classList.remove(\"gantt_touch_active\");\n\t\t\t}\n\t\t\tif (ignore(e)) return;\n\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\n\t\t\tgantt._touch_drag = false;\n\t\t\tactionMode = false;\n\t\t\tvar source = accessor(e);\n\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\tif(tasksDnD)\n\t\t\t\ttasksDnD.on_mouse_up(source);\n\n\t\t\tif (currentDndId && gantt.isTaskExists(currentDndId)) {\n\t\t\t\tgantt.refreshTask(currentDndId);\n\t\t\t\tif(dndNodes.length){\n\t\t\t\t\tdndNodes.forEach(function(node){\n\t\t\t\t\t\tif(node.parentNode){\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//gantt._touch_scroll_active = action_mode = scroll_mode = false;\n\t\t\tactionMode = scrollMode = false;\n\t\t\tdndNodes = [];\n\t\t\tcurrentDndId = null;\n\n\t\t\t//dbl-tap handling\n\t\t\tif (actionStart && dblclicktime) {\n\t\t\t\tvar now = new Date();\n\t\t\t\t// doubletap shouldn't happen with multitouch\n\t\t\t\tif ((now - dblclicktime) < 500 && multiTouchEvents <= 1) {\n\n\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\t\t\tmouseEvents.onDoubleClick(actionStart);\n\t\t\t\t\tblock_action(e);\n\t\t\t\t} else\n\t\t\t\t\tdblclicktime = now;\n\t\t\t} else {\n\t\t\t\tdblclicktime = new Date();\n\t\t\t}\n\t\t}]);\n\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\n\t\t\tgantt.event(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\n\t\t}\n\n\t\t//common helper, prevents event\n\t\tfunction block_action(e) {\n\t\t\tif (e && e.preventDefault && e.cancelable){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\te.cancelBubble = true;\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction cloneTaskRendered(taskId) {\n\t\t\tconst renders = gantt._getTaskLayers();\n\t\t\tlet task = gantt.getTask(taskId);\n\t\t\tif (task) {\n\t\t\t\tlet visible = gantt.isTaskVisible(taskId);\n\t\t\t\tif (visible){\n\t\t\t\t\tcurrentDndId = taskId;\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\t\t\t\ttask = renders[i].rendered[taskId];\n\t\t\t\t\t\tif (task && task.getAttribute(gantt.config.task_attribute) && task.getAttribute(gantt.config.task_attribute) == taskId) {\n\t\t\t\t\t\t\tconst copy = task.cloneNode(true);\n\t\t\t\t\t\t\tdndNodes.push(task);\n\t\t\t\t\t\t\trenders[i].rendered[taskId] = copy;\n\t\t\t\t\t\t\ttask.style.display = \"none\";\n\t\t\t\t\t\t\tcopy.className += \" gantt_drag_move \";\n\t\t\t\t\t\t\ttask.parentNode.appendChild(copy);\n\t\t\t\t\t\t\t//return copy;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (task.$split_subtask){\n\t\t\t\t\tlet renderedParent = task.$rendered_parent;\n\t\t\t\t\tvisible = gantt.isTaskVisible(renderedParent);\n\t\t\t\t\tif (!visible){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentDndId = taskId;\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\t\t\t\tconst parent = renders[i].rendered[renderedParent];\n\t\t\t\t\t\tlet taskNode;\n\t\t\t\t\t\tif (parent && parent.childNodes){\n\t\t\t\t\t\t\ttaskNode = parent.querySelector(`[${gantt.config.task_attribute}=\"${task.id}\"]`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (taskNode) {\n\t\t\t\t\t\t\t// move the child node to a different parent as the task bar will be repainted\n\t\t\t\t\t\t\t// and the initial node will be lost\n\t\t\t\t\t\t\tconst copy = taskNode.cloneNode(true);\n\t\t\t\t\t\t\ttaskNode.parentNode.appendChild(copy);\n\n\t\t\t\t\t\t\tgantt.$task_bars.appendChild(taskNode);\n\t\t\t\t\t\t\ttaskNode.style.display = \"none\";\n\n\t\t\t\t\t\t\t// don't add the node as rendered otherwise it will be lost:\n\t\t\t\t\t\t\t// renders[i].rendered[taskId] = taskNode;\n\t\t\t\t\t\t\t// instead, add it to dndNodes as its elements will be removed after drag\n\t\t\t\t\t\t\tdndNodes.push(taskNode);\n\n\t\t\t\t\t\t\ttaskNode = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n};","function dummy() {\n\t// eslint-disable-next-line\n\tconsole.log(\"Method is not implemented.\"); \n}\nfunction BaseControl() {\n}\n\n// base methods will be runned in gantt context\nBaseControl.prototype.render = dummy; // arguments: sns\nBaseControl.prototype.set_value = dummy; // arguments: node, value, ev, sns(config)\nBaseControl.prototype.get_value = dummy; // arguments node, ev, sns(config)\nBaseControl.prototype.focus = dummy; // arguments: node\n\nexport default function(gantt) { // we could send current instance of gantt to module\n\treturn BaseControl;\n};","import * as helpers from \"../../../utils/helpers\";\n\nvar htmlHelpers = {\n\tgetHtmlSelect: function(options, attributes, value) {\n\t\tvar innerHTML = \"\";\n\t\tvar _this = this;\n\n\t\toptions = options || [];\n\t\t\n\t\thelpers.forEach(options, function(entry) {\n\t\t\tvar _attributes = [{ key: \"value\", value: entry.key }];\n\n\t\t\tif (value == entry.key) {\n\t\t\t\t_attributes[_attributes.length] = { key: \"selected\", value: \"selected\" };\n\t\t\t}\n\t\t\tif (entry.attributes) {\n\t\t\t\t_attributes = _attributes.concat(entry.attributes);\n\t\t\t}\n\t\t\tinnerHTML += _this.getHtmlOption({ innerHTML: entry.label }, _attributes);\n\t\t});\n\n\t\treturn _getHtmlContainer(\"select\", { innerHTML: innerHTML }, attributes);\n\t},\n\tgetHtmlOption: function(options, attributes) { return _getHtmlContainer(\"option\", options, attributes); },\n\tgetHtmlButton: function(options, attributes) { return _getHtmlContainer(\"button\", options, attributes); },\n\tgetHtmlDiv: function(options, attributes) { return _getHtmlContainer(\"div\", options, attributes); },\n\tgetHtmlLabel: function(options, attributes) { return _getHtmlContainer(\"label\", options, attributes); },\n\tgetHtmlInput: function(attributes) {\n\t\treturn \"<input\" + _getHtmlAttributes(attributes || []) + \">\";\n\t}\n};\n\nfunction _getHtmlContainer(tag, options, attributes) {\n\tvar html;\n\n\toptions = options || [];\n\t\n\thtml = \"<\" + tag + _getHtmlAttributes(attributes || []) + \">\" + (options.innerHTML || \"\") + \"</\" + tag +\">\";\n\treturn html;\n\n}\n\nfunction _getHtmlAttributes(attributes) {\n\tvar html = \"\";\n\n\thelpers.forEach(attributes, function(entry) {\n\t\thtml += \" \" + entry.key + \"='\" + entry.value + \"'\";\n\t});\n\treturn html;\n}\n\nexport default htmlHelpers;","import __extends from \"../../../../utils/extends\";\nimport htmlHelpers from \"../../utils/html_helpers\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction SelectControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\n\t\treturn self; \n\t}\n\t\n\t__extends(SelectControl, _super);\n\t\n\tSelectControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\thtml += htmlHelpers.getHtmlSelect(sns.options, [{ key: \"style\", value: \"width:100%;\" }, { key: \"title\", value: sns.name }]);\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tSelectControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar select = node.firstChild;\n\t\tif (!select._dhx_onchange && sns.onchange) {\n\t\t\tselect.onchange = sns.onchange;\n\t\t\tselect._dhx_onchange = true;\n\t\t}\n\t\tif (typeof value === \"undefined\")\n\t\t\tvalue = (select.options[0] || {}).value;\n\t\tselect.value = value || \"\";\n\t};\n\t\n\tSelectControl.prototype.get_value = function(node) {\n\t\treturn node.firstChild.value;\n\t};\n\t\n\tSelectControl.prototype.focus = function(node) {\n\t\tvar a = node.firstChild;\n\t\tgantt._focus(a, true);\n\t};\n\t\n\treturn SelectControl;\n};","import __extends from \"../../../../utils/extends\";\nimport SelectControl from \"./select_control\";\nexport default function(gantt) {\n\tvar _super = SelectControl(gantt);\n\n\tfunction ParentControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\t__extends(ParentControl, _super);\n\n\n\tParentControl.prototype.render = function(sns) {\n\t\treturn _display(sns, false);\n\t};\n\n\tParentControl.prototype.set_value = function(node, value, ev, config) {\n\t\t// GS-1051. If the value is `0`, the set_value function in the select control won't select \n\t\t// the first child because (0 || '') = '';\n\t\tif (value === 0) value = \"0\";\n\n\t\tvar tmpDom = document.createElement(\"div\");\n\t\ttmpDom.innerHTML = _display(config, ev.id);\n\t\tvar newOptions = tmpDom.removeChild(tmpDom.firstChild);\n\t\tnode.onselect = null;\n\t\tnode.parentNode.replaceChild(newOptions, node);\n\n\t\treturn gantt.form_blocks.select.set_value.apply(gantt, [newOptions, value, ev, config]);\n\t};\n\n\tfunction _display(config, item_id) {\n\t\tvar tasks = [],\n\t\t\toptions = [];\n\t\tif (item_id) {\n\t\t\ttasks = gantt.getTaskByTime();\n\t\t\tif (config.allow_root) {\n\t\t\t\ttasks.unshift({id: gantt.config.root_id, text: config.root_label || \"\"});\n\t\t\t}\n\t\t\ttasks = _filter(tasks, config, item_id);\n\t\t\tif (config.sort) {\n\t\t\t\ttasks.sort(config.sort);\n\t\t\t}\n\t\t}\n\t\tvar text = config.template || gantt.templates.task_text;\n\t\tfor (var i = 0; i < tasks.length; i++) {\n\t\t\tvar label = text.apply(gantt, [tasks[i].start_date, tasks[i].end_date, tasks[i]]);\n\t\t\tif (label === undefined) {\n\t\t\t\tlabel = \"\";\n\t\t\t}\n\t\t\toptions.push({\n\t\t\t\tkey: tasks[i].id,\n\t\t\t\tlabel: label\n\t\t\t});\n\t\t}\n\t\tconfig.options = options;\n\t\tconfig.map_to = config.map_to || \"parent\";\n\t\treturn gantt.form_blocks.select.render.apply(this, arguments);\n\t}\n\n\tfunction _filter(options, config, item_id) {\n\t\tvar filter = config.filter || function() {\n\t\t\treturn true;\n\t\t};\n\n\t\toptions = options.slice(0);\n\n\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\tvar task = options[i];\n\t\t\tif (task.id == item_id || gantt.isChildOf(task.id, item_id) || filter(task.id, task) === false) {\n\t\t\t\toptions.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t}\n\treturn ParentControl;\n};","import TemplateControlConstructor from \"./controls/template_control\";\nimport TextareaControlConstructor from \"./controls/textarea_control\";\nimport TimeControlConstructor from \"./controls/time_control\";\nimport SelectControlConstructor from \"./controls/select_control\";\nimport CheckboxControlConstructor from \"./controls/checkbox_control\";\nimport RadioControlConstructor from \"./controls/radio_control\";\nimport DurationControlConstructor from \"./controls/duration_control\";\nimport ParentControlConstructor from \"./controls/parent_control\";\nimport ResourcesControlConstructor from \"./controls/resources_control\";\nimport ConstraintControlConstructor from \"./controls/constraint_control\";\nimport TypeselectControlConstructor from \"./controls/typeselect_control\";\nimport BaselineControlConstructor from \"./controls/baseline_control\";\n\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as helpers from \"../../../utils/helpers\";\n\t\n\nexport default function (gantt) {\n\n\n\tvar TemplateControl = TemplateControlConstructor(gantt);\n\tvar TextareaControl = TextareaControlConstructor(gantt);\n\tvar TimeControl = TimeControlConstructor(gantt);\n\tvar SelectControl = SelectControlConstructor(gantt);\n\tvar CheckboxControl = CheckboxControlConstructor(gantt);\n\tvar RadioControl = RadioControlConstructor(gantt);\n\tvar DurationControl = DurationControlConstructor(gantt);\n\tvar ParentControl = ParentControlConstructor(gantt);\n\tvar ResourcesControl = ResourcesControlConstructor(gantt);\n\tvar ConstraintControl = ConstraintControlConstructor(gantt);\n\tvar TypeselectControl = TypeselectControlConstructor(gantt);\n\tvar BaselineControl = BaselineControlConstructor(gantt);\n\n\tgantt._lightbox_methods = {};\n\tgantt._lightbox_template = \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>\";\n\tgantt._lightbox_template = `<div class='gantt_cal_ltitle'><div class=\"dhx_cal_ltitle_descr\"><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='dhx_title'></span>\n</div>\n<div class=\"gantt_cal_ltitle_controls\">\n\t<a class=\"gantt_cal_ltitle_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\n</div></div><div class='gantt_cal_larea'></div>`;\n\n\t// GS-1952. Attaching the lightbox to the BODY element is not considered secure.\n\t// Attach it to Gantt container for Salesforce and other secure environments\n\tgantt._lightbox_root = gantt.$root;\n\tfunction setParentNode() {\n\t\tconst cspEnvironment = gantt.config.csp === true;\n\t\tconst salesforceEnvironment = !!window[\"Sfdc\"] || !!window[\"$A\"] || window[\"Aura\"] || ('$shadowResolver$' in document.body);\n\t\tif (cspEnvironment || salesforceEnvironment) {\n\t\t\tgantt._lightbox_root = gantt.$root;\n\t\t} else {\n\t\t\tgantt._lightbox_root = document.body;\n\t\t}\n\t}\n\n\t//TODO: gantt._lightbox_id is changed from data.js and accessed from autoscheduling, check if it can be removed from gantt object\n\tvar state = gantt.$services.getService(\"state\");\n\tstate.registerProvider(\"lightbox\", function () {\n\t\treturn {\n\t\t\tlightbox: gantt._lightbox_id\n\t\t};\n\t});\n\n\tgantt.showLightbox = function (id) {\n\t\tvar task = this.getTask(id);\n\t\tif (!this.callEvent(\"onBeforeLightbox\", [id])) {\n\t\t\tif(gantt.isTaskExists(id) && gantt.getTask(id).$new){\n\t\t\t\t//GS-2340 if 'onBeforeLightbox' returns 'false' need update the order in datastore\n\t\t\t\tthis.$data.tasksStore._updateOrder();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar box = this.getLightbox(this.getTaskType(task.type));\n\n\t\tthis.showCover(box);\n\t\tthis._fill_lightbox(id, box);\n\t\tthis._setLbPosition(box);\n\t\tthis._waiAria.lightboxVisibleAttr(box);\n\n\t\tthis.callEvent(\"onLightbox\", [id]);\n\t};\n\n\tfunction _is_chart_visible(gantt) {\n\t\tvar timeline = gantt.$ui.getView(\"timeline\");\n\t\tif (timeline && timeline.isVisible()) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tgantt._get_timepicker_step = function () {\n\t\tif (this.config.round_dnd_dates) {\n\t\t\tvar step;\n\t\t\tif (_is_chart_visible(this)) {\n\t\t\t\tvar scale = gantt.getScale();\n\t\t\t\tstep = (helpers.getSecondsInUnit(scale.unit) * scale.step) / 60;//timepicker step is measured in minutes\n\t\t\t}\n\n\t\t\tif (!step || step >= 60 * 24) {\n\t\t\t\tstep = this.config.time_step;\n\t\t\t}\n\t\t\treturn step;\n\t\t}\n\t\treturn this.config.time_step;\n\t};\n\tgantt.getLabel = function (property, key) {\n\t\tvar sections = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < sections.length; i++) {\n\t\t\tif (sections[i].map_to == property) {\n\t\t\t\tvar options = sections[i].options;\n\t\t\t\tfor (var j = 0; j < options.length; j++) {\n\t\t\t\t\tif (options[j].key == key) {\n\t\t\t\t\t\treturn options[j].label;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t};\n\n\tgantt.updateCollection = function (list_name, collection) {\n\t\tcollection = collection.slice(0);\n\t\tvar list = gantt.serverList(list_name);\n\t\tif (!list) return false;\n\t\tlist.splice(0, list.length);\n\t\tlist.push.apply(list, collection || []);\n\t\tgantt.resetLightbox();\n\t};\n\tgantt.getLightboxType = function () {\n\t\treturn this.getTaskType(this._lightbox_type);\n\t};\n\tgantt.getLightbox = function (type) {\n\t\tvar lightboxDiv;\n\t\tvar fullWidth;\n\t\tvar html;\n\t\tvar sns;\n\t\tvar ds;\n\t\tvar classNames = \"\";\n\t\tsetParentNode();\n\n\t\tif (type === undefined)\n\t\t\ttype = this.getLightboxType();\n\n\t\tif (!this._lightbox || this.getLightboxType() != this.getTaskType(type)) {\n\t\t\tthis._lightbox_type = this.getTaskType(type);\n\t\t\tlightboxDiv = document.createElement(\"div\");\n\t\t\tclassNames = \"gantt_cal_light\";\n\t\t\tfullWidth = this._is_lightbox_timepicker();\n\n\t\t\tif (gantt.config.wide_form)\n\t\t\t\tclassNames += \" gantt_cal_light_wide\";\n\n\t\t\tif (fullWidth) {\n\t\t\t\tclassNames += \" gantt_cal_light_full\";\n\t\t\t}\n\n\t\t\tlightboxDiv.className = classNames;\n\n\t\t\tlightboxDiv.style.visibility = \"hidden\";\n\t\t\thtml = this._lightbox_template;\n\t\t\thtml += \"<div class='gantt_cal_lcontrols'>\";\n\t\t\thtml += getHtmlButtons(this.config.buttons_left);\n\t\t\thtml += \"<div class='gantt_cal_lcontrols_push_right'></div>\";\n\t\t\thtml += getHtmlButtons(this.config.buttons_right, true);\n\t\t\thtml += \"</div>\";\n\n\t\t\tlightboxDiv.innerHTML = html;\n\n\t\t\tgantt._waiAria.lightboxAttr(lightboxDiv);\n\n\t\t\tif (gantt.config.drag_lightbox) {\n\t\t\t\tlightboxDiv.firstChild.onmousedown = gantt._ready_to_dnd;\n\t\t\t\tlightboxDiv.firstChild.ontouchstart = function (e){\n\t\t\t\t\tgantt._ready_to_dnd(e.touches[0]);\n\t\t\t\t};\n\t\t\t\tlightboxDiv.firstChild.onselectstart = function () {\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t\tlightboxDiv.firstChild.style.cursor = \"pointer\";\n\t\t\t\tgantt._init_dnd_events();\n\t\t\t}\n\n\t\t\t// GS-1428: If there is lightbox node, we need to remove it from the DOM\n\t\t\tif (this._lightbox){\n\t\t\t\tthis.resetLightbox();\n\t\t\t}\n\t\t\tshow_cover();\n\t\t\tthis._cover.insertBefore(lightboxDiv, this._cover.firstChild);\n\t\t\tthis._lightbox = lightboxDiv;\n\n\t\t\tsns = this._get_typed_lightbox_config(type);\n\t\t\thtml = this._render_sections(sns);\n\n\t\t\tds = lightboxDiv.querySelector(\"div.gantt_cal_larea\");\n\t\t\t\n\t\t\t//GS-1131. If gantt_cal_larea is displayed, Firefox renders buttons incorrectly;\n\t\t\tvar backup_overflow = ds.style.overflow;\n\t\t\tds.style.overflow = 'hidden';\n\n\t\t\tds.innerHTML = html;\n\n\t\t\t\n\n\t\t\tbindLabelsToInputs(sns);\n\n\t\t\tds.style.overflow = backup_overflow;\n\n\t\t\tthis._init_lightbox_events(this);\n\t\t\tlightboxDiv.style.display = \"none\";\n\t\t\tlightboxDiv.style.visibility = \"visible\";\n\t\t}\n\t\treturn this._lightbox;\n\t};\n\n\tgantt._render_sections = function (sns) {\n\t\tvar html = \"\";\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar block = this.form_blocks[sns[i].type];\n\t\t\tif (!block) continue; //ignore incorrect blocks\n\t\t\tsns[i].id = \"area_\" + this.uid();\n\n\t\t\tvar display = sns[i].hidden ? \" style='display:none'\" : \"\";\n\t\t\tvar button = \"\";\n\t\t\tif (sns[i].button) {\n\t\t\t\tbutton = \"<div class='gantt_custom_button' data-index='\" + i + \"'><div class='gantt_custom_button_\" + sns[i].button + \"'></div><div class='gantt_custom_button_label'>\" + this.locale.labels[\"button_\" + sns[i].button] + \"</div></div>\";\n\t\t\t}\n\t\t\tif (sns[i].type == \"baselines\") {\n\t\t\t\tbutton = \"<div class='gantt_custom_button gantt_remove_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_delete_baselines'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_remove_all_button + \"</div></div>\" +\n\t\t\t\t\"<div class='gantt_custom_button gantt_add_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_add_baseline'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_add_button + \"</div></div>\";\n\t\t\t}\n\t\t\tif (this.config.wide_form) {\n\t\t\t\thtml += \"<div class='gantt_wrap_section' \" + display + \">\";\n\t\t\t}\n\t\t\thtml += \"<div id='\" + sns[i].id + \"' class='gantt_cal_lsection'><label>\" + button + this.locale.labels[\"section_\" + sns[i].name] + \"</label></div>\" + block.render.call(this, sns[i]);\n\t\t\thtml += \"</div>\";\n\t\t}\n\t\treturn html;\n\t};\n\n\tgantt._center_lightbox = function(box){\n\t\tgantt._setLbPosition(box);\n\t};\n\tgantt._setLbPosition = function(box) {\n\t\tif(!box){\n\t\t\treturn;\n\t\t}\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\n\t\tbox.style.top = Math.max(rootElement.offsetHeight / 2 - box.offsetHeight/2, 0) + \"px\";\n\t\tbox.style.left = Math.max(rootElement.offsetWidth / 2 - box.offsetWidth/2, 0) + \"px\";\n\t};\n\n\tgantt.showCover = function (box) {\n\t\tif (box){\n\t\t\tbox.style.display=\"block\";\n\t\n\t\t\tthis._setLbPosition(box);\n\t\t}\n\t\tshow_cover();\n\t\tthis._cover.style.display = \"\";\n\t};\n\tconst show_cover=function(){\n\t\tif(gantt._cover) {\n\t\t\treturn;\n\t\t}\n\t\n\t\tgantt._cover=document.createElement(\"div\");\n\t\tgantt._cover.className=\"gantt_cal_cover\";\n\t\tgantt._cover.style.display = \"none\";\n\t\n\t\tgantt.event(gantt._cover, \"mousemove\", gantt._move_while_dnd);\n\t\tgantt.event(gantt._cover, \"mouseup\", gantt._finish_dnd);\n\t\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\n\t\trootElement.appendChild(gantt._cover);\n\t};\n\n\tgantt._init_lightbox_events = function () {\n\t\tgantt.lightbox_events = {};\n\n\n\t\tgantt.lightbox_events.gantt_save_btn = function () {\n\t\t\tgantt._save_lightbox();\n\t\t};\n\n\n\t\tgantt.lightbox_events.gantt_delete_btn = function () {\n\t\t\tgantt._lightbox_current_type = null;\n\t\t\tif (!gantt.callEvent(\"onLightboxDelete\", [gantt._lightbox_id]))\n\t\t\t\treturn;\n\n\t\t\tif (gantt.isTaskExists(gantt._lightbox_id)) {\n\t\t\t\tgantt.$click.buttons[\"delete\"](gantt._lightbox_id);\n\t\t\t} else {\n\t\t\t\tgantt.hideLightbox();\n\t\t\t}\n\n\t\t};\n\n\n\t\tgantt.lightbox_events.gantt_cancel_btn = function () {\n\t\t\tgantt._cancel_lightbox();\n\t\t};\n\n\n\t\tgantt.lightbox_events[\"default\"] = function (e, src) {\n\t\t\tif (src.getAttribute(\"data-dhx-button\")) {\n\t\t\t\tgantt.callEvent(\"onLightboxButton\", [src.className, src, e]);\n\t\t\t} else {\n\t\t\t\tvar index, block, sec;\n\n\t\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\t\tif (className.indexOf(\"gantt_custom_button\") != -1) {\n\t\t\t\t\tif (className.indexOf(\"gantt_custom_button_\") != -1) {\n\t\t\t\t\t\tindex = src.parentNode.getAttribute(\"data-index\");\n\t\t\t\t\t\tsec = src;\n\t\t\t\t\t\twhile (sec && domHelpers.getClassName(sec).indexOf(\"gantt_cal_lsection\") == -1) {\n\t\t\t\t\t\t\tsec = sec.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindex = src.getAttribute(\"data-index\");\n\t\t\t\t\t\tsec = src.closest(\".gantt_cal_lsection\");\n\t\t\t\t\t\tsrc = src.firstChild;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar sections = gantt._get_typed_lightbox_config();\n\n\t\t\t\tif (index) {\n\t\t\t\t\tindex = index * 1;\n\t\t\t\t\tblock = gantt.form_blocks[sections[index * 1].type];\n\t\t\t\t\tblock.button_click(index, src, sec, sec.nextSibling);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tthis.event(gantt.getLightbox(), \"click\", function (e) {\n\t\t\tif(e.target.closest(\".gantt_cal_ltitle_close_btn\")){\n\t\t\t\tgantt._cancel_lightbox();\n\t\t\t}\n\t\t\tvar src = domHelpers.getTargetNode(e);\n\n\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\tif (!className) {\n\t\t\t\tsrc = src.previousSibling;\n\t\t\t\tclassName = domHelpers.getClassName(src);\n\t\t\t}\n\t\t\tif (src && className && className.indexOf(\"gantt_btn_set\") === 0) {\n\t\t\t\tsrc = src.firstChild;\n\t\t\t\tclassName = domHelpers.getClassName(src);\n\t\t\t}\n\t\t\tif (src && className) {\n\t\t\t\tvar func = gantt.defined(gantt.lightbox_events[src.className]) ? gantt.lightbox_events[src.className] : gantt.lightbox_events[\"default\"];\n\t\t\t\treturn func(e, src);\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tgantt.getLightbox().onkeydown = function (e) {\n\t\t\tvar event = e || window.event;\n\t\t\tvar target = e.target || e.srcElement;\n\t\t\tvar buttonTarget = domHelpers.getClassName(target).indexOf(\"gantt_btn_set\") > -1;\n\n\t\t\tswitch ((e || event).keyCode) {\n\t\t\t\tcase gantt.constants.KEY_CODES.SPACE: {\n\t\t\t\t\tif ((e || event).shiftKey) return;\n\t\t\t\t\tif (buttonTarget && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase gantt.keys.edit_save:\n\t\t\t\t\tif ((e || event).shiftKey) return;\n\t\t\t\t\tif (buttonTarget && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt._save_lightbox();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase gantt.keys.edit_cancel:\n\t\t\t\t\tgantt._cancel_lightbox();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\t};\n\n\tgantt._cancel_lightbox = function () {\n\t\tvar task = this.getLightboxValues();\n\t\tgantt._lightbox_current_type = null;\n\t\tthis.callEvent(\"onLightboxCancel\", [this._lightbox_id, task.$new]);\n\t\tif (gantt.isTaskExists(task.id) && task.$new) {\n\t\t\tthis.silent(function () {\n\t\t\t\tgantt.$data.tasksStore.removeItem(task.id);\n\t\t\t\tgantt._update_flags(task.id, null);\n\t\t\t});\n\t\t\tthis.refreshData();\n\t\t}\n\n\t\tthis.hideLightbox();\n\t};\n\n\tgantt._save_lightbox = function () {\n\t\tvar task = this.getLightboxValues();\n\t\tgantt._lightbox_current_type = null;\n\t\tif (!this.callEvent(\"onLightboxSave\", [this._lightbox_id, task, !!task.$new]))\n\t\t\treturn;\n\n\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\n\t\t// as they will be recalculated in the `refreshData`\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\n\t\tif (task.$new) {\n\t\t\tdelete task.$new;\n\t\t\tthis.addTask(task, task.parent, this.getTaskIndex(task.id));\n\t\t} else if (this.isTaskExists(task.id)) {\n\t\t\tthis.mixin(this.getTask(task.id), task, true);\n\t\t\tthis.refreshTask(task.id);\n\t\t\tthis.updateTask(task.id);\n\t\t}\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\tthis.refreshData();\n\n\t\t// TODO: do we need any blockable events here to prevent closing lightbox?\n\t\tthis.hideLightbox();\n\t};\n\n\tgantt._resolve_default_mapping = function (section) {\n\t\tvar mapping = section.map_to;\n\t\tvar time_controls = { \"time\": true, \"time_optional\": true, \"duration\": true, \"duration_optional\": true };\n\t\tif (time_controls[section.type]) {\n\t\t\tif (section.map_to == \"auto\") {\n\t\t\t\tmapping = { start_date: \"start_date\", end_date: \"end_date\", duration: \"duration\" };\n\t\t\t} else if (typeof (section.map_to) === \"string\") {\n\t\t\t\tmapping = { start_date: section.map_to };\n\t\t\t}\n\t\t} else if (section.type === \"constraint\") {\n\t\t\tif (!section.map_to || typeof (section.map_to) === \"string\") {\n\t\t\t\tmapping = { constraint_type: \"constraint_type\", constraint_date: \"constraint_date\" };\n\t\t\t}\n\t\t}\n\n\t\treturn mapping;\n\t};\n\n\tgantt.getLightboxValues = function () {\n\t\tvar task = {};\n\n\t\tif (gantt.isTaskExists(this._lightbox_id)) {\n\t\t\ttask = this.mixin({}, this.getTask(this._lightbox_id));\n\t\t}\n\n\t\tvar sns = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar node = gantt._lightbox_root.querySelector(\"#\" + sns[i].id);\n\t\t\tnode = (node ? node.nextSibling : node);\n\t\t\tvar block = this.form_blocks[sns[i].type];\n\t\t\tif (!block) continue;\n\t\t\tvar res = block.get_value.call(this, node, task, sns[i]);\n\t\t\tvar map_to = gantt._resolve_default_mapping(sns[i]);\n\t\t\tif (typeof map_to == \"string\" && map_to != \"auto\") {\n\t\t\t\ttask[map_to] = res;\n\t\t\t} else if (typeof map_to == \"object\") {\n\t\t\t\tfor (var property in map_to) {\n\t\t\t\t\tif (map_to[property])\n\t\t\t\t\t\ttask[map_to[property]] = res[property];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// GS-1282 We need to preserve the task type even if the lightbox doesn't have the typeselect section\n\t\t// GS-2460 set the current type from selector\n\t\tif (gantt._lightbox_current_type) {\n\t\t\ttask.type = gantt._lightbox_current_type;\n\t\t}\n\n\t\treturn task;\n\t};\n\n\n\tgantt.hideLightbox = function () {\n\t\tvar box = this.getLightbox();\n\t\tif (box) box.style.display = \"none\";\n\n\t\tthis._waiAria.lightboxHiddenAttr(box);\n\t\tthis._lightbox_id = null;\n\n\t\tthis.hideCover(box);\n\t\tthis.resetLightbox();\n\t\tthis.callEvent(\"onAfterLightbox\", []);\n\t};\n\tgantt.hideCover = function (box) {\n\t\tif(box){\n\t\t\tbox.style.display = \"none\";\n\t\t}\n\t\tif (this._cover)\n\t\t\tthis._cover.parentNode.removeChild(this._cover);\n\t\tthis._cover = null;\n\t};\n\n\tgantt.resetLightbox = function () {\n\t\tif (gantt._lightbox && !gantt._custom_lightbox)\n\t\t\tgantt._lightbox.remove();\n\t\tgantt._lightbox = null;\n\t};\n\tgantt._set_lightbox_values = function (data, box) {\n\t\tvar task = data;\n\t\tvar s = box.getElementsByTagName(\"span\");\n\t\tvar lightboxHeader = [];\n\t\tif (gantt.templates.lightbox_header) {\n\t\t\tlightboxHeader.push(\"\");\n\t\t\tlightboxHeader.push(gantt.templates.lightbox_header(task.start_date, task.end_date, task));\n\t\t\ts[1].innerHTML = \"\";\n\t\t\ts[2].innerHTML = gantt.templates.lightbox_header(task.start_date, task.end_date, task);\n\t\t} else {\n\t\t\tlightboxHeader.push(this.templates.task_time(task.start_date, task.end_date, task));\n\t\t\tlightboxHeader.push(String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70)); //IE6 fix\n\t\t\ts[1].innerHTML = this.templates.task_time(task.start_date, task.end_date, task);\n\t\t\ts[2].innerHTML = String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70); //IE6 fix\n\t\t}\n\t\ts[1].innerHTML = lightboxHeader[0];\n\t\ts[2].innerHTML = lightboxHeader[1];\n\n\t\tgantt._waiAria.lightboxHeader(box, lightboxHeader.join(\" \"));\n\n\t\tvar sns = this._get_typed_lightbox_config(this.getLightboxType());\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar section = sns[i];\n\n\t\t\tif (!this.form_blocks[section.type]) {\n\t\t\t\tcontinue;//skip incorrect sections, same check is done during rendering\n\t\t\t}\n\n\n\t\t\tvar node = gantt._lightbox_root.querySelector(\"#\" + section.id).nextSibling;\n\t\t\tvar block = this.form_blocks[section.type];\n\t\t\tvar map_to = gantt._resolve_default_mapping(sns[i]);\n\t\t\tvar value = this.defined(task[map_to]) ? task[map_to] : section.default_value;\n\t\t\tblock.set_value.call(gantt, node, value, task, section);\n\n\t\t\tif (section.focus)\n\t\t\t\tblock.focus.call(gantt, node);\n\t\t}\n\t\tif (gantt.isTaskExists(data.id)){\n\t\t\tgantt._lightbox_id = data.id;\n\t\t}\n\t};\n\tgantt._fill_lightbox = function (id, box) {\n\t\tvar task = this.getTask(id);\n\t\tthis._set_lightbox_values(task, box);\n\t};\n\n\n\tgantt.getLightboxSection = function (name) {\n\t\tvar config = this._get_typed_lightbox_config();\n\t\tvar i = 0;\n\t\tfor (i; i < config.length; i++)\n\t\t\tif (config[i].name == name)\n\t\t\t\tbreak;\n\t\tvar section = config[i];\n\t\tif (!section)\n\t\t\treturn null;\n\n\t\tif (!this._lightbox)\n\t\t\tthis.getLightbox();\n\t\tvar header = gantt._lightbox_root.querySelector(\"#\" + section.id);\n\t\tvar node = header.nextSibling;\n\n\t\tvar result = {\n\t\t\tsection: section,\n\t\t\theader: header,\n\t\t\tnode: node,\n\t\t\tgetValue: function (ev) {\n\t\t\t\treturn gantt.form_blocks[section.type].get_value.call(gantt, node, (ev || {}), section);\n\t\t\t},\n\t\t\tsetValue: function (value, ev) {\n\t\t\t\treturn gantt.form_blocks[section.type].set_value.call(gantt, node, value, (ev || {}), section);\n\t\t\t}\n\t\t};\n\n\t\tvar handler = this._lightbox_methods[\"get_\" + section.type + \"_control\"];\n\t\treturn handler ? handler(result) : result;\n\t};\n\n\tgantt._lightbox_methods.get_template_control = function (result) {\n\t\tresult.control = result.node;\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_select_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"select\")[0];\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_textarea_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"textarea\")[0];\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_time_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"select\"); // array\n\t\treturn result;\n\t};\n\n\n\tgantt._init_dnd_events = function () {\n\t\tvar eventElement = gantt._lightbox_root;\n\t\tthis.event(eventElement, \"mousemove\", gantt._move_while_dnd);\n\t\tthis.event(eventElement, \"mouseup\", gantt._finish_dnd);\n\t\tthis.event(eventElement, \"touchmove\", function (e){\n\t\t\tgantt._move_while_dnd(e.touches[0]);\n\t\t});\n\t\tthis.event(eventElement, \"touchend\", function (e){\n\t\t\tgantt._finish_dnd(e.touches[0]);\n\t\t});\n\t\t// GS-1952: In Salesforce environment, the lightbox is attached to the Gantt container. \n\t\t// So when Gantt is reinitialized, the events are no longer attached to the Gantt container.\n\t\t// gantt._init_dnd_events = function () {\n\t\t// };\n\t};\n\tgantt._move_while_dnd = function (event) {\n\t\tif (gantt._dnd_start_lb) {\n\t\t\tif (!document.gantt_unselectable) {\n\t\t\t\tgantt._lightbox_root.className += \" gantt_unselectable\";\n\t\t\t\tdocument.gantt_unselectable = true;\n\t\t\t}\n\t\t\tvar lb = gantt.getLightbox();\n\t\t\tvar now = [event.pageX, event.pageY];\n\t\t\tlb.style.top = gantt._lb_start[1] + now[1] - gantt._dnd_start_lb[1] + \"px\";\n\t\t\tlb.style.left = gantt._lb_start[0] + now[0] - gantt._dnd_start_lb[0] + \"px\";\n\t\t}\n\t};\n\tgantt._ready_to_dnd = function (event) {\n\t\tvar lb = gantt.getLightbox();\n\t\tgantt._lb_start = [lb.offsetLeft, lb.offsetTop];\n\t\tgantt._dnd_start_lb = [event.pageX, event.pageY];\n\t};\n\tgantt._finish_dnd = function () {\n\t\tif (gantt._lb_start) {\n\t\t\tgantt._lb_start = gantt._dnd_start_lb = false;\n\t\t\tgantt._lightbox_root.className = gantt._lightbox_root.className.replace(\" gantt_unselectable\", \"\");\n\t\t\tdocument.gantt_unselectable = false;\n\t\t}\n\t};\n\n\n\tgantt._focus = function (node, select) {\n\t\tif (node && node.focus) {\n\t\t\tif (gantt.config.touch) {\n\t\t\t\t//do not focus editor, to prevent auto-zoom\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tif (select && node.select) node.select();\n\t\t\t\t\tnode.focus();\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// silent errors\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\n\tgantt.form_blocks = {\n\t\tgetTimePicker: function (sns, hidden) {\n\t\t\tvar html = \"\";\n\t\t\tvar cfg = this.config;\n\t\t\tvar i;\n\t\t\tvar options;\n\t\t\tvar ariaAttrs;\n\t\t\tvar readonly;\n\t\t\tvar display;\n\t\t\tvar settings = {\n\t\t\t\tfirst: 0,\n\t\t\t\tlast: 24 * 60,\n\t\t\t\tdate: this.date.date_part(new Date(gantt._min_date.valueOf())),\n\t\t\t\ttimeFormat: getTimeFormat(sns)\n\t\t\t};\n\n\t\t\t// map: default order => real one\n\t\t\tsns._time_format_order = { size: 0 };\n\n\t\t\tif (gantt.config.limit_time_select) {\n\t\t\t\tsettings.first = 60 * cfg.first_hour;\n\t\t\t\tsettings.last = 60 * cfg.last_hour + 1;\n\t\t\t\tsettings.date.setHours(cfg.first_hour);\n\t\t\t}\n\n\t\t\tfor (i = 0; i < settings.timeFormat.length; i++) {\n\t\t\t\t// adding spaces between selects\n\t\t\t\tif (i > 0) {\n\t\t\t\t\thtml += \" \";\n\t\t\t\t}\n\n\t\t\t\toptions = getHtmlTimePickerOptions(sns, i, settings);\n\n\t\t\t\tif (options) {\n\t\t\t\t\tariaAttrs = gantt._waiAria.lightboxSelectAttrString(settings.timeFormat[i]);\n\t\t\t\t\treadonly = sns.readonly ? \"disabled='disabled'\" : \"\";\n\t\t\t\t\tdisplay = hidden ? \" style='display:none' \" : \"\";\n\t\t\t\t\thtml += \"<select \" + readonly + display + ariaAttrs + \">\" + options + \"</select>\";\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn html;\n\t\t},\n\t\tgetTimePickerValue: function (selects, config, offset) {\n\t\t\tvar map = config._time_format_order;\n\t\t\tvar needSetTime = gantt.defined(map[3]);\n\n\t\t\tvar time;\n\t\t\tvar hours = 0;\n\t\t\tvar minutes = 0;\n\n\t\t\tvar mapOffset = offset || 0;\n\n\t\t\tif (needSetTime) {\n\t\t\t\ttime = parseInt(selects[map[3] + mapOffset].value, 10);\n\t\t\t\thours = Math.floor(time / 60);\n\t\t\t\tminutes = time % 60;\n\t\t\t}\n\t\t\treturn new Date(selects[map[2] + mapOffset].value, selects[map[1] + mapOffset].value, selects[map[0] + mapOffset].value, hours, minutes);\n\t\t},\n\n\t\t_fill_lightbox_select: function (s, i, d, map) {\n\t\t\ts[i + map[0]].value = d.getDate();\n\t\t\ts[i + map[1]].value = d.getMonth();\n\t\t\ts[i + map[2]].value = d.getFullYear();\n\t\t\tif (gantt.defined(map[3])) {\n\t\t\t\tvar v = d.getHours() * 60 + d.getMinutes();\n\t\t\t\tv = Math.round(v / gantt._get_timepicker_step()) * gantt._get_timepicker_step();\n\t\t\t\tvar input = s[i + map[3]];\n\t\t\t\tinput.value = v;\n\t\t\t\t//in case option not shown\n\t\t\t\tinput.setAttribute(\"data-value\", v);\n\t\t\t}\n\t\t},\n\t\ttemplate: new TemplateControl(),\n\t\ttextarea: new TextareaControl(),\n\t\tselect: new SelectControl(),\n\t\ttime: new TimeControl(),\n\t\tduration: new DurationControl(),\n\t\tparent: new ParentControl(),\n\t\tradio: new RadioControl(),\n\t\tcheckbox: new CheckboxControl(),\n\t\tresources: new ResourcesControl(),\n\t\tconstraint: new ConstraintControl(),\n\t\tbaselines: new BaselineControl(),\n\t\ttypeselect: new TypeselectControl()\n\t};\n\n\tgantt._is_lightbox_timepicker = function () {\n\t\tvar s = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < s.length; i++)\n\t\t\tif (s[i].name == \"time\" && s[i].type == \"time\")\n\t\t\t\treturn true;\n\t\treturn false;\n\t};\n\n\tgantt._simple_confirm = function (message, title, callback, ok) {\n\t\tif (!message)\n\t\t\treturn callback();\n\t\tvar opts = { text: message };\n\t\tif (title)\n\t\t\topts.title = title;\n\t\tif (ok) {\n\t\t\topts.ok = ok;\n\t\t}\n\t\tif (callback) {\n\t\t\topts.callback = function (result) {\n\t\t\t\tif (result)\n\t\t\t\t\tcallback();\n\t\t\t};\n\t\t}\n\t\tgantt.confirm(opts);\n\t};\n\n\tfunction _get_type_name(type_value) {\n\t\tfor (var i in this.config.types) {\n\t\t\tif (this.config.types[i] == type_value) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn \"task\";\n\t}\n\n\tgantt._get_typed_lightbox_config = function (type) {\n\t\tif (type === undefined) {\n\t\t\ttype = this.getLightboxType();\n\t\t}\n\n\t\tvar field = _get_type_name.call(this, type);\n\n\t\tif (gantt.config.lightbox[field + \"_sections\"]) {\n\t\t\treturn gantt.config.lightbox[field + \"_sections\"];\n\t\t} else {\n\t\t\treturn gantt.config.lightbox.sections;\n\t\t}\n\t};\n\n\tgantt._silent_redraw_lightbox = function (type) {\n\t\tvar oldType = this.getLightboxType();\n\n\t\tif (this.getState().lightbox) {\n\t\t\tvar taskId = this.getState().lightbox;\n\t\t\tvar formData = this.getLightboxValues(),\n\t\t\t\ttask = this.copy(this.getTask(taskId));\n\n\t\t\tthis.resetLightbox();\n\n\t\t\tvar updTask = this.mixin(task, formData, true);\n\t\t\tvar box = this.getLightbox(type ? type : undefined);\n\t\t\tthis._set_lightbox_values(updTask, box);\n\t\t\tthis.showCover(box);\n\t\t} else {\n\t\t\tthis.resetLightbox();\n\t\t\tthis.getLightbox(type ? type : undefined);\n\t\t}\n\t\tthis.callEvent(\"onLightboxChange\", [oldType, this.getLightboxType()]);\n\t};\n\n\tfunction bindLabelsToInputs(sns) {\n\t\tvar section;\n\t\tvar label;\n\t\tvar labelBlock;\n\t\tvar inputBlock;\n\t\tvar input;\n\t\tvar i;\n\n\t\tfor (i = 0; i < sns.length; i++) {\n\t\t\tsection = sns[i];\n\t\t\tlabelBlock = gantt._lightbox_root.querySelector(\"#\" + section.id);\n\n\t\t\tif (!section.id || !labelBlock) continue;\n\n\t\t\tlabel = labelBlock.querySelector(\"label\");\n\t\t\tinputBlock = labelBlock.nextSibling;\n\n\t\t\tif (!inputBlock) continue;\n\n\t\t\tinput = inputBlock.querySelector(\"input, select, textarea\");\n\t\t\tif (input) {\n\t\t\t\tinput.id = input.id || \"input_\" + gantt.uid();\n\t\t\t\tsection.inputId = input.id;\n\t\t\t\tlabel.setAttribute(\"for\", section.inputId);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getHtmlButtons(buttons, floatRight) {\n\t\tvar button;\n\t\tvar ariaAttr;\n\t\tvar html = \"\";\n\t\tvar i;\n\n\t\tfor (i = 0; i < buttons.length; i++) {\n\t\t\t// needed to migrate from 'dhx_something' to 'gantt_something' naming in a lightbox\n\t\t\tbutton = gantt.config._migrate_buttons[buttons[i]] ? gantt.config._migrate_buttons[buttons[i]] : buttons[i];\n\n\t\t\tariaAttr = gantt._waiAria.lightboxButtonAttrString(button);\n\t\t\thtml += \"<div \" + ariaAttr + \" class='gantt_btn_set gantt_left_btn_set \" + button + \"_set'\" + \"><div dhx_button='1' data-dhx-button='1' class='\" + button + \"'></div><div>\" + gantt.locale.labels[button] + \"</div></div>\";\n\t\t}\n\t\treturn html;\n\t}\n\n\tfunction getTimeFormat(sns) {\n\t\tvar scale;\n\t\tvar unit;\n\t\tvar result;\n\n\t\tif (sns.time_format) return sns.time_format;\n\n\t\t// default order\n\t\tresult = [\"%d\", \"%m\", \"%Y\"];\n\t\tscale = gantt.getScale();\n\t\tunit = scale ? scale.unit : gantt.config.duration_unit;\n\t\tif (helpers.getSecondsInUnit(unit) < helpers.getSecondsInUnit(\"day\")) {\n\t\t\tresult.push(\"%H:%i\");\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction getHtmlTimePickerOptions(sns, index, settings) {\n\t\tvar range;\n\t\tvar offset;\n\t\tvar start_year;\n\t\tvar end_year;\n\t\tvar i;\n\t\tvar time;\n\t\tvar diff;\n\t\tvar tdate;\n\t\tvar html = \"\";\n\n\t\tswitch (settings.timeFormat[index]) {\n\t\t\tcase \"%Y\":\n\t\t\t\tsns._time_format_order[2] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//year\n\n\t\t\t\tif (sns.year_range) {\n\t\t\t\t\tif (!isNaN(sns.year_range)) {\n\t\t\t\t\t\trange = sns.year_range;\n\t\t\t\t\t} else if (sns.year_range.push) {\n\t\t\t\t\t\t// if\n\t\t\t\t\t\tstart_year = sns.year_range[0];\n\t\t\t\t\t\tend_year = sns.year_range[1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trange = range || 10;\n\t\t\t\toffset = offset || Math.floor(range / 2);\n\t\t\t\tstart_year = start_year || settings.date.getFullYear() - offset;\n\t\t\t\tend_year = end_year || gantt.getState().max_date.getFullYear() + offset;\n\n\t\t\t\tfor (i = start_year; i < end_year; i++)\n\t\t\t\t\thtml += \"<option value='\" + (i) + \"'>\" + (i) + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%m\":\n\t\t\t\tsns._time_format_order[1] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//month\n\t\t\t\tfor (i = 0; i < 12; i++)\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + gantt.locale.date.month_full[i] + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%d\":\n\t\t\t\tsns._time_format_order[0] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//days\n\t\t\t\tfor (i = 1; i < 32; i++)\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + i + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%H:%i\":\n\t\t\t\t//  var last = 24*60, first = 0;\n\t\t\t\tsns._time_format_order[3] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//hours\n\t\t\t\ti = settings.first;\n\t\t\t\ttdate = settings.date.getDate();\n\t\t\t\tsns._time_values = [];\n\n\t\t\t\twhile (i < settings.last) {\n\t\t\t\t\ttime = gantt.templates.time_picker(settings.date);\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + time + \"</option>\";\n\t\t\t\t\tsns._time_values.push(i);\n\t\t\t\t\tsettings.date.setTime(settings.date.valueOf() + gantt._get_timepicker_step() * 60 * 1000);\n\t\t\t\t\tdiff = (settings.date.getDate() != tdate) ? 1 : 0; // moved or not to the next day\n\t\t\t\t\ti = diff * 24 * 60 + settings.date.getHours() * 60 + settings.date.getMinutes();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn html;\n\t}\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TemplateControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\t\treturn self; \n\t}\n\n\t__extends(TemplateControl, _super);\n\n\n\tTemplateControl.prototype.render = function(sns) {\n\t\tlet height = sns.height ? `${sns.height}px` : '';\n\t\treturn `<div class='gantt_cal_ltext gantt_cal_template gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}></div>`;\n\t};\n\n\tTemplateControl.prototype.set_value = function(node, value) {\n\t\tnode.innerHTML = value || \"\";\n\t};\n\n\tTemplateControl.prototype.get_value = function(node) {\n\t\treturn node.innerHTML || \"\";\n\t};\n\n\tTemplateControl.prototype.focus = function() {};\n\n\treturn TemplateControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TextareaControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(TextareaControl, _super);\n\n\tTextareaControl.prototype.render = function(sns) {\n\t\tconst height = (sns.height || \"130\") + \"px\";\n\t\tconst placeholder = sns.placeholder ? `placeholder='${sns.placeholder}'` : \"\";\n\t\treturn `<div class='gantt_cal_ltext gantt_section_${sns.name}' style='height:${height};' ${placeholder}><textarea></textarea></div>`;\n\t};\n\n\tTextareaControl.prototype.set_value = function(node, value) {\n\t\tgantt.form_blocks.textarea._get_input(node).value = value || \"\";\n\t};\n\n\tTextareaControl.prototype.get_value = function(node) {\n\t\treturn gantt.form_blocks.textarea._get_input(node).value;\n\t};\n\n\tTextareaControl.prototype.focus = function(node) {\n\t\tvar a = gantt.form_blocks.textarea._get_input(node);\n\t\tgantt._focus(a, true);\n\t};\n\n\tTextareaControl.prototype._get_input = function(node) {\n\t\treturn node.querySelector(\"textarea\");\n\t};\n\n\treturn TextareaControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TimeControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(TimeControl, _super);\n\n\tTimeControl.prototype.render = function (sns) {\n\t\tvar time = gantt.form_blocks.getTimePicker.call(this, sns);\n\t\tlet sectionClassName = \"gantt_section_time\";\n\t\tif (sns.name !== \"time\"){\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\n\t\t}\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;text-align:center;' class='\" + sectionClassName + \"'>\";\n\t\thtml += time;\n\n\t\tif (sns.single_date) {\n\t\t\ttime = gantt.form_blocks.getTimePicker.call(this, sns, true);\n\t\t\thtml += \"<span></span>\";\n\t\t} else {\n\t\t\thtml += \"<span class='gantt_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>\";\n\t\t}\n\n\t\thtml += time;\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tTimeControl.prototype.set_value = function (node, value, ev, config) {\n\t\tvar cfg = config;\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\n\t\tif (cfg.auto_end_date) {\n\t\t\tvar _update_lightbox_select = function () {\n\t\t\t\tstart_date = new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, 0, 0);\n\t\t\t\tend_date = gantt.calculateEndDate({ start_date: start_date, duration: 1, task: ev });\n\t\t\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\n\t\t\t};\n\t\t\tfor (var i = 0; i < 4; i++) {\n\t\t\t\ts[i].onchange = _update_lightbox_select;\n\t\t\t}\n\t\t}\n\n\t\tvar mapping = gantt._resolve_default_mapping(config);\n\n\t\tif (typeof (mapping) === \"string\") mapping = { start_date: mapping };\n\n\t\tvar start_date = ev[mapping.start_date] || new Date();\n\t\tvar end_date = ev[mapping.end_date] || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask: ev\n\t\t});\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, cfg);\n\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\n\t};\n\n\tTimeControl.prototype.get_value = function (node, ev, config) {\n\t\tvar selects = node.getElementsByTagName(\"select\");\n\t\tvar startDate;\n\t\tvar map = config._time_format_order;\n\t\tfunction _getEndDate(selects, map, startDate) {\n\t\t\tvar endDate = gantt.form_blocks.getTimePickerValue(selects, config, map.size);\n\t\t\t// GS-1010: We need to add a way to obtain exact end_date for validation\n\t\t\tif (endDate <= startDate) {  // when end date seems wrong\n\t\t\t\tif (config.autofix_end !== false || config.single_date) { // auto correct it in two cases - when the auto correction is not disabled, or when we have 'single date' control and the user don't have the UI to specify the end date\n\t\t\t\t\treturn gantt.date.add(startDate, gantt._get_timepicker_step(), \"minute\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn endDate;\n\t\t}\n\n\t\tstartDate = gantt.form_blocks.getTimePickerValue(selects, config);\n\n\t\tif (typeof gantt._resolve_default_mapping(config) === \"string\") {\n\t\t\treturn startDate;\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: startDate,\n\t\t\tend_date: _getEndDate(selects, map, startDate)\n\t\t};\n\t};\n\n\tTimeControl.prototype.focus = function (node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\treturn TimeControl;\n};","import * as helpers from \"../../../../utils/helpers\";\nimport __extends from \"../../../../utils/extends\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction CheckboxControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(CheckboxControl, _super);\n\n\tCheckboxControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lcheckbox gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\tif (sns.options && sns.options.length) {\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\n\t\t\t\thtml += \"<label><input type='checkbox' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\n\t\t\t}\n\t\t}else{\n\t\t\tsns.single_value = true;\n\t\t\thtml += \"<label><input type='checkbox' name='\" + sns.name + \"'></label>\";\n\t\t}\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tCheckboxControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar checkboxes = Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]\"));\n\n\t\tif (!node._dhx_onchange && sns.onchange) {\n\t\t\tnode.onchange = sns.onchange;\n\t\t\tnode._dhx_onchange = true;\n\t\t}\n\n\t\tif(sns.single_value){\n\t\t\tvar box = checkboxes[0];\n\t\t\tbox.checked = !!value;\n\t\t}else{\n\t\t\thelpers.forEach(checkboxes, function(entry) {\n\t\t\t\tentry.checked = value ? value.indexOf(entry.value) >= 0 : false;\n\t\t\t});\n\t\t}\n\t};\n\n\tCheckboxControl.prototype.get_value = function(node, task, sns) {\n\t\tif(sns.single_value){\n\t\t\tvar box = node.querySelector(\"input[type=checkbox]\");\n\t\t\treturn box.checked;\n\t\t}else{\n\t\t\treturn helpers.arrayMap(Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]:checked\")), function(entry) {\n\t\t\t\treturn entry.value;\n\t\t\t});\n\t\t}\n\t};\n\n\tCheckboxControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\"input[type=checkbox]\"));\n\t};\n\n\treturn CheckboxControl;\n};","import __extends from \"../../../../utils/extends\";\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction RadioControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(RadioControl, _super);\n\n\tRadioControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `${sns.height}px` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lradio gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}>`;\n\n\t\tif (sns.options && sns.options.length) {\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\n\t\t\t\thtml += \"<label><input type='radio' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\n\t\t\t}\n\t\t}\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tRadioControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar radio;\n\n\t\tif (!sns.options || !sns.options.length) return;\n\n\t\tradio = node.querySelector(\"input[type=radio][value='\" + value + \"']\") ||\n\t\t\t\tnode.querySelector(\"input[type=radio][value='\" + sns.default_value + \"']\");\n\n\t\tif (!radio) return;\n\n\t\tif (!node._dhx_onchange && sns.onchange) {\n\t\t\tnode.onchange = sns.onchange;\n\t\t\tnode._dhx_onchange = true;\n\t\t}\n\n\t\tradio.checked = true;\n\t};\n\n\tRadioControl.prototype.get_value = function(node, ev) {\n\t\tvar result = node.querySelector(\"input[type=radio]:checked\");\n\n\t\treturn result ? result.value : \"\";\n\t};\n\n\tRadioControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\"input[type=radio]\"));\n\t};\n\n\treturn RadioControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport DurationFormatterNumeric from  \"../../../common/duration_formatter_numeric\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction DurationControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || new DurationFormatterNumeric();\n\t}\n\n\t__extends(DurationControl, _super);\n\n\tDurationControl.prototype.render = function(sns) {\n\t\tvar time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</div>\";\n\t\tvar label = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\n\t\tvar singleDate = sns.single_date ? \" style='display:none'\" : \"\";\n\t\tvar readonly = sns.readonly ? \" disabled='disabled'\" : \"\";\n\t\tvar ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(sns);\n\n\t\tvar durationInputClass = \"gantt_duration_value\";\n\t\tif(sns.formatter) {\n\t\t\tlabel = \"\";\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\" ;\n\t\t}\n\n\t\tvar duration = \"<div class='gantt_duration' \" + singleDate + \">\" +\n\t\t\"<div class='gantt_duration_inputs'>\" +\n\t\t\t\"<input type='button' class='gantt_duration_dec' value='−'\" + readonly + \">\" +\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\n\t\t\t\"</div>\" +\n\t\t\t\"<div class='gantt_duration_end_date'>\"+label+\"<span></span></div>\" +\n\t\t\t\"</div>\" +\n\t\t\t\"</div>\";\n\t\tlet sectionClassName = \"gantt_section_time gantt_section_duration\";\n\t\tif (sns.name !== \"time\"){\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\n\t\t}\t\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;' class='\" + sectionClassName + \"'>\" + time + \" \" + duration + \"</div>\";\n\t\treturn html;\n\t};\n\n\tDurationControl.prototype.set_value = function(node, value, ev, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar inps = node.getElementsByTagName(\"input\");\n\t\tvar duration = inps[1];\n\t\tvar btns = [inps[0], inps[2]];\n\t\tvar endspan = node.getElementsByTagName(\"span\")[0];\n\t\tvar map = config._time_format_order;\n\t\tvar mapping;\n\t\tvar start_date;\n\t\tvar end_date;\n\t\tvar duration_val;\n\n\t\tfunction _calc_date() {\n\t\t\tvar start_date = _getStartDate.call(gantt, node, config);\n\t\t\tvar duration = _getDuration.call(gantt, node, config);\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: ev});\n\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\n\t\t\tendspan.innerHTML = template(end_date);\n\t\t}\n\n\t\tfunction _change_duration(step) {\n\t\t\tvar value = duration.value;\n\n\t\t\tvalue = getFormatter(config).parse(value);\n\t\t\tif (window.isNaN(value))\n\t\t\t\tvalue = 0;\n\t\t\tvalue += step;\n\t\t\tif (value < 1) value = 1;\n\t\t\tduration.value = getFormatter(config).format(value);\n\t\t\t_calc_date();\n\t\t}\n\n\t\tbtns[0].onclick = gantt.bind(function() {\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t}, this);\n\t\tbtns[1].onclick = gantt.bind(function() {\n\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t}, this);\n\t\ts[0].onchange = _calc_date;\n\t\ts[1].onchange = _calc_date;\n\t\ts[2].onchange = _calc_date;\n\t\tif (s[3]) s[3].onchange = _calc_date;\n\n\t\tduration.onkeydown = gantt.bind(function(e) {\n\t\t\tvar code; \n\n\t\t\te = e || window.event;\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\n\t\t\t\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\twindow.setTimeout(_calc_date, 1);\n\t\t}, this);\n\n\t\tduration.onchange = gantt.bind(_calc_date, this);\n\n\t\tmapping = gantt._resolve_default_mapping(config);\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\n\n\t\tstart_date = ev[mapping.start_date] || new Date();\n\t\tend_date = ev[mapping.end_date] || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask: ev\n\t\t});\n\t\tduration_val = Math.round(ev[mapping.duration]) || gantt.calculateDuration({\n\t\t\tstart_date: start_date,\n\t\t\tend_date: end_date,\n\t\t\ttask: ev\n\t\t});\n\t\tduration_val = getFormatter(config).format(duration_val);\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\n\t\tduration.value = duration_val;\n\t\t_calc_date();\n\t};\n\n\tDurationControl.prototype.get_value = function(node, ev, config) {\n\t\tvar startDate = _getStartDate(node, config);\n\t\tvar duration = _getDuration(node, config);\n\t\tvar endDate = gantt.calculateEndDate({start_date: startDate, duration: duration, task: ev});\n\n\t\tif (typeof gantt._resolve_default_mapping(config) == \"string\") {\n\t\t\treturn startDate;\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: startDate,\n\t\t\tend_date: endDate,\n\t\t\tduration: duration\n\t\t};\n\t};\n\n\tDurationControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\n\tfunction _getStartDate(node, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\t\tvar hours = 0;\n\t\tvar minutes = 0;\n\n\t\tif (gantt.defined(map[3])) {\n\t\t\tvar input = s[map[3]];\n\t\t\tvar time = parseInt(input.value, 10);\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\n\t\t\t}\n\n\t\t\thours = Math.floor(time / 60);\n\t\t\tminutes = time % 60;\n\t\t}\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\n\t}\n\n\tfunction _getDuration(node, config) {\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\n\n\t\tduration = getFormatter(config).parse(duration.value);\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\n\t\tif (duration < 0) duration *= -1;\n\t\treturn duration;\n\t}\n\n\treturn DurationControl; \n};","import __extends from \"../../../../utils/extends\";\nimport htmlHelpers from \"../../utils/html_helpers\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction ConstraintControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(ConstraintControl, _super);\n\n\tfunction isNonTimedConstraint(value) {\n\t\tif (!value || value === gantt.config.constraint_types.ASAP || value === gantt.config.constraint_types.ALAP) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction toggleTimeSelect(timeSelects, typeValue) {\n\t\tvar isNonTimed = isNonTimedConstraint(typeValue);\n\t\tfor (var i = 0; i < timeSelects.length; i++) {\n\t\t\ttimeSelects[i].disabled = isNonTimed;\n\t\t}\n\t}\n\n\tConstraintControl.prototype.render = function (sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\tvar options = [];\n\t\tfor (var i in gantt.config.constraint_types) {\n\t\t\toptions.push({ key: gantt.config.constraint_types[i], label: gantt.locale.labels[gantt.config.constraint_types[i]] });\n\t\t}\n\n\t\tsns.options = sns.options || options;\n\n\t\thtml += \"<span data-constraint-type-select>\" + htmlHelpers.getHtmlSelect(sns.options, [{ key: \"data-type\", value: \"constraint-type\" }]) + \"</span>\";\n\n\t\tvar timeLabel = gantt.locale.labels[\"constraint_date\"] || \"Constraint date\";\n\t\thtml += \"<label data-constraint-time-select>\" + timeLabel + \": \" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</label>\";\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tConstraintControl.prototype.set_value = function (node, value, task, config) {\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\n\t\tvar map = config._time_format_order;\n\n\t\tvar mapping = gantt._resolve_default_mapping(config);\n\n\t\tif (!typeSelect._eventsInitialized) {\n\t\t\ttypeSelect.addEventListener(\"change\", function (e) {\n\t\t\t\ttoggleTimeSelect(timeSelects, e.target.value);\n\t\t\t});\n\t\t\ttypeSelect._eventsInitialized = true;\n\t\t}\n\n\t\tvar constraintDate = task[mapping.constraint_date] || new Date();\n\t\tgantt.form_blocks._fill_lightbox_select(timeSelects, 0, constraintDate, map, config);\n\n\t\tvar constraintType = task[mapping.constraint_type] || gantt.getConstraintType(task);\n\t\ttypeSelect.value = constraintType;\n\t\ttoggleTimeSelect(timeSelects, constraintType);\n\t};\n\n\tConstraintControl.prototype.get_value = function (node, task, config) {\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\n\n\t\tvar constraintType = typeSelect.value;\n\t\tvar constraintDate = null;\n\t\tif (!isNonTimedConstraint(constraintType)) {\n\t\t\tconstraintDate = gantt.form_blocks.getTimePickerValue(timeSelects, config);\n\t\t}\n\n\t\treturn {\n\t\t\tconstraint_type: constraintType,\n\t\t\tconstraint_date: constraintDate\n\t\t};\n\t};\n\n\tConstraintControl.prototype.focus = function (node) {\n\t\tgantt._focus(node.querySelector(\"select\"));\n\t};\n\n\treturn ConstraintControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./select_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TypeselectControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(TypeselectControl, _super);\n\n\tTypeselectControl.prototype.render = function(sns) {\n\t\tvar types = gantt.config.types,\n\t\t\tlocale = gantt.locale.labels,\n\t\t\toptions = [];\n\n\t\tvar filter = sns.filter || function (typeKey, typeValue) {\n\t\t\tif (!types.placeholder || typeValue !== types.placeholder) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tfor (var i in types) {\n\t\t\tif (!filter(i, types[i]) === false) {\n\t\t\t\toptions.push({ key: types[i], label: locale[\"type_\" + i] });\n\t\t\t}\n\t\t}\n\t\tsns.options = options;\n\n\t\tvar oldOnChange = sns.onchange;\n\t\tsns.onchange = function () {\n\t\t\tgantt._lightbox_current_type = this.value;\n\t\t\tgantt.changeLightboxType(this.value);\n\t\t\tif (typeof oldOnChange == 'function') {\n\t\t\t\toldOnChange.apply(this, arguments);\n\t\t\t}\n\t\t};\n\n\t\treturn _super.prototype.render.apply(this, arguments);\n\t};\n\n\treturn TypeselectControl;\n};\n","\nimport __extends from \"../../../../utils/extends\";\nimport DurationFormatterNumeric from \"../../../common/duration_formatter_numeric\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction DurationControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || new DurationFormatterNumeric();\n\t}\n\n\tfunction _generateBaselineRow (node, baseline, task, config){\n\t\tconst time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(gantt, config) + \"</div>\";\n\t\tlet durationLabel = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\n\t\tconst singleDate = config.single_date ? \" style='display:none'\" : \"\";\n\t\tconst readonly = config.readonly ? \" disabled='disabled'\" : \"\";\n\t\tconst ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(config);\n\t\tconst deleteLabel = gantt.locale.labels.baselines_remove_button;\n\n\t\tlet durationInputClass = \"gantt_duration_value\";\n\t\tif(config.formatter) {\n\t\t\tdurationLabel = \"\";\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\";\n\t\t}\n\n\t\tconst durationEl = \"<div class='gantt_duration' \" + singleDate + \">\" +\n\t\t\"<div class='gantt_duration_inputs'>\" +\n\t\t\t\"<input type='button' class='gantt_duration_dec' value='−'\" + readonly + \">\" +\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\n\t\t\t\"</div>\" +\n\t\t\t\"<div class='gantt_duration_end_date'>\"+durationLabel+\"<span></span></div>\" +\n\t\t\t\"</div>\" +\n\t\t\t\"</div>\";\n\n\t\tconst deleteButton = `<div><div class='baseline_delete_button gantt_custom_button'>${deleteLabel}</div></div>`;\n\n\t\tconst baselineRow = document.createElement(\"div\");\n\t\tbaselineRow.className = \"gantt_section_time gantt_section_duration\";\n\t\tbaselineRow.setAttribute(\"data-baseline-id\", baseline.id);\n\t\tbaselineRow.innerHTML = time + durationEl + deleteButton + \"<br>\";\n\t\tnode.appendChild(baselineRow);\n\n\t\tvar s = baselineRow.getElementsByTagName(\"select\");\n\t\tvar inps = baselineRow.getElementsByTagName(\"input\");\n\t\tvar duration = inps[1];\n\t\tvar btns = [inps[0], inps[2]];\n\t\tvar endspan = baselineRow.getElementsByTagName(\"span\")[0];\n\t\tvar map = config._time_format_order;\n\t\tvar mapping;\n\t\tvar start_date;\n\t\tvar end_date;\n\t\tvar duration_val;\n\n\t\tconst deleteEl = baselineRow.querySelector(\".baseline_delete_button\");\n\t\tdeleteEl.onclick = function(e){\n\t\t\tconst section = baselineRow.parentNode;\n\t\t\tbaselineRow.innerHTML = \"\";\n\t\t\tbaselineRow.remove();\n\t\t\tif (section.innerHTML === \"\"){\n\t\t\t\tsection.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t\t}\n\t\t};\n\t\t\n\n\t\tfunction _calc_date() {\n\t\t\tvar start_date = _getStartDate.call(gantt, baselineRow, config);\n\t\t\tvar duration = _getDuration.call(gantt, baselineRow, config);\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: task});\n\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\n\t\t\tendspan.innerHTML = template(end_date);\n\t\t}\n\n\t\tfunction _change_duration(step) {\n\t\t\tvar value = duration.value;\n\n\t\t\tvalue = getFormatter(config).parse(value);\n\t\t\tif (window.isNaN(value))\n\t\t\t\tvalue = 0;\n\t\t\tvalue += step;\n\t\t\tif (value < 1) value = 1;\n\t\t\tduration.value = getFormatter(config).format(value);\n\t\t\t_calc_date();\n\t\t}\n\n\t\tbtns[0].onclick = gantt.bind(function() {\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t}, gantt);\n\t\tbtns[1].onclick = gantt.bind(function() {\n\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t}, gantt);\n\t\ts[0].onchange = _calc_date;\n\t\ts[1].onchange = _calc_date;\n\t\ts[2].onchange = _calc_date;\n\t\tif (s[3]) s[3].onchange = _calc_date;\n\n\t\tduration.onkeydown = gantt.bind(function(e) {\n\t\t\tvar code; \n\n\t\t\te = e || window.event;\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\n\t\t\t\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\twindow.setTimeout(_calc_date, 1);\n\t\t}, gantt);\n\n\t\tduration.onchange = gantt.bind(_calc_date, gantt);\n\n\t\tmapping = gantt._resolve_default_mapping(config);\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\n\n\t\tstart_date = baseline.start_date || new Date();\n\t\tend_date = baseline.end_date || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask\n\t\t});\n\t\tduration_val = gantt.calculateDuration({\n\t\t\tstart_date: start_date,\n\t\t\tend_date: end_date,\n\t\t\ttask\n\t\t});\n\t\tduration_val = getFormatter(config).format(duration_val);\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\n\t\tduration.value = duration_val;\n\t\t_calc_date();\n\t}\n\n\t__extends(DurationControl, _super);\n\n\tDurationControl.prototype.render = function(sns) {\n\t\tconst baselineSection = `<div style='height: ${sns.height || 100}px; padding-top:0px; font-size:inherit;' class='gantt_section_baselines'></div>`;\n\t\treturn baselineSection;\n\t};\n\n\tDurationControl.prototype.set_value = function(node, value, task, config) {\n\t\tif (task.baselines){\n\t\t\tnode.innerHTML = \"\";\n\n\t\t\ttask.baselines.forEach((baseline)=>{\n\t\t\t\t_generateBaselineRow(node, baseline, task, config);\n\t\t\t});\n\t\t} else {\n\t\t\tnode.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t}\t\t\n\n\t};\n\n\tDurationControl.prototype.get_value = function(node, task, config) {\n\t\tconst baselines = [];\n\t\tconst baselineRows = node.querySelectorAll(`[data-baseline-id]`);\n\t\tbaselineRows.forEach((baselineNode)=>{\n\t\t\tconst baselineId = baselineNode.dataset.baselineId;\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\n\t\t\tlet baseline = baselineStore.getItem(baselineId);\n\t\t\tlet updatedBaseline;\n\t\t\tif (baseline){\n\t\t\t\tupdatedBaseline = gantt.copy(baseline);\n\t\t\t} else {\n\t\t\t\tupdatedBaseline = {\n\t\t\t\t\tid: gantt.uid(),\n\t\t\t\t\ttask_id: task.id,\n\t\t\t\t\ttext: \"Baseline 1\"\n\t\t\t\t};\n\t\t\t}\n\t\t\tupdatedBaseline.start_date = _getStartDate(baselineNode, config);\n\t\t\tupdatedBaseline.duration = _getDuration(baselineNode, config);\n\t\t\tupdatedBaseline.end_date = gantt.calculateEndDate({start_date: updatedBaseline.start_date, duration: updatedBaseline.duration, task});\n\n\t\t\tbaselines.push(updatedBaseline);\n\t\t});\n\n\t\treturn baselines;\n\t};\n\n\tDurationControl.prototype.button_click = function (index, el, section, container) {\n\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_remove_baselines\")){\n\t\t\tcontainer.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_add_baselines\")){\n\t\t\tif (container.innerHTML == gantt.locale.labels.baselines_section_placeholder){\n\t\t\t\tcontainer.innerHTML = \"\";\n\t\t\t}\n\t\t\tconst task = gantt.getTask(gantt._lightbox_id);\n\t\t\tconst baseline = {\n\t\t\t\tid: gantt.uid(),\n\t\t\t\ttask_id: task.id,\n\t\t\t\ttext: \"Baseline 1\",\n\t\t\t\tstart_date: task.start_date,\n\t\t\t\tend_date: task.end_date\n\t\t\t};\n\t\t\tconst config = gantt._get_typed_lightbox_config()[index];\n\t\t\t_generateBaselineRow(container, baseline, task, config);\n\t\t}\n\t};\n\n\tDurationControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\n\tfunction _getStartDate(node, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\t\tvar hours = 0;\n\t\tvar minutes = 0;\n\n\t\tif (gantt.defined(map[3])) {\n\t\t\tvar input = s[map[3]];\n\t\t\tvar time = parseInt(input.value, 10);\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\n\t\t\t}\n\n\t\t\thours = Math.floor(time / 60);\n\t\t\tminutes = time % 60;\n\t\t}\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\n\t}\n\n\tfunction _getDuration(node, config) {\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\n\n\t\tduration = getFormatter(config).parse(duration.value);\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\n\t\tif (duration < 0) duration *= -1;\n\t\treturn duration;\n\t}\n\n\treturn DurationControl; \n};","import * as utils from \"../utils/utils\";\nimport env from \"../utils/env\";\nimport isHeadless from \"../utils/is_headless\";\nimport * as domHelpers from \"./ui/utils/dom_helpers\";\nimport * as codeHelpers from \"../utils/helpers\";\nimport domEventScope from \"./ui/utils/dom_event_scope\";\nimport messages from \"./ui/message\";\nimport ui from \"./ui/index\";\nimport createLayoutFacade from \"./facades/layout\";\nimport taskLayers from \"./data_task_layers\";\n\nimport skin from \"./ui/skin\";\nimport skyblue from \"../css/skins/skyblue\";\nimport meadow from \"../css/skins/meadow\";\nimport terrace from \"../css/skins/terrace\";\nimport broadway from \"../css/skins/broadway\";\nimport material from \"../css/skins/material\";\nimport dark from \"../css/skins/dark\";\nimport contrast_black from \"../css/skins/contrast_black\";\nimport contrast_white from \"../css/skins/contrast_white\";\nimport plugins from \"./ui/plugins\";\nimport touch from \"./ui/touch\";\nimport lightbox from \"./ui/lightbox\";\nimport lightbox_optional_time from \"./ui/lightbox/lightbox_optional_time\";\nimport wai_aria from \"./ui/wai_aria\";\n\n\nexport default function(gantt) {\n\n\tif(!env.isNode){\n\n\t\tgantt.utils = {\n\t\t\tarrayFind: codeHelpers.arrayFind,\n\t\t\tdom: domHelpers\n\t\t};\n\n\t\tvar domEvents = domEventScope();\n\t\tgantt.event = domEvents.attach;\n\t\tgantt.eventRemove = domEvents.detach;\n\t\tgantt._eventRemoveAll = domEvents.detachAll;\n\t\tgantt._createDomEventScope = domEvents.extend;\n\n\t\tutils.mixin(gantt, messages(gantt));\n\t\tvar uiApi = ui.init(gantt);\n\t\tgantt.$ui = uiApi.factory;\n\t\tgantt.$ui.layers = uiApi.render;\n\t\tgantt.$mouseEvents = uiApi.mouseEvents;\n\t\tgantt.$services.setService(\"mouseEvents\", function () {\n\t\t\treturn gantt.$mouseEvents;\n\t\t});\n\t\tgantt.mixin(gantt, uiApi.layersApi);\n\n\t\ttaskLayers(gantt);\n\n\t\tgantt.$services.setService(\"layers\", function () {\n\t\t\treturn uiApi.layersService;\n\t\t});\n\n\t\tgantt.mixin(gantt, createLayoutFacade());\n\t\tskin(gantt);\n\t\tskyblue(gantt);\n\t\tdark(gantt);\n\t\tmeadow(gantt);\n\t\tterrace(gantt);\n\t\tbroadway(gantt);\n\t\tmaterial(gantt);\n\t\tcontrast_black(gantt);\n\t\tcontrast_white(gantt);\n\t\tplugins(gantt);\n\t\ttouch(gantt);\n\t\tlightbox(gantt);\n\t\tlightbox_optional_time(gantt);\n\t\twai_aria(gantt);\n\n\t\tgantt.locate = function(e) {\n\t\t\tvar trg = domHelpers.getTargetNode(e);\n\n\t\t\t// ignore empty rows/cells of the timeline\n\t\t\tif(domHelpers.closest(trg, \".gantt_task_row\")){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar targetAttribute = arguments[1] || this.config.task_attribute;\n\n\t\t\tvar node = domHelpers.locateAttribute(trg, targetAttribute);\n\t\t\tif(node){\n\t\t\t\treturn node.getAttribute(targetAttribute);\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t};\n\n\t\tgantt._locate_css = function(e, classname, strict){\n\t\t\treturn domHelpers.locateClassName(e, classname, strict);\n\t\t};\n\n\t\tgantt._locateHTML = function(e, attribute) {\n\t\t\treturn domHelpers.locateAttribute(e, attribute || this.config.task_attribute);\n\t\t};\n\t}\n\n\tgantt.attachEvent(\"onParse\", function(){\n\t\tif(!isHeadless(gantt)){\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\tif(gantt.config.initial_scroll){\n\t\t\t\t\tvar firstTask = gantt.getTaskByIndex(0);\n\t\t\t\t\tvar id = firstTask ? firstTask.id : gantt.config.root_id;\n\t\t\t\t\t// GS-1450. Don't scroll to the task if there is no timeline\n\t\t\t\t\tif(gantt.isTaskExists(id) && gantt.$task && gantt.utils.dom.isChildOf(gantt.$task, gantt.$container)){\n\t\t\t\t\t\tgantt.showTask(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, {once: true});\n\t\t}\n\n\t});\n\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif (!this.config.scroll_size)\n\t\t\tthis.config.scroll_size = domHelpers.getScrollSize() || 15;\n\n\t\tif(!isHeadless(gantt)){\n\t\t\t// detach listeners before clearing old DOM, possible IE errors when accessing detached nodes\n\t\t\tthis._eventRemoveAll();\n\t\t\tthis.$mouseEvents.reset();\n\n\t\t\tthis.resetLightbox();\n\t\t}\n\n\t});\n\n\t// GS-1261: scroll the views to the right side when RTL is enabled\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(!isHeadless(gantt) && gantt.config.rtl){\n\t\t\tgantt.$layout.getCellsByType(\"viewCell\").forEach(function(cell){ \n\t\t\t\tvar attachedScrollbar = cell.$config.scrollX;\n\t\t\t\tif (!attachedScrollbar) return;\n\n\t\t\t\tvar scrollbar = gantt.$ui.getView(attachedScrollbar);\n\t\t\t\tif (scrollbar) scrollbar.scrollTo(scrollbar.$config.scrollSize,0);\n\n\t\t\t});\n\t\t}\n\t});\n\n\t// GS-1649: check if extensions are connected via files\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(!isHeadless(gantt)){\n\n\t\t\tvar activePlugins = gantt.plugins();\n\n\t\t\tvar availablePlugins = {\n\t\t\t\tauto_scheduling: gantt.autoSchedule,\n\t\t\t\tclick_drag: gantt.ext.clickDrag,\n\t\t\t\tcritical_path: gantt.isCriticalTask,\n\t\t\t\tdrag_timeline: gantt.ext.dragTimeline,\n\t\t\t\texport_api: gantt.exportToPDF,\n\t\t\t\tfullscreen: gantt.ext.fullscreen,\n\t\t\t\tgrouping: gantt.groupBy,\n\t\t\t\tkeyboard_navigation: gantt.ext.keyboardNavigation,\n\t\t\t\tmarker: gantt.addMarker,\n\t\t\t\tmultiselect: gantt.eachSelectedTask,\n\t\t\t\toverlay: gantt.ext.overlay,\n\t\t\t\tquick_info: gantt.templates.quick_info_content,\n\t\t\t\ttooltip: gantt.ext.tooltips,\n\t\t\t\tundo: gantt.undo\n\t\t\t};\n\n\t\t\tfor (let plugin in availablePlugins){\n\t\t\t\tif (availablePlugins[plugin] && !activePlugins[plugin]){\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.warn(`You connected the '${plugin}' extension via an obsolete file. \nTo fix it, you need to remove the obsolete file and connect the extension via the plugins method: https://docs.dhtmlx.com/gantt/api__gantt_plugins.html`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};","export default function(gantt) {\n\tdelete gantt.addTaskLayer;\n\tdelete gantt.addLinkLayer;\n};","function createLayoutFacade(){\n\n\tfunction getTimeline(gantt){\n\t\treturn gantt.$ui.getView(\"timeline\");\n\t}\n\n\tfunction getGrid(gantt){\n\t\treturn gantt.$ui.getView(\"grid\");\n\t}\n\n\tfunction getBaseCell(gantt){\n\t\tvar timeline = getTimeline(gantt);\n\t\tif (timeline && !timeline.$config.hidden){\n\t\t\treturn timeline;\n\t\t} else{\n\t\t\tvar grid = getGrid(gantt);\n\t\t\tif (grid && !grid.$config.hidden){\n\t\t\t\treturn grid;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getVerticalScrollbar(gantt){\n\t\tvar baseCell = null;\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\n\t\tvar gridDrag = false;\n\t\tvar gridMarkers = [\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\n\t\t];\n\t\tgridMarkers.forEach(function (selector) {\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\n\t\t});\n\t\tif (gridDrag){\n\t\t\tbaseCell = getGrid(gantt);\n\t\t} else{\n\t\t\tbaseCell = getBaseCell(gantt);\n\t\t}\n\n\t\t// GS-1827. If there is no grid and timeline, there is no scrollbar for them\n\t\tif (!baseCell){\n\t\t\treturn null;\n\t\t}\n\n\t\tvar verticalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollY\");\n\t\treturn verticalScrollbar;\n\t}\n\n\tfunction getHorizontalScrollbar(gantt){\n\t\tvar baseCell = getBaseCell(gantt);\n\t\tif (!baseCell || baseCell.id == \"grid\"){\n\t\t\treturn null; // if the timeline is not displayed, do not return the scrollbar\n\t\t}\n\t\tvar horizontalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollX\");\n\t\treturn horizontalScrollbar;\n\t}\n\n\tfunction getAttachedScrollbar(gantt, cell, type){\n\t\tvar attachedScrollbar = cell.$config[type];\n\t\tvar scrollbarView = gantt.$ui.getView(attachedScrollbar);\n\t\treturn scrollbarView;\n\t}\n\n\tvar DEFAULT_VALUE = \"DEFAULT_VALUE\";\n\n\tfunction tryCall(getView, method, args, fallback){\n\t\tvar view = getView(this);\n\t\tif (!(view && view.isVisible())) {\n\t\t\tif(fallback){\n\t\t\t\treturn fallback();\n\t\t\t}else{\n\t\t\t\treturn DEFAULT_VALUE;\n\t\t\t}\n\t\t} else {\n\t\t\treturn view[method].apply(view, args);\n\t\t}\n\t}\n\n\treturn {\n\n\t\tgetColumnIndex: function(name) {\n\t\t\tvar res = tryCall.call(this, getGrid, \"getColumnIndex\", [name]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tdateFromPos: function(x) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"dateFromPos\", Array.prototype.slice.call(arguments));\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn this.getState().min_date;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tposFromDate: function(date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"posFromDate\", [date]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetRowTop: function(index) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getRowTop\", [index],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getRowTop\", [index]);}\n\t\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskTop: function(id) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemTop\", [id],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemTop\", [id]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\n\t\tgetTaskPosition: function(task, start_date, end_date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getItemPosition\", [task, start_date, end_date]);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\tvar top = this.getTaskTop(task.id);\n\t\t\t\tvar height = this.getTaskBarHeight(task.id);\n\n\t\t\t\treturn {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: top,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: 0\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskBarHeight: function(taskId, isMilestoneRender) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getBarHeight\", [taskId, isMilestoneRender],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskHeight: function(taskId) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemHeight\", [taskId],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\n\t\tcolumnIndexByDate: function(date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"columnIndexByDate\", [date]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\troundTaskDates: function() {\n\t\t\ttryCall.call(this, getTimeline, \"roundTaskDates\", []);\n\t\t},\n\n\t\tgetScale: function() {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getScale\", []);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn null;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskNode: function(id) {\n\t\t\tvar timeline = getTimeline(this);\n\t\t\tif (!timeline || !timeline.isVisible()) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\tvar node = timeline._taskRenderer.rendered[id];\n\t\t\t\tif(!node){\n\t\t\t\t\tvar domAttr = timeline.$config.item_attribute;\n\t\t\t\t\tnode = timeline.$task_bars.querySelector(\"[\" +domAttr+ \"='\"+id+\"']\");\n\t\t\t\t}\n\n\t\t\t\treturn node || null;\n\t\t\t}\n\t\t},\n\n\n\t\tgetLinkNode: function(id) {\n\t\t\tvar timeline = getTimeline(this);\n\t\t\tif (!timeline.isVisible()) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\treturn timeline._linkRenderer.rendered[id];\n\t\t\t}\n\t\t},\n\n\t\tscrollTo: function(left, top){\n\t\t\tvar vertical = getVerticalScrollbar(this);\n\t\t\tvar horizontal = getHorizontalScrollbar(this);\n\n\t\t\tvar oldH = {position: 0},\n\t\t\t\toldV = {position: 0};\n\n\t\t\tif(vertical){\n\t\t\t\toldV = vertical.getScrollState();\n\t\t\t}\n\t\t\tif(horizontal){\n\t\t\t\toldH = horizontal.getScrollState();\n\t\t\t}\n\n\t\t\tvar scrollHorizontal = (horizontal && left*1 == left);\n\t\t\tvar scrollVertical = (vertical && top*1 == top);\n\t\t\tvar scrollBoth = scrollHorizontal && scrollVertical;\n\n\t\t\tif(scrollBoth){\n\t\t\t\t// some views will be scrolled both horizontally and vertically and smart rendering can be called twice\n\t\t\t\t// set flag in order not to invoke smart rendering at the horizontal scroll stage\n\t\t\t\t// so it will repaint only once when the scroll is completed\n\t\t\t\tvar verticalViews = vertical._getLinkedViews();\n\t\t\t\tvar horizontalViews = horizontal._getLinkedViews();\n\n\t\t\t\tvar commonViews = [];\n\t\t\t\tfor(var i = 0; i < verticalViews.length; i++){\n\t\t\t\t\tfor(var j = 0; j < horizontalViews.length; j++){\n\n\t\t\t\t\t\tif(verticalViews[i].$config.id && horizontalViews[j].$config.id && verticalViews[i].$config.id === horizontalViews[j].$config.id){\n\t\t\t\t\t\t\tcommonViews.push(verticalViews[i].$config.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (scrollHorizontal){\n\t\t\t\tif(commonViews){\n\t\t\t\t\tcommonViews.forEach((function(viewId){\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = true;\n\t\t\t\t\t}).bind(this));\n\t\t\t\t}\n\n\t\t\t\thorizontal.scroll(left);\n\t\t\t\tif(commonViews){\n\t\t\t\t\tcommonViews.forEach((function(viewId){\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = false;\n\t\t\t\t\t}).bind(this));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(scrollVertical){\n\t\t\t\tvertical.scroll(top);\n\t\t\t}\n\n\t\t\tvar newV = {position: 0},\n\t\t\t\tnewH = {position: 0};\n\t\t\tif(vertical){\n\t\t\t\tnewV = vertical.getScrollState();\n\t\t\t}\n\t\t\tif(horizontal){\n\t\t\t\tnewH = horizontal.getScrollState();\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onGanttScroll\", [oldH.position, oldV.position, newH.position, newV.position]);\n\t\t},\n\n\t\tshowDate: function(date){\n\t\t\tvar date_x = this.posFromDate(date);\n\t\t\tvar scroll_to = Math.max(date_x - this.config.task_scroll_offset, 0);\n\t\t\tthis.scrollTo(scroll_to);\n\t\t},\n\t\tshowTask: function(id) {\n\t\t\tvar pos = this.getTaskPosition(this.getTask(id));\n\n\t\t\t// GS-1261: we need to show the start_date even in the RTL mode\n\t\t\tvar leftPos = pos.left;\n\t\t\tif (this.config.rtl) leftPos = pos.left + pos.width;\n\n\t\t\tvar left = Math.max(leftPos - this.config.task_scroll_offset, 0);\n\n\t\t\tvar dataHeight = this._scroll_state().y;\n\t\t\tvar top;\n\t\t\tif(!dataHeight){\n\t\t\t\ttop = pos.top;\n\t\t\t}else{\n\t\t\t\ttop = pos.top - (dataHeight - this.getTaskBarHeight(id))/2;\n\t\t\t}\n\n\t\t\tthis.scrollTo(left, top);\n\t\t\t// GS-1150: if the grid and timeline have different scrollbars, we need to scroll thegrid to show the task\n\t\t\tvar gridCell = getGrid(this);\n\t\t\tvar timelineCell = getTimeline(this);\n\t\t\tif (gridCell && timelineCell && gridCell.$config.scrollY != timelineCell.$config.scrollY){\n\t\t\t\tvar gridScrollbar = getAttachedScrollbar(this, gridCell, \"scrollY\");\n\t\t\t\tgridScrollbar.scrollTo(null, top);\n\t\t\t}\n\t\t},\n\t\t_scroll_state: function(){\n\t\t\tvar result = {\n\t\t\t\tx: false,\n\t\t\t\ty: false,\n\t\t\t\tx_pos: 0,\n\t\t\t\ty_pos: 0,\n\t\t\t\tscroll_size: this.config.scroll_size + 1,//1px for inner content\n\t\t\t\tx_inner: 0,\n\t\t\t\ty_inner: 0\n\t\t\t};\n\n\t\t\tvar scrollVer = getVerticalScrollbar(this),\n\t\t\t\tscrollHor = getHorizontalScrollbar(this);\n\t\t\tif(scrollHor){\n\t\t\t\tvar horState = scrollHor.getScrollState();\n\t\t\t\tif(horState.visible){\n\t\t\t\t\tresult.x = horState.size;\n\t\t\t\t\tresult.x_inner = horState.scrollSize;\n\t\t\t\t}\n\t\t\t\tresult.x_pos = horState.position || 0;\n\t\t\t}\n\n\t\t\tif(scrollVer){\n\t\t\t\tvar verState = scrollVer.getScrollState();\n\t\t\t\tif(verState.visible){\n\t\t\t\t\tresult.y = verState.size;\n\n\t\t\t\t\tresult.y_inner = verState.scrollSize;\n\t\t\t\t}\n\t\t\t\tresult.y_pos = verState.position || 0;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tgetScrollState: function(){\n\t\t\tvar state = this._scroll_state();\n\t\t\treturn { x:state.x_pos, y:state.y_pos, inner_width:state.x, inner_height:state.y, width: state.x_inner, height: state.y_inner };\n\t\t},\n\n\t\tgetLayoutView: function(cellName){\n\t\t\treturn this.$ui.getView(cellName);\n\t\t},\n\n\t\tscrollLayoutCell: function(cellName, left, top){\n\t\t\tconst cell = this.$ui.getView(cellName);\n\t\t\tif (!cell){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (left !== null){\n\t\t\t\tconst horizontalScroll = this.$ui.getView(cell.$config.scrollX);\n\t\t\t\tif (horizontalScroll){\n\t\t\t\t\thorizontalScroll.scrollTo(left, null);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (top !== null){\n\t\t\t\tconst verticalScroll = this.$ui.getView(cell.$config.scrollY);\n\t\t\t\tif (verticalScroll){\n\t\t\t\t\tverticalScroll.scrollTo(null, top);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n}\n\nexport default createLayoutFacade;","export default function(gantt) {\ngantt.skins.skyblue = {\n\tconfig:{\n\t\tgrid_width:370,\n\t\trow_height: 27,\n\t\tbar_height_padding:4,\n\t\tscale_height: 27,\n\t\tlink_line_width:1,\n\t\tlink_arrow_size:8,\n\t\tlink_radius:2,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:95,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins.dark = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 36,\n\t\tscale_height: 36,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tbar_height_padding:9,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:70\t\t\n};\n\n};","export default function(gantt) {\ngantt.skins.meadow = {\n\tconfig:{\n\t\tgrid_width:380,\n\t\trow_height: 27,\n\t\tscale_height: 30,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:10,\n\t\tbar_height_padding:4,\n\t\tlightbox_additional_height:72\n\t},\n\t_second_column_width:95,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins.terrace = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 36,\n\t\tscale_height: 36,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tbar_height_padding:9,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:70\t\t\n};\n\n};","export default function(gantt) {\n\tgantt.skins.broadway = {\n\t\tconfig: {\n\t\t\tgrid_width: 390,\n\t\t\trow_height: 35,\n\t\t\tscale_height: 35,\n\t\t\tlink_line_width: 1,\n\t\t\tlink_arrow_size: 9,\n\t\t\tbar_height_padding:4,\n\t\t\tlightbox_additional_height: 86\n\t\t},\n\t\t_second_column_width: 100,\n\t\t_third_column_width: 80,\n\n\t\t_lightbox_template: \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>\",\n\t\t_config_buttons_left: {},\n\t\t_config_buttons_right: {\n\t\t\t\"gantt_delete_btn\": \"icon_delete\",\n\t\t\t\"gantt_save_btn\": \"icon_save\"\n\t\t}\n\t};\n};","export default function(gantt) {\n\tgantt.skins.material = {\n\t\tconfig: {\n\t\t\tgrid_width: 411,\n\t\t\trow_height: 34,\n\t\t\tscale_height: 36,\n\t\t\tlink_line_width: 2,\n\t\t\tlink_arrow_size: 12,\n\t\t\tbar_height_padding:9,\n\t\t\tlightbox_additional_height: 80\n\t\t},\n\t\t_second_column_width: 110,\n\t\t_third_column_width: 75,\n\t\t_redefine_lightbox_buttons: {\n\t\t\t\"buttons_left\": [\"dhx_delete_btn\"],\n\t\t\t\"buttons_right\": [\"dhx_cancel_btn\", \"dhx_save_btn\"]\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onAfterTaskDrag\", function (id) {\n\t\tvar t = gantt.getTaskNode(id);\n\t\tif (t) {\n\t\t\tt.className += \" gantt_drag_animation\";\n\t\t\tsetTimeout(function () {\n\t\t\t\tvar indx = t.className.indexOf(\" gantt_drag_animation\");\n\t\t\t\tif (indx > -1) {\n\t\t\t\t\tt.className = t.className.slice(0, indx);\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t});\n\n};","export default function(gantt) {\ngantt.skins[\"contrast_black\"] = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 35,\n\t\tscale_height: 35,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins[\"contrast_white\"] = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 35,\n\t\tscale_height: 35,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:80\n};\n\n};","import autoscroll from \"./autoscroll\";\nimport jquery_hooks from \"./jquery_hooks\";\nimport dhtmlx_hooks from \"./dhtmlx_hooks\";\nimport TimelineZoom from \"./timeline_zoom\";\n\n\nexport default function(gantt){\n\tif(!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tvar modules = [\n\t\tautoscroll,\n\t\tjquery_hooks,\n\t\tdhtmlx_hooks\n\t];\n\n\tfor(var i = 0; i < modules.length; i++){\n\t\tif(modules[i])\n\t\t\tmodules[i](gantt);\n\t}\n\n\tgantt.ext.zoom = new TimelineZoom(gantt);\n};","export default function(gantt) {\n\n\tgantt._extend_to_optional = function (lightbox_block) {\n\n\t\tvar duration = lightbox_block;\n\t\tvar optional_time = {\n\t\t\trender: duration.render,\n\t\t\tfocus: duration.focus,\n\t\t\tset_value: function (node, value, task, section) {\n\t\t\t\tvar mapping = gantt._resolve_default_mapping(section);\n\t\t\t\tif (!task[mapping.start_date] || (mapping.start_date == \"start_date\" && this._isAllowedUnscheduledTask(task))) {\n\t\t\t\t\toptional_time.disable(node, section);\n\t\t\t\t\tvar val = {};\n\n\t\t\t\t\tfor (var i in mapping) {\n\t\t\t\t\t\t//take default values from the time control from task start/end dates\n\t\t\t\t\t\tval[mapping[i]] = task[i];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, val, section);//set default value\n\t\t\t\t} else {\n\t\t\t\t\toptional_time.enable(node, section);\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, task, section);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_value: function (node, task, section) {\n\t\t\t\tif (section.disabled) {\n\t\t\t\t\treturn {start_date: null};\n\t\t\t\t} else {\n\t\t\t\t\treturn duration.get_value.call(gantt, node, task, section);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate_block: function (node, section) {\n\t\t\t\tgantt.callEvent(\"onSectionToggle\", [gantt._lightbox_id, section]);\n\t\t\t\tnode.style.display = section.disabled ? \"none\" : \"\";\n\n\t\t\t\tif (section.button) {\n\t\t\t\t\tvar button = node.previousSibling.querySelector(\".gantt_custom_button_label\"),\n\t\t\t\t\t\tlabels = gantt.locale.labels;\n\n\t\t\t\t\tvar button_text = section.disabled ? labels[section.name + \"_enable_button\"] : labels[section.name + \"_disable_button\"];\n\n\t\t\t\t\tbutton.innerHTML = button_text;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisable: function (node, section) {\n\t\t\t\tsection.disabled = true;\n\t\t\t\toptional_time.update_block(node, section);\n\n\t\t\t},\n\t\t\tenable: function (node, section) {\n\t\t\t\tsection.disabled = false;\n\t\t\t\toptional_time.update_block(node, section);\n\t\t\t},\n\t\t\tbutton_click: function (index, el, section, container) {\n\t\t\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar config = gantt._get_typed_lightbox_config()[index];\n\t\t\t\tif (config.disabled) {\n\t\t\t\t\toptional_time.enable(container, config);\n\t\t\t\t} else {\n\t\t\t\t\toptional_time.disable(container, config);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn optional_time;\n\t};\n\n\tgantt.form_blocks.duration_optional = gantt._extend_to_optional(gantt.form_blocks.duration);\n\tgantt.form_blocks.time_optional = gantt._extend_to_optional(gantt.form_blocks.time);\n\n};","export default function(gantt){\n\tvar htmlTags = new RegExp(\"<(?:.|\\n)*?>\", \"gm\");\n\tvar extraSpaces = new RegExp(\" +\", \"gm\");\n\n\tfunction stripHTMLLite(htmlText){\n\t\treturn (htmlText + \"\")\n\t\t\t.replace(htmlTags, \" \").\n\t\t\treplace(extraSpaces, \" \");\n\t}\n\n\tvar singleQuotes = new RegExp(\"'\", \"gm\");\n\tfunction escapeQuotes(text){\n\t\treturn (text + \"\").replace(singleQuotes, \"&#39;\");\n\t}\n\n\tgantt._waiAria = {\n\t\tgetAttributeString: function(attr){\n\t\t\tvar attributes = [\" \"];\n\t\t\tfor(var i in attr){\n\t\t\t\tvar text = escapeQuotes(stripHTMLLite(attr[i]));\n\t\t\t\tattributes.push(i + \"='\" + text + \"'\");\n\t\t\t}\n\t\t\tattributes.push(\" \");\n\t\t\treturn attributes.join(\" \");\n\n\t\t},\n\n\t\tgetTimelineCellAttr:function(dateString){\n\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": dateString});\n\t\t},\n\n\t\t_taskCommonAttr: function(task, div){\n\n\t\t\tif(!(task.start_date && task.end_date))\n\t\t\t\treturn;\n\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(gantt.templates.tooltip_text(task.start_date, task.end_date, task)));\n\n\t\t\tif(task.$dataprocessor_class){\n\t\t\t\tdiv.setAttribute(\"aria-busy\", true);\n\t\t\t}\n\n\t\t},\n\n\t\tsetTaskBarAttr: function(task, div){\n\t\t\tthis._taskCommonAttr(task, div);\n\n\t\t\t// task bars are complex elements that should be treated as a single element\n\t\t\tdiv.setAttribute(\"role\", \"img\");\n\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.drag_move){\n\t\t\t\tif(task.id != gantt.getState(\"tasksDnd\").drag_id){\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\n\t\t\t\t}else{\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\ttaskRowAttr: function(task, div){\n\n\t\t\tthis._taskCommonAttr(task, div);\n\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.order_branch){\n\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\n\t\t\t}\n\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t\t// selected attribute should be added only to the grid  because\n\t\t\t// other parts don't have the keyboard navigation\n\t\t\tdiv.setAttribute(\"aria-selected\", gantt.isSelectedTask(task.id) ? \"true\" : \"false\");\n\n\t\t\t// allowed values start from 1, set 1 for non-tree datastores\n\t\t\tdiv.setAttribute(\"aria-level\", task.$level + 1 || 1);\n\n\t\t\tif(gantt.hasChild(task.id)){\n\t\t\t\tdiv.setAttribute(\"aria-expanded\", task.$open ? \"true\" : \"false\");\n\t\t\t}\n\t\t},\n\n\t\tlinkAttr: function(link, div){\n\n\t\t\tvar linkTypes = gantt.config.links;\n\n\t\t\tvar toStart = link.type == linkTypes.finish_to_start || link.type == linkTypes.start_to_start;\n\t\t\tvar fromStart = link.type == linkTypes.start_to_start || link.type == linkTypes.start_to_finish;\n\n\t\t\tvar content = gantt.locale.labels.link + \" \" +  gantt.templates.drag_link(link.source, fromStart, link.target, toStart);\n\n\t\t\t// links are complex elements that should be treated as a single element\n\t\t\tdiv.setAttribute(\"role\", \"img\");\n\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(content));\n\t\t\tif(gantt.isReadonly(link)){\n\t\t\t\tdiv.setAttribute(\"aria-readonly\", true);\n\t\t\t}\n\t\t},\n\n\t\tgridSeparatorAttr: function(div){\n\t\t\t// the only valid role for the grid header\n\t\t\tdiv.setAttribute(\"role\", \"columnheader\");\n\t\t},\n\t\trowResizerAttr: function(div){\n\t\t\t// the only valid role for the grid header\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t},\n\n\t\tlightboxHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t},\n\n\t\tlightboxVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\tlightboxAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t\tdiv.firstChild.setAttribute(\"role\", \"heading\");\n\t\t\tdiv.firstChild.setAttribute(\"aria-level\", \"1\");\n\t\t},\n\n\t\tlightboxButtonAttrString:function(buttonName){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":gantt.locale.labels[buttonName], \"tabindex\":\"0\"});\n\t\t},\n\n\t\tlightboxHeader: function(div, headerText){\n\t\t\tdiv.setAttribute(\"aria-label\", headerText);\n\t\t},\n\n\t\tlightboxSelectAttrString: function(time_option){\n\t\t\tvar label = \"\";\n\n\t\t\tswitch (time_option) {\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tlabel = gantt.locale.labels.years;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tlabel = gantt.locale.labels.months;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tlabel = gantt.locale.labels.days;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%H:%i\":\n\t\t\t\t\tlabel = gantt.locale.labels.hours + gantt.locale.labels.minutes;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": label});\n\t\t},\n\n\t\tlightboxDurationInputAttrString: function(section){\n\t\t\treturn this.getAttributeString({\n\t\t\t\t\"aria-label\": gantt.locale.labels.column_duration,\n\t\t\t\t\"aria-valuemin\": \"0\",\n\t\t\t\t\"role\": \"spinbutton\"\n\t\t\t});\n\t\t},\n\n\t\tinlineEditorAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t},\n\n\t\tgridAttrString: function(){\n\t\t\treturn [\" role='treegrid'\", gantt.config.multiselect ? \"aria-multiselectable='true'\" : \"aria-multiselectable='false'\", \" \"].join(\" \");\n\t\t},\n\n\n\t\tgridScaleRowAttrString: function(){\n\t\t\treturn \"role='row'\";\n\t\t},\n\n\t\tgridScaleCellAttrString: function(column, label){\n\t\t\tvar attrs = \"\";\n\t\t\tif(column.name == \"add\"){\n\t\t\t\t// a more precise role is button, but it is not valid for the grid header\n\t\t\t\tattrs = this.getAttributeString({\"role\":\"columnheader\", \"aria-label\": gantt.locale.labels.new_task});\n\t\t\t}else{\n\n\t\t\t\tvar attributes = {\n\t\t\t\t\t\"role\":\"columnheader\",\n\t\t\t\t\t\"aria-label\": label\n\t\t\t\t};\n\n\t\t\t\tif(gantt._sort && gantt._sort.name == column.name){\n\t\t\t\t\tif(gantt._sort.direction == \"asc\"){\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"ascending\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"descending\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tattrs = this.getAttributeString(attributes);\n\t\t\t}\n\t\t\treturn attrs;\n\t\t},\n\n\t\tgridDataAttrString: function(){\n\t\t\treturn \"role='rowgroup'\";\n\t\t},\n\n\t\treorderMarkerAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"grid\");\n\t\t\tdiv.firstChild.removeAttribute(\"aria-level\");\n\t\t\tdiv.firstChild.setAttribute(\"aria-grabbed\", \"true\");\n\t\t},\n\n\t\tgridCellAttrString: function(column, textValue, task){\n\t\t\tvar attributes = {\"role\":\"gridcell\", \"aria-label\": textValue};\n\t\t\tif(!column.editor || gantt.isReadonly(task)){\n\t\t\t\tattributes[\"aria-readonly\"] = true;\n\t\t\t}\n\n\t\t\treturn this.getAttributeString(attributes);\n\t\t},\n\n\t\tgridAddButtonAttrString: function(column){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\": gantt.locale.labels.new_task});\n\t\t},\n\n\t\tmessageButtonAttrString: function(buttonLabel){\n\t\t\treturn \"tabindex='0' role='button' aria-label='\"+buttonLabel+\"'\";\n\t\t},\n\n\t\tmessageInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"alert\");\n\t\t\t//div.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tmessageModalAttr: function(div, uid){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tif(uid){\n\t\t\t\tdiv.setAttribute(\"aria-labelledby\", uid);\n\t\t\t}\n\n\t\t//\tdiv.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tquickInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t},\n\n\t\tquickInfoHeaderAttrString: function(){\n\t\t\treturn \" role='heading' aria-level='1' \";\n\t\t},\n\n\t\tquickInfoHeader: function(div, header){\n\t\t\tdiv.setAttribute(\"aria-label\", header);\n\t\t},\n\n\t\tquickInfoButtonAttrString: function(label){\n\t\t\treturn gantt._waiAria.getAttributeString({\"role\":\"button\", \"aria-label\":label, \"tabindex\":\"0\"});\n\t\t},\n\n\t\ttooltipAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"tooltip\");\n\t\t},\n\n\t\ttooltipVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\ttooltipHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t};\n\n\tfunction isDisabled(){\n\t\treturn !gantt.config.wai_aria_attributes;\n\t}\n\n\tfor(var i in gantt._waiAria){\n\t\tgantt._waiAria[i] = (function(payload){\n\t\t\treturn function(){\n\t\t\t\tif(isDisabled()){\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t\treturn payload.apply(this, arguments);\n\t\t\t};\n\t\t})(gantt._waiAria[i]);\n\t}\n\n\n};","import extensions from \"./ext/extensions_gpl\";\nimport base from \"./factory/make_instance_web\";\nimport scope from \"./utils/global\";\nconst gantt = (scope as any).gantt = base(extensions);\n\nexport default gantt;\nexport { gantt };","import \"../css/dhtmlxgantt.less\";\n\nimport factory from \"./make_instance_common\";\nimport ui from \"../core/ui_core\";\nimport ajaxLoading from \"../core/loading/ajax_loading\";\nimport dynamicLoading from \"../core/loading/dynamic_loading\";\n\nexport default function(supportedExtensions) {\n\tvar gantt = factory(supportedExtensions);\n\n\tif(!gantt.env.isNode){\n\t\tui(gantt);\n\t\tajaxLoading(gantt);\n\t\tdynamicLoading(gantt);\n\t}\n\n\treturn gantt;\n};","export default function(gantt) {\n\tgantt.load = function (url, type, callback) {\n\t\tthis._load_url = url;\n\t\tthis.assert(arguments.length, \"Invalid load arguments\");\n\n\t\tvar tp = 'json', cl = null;\n\t\tif (arguments.length >= 3) {\n\t\t\ttp = type;\n\t\t\tcl = callback;\n\t\t} else {\n\t\t\tif (typeof arguments[1] == \"string\")\n\t\t\t\ttp = arguments[1];\n\t\t\telse if (typeof arguments[1] == \"function\")\n\t\t\t\tcl = arguments[1];\n\t\t}\n\n\t\tthis._load_type = tp;\n\n\t\tthis.callEvent(\"onLoadStart\", [url, tp]);\n\n\t\treturn this.ajax.get(url, gantt.bind(function (l) {\n\t\t\tthis.on_load(l, tp);\n\t\t\tthis.callEvent(\"onLoadEnd\", [url, tp]);\n\t\t\tif (typeof cl == \"function\")\n\t\t\t\tcl.call(this);\n\t\t}, this));\n\t};\n};"],"names":["getNodePosition","elem","top","left","right","bottom","getBoundingClientRect","box","body","document","docElem","documentElement","parentNode","scrollTop","window","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","offsetWidth","offsetHeight","parseInt","offsetTop","offsetLeft","offsetParent","y","Math","round","x","width","height","isVisible","node","display","visibility","getComputedStyle","style","currentStyle","hasNonNegativeTabIndex","isNaN","getAttribute","hasHref","a","area","nodeName","loLowerCase","isEnabled","input","select","textarea","button","object","toLowerCase","hasAttribute","getFocusableNodes","root","nodes","querySelectorAll","join","nodesArray","Array","prototype","slice","call","i","length","$position","sort","b","tabIndex","splice","getScrollSize","div","createElement","cssText","appendChild","clientWidth","removeChild","max","getClassName","className","baseVal","indexOf","_trimString","addClassName","removeClassName","name","split","regEx","RegExp","replace","toNode","getElementById","querySelector","_slave","insertNode","newone","innerHTML","child","firstChild","removeNode","getChildNodes","css","ch","childNodes","len","out","obj","push","getTargetNode","e","trg","tagName","event","target","srcElement","shadowRoot","composedPath","locateAttribute","attribute","str","String","trim","this","apply","locateClassName","classname","strict","undefined","ind","charAt","getRelativeEventPosition","ev","d","clientX","clientY","getRelativeNodePosition","parent","childPos","parentPos","isChildOf","closest","element","selector","matches","msMatchesSelector","webkitMatchesSelector","el","contains","parentElement","nodeType","console","error","getClosestSizedElement","isShadowDomSupported","head","createShadowRoot","attachShadow","getActiveElement","activeElement","getSelection","focusNode","getRootNode","ShadowRoot","host","classList","test","scope","global","EventsManager$1","gantt","_mouseDown","_gantt","_domEvents","_createDomEventScope","selectedRegion","useKey","ignore","_target","getViewPort","_originPosition","_restoreOriginPosition","position","state","$services","getService","registerProvider","autoscroll","scheduledDndCoordinates","startDragAndDrop","setStart","copy","setPosition","setEnd","attach","filterTargets","utils","dom","_getCoordinates","eventElement","domHelpers.getRootNode","$root","coordinates","dragEnd","dragTimeline","ext","clickDrag","dragTimelineUseKey","config","drag_timeline","abs","relative","render","detachAll","unregisterProvider","detach","viewPort","viewPortBounds","absolute","EventHost","_silent_mode","listeners","_silentStart","_silentEnd","createEventStorage","handlers","index","eventStorage","combinedResult","handlerResult","arguments","addEvent","handler","settings","t","handlerId","id","once","originalHandler","removeEvent","clear","makeEventable","eventHost","attachEvent","eventName","thisObject","bind","attachAll","callback","callEvent","eventArguments","handlerName","concat","checkEvent","detachEvent","list","eventId","detachAllEvents","units","second","minute","hour","day","week","month","quarter","year","getSecondsInUnit","unit","forEach","arr","workArray","arrayFind","find","arrayIncludes","item","includes","isArray","pop","isDate","getFullYear","getMonth","getDate","isValidDate","getTime","delay","timeout","timer","result","$cancelTimeout","$pending","args","setTimeout","clearTimeout","$execute","replaceValidZeroId","rootId","checkZeroId","findBinary","array","prev","low","high","floor","SelectedRegion","view","_el","defaultRender","start","end","min","_singleRow","pos","_getTaskPositionByTop","_startPoint","_view","_viewPort","add","_callback","_endPoint","draw","eventable","singleRow","_useRequestAnimationFrame","useRequestAnimationFrame","requestAnimationFrame","getElement","startPoint","_startDate","dateFromPos","endPoint","_endDate","_positionPoint","positionPoint","getState","max_date","valueOf","tasksByTime","getTaskByTime","tasksByIndex","_getTasksByTop","startValue","endValue","startIndex","endIndex","getTaskByIndex","getItemIndexByTopPosition","task","getItemHeight","getItemTop","dataHeight","getTotalHeight","row_height","getTaskCount","EventsManager","_calculateDirectionVector","_trace","dots","vectors","resultVector","vector","magnitude","sqrt","angleDegrees","atan2","PI","_applyDndReadyStyles","_timeline","$task","_clearDndReadyStyles","remove","_getScrollPosition","timeline","$ui","getView","$config","scrollX","getScrollState","scrollY","_countNewScrollPosition","coords","shiftX","shiftY","_scrollState","_setScrollPosition","scrollLayoutCell","$id","_stopDrag","_originalReadonly","readonly","_originAutoscroll","_startDrag","destructor","enabled","clickDragUseKey","click_drag","scrollPosition","modals","modalsStack","isModal","afterPopup","$destroyed","focus","startModal","eventRemove","trapFocus","endModal","currentTarget","$keyboardNavigation","traceLightbox","getLightbox","focusElement","QuickInfo","show","_showForTask","_showAtCoordinates","hide","forced","qi","_quickInfoBox","_quickInfoBoxId","taskId","_quickInfoTask","quick_info_detached","getNode","setContainer","container","_container","setContent","content","defaultContent","header","title","date","buttons","quickinfo_buttons","_createQuickInfoElement","titleBox","titleContent","titleDate","main","controls","_waiAria","quickInfoHeader","html","ariaAttr","quickInfoButtonAttrString","locale","labels","_qiButtonClickHandler","_qiKeyPressHandler","_qi_button_click","code","which","_appendAtCoordinates","show_quick_info","_getContainer","_get_event_counter_part","xViewport","yViewport","_init_quick_info","_prepare_quick_info_classname","_fill_quick_data","_show_quick_info","offset","domEv","getTaskNode","getTaskRowNode","scroll","dx","dy","quickInfoAttr","quickInfoHeaderAttrString","getTask","_quickInfoReadonly","isReadonly","getTaskType","template","templates","quick_info_class","start_date","end_date","allowedButtons","isEditor","icon_delete","icon_edit","quick_info_title","quick_info_date","quick_info_content","popupHeight","scrolls","screenWidth","relativePopupBottom","mask","$click","$task_data","$grid_data","$grid","$layout","seed","plainObjectConstructor","constructor","toString","helpers.isDate","Date","helpers.isArray","Object","create","hasOwnProperty","mixin","source","force","f","defined","uid","functor","capture","addEventListener","removeEventListener","createScope","utils.event","utils.eventRemove","eventScope","staticArray","extend","Tooltip","_tooltipNode","tooltipAttr","_root","domHelpers.isChildOf","_isLikeMouseEvent","_calculateTooltipPosition","tooltipVisibleAttr","tooltipHiddenAttr","viewport","_getViewPortSize","tooltipNode","tooltip","offsetX","tooltip_offset_x","offsetY","tooltip_offset_y","mouse","domHelpers.getRelativeEventPosition","containerPos","domHelpers.getNodePosition","_getViewPort","TooltipManager","_listeners","domEventsScope","_initDelayedFunctions","hideTooltip","delayHide","watchableTarget","eventTarget","domHelpers.getTargetNode","targetNode","domHelpers.closest","doOnMouseEnter","onmouseenter","onmousemove","onmouseleave","listener","cloneDomEvent","clone","createEvent","delayShow","helpers.delay","tooltip_timeout","tooltip_hide_timeout","noTrack","onBeforeUndo","onBeforeRedo","batchActions","Monitor","undo","_batchAction","_batchMode","_ignore","_ignoreMoveEvents","_initialTasks","_initialLinks","_nestedTasks","_nestedLinks","_undo","_attachEvents","type","overwrite","undo_types","_storeTask","link","_storeLink","isMoveEventsIgnored","newValue","stopIgnore","startBatchAction","_timeout","stopBatchAction","action","logAction","_storeTaskCommand","command","update","$local_index","getTaskIndex","oldValue","getInitialTask","getParent","_storeEntityCommand","move","entity","children","childrenLinks","_storeLinkCommand","taskIds","tasks","linkIds","_getLinks","setInitialTask","uniqueLinks","links","setInitialLink","$index","getGlobalTaskIndex","setInitialTaskObject","getLink","clearInitialLinks","deleteCacheCooldown","saveInitialAll","clearInitialTasks","eachTask","getLinks","getMoveObjectByTaskId","startIgnore","clearUndoStack","clearRedoStack","onTaskAdded","onTaskUpdated","onTaskDeleted","onLinkAdded","onLinkUpdated","onLinkDeleted","onTaskMoved","toggleIgnoreMoveEvents","store","nested","setNestedTasks","datastore","getDatastore","tindex","dragId","projectDrag","drag_id","isSummaryTask","drag_project","plugins","multiselect","selectedIds","getSelectedTasks","inlineEditors","onBeforeEditStartId","onEditStart","updateConfigs","undoEnabled","commands","old","actionType","entityType","_storeCommand","isTaskExists","getInitialLink","$source","$target","linkId","Undo","maxSteps","redoEnabled","invert","revert","value","inverseCommands","types","assert","_undoStack","_redoStack","stack","getRedoStack","undo_steps","undo_actions","redo","_pop","_reorderCommands","_applyAction","_push","shift","weights","any","actionWeights","weightA","entities","actions","methods","get","isExists","batchUpdate","method","getMethod","check","prop","copyProperty","startsWith","extensions","defaultConfig","eventsManager","fullscreen","isExpanded","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","isFullscreenAvailable","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","backupBodyPadding","overflow","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","backupElementSizes","zIndex","modified","backupPositioning","updateSizes","expandGantt","onFullScreenChange","$container","getFullscreenElement","positions","originalPositioning","setFullScreenSizes","record","cantFullscreen","warning","log","expand","requestArguments","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","requestExitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","exitFullscreen","toggle","collapse","keyboard_navigation","keyboard_navigation_cells","_compose","parts","res","p","shortcuts","createCommand","modifiers","alt","ctrl","meta","keyCode","parse","shortcut","expr","getExpressions","words","getWords","j","commandKeys","specialKeys","charCodeAt","getCommandFromEvent","domEvent","shiftKey","altKey","ctrlKey","metaKey","printableKey","fromCharCode","getHashFromEvent","getHash","junctionChar","term","combinationChar","backspace","tab","enter","esc","space","up","down","home","pageup","pagedown","delete","insert","plus","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","EventHandler","_handlers","findHandler","hash","doAction","facade","preventDefault","returnValue","unbind","bindAll","map","initKeys","keys","domHelpers.getFocusableNodes","focusable","currentFocus","domHelpers.getActiveElement","currentIndex","lastItem","firstItem","GanttNode","blur","scrollHorizontal","dir","scale","getScale","step","scrollTo","posFromDate","scrollVertical","KeyNavNode","isValid","fallback","moveTo","dispatcher","setActiveNode","compareTo","canStringifyThis","canStringifyThat","eventFacade","setAttribute","$eventAttached","HeaderCell","show_grid","getVisibleTaskCount","getGridColumns","TaskRow","visibleColumns","fromDomElement","cellElement","domHelpers.locateClassName","previousSibling","$grid_scale","columns","taskRow","rootLevel","getChildren","root_id","TaskCell","click","createTask","globalIndex","splitItem","$split_subtask","parentId","nextIndex","locate","isTaskVisible","task_attribute","keptFocus","getTaskPosition","getTaskHeight","viewWidth","viewHeight","inner_width","inner_height","scroll_on_click","show_chart","task_scroll_offset","grid","scrollPositionX","scrollPositionY","attachedScrollbarHorizontal","scrollable","scrollbarHorizontal","attachedScrollbarVertical","scrollbarVertical","scrollGrid","nextElement","prevTask","getPrev","nextTask","getNext","hasChild","$open","open","close","prevId","getPrevSibling","moveTask","updateTask","isSelectedTask","unselectTask","selectTask","showLightbox","columnIndex","domHelpers.locateAttribute","row","isActive","activeNode","globalNode","enable","getActiveNode","disable","getDefaultNode","setDefaultNode","inputs","focusGlobalNode","blurNode","focusChanged","keyDownHandler","defaultPrevented","ganttNode","awaitsFocus","clearDelay","isTaskFocused","isInlineEditorCell","isNoKeyboardNavigationElement","focusHandler","$preventDefault","reFocusActiveNode","outsideGantt","localName","domElement","mousedownHandler","locateTask","removeAttribute","onReady","$data","tasksStore","currentNode","gridDataTopScroll","gridDataBottomScroll","_smart_render","updateRender","_redrawTasks","renderers","items","focusedItemVisible","createdTaskId","keepFocusOnNewTask","placeholder","nodeConstructor","placeholder_task","focusOnCreate","oldId","newId","interval","setInterval","getScope","mode","scopes","headerCell","taskCell","findVisibleColumnIndex","columnName","clearInterval","keyNavFacade","addShortcut","scopeObject","getShortcutHandler","getCommandHandler","removeShortcut","column","keyboardNavigation","quick_info","quickInfo","text","substr","details","task_time","events","hidingFunction","clearQuickInfo","hideQuickInfo","showQuickInfo","tooltipManager","tooltips","tooltipFor","touch","touch_tooltip","targetTaskId","tooltip_text","link_source_id","monitor","updTask","changeTaskCommandId","updLink","oldTaskId","newTaskId","changeLinkCommandId","updateTasksIds","entry","updateLinksIds","getUndoStack","setUndoStack","setRedoStack","saveState","getInitialState","marker","render_marker","show_markers","min_date","marker_class","markerHeight","getRowTop","timeline_placeholder","scrollHeight","initMarkerArea","markerArea","$marker_area","_markers","createDatastore","initItem","renderMarkers","createDataRender","defaultContainer","addLayer","getMarker","getItem","addMarker","addItem","deleteMarker","exists","removeItem","updateMarker","refresh","_getMarkers","getItems","multiselect_one_level","_multiselect","_selected","_one_level","_active","_first_selected_when_shift","getDefaultSelected","selected","getSelected","setFirstSelected","getFirstSelected","updateState","active","select_task","reset","setLastSelected","silent","unselect","getLastSelected","last","getSelectedId","afterSelect","isSelected","forSelected","isSameLevel","calculateTaskLevel","_quickRefresh","refreshTask","doSelection","_is_icon_open_click","target_ev","defaultLast","isLast","multiSelect","singleSelection","controller","cell","locateCell","inline_editors_multiselect_open","getEditorConfig","startEdit","blockSelection","first_indx","target_indx","last_indx","tmp","old_selectTask","old_unselectTask","toggleTaskSelection","eachSelectedTask","getLastSelectedTask","old_isSelected","new_id","task_id","oldSelectedId","oldSelectedTask","newSelectedTask","differentTreeLevel","$level","export_api","_apiUrl","previousDateRage","str_to_date","date_format","data","_serializeHtml","_prepareConfigPDF","_serializeAll","_fixColumns","raw","_preparePDFConfigRaw","version","_sendToExport","_pdfExportRouter","_serializePlain","dates","smartRendering","smart_rendering","visual","convert","_eachTaskTimed","_no_progress_colors","_serializeTimeline","_serializeGrid","rawDates","scales","_serializeScales","worktime","_getWorktimeSettings","formData","File","FormData","append","_sendImportAjaxExcel","_sendImportAjaxMSP","importFromPrimaveraP6","importFromMSProject","skip_circular_links","oldXmlFormat","xml_format","oldFormatDate","format_date","oldXmlDate","xml_date","oldDateFormat","exportServiceDateFormat","date_to_str","_customProjectProperties","_customTaskProperties","_clearRecLinks","_exportConfig","$custom_data","custom","exportToPrimaveraP6","exportToMSProject","label","url","pack","cb","ajax","post","base","$template","server","JSON","stringify","sheet","xhr","XMLHttpRequest","onreadystatechange","readyState","status","onload","info","responseText","setRequestHeader","send","encodeURIComponent","_xdr","loader","xdoc","xmlDoc","col","editor","editor_types","skin","_serializableGanttConfig","_markColumns","_ajaxToExport","form","_createHiddenForm","submit","_hidden_export_form","constraint_date","deadline","key","formatDate","_color_box","_color_hash","color","_getColor","backgroundColor","parsedRanges","minutes","range","startMinute","endMinute","defaultWorkTimes","hours","time","work_time","wTime","_working_time_helper","get_calendar","worktimes","parsed","_getMinutesWorktimeSettings","master","branch","_pull","_originalCopyObject","json","_copyObject","task_text","_copyObjectBase","rgb","match","toISOstring","_copyObjectColumns","_copyObjectPlain","getDayIndex","_day_index_by_date","columnIndexByDate","$start","$end","hiddenCells","scaleCellsWidth","$type","$rendered_type","tmps","$text","$left","leftside_text","$right","rightside_text","_copyObjectTable","$color","ct","val","date_grid","smartScales","smart_scales","_copyObjectAll","_exportSerialize","_scale_helpers","_get_scales","minWidth","min_column_width","autosizeMinWidth","_get_resize_options","autosize_min_width","scale_height","prepareConfigs","availWidth","autosize","_getScales","rtl","$scaleHelper","_copyObjectColors","cellColors","timeline_cell_class","task_cell_class","_getRaw","steps","trace_x","styles","cellCss","_getStyles","Infinity","col_width","format","date_scale","scaleCell","scaleCell_class","scaleCss","exportMode","cols","ccount","tree","xmlFormat","serialize","_lvl","_setLevel","_makeLinksSameLevel","skippedLinks","_clearCircDependencies","_clearLinksSameLevel","_clearLevel","usedTasks","prevLink","sources","$_source","_onCircDependencyFind","targets","curLink","targetTask","_source","targetLvl","linkT","sourceParent","targetParent","$_target","project","projectName","projectDates","getSubtaskDates","start_end","manual","auto_scheduling","durationUnit","projectProperties","taskProperties","exportToPDF","exportToPNG","exportToICal","exportToExcel","exportToJSON","importFromExcel","constants","KEY_CODES","UP","DOWN","LEFT","RIGHT","SPACE","ENTER","DELETE","ESC","TAB","ExtensionsManager","addExtension","_extensions","getExtension","layout","rows","resizer","finish_to_start","start_to_start","finish_to_finish","start_to_finish","milestone","auto_types","duration_unit","correct_work_time","skip_off_time","cascade_delete","autoscroll_speed","deepcopy_on_parse","show_links","show_task_cells","static_background","static_background_cells","branch_loading","branch_loading_property","show_loading","min_duration","start_on_monday","server_utc","show_progress","fit_tasks","preserve_scroll","container_resize_timeout","deadlines","drag_links","drag_progress","drag_resize","drag_move","drag_mode","resize","progress","round_dnd_dates","link_wrapper_width","link_arrow_size","autofit","align","scale_offset_minimal","inherit_scale_class","time_step","duration_step","task_date","time_picker","link_attribute","layer_attribute","buttons_left","_migrate_buttons","dhx_save_btn","dhx_cancel_btn","dhx_delete_btn","buttons_right","lightbox","sections","map_to","project_sections","milestone_sections","single_date","drag_lightbox","details_on_create","details_on_dblclick","initial_scroll","order_branch","order_branch_free","task_height","bar_height","bar_height_padding","min_grid_column_width","grid_resizer_column_attribute","keep_grid_width","grid_resize","grid_elastic_columns","show_tasks_outside_timescale","show_unscheduled","resize_rows","task_grid_row_resizer_attribute","min_task_grid_row_height","readonly_property","editable_property","calendar_property","resource_calendars","dynamic_resource_calendars","inherit_calendar","type_renderers","open_tree_initially","optimize_render","prevent_default_scroll","show_errors","wai_aria_attributes","horizontal_scroll_key","drag_multiple","csp","isWindowAwailable","env","isIE","navigator","userAgent","isIE6","isIE7","isIE8","isOpera","isChrome","isKHTML","isFF","isIPad","search","isEdge","isNode","serialized","createConfig","Error","async","headers","fastVersion","utc","dateToStrFn","Function","to_fixed","getISOWeek","getWeek","splt","strToDateFn","dateString","cspVersion","getUTCDate","getUTCMonth","getUTCFullYear","day_short","getUTCDay","getDay","day_full","month_short","month_full","getUTCHours","getHours","getUTCMinutes","getMinutes","getUTCSeconds","getSeconds","getUTCISOWeek","set","temp","month_short_hash","month_full_hash","UTC","canUseCsp","useCsp","dateHelper","init","s","date_part","setHours","hour_start","setTime","time_part","getTimezoneOffset","week_start","month_start","setDate","quarter_start","res_month","m","setMonth","year_start","day_start","setMinutes","minute_start","setSeconds","getMilliseconds","setMilliseconds","_add_days","modifiedDate","inc","originalDate","incCondition","getHoursCondition","getDateCondition","ndate","setYear","add_quarter","num","cspCompliantVersion","_getWeekNumber","isoWeek","nday","first_thursday","year_number","ordinal_date","convert_to_utc","parseDate","parse_date","token","_url","_token","_mode","_seed","_queue","api","_events","Accept","credentials","fetch","then","websocket","_wrapper","connect","_socket","onclose","n","location","protocol","o","r","WebSocket","onmessage","fire","onError","_send","_resubscribe","Promise","_uid","resolve","reject","onCall","filter","catch","onResponse","remoteEvents","remote","remote_client.Client","req","_ready","load","back","_remote","ready","on","checkTimeout","updPerSecond","_on_timeout","ceil","StateService","stateProviders","internal","utils.mixin","provider","Promise$1","$powerArray","$create","$removeAt","$remove","$find","$insertAt","$each","$map","$filter","isPlaceholderTask","DataStore","pull","$initItem","visibleOrder","powerArray","fullOrder","_skip_refresh","_filterRule","_searchVisibleOrder","_indexRangeCache","_getItemsCache","_attachDataChange","_parseInner","loaded","copyOnParse","utils.copy","isSilent","_updateOrder","updateItem","utils.defined","_removeItemInner","_addItemInner","order","data_size","getVisibleItems","getIndexRange","utils.uid","_changeIdInner","changeId","_moveInner","sindex","getIdByIndex","clearAll","alreadySilent","arraysEqual","arr1","arr2","quick","skipFilter","_quick_refresh","_mark_recompute","oldOrder","count","countVisible","eachItem","rule","filteredOrder","placeholderIds","_ganttConfig","from","to","cacheKey","ret","getIndexById","_getNullIfUndefined","getFirst","getLast","TreeDataStore","_branches","loadedItem","existingItem","$parentProperty","parentProperty","$getRootId","$openInitially","openInitially","_eachItemMainRangeCache","getConfig","splitParents","splitItems","taskOpenState","taskVisibility","haveSplitItems","_isSplitItem","canOpenSplitTasks","open_split_tasks","$expanded_branch","isHeadless","_buildTree","setParent","_add_branch","calculateItemLevel","getBranchIndex","targetIndex","_move_branch","$rendered_parent","_replace_branch_child","_traverseBranches","itemId","sid","source_pid","tbranch","tid","diff","childId","pid","getSiblings","getNextSibling","siblings","nextSibling","level","eachParent","_setParentInner","new_pid","_eachItemCached","cache","_eachItemIterate","startId","itemsStack","reverse","useCache","buildCache","startItem","parentsHash","old_parent","new_parent","old_id","newbranch","field","desc","criteria","original_criteria","els","renderedParent","actualParent","_skipTaskRecalculation","datastoreRender","itemRepainter","renderer","renders","getLayers","render_item","allData","loadedRanges","layer","layerData","get_visible_range","ids","prepare_data","render_items","update_items","extraDataArr","skipRepaint","batch_update","getDataRender","onUpdateRequest","change_id","getDatastores","storeNames","facadeFactory","$StoreType","self","selectedId","deleteItem","subItem","storeAccessName","dropService","storeList","setService","_getDatastores","refreshData","scrollState","stores","refresh_links","refreshLinks","refreshLink","_bulk_dnd","hasSplitParent","isSplitTask","linksStore","_update_flags","userdata","_clear_data","oldSelectId","_skipResourceRepaint","addTask","parentObj","deleteTask","utils.bind","startTask","changeTaskId","oldid","newid","getLinkCount","isLinkExists","addLink","newLink","updateLink","deleteLink","changeLinkId","ScaleHelper","services","getSum","sizes","summ","setSumWidth","sum_width","adjustSize","full_width","splitSize","full","share","sortScales","cellSize","_isLegacyMode","scaleConfig","scale_unit","subscales","_prepareScaleObject","primaryScale","legacyMode","initTemplate","scale_cell_class","getSubScales","docLink","warn","min_coll_width","container_width","minDate","maxDate","heights","configs","main_scale","cfg","initScaleConfig","processIgnores","initColSizes","limitVisibleRange","unshift","alineScaleColumns","reverseScale","setPosSettings","indexes","trace_indexes","trace_index_transition","_ignore_time_config","skip","probe","isWorkTime","ignore_x","display_count","min_col_width","line_height","cont_width","column_count","ignores","eachColumn","trace_x_ascending","iterateScales","lower_scale","upper_scale","upper_dates","lower_dates","prevUpper","target_index","upper_start","upper_end","lower_start","lower_end","targetWidth","curr","tzOffset","_correct_dst_change","lastDate","outDate","shared","_init_tasks_range","PrimaryScaleHelper","helper","start_interval","onlyProjectTasks","extendRangeForDates","constraint_type","constraint_types","ASAP","ALAP","baselines","baseline","calculateEndDate","duration","_min_date","_max_date","updateTasksRange","old_min","old_max","copyLinkIdsArray","targetHash","copyLinkIds","treeHelper","getSubtreeLinks","getSubtreeTasks","DataProcessorEvents","dp","$gantt","$dp","_dataProcessorHandlers","cascadeDelete","clientSideDelete","setGanttMode","setUpdated","_sendTaskOrder","deleteAfterConfirmation","needDbDelete","needCascadeDelete","dpMode","updateMode","setUpdateMode","cascade","storeItem","sendAllData","_tSend","_waitMode","itemLinks","_links","_dp","_tMode","_serverProcessor","_ganttMode","substring","serverProcessor","pluralizedMode","urlSeparator","upd","xml","_xmlNodeToJSON","isExist","objData","property","assignmentsStore","handleResourceCRUD","handleResourceAssignmentCRUD","handleBaselineCRUD","updated","updatedRows","clientOnly","getUserData","_in_progress","resources","dataprocessor_assignments","resource_assignment_store","insertedTasks","pendingAssignments","insertResourceAssignment","assignment","dataprocessor_resources","resourcesStore","resource_store","resource","dataprocessor_baselines","baselineStore","helpers.forEach","SimpleStorage","_storage","getStoredItem","_Ut","DataProcessor$1","serverProcessorURL","action_param","autoUpdate","_headers","_payload","_postDelim","_routerParametersFormat","_invalid","messages","inserted","deleted","invalid","invalid_cell","enableUTFencoding","total","payload","_serializeAsJson","_router","router","_utf","escape","dnd","rowId","findRow","existing","set_invalid","setUserData","is_invalid","markRow","sendData","_methods","editStop","pendingUpdateModes","modes","checkBeforeUpdate","_beforeSendData","_getRowData","_serializeAsJSON","serialize_one","security_key","pref","valid","_forEachUpdatedRow","_sendData","_getAllData","pattern","_uActions","btag","ganttMode","correct","originalSid","that","_xml","getGanttMode","reqUrl","filePath","tag","processCallback","afterUpdateCallback","finalizeUpdate","xmltop","cleanUpdate","atag","xpath","_initialized","_dp_init","_setDefaultTransactionMode","delete_confirmation","_change_id","_row_style","$dataprocessor_class","_delete_task","$drop_target","setDp","dataProcessorEvents","user","_user","_needUpdate","_updateBusy","afterAutoUpdate","fullSync","loadUpdate","xml_node","getUpdates","vers","_getXmlNodeValue","updates","newState","dataToSend","processedData","_cleanupArgumentsBeforeSend","_cleanupItemBeforeSend","updatedItem","output","taskState","taskAction","getActionByState","_onResolvedCreateUpdate","actionPromise","errorMsgStart","errorMsgEnd","queryParams","afterUpdate","dhxVersion","urlParams","_applyPayload","preprocessedData","query","setTransactionMode","nodeValue","hasOne","traversedObjects","_prepareDate","helpers.arrayIncludes","_prepareArray","_prepareObject","rawItem","processedItem","dataItem","_prepareDataItem","DataProcessor","DEPRECATED_api","DataProcessor.DataProcessor","createDataProcessor","tMode","createMethod","disableMethod","methodName","dummyMethod","restoreMethod","disableMethods","methodsHash","restoreMethods","batchUpdatePayload","noRedraw","dp_mode","call_dp","resetProjects","resetProjectDates","createWbs","_needRecalc","_isRecalcNeeded","_isGroupSort","_getWBSCode","_calcWBS","$virtual","$wbs","_setWBSCode","getWBSCode","getByWBSCode","_isFirst","_prevSibling","_wbs","_parent","wbs","resetCache","getTaskByWBSCode","createResourceMethods","resourceTaskCache","singleResourceCacheBuilt","falsyValuePrefix","random","resourceHashFunction","getCacheKey","resourceIds","typeFilter","getResourceTasks","matchingResources","resourceId","resourceValue","resource_id","selectAssignments","resource_property","owners","getTaskBy","propertyName","propertyValue","getResourceAssignments","assignments","resourcePlugin","renderEditableLabel","editable","$task_id","$resource_id","renderSummaryLabel","sum","reduce","Number","editableResourceCellTemplate","$role","editableResourceCellClass","capacity","getSummaryResourceAssignments","childResource","initEditableDiagram","resource_render_empty_cells","timeoutId","makeEditable","cancelAnimationFrame","contentEditable","getCellsByType","$content","assignmentEditInProcess","strValue","innerText","assignmentId","startDate","endDate","assignmentStore","nextChunk","calculateDuration","updateTaskAssignments","editable_resource_diagram","fetchTasks","lightbox_resources","lightboxOptions","resourceStoreConfig","initItems","storeType","$resourcesStore","lightboxOptionsFnc","options","updateCollection","histogram_cell_class","histogram_cell_label","histogram_cell_allocated","histogram_cell_capacity","defaultResourceCellClass","defaultResourceCellTemplate","resource_cell_value","resource_cell_class","resource_assignments","resourceAssignmentsProperty","process_resource_assignments","resourceAssignmentFormats","auto","singleValue","valueArray","resourceValueArray","assignmentsArray","resourceAssignmentFormat","assignmentModes","fixedDates","fixedDuration","default","initAssignmentFields","initDelay","timing","_assignmentTimeFromTask","resourceAssignmentsStore","_makeAssignmentsFromTask","resourceAssignments","detectFormat","usedIds","defaultMode","_updateTaskBack","_assignAssignments","getTaskAssignments","_loadAssignmentsFromTask","_syncAssignments","storeAssignments","taskValues","assignmentsStoreValues","inBoth","inTaskNotInStore","inStoreNotInTask","taskOwner","ownerId","foundOwnerAssignment","taskSearch","storeSearch","processedIds","inTask","inStore","ignoreFields","_syncOnTaskUpdate","totalAssignments","needUpdate","needUpdateFor","undoBatchCancel","assignmentsHash","unscheduled","idsSearch","deleteIds","resourceAssignmentsCache","resourceTaskAssignmentsCache","taskAssignmentsCache","searchTaskId","resourceTaskCacheKey","getTaskResources","uniqueResources","addPlaceholder","callIfEnabled","insertPlaceholder","placeholders","new_task","afterEdit","newTask","dataProcessor","_silencedPlaceholder","isPlaceholderLink","auto_task_types","checkTaskType","changedTypes","targetType","getTaskTypeToUpdate","$needsUpdate","updateParentTypes","group_mode","delTaskParent","allTypes","hasChildren","taskType","originalRowDndParent","originalMoveTaskParent","isParsingDone","updateAfterRemoveChild","DurationFormatterNumeric","canParse","_ne","LinkFormatterSimple","_linkReg","linkPart","exec","_findSource","lag","pred","reqTemplate","_ae","formatters","durationFormatter","DurationFormatter","linkFormatter","LinkFormatter","empty_state_screen","show_empty_state","emptyStateElement","isGanttEmpty","placeholderContainer","empty_state_text_link","empty_state_text_description","clickEvents","detachAddTaskEvents","getContainer","domHelpers","wrapper","marginTop","oldNodes","attachAddTaskEvent","renderContent","emptyStateElementNode","hasBaselinesBelow","baselinesOnDifferentRow","render_mode","childrenHaveBaselines","hasBaselines","isSplitParent","getMaxParentHeight","heightLimit","maxHeight","shrinkHeight","splitChild","parentHeight","getItemPosition","rowHeight","_adjustSplitParentHeight","maxParentHeight","adjustTaskHeightForBaselines","childHeight","_increaseSplitParentHeight","getLayoutView","getBarHeight","subtaskId","subtask","subtaskHeight","baselineSize","baselineAmount","subrowHeight","newBaseline","existingBaseline","shouldRepaint","iteratedBaselines","taskBaselines","exisingBaselines","getTaskBaselines","exisingBaseline","repaint","parsing","jsonParseError","on_load","resp","responseURL","_process_loading","collections","_load_collections","assignmentsByTasks","collections_loaded","collection","serverList","option","option_key","$ignore","dhx_security","serializeTask","serializeLink","_copyLink","rawLinks","baselineCopy","attrs_only","attributes","_getCollections","opts","itms","attrs","k","attr","_getXML","toptag","getXMLTopNode","skey","evs","oldxml","startdate","est","enddate","predecessortasks","message","IsWorkTimeArgument","calendar","ClosestWorkTimeArgument","CalculateEndDateArgument","GetDurationArgument","calendarArgumentsHelper","getWorkHoursArguments","helpers.isValidDate","setWorkTimeArguments","unsetWorkTimeArguments","isWorkTimeArguments","processedConfig","getClosestWorkTimeArguments","arg","_getStartEndConfig","param","argumentType","getDurationArguments","hasDurationArguments","calculateEndDateArguments","WorkTimeCalendarMerger","_getIntervals","hoursArray","_toHoursArray","intervalsArray","formatHHMM","secondsValue","minutePart","_intersectHourRanges","first","baseArray","overridesArray","current","_mergeAdjacentIntervals","_mergeHoursConfig","firstHours","secondHours","merge","firstConfig","secondConfig","mergedSettings","customWeeks","processCalendar","config1","config2","date1","date2","hours2","WorkUnitsMapCache","timestamp","_cache","has","subCache","rawValue","unitCache","yearCache","Map","WorkUnitsObjectCache","LargerUnitsCache","getMinutesPerWeek","weekStart","_weekCache","_calendar","minutesPerWeek","getHoursPerDay","getMinutesPerMonth","monthStart","_monthCache","minutesPerMonth","nextMonth","DateDurationCache","stepCache","durations","endDates","compute","_getCacheObject","startDateTimestamp","_endDateCacheKey","resultTimestamp","_durationCacheKey","endDateTimestamp","CalendarWorkTimeStrategy","argumentsHelper","_workingUnitsCache","_largeUnitsCache","_dateDurationCache","_worktime","_cached_timestamps","_cached_timestamps_count","_clearCaches","_getUnitOrder","_resetTimestampCache","_timestamp","_checkIfWorkingUnit","hasDuration","_is_work_day","_getWorkHours","_is_work_hour","startHour","endHour","_getTimeOfDayStamp","dayEnd","_is_work_minute","checkTime","_nextDate","_getWorkUnitsBetweenGeneric","stepStart","stepEnd","next","checkFirst","checkLast","isLastStep","_isWorkTime","unitOrder","biggerTimeUnit","_getClosestWorkTimeFuture","_getMinutesPerHour","hourStart","hourEnd","_getMinutesPerDay","durationMinutes","durationHours","_getWorkUnitsForRange","getUnitsPerDay","_getMinutesBetweenSingleDay","_getIntervalTimestamp","minuteFrom","minuteTo","_getMinutesBetween","firstDayStart","firstDayEnd","lastDayStart","lastDayEnd","startPart","endPart","_getHoursBetween","_setConfig","_parseSettings","haveCustomWeeks","customWeeksRangeStart","customWeeksRangeEnd","customWeeksBoundaries","_parseHours","minCustomRangeStart","maxCustomRangeEnd","customTime","rangeStart","rangeEnd","fromReadable","toReadable","currentWeek","_tryChangeCalendarSettings","backup","hasWorkTime","_arraysEqual","_compareSettings","mySettings","thatSettings","myDays","otherDates","myHours","otherHours","equals","myWeek","thatWeek","getWorkHours","dateValue","endHours","timestampRanges","part","timerangeConfig","durationSeconds","setWorkTime","calendarConfig","unsetWorkTime","reset_calendar","dateKey","isWorkUnit","setItem","getDuration","_calculateDuration","sign","mult","getEndDate","_calculateEndDate","_calculateMinuteEndDate","_subtractMinuteDate","_calculateHourEndDate","_addInterval","stopAction","added","dstShift","_addHoursUntilDayEnd","rangeHours","addHours","intervalEnd","durationLeft","hoursPerDay","_addMinutesUntilHourEnd","rangeMinutes","addMinutes","_subtractMinutesUntilHourStart","hourStartTimestamp","initialDateTimestamp","minutePrecision","_isMinutePrecision","addedInterval","calculatedDay","daySchedule","minutesInDay","dayStart","iterateFromDayEnd","isWorkHour","workInterval","prevInterval","minutesInHour","_getClosestWorkTimePast","times","lastInterval","getClosestWorkTime","_getClosestWorkTime","inputDate","direction","closestFuture","closestPast","_getClosestWorkTimeGeneric","_findClosestTimeInDay","resultDate","fromDayEnd","_getClosestWorkMinute","increment","hasRegularHours","_checkWorkHours","dayConfig","legacyResourceCalendarConfig","isLegacyResourceCalendarFormat","resourceCalendarsProperty","getResourceProperty","resourceCalendarsConfig","getCalendarIdFromLegacyConfig","calendarId","dynamicResourceCalendars","dynamicCalendars","getCalendarIdFromMultipleResources","manager","getResourceCalendar","tempCalendar","mergeCalendars","addCalendar","CalendarManager","_calendars","_legacyConfig","_isLegacyConfig","createDefaultCalendars","CalendarDisabledTimeStrategy","TimeCalculator","calendarManager","createArgumentsHelper","$disabledCalendar","NoWorkTimeCalendar","_convertWorkTimeSettings","days","calendars","mergeHelper","CalendarMergeHelper","_createCalendarFromConfig","createCalendar","apiCore","preparedConfig","parentCalendar","defaults","fulltime","getCalendar","getCalendars","_getOwnCalendar","resourceProperty","calendarsConfig","getTaskCalendar","taskObject","groupMode","currentTask","$effective_calendar","isCalendar","deleteCalendar","restoreConfigCalendars","possibleCalendar","every","fixedUnits","_getCalendar","worktimeFacadeFactory","timeCalculator","_hasDuration","isUnscheduledTask","_isAllowedUnscheduledTask","_isTaskInTimelineLimits","taskStart","taskEnd","_getProjectEnd","project_end","_getProjectStart","project_start","getDefaultTaskDate","parent_id","schedule_from_end","_set_default_task_timing","$new","showTask","_lightbox_id","_tasks_dnd","drag","getTaskTimingMode","task_type","$no_start","$no_end","scheduled_summary","updateTaskTiming","assignProjectDates","taskTiming","summaryDateFields","manuallyScheduledSummaryDateFields","dateFields","_init_task_timing","getSubtaskInfo","rollup","isScheduledSummary","task_mode","dirty","$calculate_duration","effectiveCalendar","taskMode","$rollup","getSubtaskDuration","_update_parents","updateAll","has_changed","startDateField","$auto_start_date","endDateField","$auto_end_date","oldStart","oldEnd","roundDate","upper","lower","colIndex","correctTaskWorkTime","listenWindowResize","resizeDelay","resizeTimeout","previousSize","getContainerSize","container_resize_method","lowlevelResizeWatcher","$scrollbarRepaint","currentSize","repaintGantt","previousHeight","previousWidth","gantt_core","expire","invalidContainerMessage","validateNode","cloneNode","_reinit","dropLayout","_clearTaskLayers","_clearLinkLayers","rebuildLayout","calculateScaleRange","createView","getPropertyValue","resizeWatcher","contentWindow","resetLayout","initTemplates","domHelpers.toNode","$mouseEvents","edit","question","confirm_deleting","confirm_deleting_title","_simple_confirm","hideLightbox","visibleDate","_sort","posX","_getHorizontalScrollbar","codeScrollLeft","preserveScroll","new_pos","posY","gridCell","attachedScrollbar","verticalScrollbar","$view","setSizes","changeLightboxType","getLightboxType","_silent_redraw_lightbox","_get_link_type","from_start","to_start","isLinkAllowed","prevOffset","time_unit","helpers.getSecondsInUnit","offsetChanged","domHelpers.getClassName","icon_save","icon_cancel","icon_details","confirm_closing","section_description","section_time","section_type","section_deadline","section_baselines","column_wbs","column_text","column_start_date","column_duration","column_add","confirm_link_deleting","link_start","link_end","type_task","type_project","type_milestone","weeks","months","years","message_ok","message_cancel","section_constraint","asap","alap","snet","snlt","fnet","fnlt","mso","mfo","resources_filter_placeholder","resources_filter_label","baselines_section_placeholder","baselines_add_button","baselines_remove_button","baselines_remove_all_button","deadline_enable_button","deadline_disable_button","LocaleManager","addLocale","_locales","getLocale","DHXGantt","license","edit_save","edit_cancel","factory","supportedExtensions","extensionManager","ExtensionManager","activePlugins","plugin","getter","service","DOMParser","ActiveXObject","loadXML","parseFromString","tagname","responseXML","getElementsByTagName","xpathExp","docObj","selectNodes","ownerDocument","evaluate","XPathResult","ANY_TYPE","iterateNext","_call","onLoad","getSync","put","postData","del","postSync","isQt","noCache","toUpperCase","RemoteEvents","copyDomEvent","pageX","pageY","DnD","_obj","_settings","inputMethods","getInputMethods","_drag_start_timer","clearDragTimer","eventParams","passive","accessor","timeStamp","original_target","original_element_sizes","domHelpers.getClosestSizedElement","dragStart","touch_drag","traceDragEvents","inputMethod","mousemove","dragMove","dragScroll","limited_mousemove","started","updates_per_second","dndActive","cancelable","mousemoveContainer","mouseup","checkPositionChange","diff_x","diff_y","pow","sensitivity","initDnDMarker","backupEventTarget","getEvent","backup_element","touchEventsSupported","touches","elementFromPoint","pointerEnabled","pointerType","msPointerEnabled","MSPOINTER_TYPE_MOUSE","getPosition","_prevent_touch_scroll","_touch_drag","_touch_feedback","targetTouches","templatesLoader","regTemplates","initial","template_name","gantt_save_btn","gantt_cancel_btn","gantt_delete_btn","c","progress_text","grid_header_class","task_class","task_end_date","grid_row_class","task_row_class","timeline_cell_content","scale_row_class","grid_indent","grid_folder","grid_file","grid_open","grid_blank","task_unscheduled_time","grid_date_format","link_class","link_description","drag_link","drag_link_class","tooltip_date_format","baseline_text","stateService","selected_task","deletedLinks","originalTask","checkLinkedTaskVisibility","sync_link","sourceTask","sync_link_delete","sync_links","mapEvents","conf","mapFrom","mapTo","sourceEvent","targetEvent","taskLinks","existingLink","sourceMatch","targetMatch","typeMatch","changedTask","oldState","sourceVisible","targetVisible","onItemLoading","onBeforeAdd","onAfterAdd","onBeforeUpdate","onAfterUpdate","onBeforeDelete","onAfterDelete","onIdChange","onBeforeItemMove","onAfterItemMove","onFilterItem","onItemOpen","onItemClose","onBeforeSelect","onAfterSelect","onAfterUnselect","modules","new_task_placeholder","getGridColumn","activate","_cached_functions","update_if_changed","critical_path_mode","wrap_methods","_prefetch_originals","prefetch","methodname","original","optimizer","argumentsArray","l","get_arguments_hash","cached_values","has_cached_value","get_cached_value","cache_value","arguments_hash","is_date","values","stringify_argument","deactivate","setup","override_gantt","gantt_methods","highlight_critical_path","deactivTimeout","_eventRemoveAll","resetLightbox","i18n","en","ar","be","ca","cn","cs","da","de","es","fa","fi","fr","he","hr","hu","it","jp","kr","nb","nl","no","pl","pt","ro","ru","si","sk","sv","tr","ua","setLocale","localeObject","boxAttribute","_dhx_msg_cfg","usercall","modalBox","modal_key","messageBox","keyboard","cancelBubble","modality","cover","onkeydown","messageButtonAttrString","getFirstDefined","_createBox","ok","cancel","contentId","messageModalAttr","inner","btn","onclick","hidden","innerWidth","innerHeight","alertPopup","confirmPopup","boxPopup","box_params","params","messageInfoAttr","insertBefore","timers","hideAll","popups","alert","confirm","modalbox","extendSettings","parentSettings","own","$extendedConfig","setPrototypeOf","configurable$1","parentView","parentConfig","parentTemplates","$getConfig","$getTemplates","uiFactory$1","views","createdViews","creator","configure","configurable","$parent","initUI","registerView","viewConstructor","createMouseHandler","eventHandlers","doubleclick","contextMenu","addEventTarget","onClick","findEventHandlers","callEventHandlers","onContextMenu","src","delegateHandlers","h","onDoubleClick","onMouseMove","_last_move_event","domEvents","delegate","elementHandlers","callHandler","mouseEvents","genericViewPortChecker","x_end","y_end","isLegacyRender","getRowRectangle","getVisibleTasksRange","indexStart","indexEnd","extraTasksIds","inlineEditorId","layerFactory","renderFactory","task_area_pulls","task_area_renderers","getRenderer","renderMethod","updateMethod","getRectangle","renderCallbackMethod","specializedViewPortChecker","basicGetRectangle","onrender","isInViewPort","layerView","viewConfig","rendererViewPort","useBuffer","remove_item","rendered","clear_container","basicGetRange","getVisibleRange","prepareData","buffer","createDocumentFragment","vis","itemsSearch","renderedItems","newElements","nodesToRemove","renderCalledFor","itemNode","restore","replace_item","item_id","newNode","replaceChild","clearRenderers","createGroup","relativeRoot","defaultFilters","initLayer","renderGroup","tempCollection","filters","_add","getLayer","pending","topmost","rel","mergeFilters","requestUpdate","eachLayer","removeLayer","filter_methods","filter_method","barRectangle","startCoord","endCoord","calculated","clearCache","rec","sourceBox","targetBox","initialized","visibleBoxes","isLinkInViewPort","sourceTop","sourceHeight","targetTop","targetHeight","sourceLeft","sourceRight","targetLeft","targetRight","$skipSmartRenderOnScroll","Cell","headerHeight","$domEvents","$name","$factory","_headerClickHandler","final","$preResize","topCont","topSize","getSize","maxWidth","minHeight","setSize","_hide","cellIndex","moveView","$toHTML","canCollapse","$fill","collapsed","size","gravity","getContentSize","$lastSize","contentX","contentY","_getBorderSizes","borders","horizontal","vertical","_currentBorders","_borders","_sizeHeader","_sizeContent","_setBorders","domHelpers.removeClassName","cssHash","domHelpers.addClassName","xLayout","transform","__extends","__","Layout","_super","_this","_parseConfig","domHelpers.removeNode","$cells","_resizeScrollbars","scrollbars","scrollChanged","visibleScrollbars","hiddenScrollbars","scrollbarsToHide","showScrollbar","scrollbar","hideScrollbar","shouldHide","shouldShow","visibleGroups","group","_syncCellSizes","groupName","newSize","groups","_eachChild","_syncGroupSize","cells","_xLayout","newSizeValue","isGravity","ownSize","resizeSibling","siblingSize","totalGravity","totalSize","mainGrid","grid_width","startStage","mainCall","_resizeInProgress","contentViews","setContentSize","_getAutosizeMode","$originalWidthStored","$originalWidth","$originalHeightStored","$originalHeight","isChild","cellId","sub","getCells","domHelpers.insertNode","domHelpers.getChildNodes","contentWidth","contentHeight","_cleanElSize","_getBoxStyles","computed","properties","boxSizing","clientHeight","MozBoxSizing","horPaddings","borderLeftWidth","borderRightWidth","vertPaddings","borderTopWidth","borderBottomWidth","borderBox","outerWidth","outerHeight","boxSizes","contentSizes","_sizes","margin","_calcFreeSpace","side","_free","_gravity","_calcSize","_configureBorders","borderClass","lastVisibleIndex","lastCell","borderColorClass","_updateCellVisibility","oldVisibleCells","_visibleCells","firstCall","visibleCells","parentVisibility","hide_empty","hideCell","cellView","marginSide","ViewLayout","$cell","byMaxSize","otherCell","ViewCell","childConfig","$initialized","unload","_setContentSize","outerX","outerY","childSize","ScrollbarCell","SCROLL_MODIFIER_KEYS","_scrollHorizontalHandler","_scrollVerticalHandler","_outerScrollVerticalHandler","_outerScrollHorizontalHandler","_mouseWheelHandler","scroll_size","_isHorizontal","eachCell","_isVertical","_initVertical","_initHorizontal","_initMouseWheel","_initLinkedViews","_getRootParent","_eachView","_getLinkedViews","$scroll_hor","$scroll_ver","_updateLinkedViews","scrollHorizontally","_scrolling","oldSize","scrollVertically","_wheel_time","_oldLeft","_getScrollSize","scrollSize","outerSize","isHorizontal","linked","scrollProperty","innerSizeProperty","outerProperty","_getScrollOffset","cellScrollSize","nonScrollableSize","outerScroll","innerScroll","visible","scrollSizes","_setScrollSize","toggleVisibility","_getScaleOffset","parentLayout","_oldTop","_checkWheelTarget","connectedViews","wheelSpeed","wheelSpeedConfig","wheel_scroll_sensitivity","ff","deltaX","wheelDeltaX","deltaY","wheelDelta","multiplier","deltaMode","wx","wy","horizontalScrollModifier","oldLeft","detail","oldTop","createMixin","getItemTopCache","getRowTopCache","getItemHeightCache","totalHeightCache","getItemHeightCacheState","quickPosition","cachedRowHeight","canUseSimpleCalc","_getRowHeight","_refreshState","rowStore","globalRowHeight","canUseSimpleCalculation","_resetTopPositionHeight","_resetHeight","getCacheStateTotalHeight","shouldClearHeightCache","all","itemIndex","_fillHeightCache","defaultHeight","globalHeight","itemHeightCache","sumHeight","getHeight","visibleItems","totalHeight","canvasRender","destroy","Timeline","_posFromDateCache","_timelineDragScroll","topPositionMixin","$task_scale","taskBg","$task_bg","$task_baselines","$task_links","$task_bars","$task_constraints","$task_deadlines","_tasks","linksAttr","bindLinks","item_attribute","layers","_createLayerConfig","linkLayers","_attachLayers","backgroundImage","data_els","scrollWidth","scrolled","_refreshScales","_scales","_getScaleChunkHtml","taskFilter","taskLayers","expose","taskBar","hide_bar","_taskLayers","_linkLayers","_bindStore","taskRenderer","bar_layer","_taskRenderer","_initStaticBackgroundRender","linkStore","linkRenderer","linkLayer","_linkRenderer","staticRender","_staticBgHandler","staticBgContainer","$task_bg_static","staticBackgroundHeight","_clearLayers","_render_tasks_scales","scales_html","outer_width","helpers","cfgs","fromPos","toPos","cssClass","tplClass","_prepareScaleHtml","globalConfig","globalTemplates","helpers.findBinary","cssclass","g","floatConfig","sticky","labelPosition","approxLabelWidth","labelPos","translateValue","getTimelineCellAttr","_getColumnDuration","wholeCells","partCell","roundPos","_getNextVisibleColumn","visibleDateIndex","_getPrevVisibleColumn","_getClosestVisibleColumn","dateIndex","visibleIndex","transition","xLeft","xRight","displayStart","displayEnd","isMilestoneRender","_timelineCacheAttached","_unbindStore","ScrollableGrid","_scrollOrder","getCurrentX","_dnd","_scrollView","attachEvents","isScrollable","gridBoundingRect","maxLeft","minLeft","currentX","autoscrollRight","autoscrollStart","autoscrollLeft","autoscrollStop","scrollStep","COLUMN_ID_ATTR_NAME","ColumnsGridDnd","_targetMarker","calculateCurrentPosition","eventX","DND","_scrollableGrid","_draggedCell","draggedColumn","draggedIndex","_gridConfig","outerHTML","lineHeight","_dragX","columnIndexes","findColumnsIndexes","targetColumn","cleanTargetMarker","setMarkerPosition","drawTargetMarker","reorderColumns","draggedId","xBefore","xAfter","currentColumn","startX","endX","columnRelativePos","compare","relativeX","getCorrection","gridOffset","nextPosition","Grid","$state","gridAriaAttr","gridAttrString","gridDataAriaAttr","gridDataAttrString","reorder_grid_columns","gridScaleRowAttrString","doOnRender","_renderHeaderResizers","_mouseDelegates","mouseEventContainer","resizerrow","_task_grid_row_resize","row_before_start","row_id","row_after_start","row_drag_move","dd","itemHeight","itemTop","pointerPosition","markerStartPosition","marker_height","minPointerPosition","row_drag_end","oldItemHeight","finalHeight","dnd_sensitivity","_addLayers","_initEvents","_columnDND","ColumnDnd","_validateColumnWidth","numericWidth","elasticColumns","_setColumnsWidth","columnProperty","newColumnWidth","columnsWidth","_getGridWidth","_gridCacheAttached","_initSmartRenderingPlaceholder","_calculateGridWidth","_renderGridHeader","getColumnIndex","excludeHidden","hiddenIndexShift","getColumn","gridLine","gridTaskRowResizer","_refreshPlaceholderOnStoreUpdate","$rowsPlaceholder","_getColumnWidth","min_width","new_width","max_width","_checkGridColumnMinWidthLimits","_getGridWidthLimits","min_limit","max_limit","newWidth","start_index","columns_width","final_width","extra_width","start_width","iterator","curExtra","_getColsTotalWidth","cols_width","v","parseFloat","unknown","gridWidth","delta","changed","lineHeigth","colWidth","gridScaleCellAttrString","defaultMapping","isChanged","save","onShow","preventKeyNav","shouldPrevent","editPrevCell","editNextCell","onHide","keyNavMappings","onBlurDelay","keyNav","activeCell","editorState","hasEditor","editorType","anyModifier","BaseFactory","BaseEditor","set_value","get_input","get_value","is_changed","currentValue","is_valid","textEditorFactory","TextEditor","numberEditorFactory","NumberEditor","oninput","selectEditorFactory","SelectEditor","optionsHtml","dateEditorFactory","html5DateFormat","dateToStr","strToDate","DateEditor","minValue","maxValue","predecessorEditorFactory","PredecessorEditor","getFormatter","formatter","parseInputString","predecessors","delimiter","formatPredecessors","formatLinkKey","getLinksDiff","predecessorCodes","selectedLinks","Set","existingLinksSearch","linksToAdd","linkKey","linksToDelete","linksDiff","autoSchedule","inputPredecessors","taskPredecessors","durationEditorFactory","linkedPropertiesProcessor","decreaseStartDate","initConfigs","number","predecessor","keyboardMapping","mapping","setMapping","getMapping","eventBus","inlineEditController","createEditors","_createPlaceholder","inlineEditorAttr","updateTaskDateProperties","ganttHandlers","_itemId","_columnName","_editor","_editorType","_placeholder","setValue","editorConfig","getValue","_getItemValue","inline_editors_date_processing","_findEditableCell","nextColumn","getNextCell","getFirstCell","getLastCell","canChangeRow","moveRow","nextItem","editNextRow","skipReadonly","editPrevRow","detachStore","isBarInViewport","createTaskRenderer","_task_default_render","controlsMargin","padd","milestoneHeight","milestoneWidth","done","pr","markerPos","basic","link_from_start","link_target_id","isCriticalTask","link_landing_area","from_id","link_to_start","dragClass","progressColor","textColor","u","setProperty","_get_link_crossing_css","marginStyle","_render_side_content","setTaskBarAttr","_render_pair","outer","showLinkPoints","cond","ln","tp","marginLeft","marginRight","defaultRenderer","createBaseBarRender","resourceHistogramRenderer","getVisibleCellsRange","firstCellIndex","lastCellIndex","isColumnVisible","cellLeftCoord","cellRightCoord","bgPlaceholder","placeholderConfig","lastTaskId","placeholderTask","calendar_id","createLinkRender","drawer","current_pos","dirs","path","point","get_lines","line_to","get_path","line","_get_line","get_wrapper_sizes","wrapper_size","get_line_sizes","line_size","link_line_width","render_line","innerPos","render_corner","corner","radius","lineWidth","cornerDiv","borderVertical","borderHorizontal","arrow","get_direction","vect","path_builder","point_to","get_points","get_endpoint","xy","e_y","e_x","lineType","get_line_type","forward","getMilestonePosition","splitParams","milestoneTask","siblingBaselines","shapes","lines","link_radius","arrowSize","nextLine","cornerX","cornerY","lastLine","arrowX","arrowY","shape","render_arrow","cssTemplate","isCriticalLink","linkAttr","createResourceTimelineBuilder","assignmentsPassed","timegrid","scaleUnit","scaleStep","precalculatedTimes","firstColumn","minScaleDate","currDate","cachedTimes","timetable","rowDnd","checkPlaceholderTask","getStore","initial_open_state","$transparent","lastTaskOfLevel","last_item","_getGridPos","gridHeight","maxBottom","_getTargetY","scrollPos","_getTaskByY","dropIndex","gridDataSizes","reorderMarkerAttr","containerSize","targetY","allowedLevel","over","nextId","dropTarget","createDropTargetObject","targetId","prevSibling","nextSiblingTarget","dndTaskId","prevSiblingTarget","firstChildTarget","lastChildTarget","findClosesTarget","targetLevel","findTargetAbove","findTargetBelow","getSameLevelDropPosition","relTargetPos","eventTop","targetAbove","targetBelow","gridToPageCoordinates","gridPos","setWidthWithinContainer","higlighter","removeLineHighlight","markerLine","highlightPosition","ePos","pointerEvents","markerFolder","folderHighlightWidth","linePos","indentNode","indent","iconWidth","childCount","markerLineTop","rowDndMarker","opacity","drop_target","getDropPosition","doctype","minTop","firstVisibleTaskIndex","firstVisibleTaskId","firstVisibleTaskPos","hiddenTaskPart","gridPosition","gridBottom","placeholderRowHeight","lockLevel","getLockedLevelTarget","initializer","onCreated","extendGantt","_inlineEditors","onInitialized","initEvents","extendDom","onDestroyed","clearEvents","showDate","sorting_method","totalWidth","taskDnD","createTaskDND","roundTaskDates","round_task_dates","dragMultiple","before_start","before_finish","after_finish","clear_drag_state","set_actions","drag_from_start","stage","_move","_resize","_resize_progress","on_mouse_move","on_mouse_down","on_mouse_up","start_x","start_y","coords_x","_drag_task_coords","minDurationInUnits","_calculateMinDuration","diffValue","_find_max_shift","dragItems","correctShift","minX","maxX","maxShift","minShift","multipleDragShift","new_start","new_end","obj_s_x","obj_e_x","_mouse_position_change","oldPos","newPos","_is_number","isFinite","start_drag","sX","sY","now","_start_dnd","_update_on_move","_update_item_on_move","curr_date","dragHash","_isMultiselect","dragProject","initialDrag","childDrag","_get_drag_mode","_fix_dnd_scale_time","fixStart","_fix_working_times","_finalize_mouse_up","_fireEvent","_dhx_changed","finalizingBulkMove","moveCount","doFinalize","dragProperty","selectedTasksIds","selectedTask","_addSubtasksToDragMultiple","trigger","drag_state","summaryId","initLinksDND","_link_landing","_link_target_task","_link_target_task_start","_link_source_task","_link_source_task_start","getDndState","link_edge_marker","link_landing_hover_area","markerSize","viewportSize","ganttOffsetY","updateMarkedHtml","resetDndState","showDirectingLine","s_x","s_y","_direction","link_direction_class","dist","tan","angle","atan","coordinateCircleQuarter","sin","cos","shiftLeft","shiftTop","eX","eY","_dir_start","landing","prevTarget","prevLanding","prevToStart","targ","absCoords","domHelpers.getRelativeNodePosition","_dir_end","targetChanged","linkDnD","_linksDnD","_tasksDnD","MouseDelegates","_attachDomEvents","_attachStateProvider","_clearDomEvents","_clearStateProvider","_delete_link_handler","coll","coll_date","scale_step","getVerticalScrollbar","getHorizontalScrollbar","_legacyGridResizerClass","resizers","gridResizer","mainTimeline","colsWidth","hideGrid","grid_limits","ganttContainerWidth","verticalScrollbarWidth","gridOverflow","original_grid_width","skinSettings","skins","_initScrollStateEvents","_getVerticalScrollbar","_findGridResizer","gridFirst","_getSiblings","_behind","_front","resizeInfo","initialWidth","prevCellWidth","nextCellWidth","viewCell","limits","newBehindSize","newFrontSize","oldBackSize","oldFrontSize","newBackSize","ui$1","attachInitializer","uiFactory","Scrollbar","mainLayoutInitializer","mainTimelineInitializer","mainGridInitializer","ResourceGrid","ResourceTimeline","ResourceHistogram","layersEngine","createLayerFactory","previusSiblingContainer","defaultContainerSibling","addTaskLayer","rangeFunction","getVisibleTaskRange","_getTaskLayers","removeTaskLayer","addLinkLayer","getVisibleLinksRangeFactory","isLinkInViewport","_getLinkLayers","removeLinkLayer","gridEditorsFactory","layersApi","textValue","aria","gridAddButtonAttrString","justifyContent","center","gridCellAttrString","css_template","taskRowAttr","rowNode","cellNode","external_render","adapter","isElement","renderElement","renderedCells","isRendered","detachRenderedCell","getCellClassTemplate","getCellContentTemplate","renderOneCell","contentTemplate","cssTemplateContent","htmlTemplateContent","customCell","cellCssTemplate","cellHtmlTemplate","odd","placeholderTop","placeholderHeight","renderTaskBar","timedProjectBar","renderTimedProjectBar","taskRollupBar","renderedNodes","checkVisibility","generateChildElement","childCopy","$rendered_at","getKey","renderParentId","rollupKey","taskSplitBar","renderSplitTaskBar","taskConstraints","renderConstraints","taskDeadline","renderDeadline","renderBaselines","renderLink","resourceRow","getResourceLoad","resourceTimetable","renderedResourceLines","renderResourceLineCell","detachRenderedResourceLine","checkedColumns","resourceHistogram","resize_el","rowResizerAttr","layersService","_get_skin","themeVar","themeName","isCssVarTheme","href","_theme_info","theme","cssVarTheme","skinset","_second_column_width","_third_column_width","_lightbox_template","_redefine_lightbox_buttons","scrollRange","scrollDelay","scrollSpeed","isMove","delayTimeout","startPos","eventPos","isDisplayed","isScrollState","dragMarker","isResize","isLink","isClickDrag","defineDelayTimeout","speed","tick","autoscroll_delay","defineScrollInterval","autoscrollInterval","isScroll","gridDrag","need_scroll","currentScrollTop","scrollOuterHeight","scrollInnerHeight","currentScrollLeft","scrollOuterWidth","scrollInnerWidth","autoscroll_step","boxSize","$","jQuery","fn","dhx_gantt","each","newgantt","Gantt","getGanttInstance","jquery_hooks","dhtmlx","attaches","attachGantt","cmp","attachObject","dataType","dataObj","vs","av","border","gridId","gridObj","dhtmlXCellObject","dhtmlx_hooks","USE_KEY","_defaultScales","TimelineZoom","zoomIn","getCurrentLevel","setLevel","zoomOut","_levels","_activeLevelIndex","getLevels","zoomLevel","_getZoomIndexByName","levelName","_getVisibleDate","_visibleDate","cursorOffset","nextConfig","chartConfig","resourceView","resourceConfig","fixed_scales","cursorDate","newPosition","middleDate","_attachWheelEvent","_useKey","_handler","_defaultHandler","timelineOffset","wheelUp","stopPropagation","_setScaleSettings","_setScaleDates","_initialStartDate","_initialEndDate","activeLevelIndex","_mapScales","levels","_minColumnWidth","minColumnWidth","_maxColumnWidth","maxColumnWidth","_widthStep","widthStep","_stepUp","_stepDown","nextLevel","addTouchEvents","platform","maxTouchPoints","_touch_events","getTaskDND","tasksDnD","touch_feedback","touch_feedback_duration","vibrate","touchHandlers","names","dblclicktime","actionMode","scrollMode","actionStart","longTapTimer","currentDndId","dndNodes","targetView","multiTouchEvents","newScrollState","block_action","allViews","_locate_css","taskNode","dummy","BaseControl","BaseConstrutor","htmlHelpers","getHtmlSelect","_attributes","getHtmlOption","_getHtmlContainer","getHtmlButton","getHtmlDiv","getHtmlLabel","getHtmlInput","_getHtmlAttributes","ResourcesControlConstructor","Super","SelectControl","sns","_dhx_onchange","onchange","_focus","ParentControlConstructor","ParentControl","_display","allow_root","root_label","form_blocks","tmpDom","newOptions","onselect","TemplateControl","TextareaControl","_get_input","TimeControl","getTimePicker","sectionClassName","_time_format_order","auto_end_date","_update_lightbox_select","_fill_lightbox_select","_resolve_default_mapping","selects","getTimePickerValue","autofix_end","_get_timepicker_step","SelectControlConstructor","CheckboxControl","single_value","checkboxes","checked","resArray","RadioControl","radio","default_value","DurationControl","_getStartDate","_getDuration","singleDate","lightboxDurationInputAttrString","durationInputClass","duration_val","inps","btns","endspan","_calc_date","_change_duration","charCode","ResourcesControl","ConstraintControl","isNonTimedConstraint","toggleTimeSelect","timeSelects","typeValue","isNonTimed","disabled","typeSelect","_eventsInitialized","constraintDate","constraintType","getConstraintType","TypeselectControl","typeKey","oldOnChange","_lightbox_current_type","BaselineControl","_generateBaselineRow","durationLabel","deleteLabel","durationEl","deleteButton","baselineRow","section","baselineNode","baselineId","dataset","updatedBaseline","button_click","_get_typed_lightbox_config","_lightbox_methods","_lightbox_root","showCover","_fill_lightbox","_setLbPosition","lightboxVisibleAttr","getLabel","list_name","_lightbox_type","lightboxDiv","fullWidth","ds","classNames","cspEnvironment","salesforceEnvironment","setParentNode","_lightbox","_is_lightbox_timepicker","wide_form","getHtmlButtons","lightboxAttr","onmousedown","_ready_to_dnd","ontouchstart","onselectstart","cursor","_init_dnd_events","show_cover","_cover","_render_sections","backup_overflow","labelBlock","inputBlock","inputId","_init_lightbox_events","block","_center_lightbox","rootElement","_move_while_dnd","_finish_dnd","_get_type_name","type_value","floatRight","lightboxButtonAttrString","getTimeFormat","time_format","getHtmlTimePickerOptions","start_year","end_year","tdate","timeFormat","year_range","_time_values","lightbox_events","_save_lightbox","_cancel_lightbox","sec","buttonTarget","getLightboxValues","time_optional","duration_optional","lightboxHiddenAttr","hideCover","_custom_lightbox","_set_lightbox_values","lightboxHeader","lightbox_header","getLightboxSection","get_template_control","control","get_select_control","get_textarea_control","get_time_control","_dnd_start_lb","gantt_unselectable","lb","_lb_start","ariaAttrs","limit_time_select","first_hour","last_hour","lightboxSelectAttrString","mapOffset","checkbox","constraint","typeselect","oldType","ui","codeHelpers.arrayFind","domEventScope","uiApi","getTimeline","getGrid","getBaseCell","baseCell","getAttachedScrollbar","DEFAULT_VALUE","tryCall","getTaskTop","getTaskBarHeight","domAttr","getLinkNode","oldH","oldV","verticalViews","horizontalViews","commonViews","viewId","newV","newH","date_x","scroll_to","leftPos","_scroll_state","timelineCell","x_pos","y_pos","x_inner","y_inner","scrollVer","scrollHor","horState","verState","cellName","horizontalScroll","verticalScroll","createLayoutFacade","resetSkin","monitorThemeChange","_addThemeClass","setSkin","monitorIntervalId","csstheme","skyblue","lightbox_additional_height","dark","meadow","terrace","broadway","_config_buttons_left","_config_buttons_right","material","indx","zoom","_extend_to_optional","lightbox_block","optional_time","update_block","button_text","htmlTags","extraSpaces","stripHTMLLite","htmlText","singleQuotes","escapeQuotes","getAttributeString","_taskCommonAttr","linkTypes","toStart","fromStart","gridSeparatorAttr","buttonName","role","tabindex","headerText","time_option","buttonLabel","targetAttribute","_locateHTML","firstTask","domHelpers.getScrollSize","availablePlugins","critical_path","grouping","groupBy","overlay","_load_url","cl","_load_type"],"mappings":"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","x_google_ignoreList":[44]}